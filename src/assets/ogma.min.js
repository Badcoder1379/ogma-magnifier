/**
 * Ogma
 * @description Graph visualization library
 * @version 2.9.0 (built on Thu Nov 14 2019 12:07:15 GMT+0100 (Central European Standard Time))
 * @author Linkurious SAS
 * @license (c) Linkurious 2019. All rights reserved.
 * @preserve
 *
 * eslint-disable
 */
(function(e,t){typeof exports==="object"&&typeof module!=="undefined"?module.exports=t():typeof define==="function"&&define.amd?define(t):(e=e||self,e.Ogma=t())})(this,function(){"use strict";if(!Array.prototype.fill){Object.defineProperty(Array.prototype,"fill",{value:function(value){if(this==null){throw new TypeError("this is null or not defined")}var e=Object(this);var t=e.length>>>0;var r=arguments[1];var i=r>>0;var n=i<0?Math.max(t+i,0):Math.min(i,t);var a=arguments[2];var o=a===undefined?t:a>>0;var s=o<0?Math.max(t+o,0):Math.min(o,t);while(n<s){e[n]=value;n++}return e}})}if(!Array.prototype.copyWithin){Array.prototype.copyWithin=function(e,t){if(this==null){throw new TypeError("this is null or not defined")}var r=Object(this);var i=r.length>>>0;var n=e>>0;var a=n<0?Math.max(i+n,0):Math.min(n,i);var o=t>>0;var s=o<0?Math.max(i+o,0):Math.min(o,i);var u=arguments[2];var l=u===undefined?i:u>>0;var d=l<0?Math.max(i+l,0):Math.min(l,i);var h=Math.min(d-s,i-a);var f=1;if(s<a&&a<s+h){f=-1;s+=h-1;a+=h-1}while(h>0){if(s in r){r[a]=r[s]}else{delete r[a]}s+=f;a+=f;h--}return r}}if(!Array.prototype.lastIndexOf){Array.prototype.lastIndexOf=function(e){if(this===void 0||this===null){throw new TypeError}var t,r,i=Object(this),n=i.length>>>0;if(n===0){return-1}t=n-1;if(arguments.length>1){t=Number(arguments[1]);if(t!=t){t=0}else if(t!=0&&t!=1/0&&t!=-(1/0)){t=(t>0||-1)*Math.floor(Math.abs(t))}}for(r=t>=0?Math.min(t,n-1):n-Math.abs(t);r>=0;r--){if(r in i&&i[r]===e){return r}}return-1}}if(!Array.from){Array.from=function(){var e=Object.prototype.toString;var t=function(t){return typeof t==="function"||e.call(t)==="[object Function]"};var r=function(value){var e=Number(value);if(isNaN(e)){return 0}if(e===0||!isFinite(e)){return e}return(e>0?1:-1)*Math.floor(Math.abs(e))};var i=Math.pow(2,53)-1;var n=function(value){var e=r(value);return Math.min(Math.max(e,0),i)};return function e(r){var i=this;var a=Object(r);if(r==null){throw new TypeError("Array.from requires an array-like object - not null or undefined")}var o=arguments.length>1?arguments[1]:void undefined;var s;if(typeof o!=="undefined"){if(!t(o)){throw new TypeError("Array.from: when provided, the second argument must be a function")}if(arguments.length>2){s=arguments[2]}}var u=n(a.length);var l=t(i)?Object(new i(u)):new Array(u);var d=0;var h;while(d<u){h=a[d];if(o){l[d]=typeof s==="undefined"?o(h,d):o.call(s,h,d)}else{l[d]=h}d+=1}l.length=u;return l}}()}if(!Array.prototype.includes){Object.defineProperty(Array.prototype,"includes",{value:function(e,t){if(this==null){throw new TypeError('"this" is null or not defined')}var r=Object(this);var i=r.length>>>0;if(i===0){return false}var n=t|0;var a=Math.max(n>=0?n:i-Math.abs(n),0);function o(e,t){return e===t||typeof e==="number"&&typeof t==="number"&&isNaN(e)&&isNaN(t)}while(a<i){if(o(r[a],e)){return true}a++}return false}})}if(!Array.prototype.find){Object.defineProperty(Array.prototype,"find",{value:function(e){if(this==null){throw new TypeError('"this" is null or not defined')}var t=Object(this);var r=t.length>>>0;if(typeof e!=="function"){throw new TypeError("predicate must be a function")}var i=arguments[1];var n=0;while(n<r){var a=t[n];if(e.call(i,a,n,t)){return a}n++}return undefined},configurable:true,writable:true})}var e=[Uint32Array,Uint16Array,Uint8Array,Int32Array,Int16Array,Int8Array,Float32Array,Float64Array];var t=["join","slice","reverse","forEach","map","includes","copyWithin","reduce","indexOf","sort","filter","every","some","fill"];if(!ArrayBuffer.isView){ArrayBuffer.isView=function(t){for(var r=0;r<e.length;++r){if(t instanceof e[r]){return true}}return false}}var r=function(e){return function(t,r){return new e(Array.prototype.slice.call(this,t,r))}};var i=function(){var e=a[n];for(var i=0,o=t;i<o.length;i+=1){var s=o[i];if(!e.prototype[s]){var u=s==="slice"?r(e):Array.prototype[s];e.prototype[s]=u}}if(!e.from){(function(){e.from=function(t,r,i){var n=e.__proto__;if(typeof this!=="function"){throw new TypeError("# is not a constructor")}if(this.__proto__!==n){throw new TypeError("this is not a typed array.")}r=r||function(e){return e};if(typeof r!=="function"){throw new TypeError("specified argument is not a function")}t=Object(t);if(!t["length"]){return new this(0)}var a=[];for(var o=0;o<t.length;o++){a.push(t[o])}a=a.map(r,i);var s=new this(a.length);for(var o=0;o<s.length;o++){s[o]=a[o]}return s}})()}};for(var n=0,a=e;n<a.length;n+=1)i();if(typeof CanvasRenderingContext2D!=="undefined"&&!CanvasRenderingContext2D.prototype.setLineDash){CanvasRenderingContext2D.prototype.setLineDash=function(){}}if(!Math.log2){Math.log2=function(e){return Math.log(e)*Math.LOG2E}}if(!Math.sign){Math.sign=function(e){return(e>0)-(e<0)||+e}}if(!Number.isNaN){Number.isNaN=function(value){return typeof value==="number"&&isNaN(value)}}if(!Number.MAX_SAFE_INTEGER){Object.defineProperty(Number,"MAX_SAFE_INTEGER",{enumerable:false,configurable:false,writable:false,value:Math.pow(2,53)-1})}var o=typeof window!=="undefined"?window:typeof global!=="undefined"?global:typeof self!=="undefined"?self:{};function s(e,t){return t={exports:{}},e(t,t.exports),t.exports}(function(){var e=setTimeout;function t(){}function r(e,t){return function(){e.apply(t,arguments)}}function i(e){if(typeof this!=="object"){throw new TypeError("Promises must be constructed via new")}if(typeof e!=="function"){throw new TypeError("not a function")}this._state=0;this._handled=false;this._value=undefined;this._deferreds=[];d(e,this)}function n(e,t){while(e._state===3){e=e._value}if(e._state===0){e._deferreds.push(t);return}e._handled=true;i._immediateFn(function(){var r=e._state===1?t.onFulfilled:t.onRejected;if(r===null){(e._state===1?a:s)(t.promise,e._value);return}var i;try{i=r(e._value)}catch(e){s(t.promise,e);return}a(t.promise,i)})}function a(e,t){try{if(t===e){throw new TypeError("A promise cannot be resolved with itself.")}if(t&&(typeof t==="object"||typeof t==="function")){var n=t.then;if(t instanceof i){e._state=3;e._value=t;u(e);return}else if(typeof n==="function"){d(r(n,t),e);return}}e._state=1;e._value=t;u(e)}catch(t){s(e,t)}}function s(e,t){e._state=2;e._value=t;u(e)}function u(e){if(e._state===2&&e._deferreds.length===0){i._immediateFn(function(){if(!e._handled){i._unhandledRejectionFn(e._value)}})}for(var t=0,r=e._deferreds.length;t<r;t++){n(e,e._deferreds[t])}e._deferreds=null}function l(e,t,r){this.onFulfilled=typeof e==="function"?e:null;this.onRejected=typeof t==="function"?t:null;this.promise=r}function d(e,t){var r=false;try{e(function(value){if(r){return}r=true;a(t,value)},function(e){if(r){return}r=true;s(t,e)})}catch(e){if(r){return}r=true;s(t,e)}}i.prototype.catch=function(e){return this.then(null,e)};i.prototype.then=function(e,r){var i=new this.constructor(t);n(this,new l(e,r,i));return i};i.all=function(e){var t=Array.prototype.slice.call(e);return new i(function(e,r){if(t.length===0){return e([])}var i=t.length;function n(a,o){try{if(o&&(typeof o==="object"||typeof o==="function")){var s=o.then;if(typeof s==="function"){s.call(o,function(e){n(a,e)},r);return}}t[a]=o;if(--i===0){e(t)}}catch(e){r(e)}}for(var a=0;a<t.length;a++){n(a,t[a])}})};i.resolve=function(value){if(value&&typeof value==="object"&&value.constructor===i){return value}return new i(function(e){e(value)})};i.reject=function(value){return new i(function(e,t){t(value)})};i.race=function(e){return new i(function(t,r){for(var i=0,n=e.length;i<n;i++){e[i].then(t,r)}})};i._immediateFn=typeof o.setImmediate==="function"&&function(e){o.setImmediate(e)}||function(t){e(t,0)};i._unhandledRejectionFn=function e(t){if(typeof console!=="undefined"&&console){console.warn("Possible Unhandled Promise Rejection:",t)}};i._setImmediateFn=function e(t){i._immediateFn=t};i._setUnhandledRejectionFn=function e(t){i._unhandledRejectionFn=t};if(typeof o==="object"&&!o.Promise){o.exports=i}if(typeof window==="object"&&!window.Promise){window.Promise=i}})();if(!String.prototype.endsWith){String.prototype.endsWith=function(e,t){var r=this.toString();if(typeof t!=="number"||!isFinite(t)||Math.floor(t)!==t||t>r.length){t=r.length}t-=e.length;var i=r.lastIndexOf(e,t);return i!==-1&&i===t}}if(!String.prototype.startsWith){String.prototype.startsWith=function(e,t){return this.substr(t||0,e.length)===e}}if(!String.prototype.includes){String.prototype.includes=function(e,t){if(typeof t!=="number"){t=0}if(t+e.length>this.length){return false}else{return this.indexOf(e,t)!==-1}}}if(typeof Object.assign!=="function"){Object.defineProperty(Object,"assign",{value:function e(t){var r=arguments;if(t==null){throw new TypeError("Cannot convert undefined or null to object")}var i=Object(t);for(var n=1;n<arguments.length;n++){var a=r[n];if(a!=null){for(var o in a){if(Object.prototype.hasOwnProperty.call(a,o)){i[o]=a[o]}}}}return i},writable:true,configurable:true})}var u=function(e,t){u=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t){if(t.hasOwnProperty(r)){e[r]=t[r]}}};return u(e,t)};function l(e,t){u(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}var d=function(){d=Object.assign||function e(t){var r=arguments;for(var i,n=1,a=arguments.length;n<a;n++){i=r[n];for(var o in i){if(Object.prototype.hasOwnProperty.call(i,o)){t[o]=i[o]}}}return t};return d.apply(this,arguments)};function h(e,t){var r={};for(var i in e){if(Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0){r[i]=e[i]}}if(e!=null&&typeof Object.getOwnPropertySymbols==="function"){for(var n=0,i=Object.getOwnPropertySymbols(e);n<i.length;n++){if(t.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(e,i[n])){r[i[n]]=e[i[n]]}}}return r}var f=typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{};var c={};var v={};var p={};var g=function(){return null};if(typeof f==="object"){v=f}if(typeof window==="object"){p=window}if(typeof module==="object"&&typeof module.require==="function"){var _=module.require.bind(module);g=function(e){try{return _(e)}catch(e){return null}}}else if(typeof v.require==="function"){g=function(e){var t=module.require;try{return t(e)}catch(e){return null}}}function m(e,t){if(t===void 0)t={};var r=t.throwOnError;var i=null;if(!i&&e){i=c[e]}if(!i&&e){i=g(e)}if(!i&&e){i=p[e]}if(!i&&e){i=v[e]}if(!i&&r){var n=['unable to find module "'+e+'"; make sure one of these statements is true:',"- Ogma.libraries['"+e+"'] is set to the right library","- require('"+e+"') returns the right library","- window['"+e+"'] is set to the right library"].join("\n");throw new Error(n)}return i}function y(e,t){for(var r=1,i=e.length;r<i;r++){var n=e[r];var a=r;while(a>0&&t.get(e[a-1])>t.get(n)){e[a]=e[a-1];--a}e[a]=n}return e}function b(e,t){for(var r=1,i=e.length;r<i;r++){var n=e[r];var a=r;while(a>0&&t.get(e[a-1])<t.get(n)){e[a]=e[a-1];--a}e[a]=n}return e}function x(value){return Array.isArray(value)||ArrayBuffer.isView(value)}function A(value){return Array.isArray(value)?value:[value]}function E(e){var t=[];for(var r=0;r<e.length;++r){var i=e[r];if(Array.isArray(i)){for(var n=0;n<i.length;++n){t.push(i[n])}}else{t.push(i)}}return t}function S(){var e=arguments;var t=[];for(var r=0;r<arguments.length;r++){t[r]=e[r]}if(t.length===0){return[]}var i=t[0].constructor;var n=0;for(var a=0,o=t;a<o.length;a++){var s=o[a];n+=s.length}var u=new i(n);var l=0;for(var d=0,h=t;d<h.length;d++){var s=h[d];for(var f=0;f<s.length;f++){u[l+f]=s[f]}l+=s.length}return u}function w(e,t){var r=e.indexOf(t);if(r!==-1){e.splice(r,1);return true}return false}function T(e){return typeof e==="number"&&e%1===0}function C(e){if(!e){return[]}if(typeof e==="string"){return e.split(".")}if(Array.isArray(e)){for(var t=0;t<e.length;++t){if(typeof e[t]!=="string"){throw new TypeError(e[t]+" is not a string")}}return e.slice()}throw new TypeError('invalid property path "'+e+'": expected string or array of strings')}function I(e,t,r){var i,n;var a;if(t===0){return function(){e.apply(r,arguments)}}var o=function(){i=false;if(n){a.apply(r,n);n=null}};a=function(){var a;if(i){n=arguments}else{a=e.apply(r,arguments);setTimeout(o,t);i=true}return a};return a}function M(e,t,r){var i;var n,a;var o,s;if(t===0||t===undefined){t=100}function u(){var l=Date.now()-o;if(l<t&&l>=0){i=setTimeout(u,t-l)}else{i=null;if(!r){s=e.apply(a,n);a=n=null}}}var l=function(){a=this;n=arguments;o=Date.now();var l=r&&!i;if(!i){i=setTimeout(u,t)}if(l){s=e.apply(a,n);a=n=null}return s};l.clear=function(){if(i){clearTimeout(i);i=null}};l.flush=function(){if(i){s=e.apply(a,n);a=n=null;clearTimeout(i);i=null}};return l}function L(e,t,r,i,n){r(e[t],t,e,i,n).then(function(a){if(t===e.length-1){i(a)}else{L(e,t+1,r,i,n)}}).catch(n)}function k(e,t){return new Promise(function(r,i){return L(e,0,t,r,i)})}function N(){return new Uint8Array(new Uint32Array([305419896]).buffer)[0]===120}function F(e){return e.reduce(function(e,t){return e.then(t)},Promise.resolve())}function z(e){return e!==null&&typeof e==="object"&&!x(e)&&!(e instanceof RegExp)&&(typeof HTMLElement==="undefined"||!(e instanceof HTMLElement))}function R(e){var t=Object.keys(e);var r=new Array(t.length);for(var i=0;i<t.length;++i){r[i]=e[t[i]]}return r}function P(e,t,r){if(Array.isArray(e)){return e.forEach(t,r)}if(!z(e)){throw new Error("forEach: invalid argument "+JSON.stringify(e))}var i=Object.keys(e);if(r!==undefined){for(var n=0;n<i.length;++n){var a=i[n];t.call(r,e[a],a)}}else{for(var n=0;n<i.length;++n){var a=i[n];t(e[a],a)}}}function O(e){if(Array.isArray(e)){var t=new Array(e.length);for(var r=0;r<e.length;++r){t[r]=O(e[r])}return t}if(!Y(e)){return e}var i={};var n=Object.keys(e);for(var r=0;r<n.length;++r){var a=n[r];i[a]=O(e[a])}return i}function D(e,t){P(t,function(t,value){if(typeof value==="object"&&value!==null){if(typeof e[t]!=="object"||e[t]===null){e[t]={}}D(e[t],value)}else{e[t]=value}})}function B(e,t){t.forEach(function(t){if(e.indexOf(t)===-1){e.push(t)}})}function V(e,t,value){var r=typeof t==="string"?t.split("."):t;for(var i=0;i<r.length-1;++i){var n=r[i];var a=e[n];if(!a){a={};e[n]=a}e=a}e[r[r.length-1]]=value}function j(e,t){var r=C(t);if(!r.length){return e}if(!e){return undefined}for(var i=0;i<r.length-1;++i){var n=r[i];var a=e[n];if(!a){return undefined}e=a}return e[r[r.length-1]]}function U(e,t,r){if(r===void 0){r="."}if(!t){t=function(e){return!z(e)}}var i={};var n=Object.keys(e);for(var a=0;a<n.length;++a){var o=n[a];var value=e[o];if(!t(value)){var s=U(value,t);var u=Object.keys(s);for(var l=0;l<u.length;l++){var d=u[l];i[""+o+r+d]=s[d]}}else{i[o]=value}}return i}function G(e){var t={};var r=Object.keys(e);for(var i=0;i<r.length;++i){var n=r[i];V(t,n,e[n])}return t}function q(e,t,r){if(r===void 0){r=[]}var i=Object.keys(e);for(var n=0;n<i.length;++n){var a=i[n];var value=e[a];var o=t?t+a:a;if(!Y(value)){r.push(o)}else{q(value,o+".",r)}}return r}function H(e,t){if(t===void 0){t=[]}if(!Y(e)){t.push(e)}else{var r=Object.keys(e);for(var i=0,n=r;i<n.length;i++){var a=n[i];H(e[a],t)}}return t}function W(e){for(var t in e){if(typeof e[t]==="function"){delete e[t]}}return e}function X(value,e){if(value===undefined){return O(e)}if(!z(value)){return value}var t={};var r=Object.keys(e);for(var i=0,n=r;i<n.length;i++){var a=n[i];var o=e[a];var s=value[a];if(z(o)){t[a]=X(s,o)}else if(s===undefined){t[a]=O(o)}else{t[a]=s}}return t}function Y(value){return value&&(value.constructor===Object||!value.constructor)}function Z(e,t){if(!Y(t)||!Y(e)){return t}var r=Object.assign({},e);var i=Object.keys(t);for(var n=0;n<i.length;++n){var a=i[n];r[a]=Z(r[a],t[a])}return r}function K(e,t){if(t==null){return e}return t.reduce(function(t,r){t[r]=e[r];return t},{})}var Q=function(){var e=0;return typeof requestAnimationFrame!=="undefined"?requestAnimationFrame:function(t){var r=Date.now();var i=Math.min(16,Math.max(0,16-(r-e)));var n=e=r+i;return setTimeout(function(){return t(n)},i)}}();var J=typeof cancelAnimationFrame!=="undefined"?cancelAnimationFrame:function(e){return clearTimeout(e)};function $(e,t){return Q(function(r){e.call(t,r)})}function ee(e){if(e){J(e)}}var te=300;var re=150;var ie;var ne;var ae;var oe;var se;var ue;var le=function e(){if(e.onCreate){e.onCreate(this)}};le.prototype.open=function e(t,r){this.method=t;this.url=r;if(le.onSend){le.onSend(this)}};le.prototype.respond=function e(t,r,i){this.readyState=4;this.status=t;this.headers=r;this.responseText=i;this.response=i;this.onreadystatechange()};le.prototype.send=function e(){this.readyState=4};var de=function e(){if(e.onCreate){e.onCreate(this)}};de.prototype.readAsDataURL=function e(t){this._blob=t;if(de.onRead){de.onRead(this)}};de.prototype.load=function e(t){if(typeof t==="function"){this.result=t(this._blob)}else{this.result=t}if(this.onload){this.onload()}};(function(){ie=m("xmldom");ne=m("canvas")||m("canvas-prebuilt");if(typeof XMLSerializer!=="undefined"){ae=XMLSerializer}else if(ie){ae=ie.XMLSerializer}else{ae=null}if(typeof document!=="undefined"){oe=document}else if(ie){oe=(new ie.DOMImplementation).createDocument()}else{oe=null}if(typeof XMLHttpRequest!=="undefined"){se=XMLHttpRequest}else{se=le}if(typeof FileReader!=="undefined"){ue=FileReader}else{ue=de}})();function he(){if(oe){return oe}else{return{createElementNS:function e(){return null},createElement:function e(){return null},implementation:{createDocument:function e(){throw new Error('unable to create XML document; if you use Node JS install the "xmldom" package')}}}}}function fe(e,t){var value=e.style[t]||e.currentStyle&&e.currentStyle[t];if((!value||value==="auto")&&he().defaultView){var r=document.defaultView.getComputedStyle(e,null);value=r?r[t]:null}return value==="auto"?null:value}function ce(){return ve(Se(),{})!==null}function ve(e,t){var r=e.getContext("webgl",t);if(!r){r=e.getContext("experimental-webgl",t)}return r||null}var pe=function e(){this.onmousewheel=function(){};this.__dummy=true;this.style={width:"0px",height:"0px",top:null,left:null,position:""};this.clientWidth=0;this.clientHeight=0;this.childNodes=[]};var ge={offsetWidth:{configurable:true},offsetHeight:{configurable:true},firstChild:{configurable:true},parentNode:{configurable:true},classList:{configurable:true},innerHTML:{configurable:true}};ge.offsetWidth.get=function(){return parseFloat(this.style.width)};ge.offsetHeight.get=function(){return parseFloat(this.style.height)};ge.firstChild.get=function(){return null};ge.parentNode.get=function(){return null};ge.classList.get=function(){return{add:function e(){},remove:function e(){}}};ge.innerHTML.get=function(){return""};ge.innerHTML.set=function(e){};pe.prototype.appendChild=function e(){};pe.prototype.removeChild=function e(){};pe.prototype.addEventListener=function e(){};pe.prototype.removeEventListener=function e(){};pe.prototype.insertBefore=function e(){};pe.prototype.contains=function e(t){return false};Object.defineProperties(pe.prototype,ge);var _e=function e(){this.__context=new ye;this.style={};this.width=te;this.height=re};var me={__dummy:{configurable:true},parentNode:{configurable:true}};me.__dummy.get=function(){return true};me.parentNode.get=function(){return null};_e.prototype.getContext=function e(t){return t==="2d"?this.__context:null};_e.prototype.toDataURL=function e(t){if(t===void 0)t="png";return"data:image/"+t+";base64,"};_e.prototype.addEventListener=function e(){};_e.prototype.removeEventListener=function e(){};_e.prototype.getBoundingClientRect=function e(){return{left:0,top:0,bottom:0,right:0,width:this.width,height:this.height}};Object.defineProperties(_e.prototype,me);var ye=function e(){this._fontSize=10};var be={font:{configurable:true},fillStyle:{configurable:true},textBaseline:{configurable:true},textAlign:{configurable:true},strokeStyle:{configurable:true},lineWidth:{configurable:true}};be.font.set=function(e){var t=e.match(/\d+/);if(t){this._fontSize=parseFloat(t[0])}};be.fillStyle.set=function(e){};be.textBaseline.set=function(e){};be.textAlign.set=function(e){};be.strokeStyle.set=function(e){};be.lineWidth.set=function(e){};ye.prototype.fill=function e(){};ye.prototype.stroke=function e(){};ye.prototype.clearRect=function e(){};ye.prototype.fillRect=function e(){};ye.prototype.strokeRect=function e(){};ye.prototype.beginPath=function e(){};ye.prototype.closePath=function e(){};ye.prototype.moveTo=function e(){};ye.prototype.lineTo=function e(){};ye.prototype.rect=function e(){};ye.prototype.arc=function e(){};ye.prototype.save=function e(){};ye.prototype.restore=function e(){};ye.prototype.clip=function e(){};ye.prototype.translate=function e(){};ye.prototype.rotate=function e(){};ye.prototype.fillText=function e(){};ye.prototype.setLineDash=function e(){};ye.prototype.quadraticCurveTo=function e(){};ye.prototype.bezierCurveTo=function e(){};ye.prototype.drawImage=function e(){};ye.prototype.measureText=function e(t){return{width:t.length*Math.ceil(this._fontSize*.625)}};ye.prototype.getImageData=function e(){return{width:0,height:0,data:new Uint8ClampedArray(0)}};Object.defineProperties(ye.prototype,be);function xe(){return new pe}function Ae(){return oe.implementation.createDocument("","",null)}function Ee(e){return(new ae).serializeToString(e)}function Se(){var e=null;if(typeof document!=="undefined"){e=document.createElement("canvas")}else if(ne){if(ne.createCanvas){e=ne.createCanvas(te,re)}else{e=new ne(te,re)}e.style={}}else{e=new _e}return e}function we(){return typeof window!=="undefined"&&window.devicePixelRatio||1}function Te(e){var t=";base64,";var r,i,n;if(e.indexOf(t)===-1){r=e.split(",");i=r[0].split(":")[1];n=decodeURIComponent(r[1]);return Ie(n,i)}r=e.split(t);i=r[0].split(":")[1];n=window.atob(r[1]);var a=n.length;var o=new Uint8Array(a);for(var s=0;s<a;++s){o[s]=n.charCodeAt(s)}return Ie([o],i)}function Ce(e,t){this.data=e;this.type=t}function Ie(e,t){if(typeof Blob!=="undefined"){return new Blob(e,{type:t})}else{return new Ce(e,t)}}function Me(e){if(typeof Blob!=="undefined"){return e instanceof Blob||e instanceof Ce}else{return e instanceof Ce}}function Le(e,t,r){if(typeof window==="undefined"||window["__OGMA_HEADLESS"]){return e}var i=null;var n=null;var a=null;if(window.Blob){if(r==="blob"){i=e}else if(r==="dataURL"){i=Te(e)}else{i=Ie([e],"text/xml")}n=window.URL.createObjectURL(i)}else{a="data:text/xml;charset=UTF-8,"+encodeURIComponent('<?xml version="1.0" encoding="UTF-8"?>')+encodeURIComponent(e)}if(navigator.msSaveBlob){navigator.msSaveBlob(i,t)}else if(navigator.msSaveOrOpenBlob){navigator.msSaveOrOpenBlob(i,t)}else{var o=document.createElement("a");o.setAttribute("href",window.Blob?n:a);o.setAttribute("download",t);document.body.appendChild(o);o.click();document.body.removeChild(o)}if(n){setTimeout(function(){window.URL.revokeObjectURL(n)},0)}return e}function ke(e,t,r,i){if(!i){i=we()}e.style.width=t+"px";e.style.height=r+"px";e.width=t*i;e.height=r*i}function Ne(e,t){P(t,function(value,t){if(value!==undefined){e.setAttribute(t,value)}})}var Fe="http://www.w3.org/2000/svg";var ze="http://www.w3.org/2000/xmlns/";var Re="http://www.w3.org/1999/xlink";function Pe(e,t){var r=oe.createElementNS(Fe,e);if(!r.style){r.style={}}if(t){Ne(r,t)}return r}function Oe(e){return oe.createTextNode(e)}function De(e){if(typeof Image==="undefined"){return Promise.resolve(null)}return new Promise(function(t){var r=new Image;r.src=e;r.onload=function(){return t(r)};r.onerror=function(){return t(null)}})}function Be(e){if(e.indexOf("http://")===0||e.indexOf("https://")===0){return e}var t=window.location.origin;var r=window.location.pathname;var i=r.lastIndexOf("/");if(i===-1){return t+"/"+e}else{return t+r.substr(0,i)+"/"+e}}function Ve(e){return new Promise(function(t,r){var i=new se;i.open("GET",Be(e),true);i.onreadystatechange=function(){if(i.readyState===4){var n=i.status;if(n===200){t(i.responseText)}else if(n!==0){r(new Error('cannot retrieve file at url "'+e+'"; the server responded with status code '+n+"."))}else{r(new Error('cannot send XMLHttpRequest to url "'+e+"\"; if you're using the local file protocol this is most likely the cause."))}}};i.onerror=function(){r(new Error('cannot retrieve file at url "'+e+'"; the XMLHttpRequest failed.'))};i.send()})}function je(e){return typeof HTMLElement!=="undefined"?e instanceof HTMLElement:false}function Ue(e,t){e.style.cursor=t;if(e.style.cursor!==t){e.style.cursor="-webkit-"+t}}var Ge=function e(){this._src="";this._width=0;this._height=0};var qe={src:{configurable:true},width:{configurable:true},height:{configurable:true}};qe.src.set=function(e){this._src=e;return this};qe.src.get=function(){return this._src};qe.width.get=function(){return this._width};qe.width.set=function(e){return this._width=e};qe.height.get=function(){return this._height};qe.height.set=function(e){return this._height=e};Object.defineProperties(Ge.prototype,qe);function He(e){if(!e.getBoundingClientRect){return null}try{return e.getBoundingClientRect()}catch(e){return null}}function We(e){return new Promise(function(t,r){var i=new se;i.responseType="blob";i.open("GET",Be(e),true);i.onreadystatechange=function(){if(i.readyState===4){if(i.status===200){t(i.response)}else{r(i.status)}}};i.onerror=function(e){return r(e)};i.send()})}function Xe(e){return We(e).then(function(e){return new Promise(function(t,r){var i=new ue;i.onerror=r;i.onload=function(){return t(i.result)};i.readAsDataURL(e)})})}function Ye(e,t,r,i){if(i===void 0)i="";e.font=i+" "+r+"px "+t}function Ze(e,t){if(t===void 0)t=true;var r=t?"&#13;":"\n";return(""+e).replace(/&/g,"&amp;").replace(/'/g,"&apos;").replace(/"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\r\n/g,r).replace(/[\r\n]/g,r)}var Ke={0:"left",1:"middle",2:"right"};function Qe(e){if(e.baseURI){return e.baseURI}var t=e.getElementsByTagName("base");if(t.length>0){return t[0].href}return e.URL||e.location.href}function Je(e,t,r,i){return new Promise(function(n){var a=t;var o=Date.now();var s=(r-t)*Math.min(1,1/(i/16));function u(){if(Date.now()-o<i){a=Math.min(1,Math.max(0,a+s));e.style.opacity=a.toString();$(u)}else{n()}}u()})}var $e=typeof performance!=="undefined"&&performance.now?function(){return performance.now()|0}:function(){return Date.now()};var et=$e();function tt(){return $e()-et}function rt(){var e=new Date;var t=e.getDate();var r=e.getMonth()+1;var i=e.getFullYear();return i+"-"+(r<10?"0"+r:r)+"-"+(t<10?"0"+t:t)}function it(){var e=new Date;var t=nt((e.getUTCHours()-(e.getTimezoneOffset()/60|0))%24);var r=nt(e.getUTCMinutes());var i=nt(e.getUTCSeconds());var n=nt(e.getUTCMilliseconds(),3);return"["+t+":"+r+":"+i+":"+n+"]"}function nt(e,t){if(t===void 0){t=2}var r=Math.pow(10,t-1);var i=String(e);while(r>1){if(e<r){i="0"+i}r/=10}return i}var at=typeof window!=="undefined";var ot=at&&!window.PointerEvent&&window.MSPointerEvent;var st=at&&!!(window.PointerEvent||ot);var ut=ot?"MSPointerDown":"pointerdown";var lt=ot?"MSPointerMove":"pointermove";var dt=ot?"MSPointerUp":"pointerup";var ht=ot?"MSPointerCancel":"pointercancel";var ft={};var ct=0;function vt(e){return e.pointerType==="mouse"||e.MSPOINTER_TYPE_MOUSE&&e.pointerType===e.MSPOINTER_TYPE_MOUSE}function pt(e){return e.pointerType!=="mouse"&&(e.MSPOINTER_TYPE_MOUSE&&e.pointerType!==e.MSPOINTER_TYPE_MOUSE)}function gt(){if(typeof document!=="undefined"&&ct===0&&st){var e=document.documentElement;e.addEventListener(ut,mt,true);e.addEventListener(lt,yt,true);e.addEventListener(dt,bt,true);e.addEventListener(ht,bt,true)}ct++}function _t(){ct--;if(typeof document!=="undefined"&&ct===0){var e=document.documentElement;e.removeEventListener(ut,mt,true);e.removeEventListener(lt,yt,true);e.removeEventListener(dt,bt,true);e.removeEventListener(ht,bt,true)}}function mt(e){ft[e.pointerId]=e}function yt(e){if(ft[e.pointerId]){ft[e.pointerId]=e}}function bt(e){delete ft[e.pointerId]}function xt(e,t){e.touches=[];for(var r in ft){e.touches.push(ft[r])}e.changedTouches=[e];t(e)}function At(e,t,r){var i=function(e){if(vt(e)){return}if(pt(e)){e.preventDefault()}xt(e,r)};e(t,ut,i,false);return i}function Et(e,t,r){var i=function(e){if(pt(e)){e.preventDefault()}xt(e,r)};e(t,ht,i,false);return i}function St(e,t,r){var i=function(e){if(vt(e)&&e.buttons===0){return}xt(e,r)};e(t,lt,i,false);return i}function wt(e,t,r){var i=function(e){return xt(e,r)};e(t,dt,i,false);e(t,ht,i,false);return i}function Tt(e,t,r,i){if(r==="touchstart"){return e(t,ut,i,false)}if(r==="touchmove"){return e(t,lt,i,false)}if(r==="touchend"){e(t,dt,i,false);return e(t,ht,i,false)}}var Ct=function(){function e(){}e.prototype.onMounted=function(e,t){};e.prototype.destroy=function(e){};return e}();var It;(function(e){e["MOVE"]="move";e["DOWN"]="down";e["UP"]="up";e["CLICK"]="click";e["DOUBLE_CLICK"]="doubleClick";e["HOVER"]="hover";e["UNHOVER"]="unhover";e["WHEEL"]="wheel";e["DRAG_START"]="dragStart";e["DRAG_PROGRESS"]="dragProgress";e["DRAG_END"]="dragEnd";e["GESTURE_START"]="gestureStart";e["GESTURE_PROGRESS"]="gestureProgress";e["GESTURE_END"]="gestureEnd";e["RESIZE"]="resize";e["ADD_NODES"]="addNodes";e["ADD_EDGES"]="addEdges";e["REMOVE_NODES"]="removeNodes";e["REMOVE_EDGES"]="removeEdges";e["BEFORE_REMOVE_NODES"]="beforeRemoveNodes";e["BEFORE_REMOVE_EDGES"]="beforeRemoveEdges";e["CLEAR_GRAPH"]="clear";e["EXCLUDED_STATE_CHANGE"]="excludedStateChange";e["START_ZOOM"]="startZoom";e["VIEW_CHANGED"]="viewChanged";e["MOVE_END"]="moveEnd";e["CAMERA_MOVE"]="cameraMove";e["NODES_DRAG_START"]="startMoveNodesByDragging";e["NODES_DRAG_PROGRESS"]="progressMoveNodesByDragging";e["NODES_DRAG_END"]="endMoveNodesByDragging";e["ANIMATE"]="animate";e["NEW_FRAME"]="newFrame";e["BEFORE_NEW_FRAME"]="beforeNewFrame";e["AFTER_NEW_FRAME"]="afterNewFrame";e["SET_CONTAINER"]="setContainer";e["MOUSE_LEAVE"]="mouseLeave"})(It||(It={}));var Mt=["graphics","legend","brand"];var Lt=300;var kt=300;var Nt=function(e){l(t,e);function t(t,r){var i=t.events,n=t.settings;var a=r===void 0?{}:r,o=a.width,s=o===void 0?Lt:o,u=a.height,l=u===void 0?kt:u;var d=e.call(this)||this;d._layers={};d._focus=false;d._container=null;d._isFullScreen=false;d._beforeNextFramePromises=[];d._afterNextFramePromises=[];d._refreshUntil=0;d._currentTime=tt();d._timeouts=[];d._isDestroyed=false;d._onDetachDom=[];d._isRealBrowser=typeof window!=="undefined"&&!window.__OGMA_HEADLESS;d._isDocumentReady=typeof document!=="undefined"&&!window.__OGMA_HEADLESS;d._inFrame=false;d._mustRefresh=false;d._nextFrame=null;d._onWindowResize=function(){return d._resize()};d._onWindowFocus=function(){return d.refresh()};d._events=i;d._settings=n;d._width=s;d._height=l;d._settings.register("minimumWidth",Lt,function(){return d._resize()},false);d._settings.register("minimumHeight",kt,function(){return d._resize()},false);d._events.register([It.BEFORE_NEW_FRAME,It.NEW_FRAME,It.AFTER_NEW_FRAME,It.SET_CONTAINER,It.RESIZE]);d._onDetachDom=[];gt();d.addWindowEventListener("resize",d._onWindowResize);d.addWindowEventListener("focus",d._onWindowFocus);return d}t.prototype.onMounted=function(e,t){if(t.container){e.setContainer(t.container)}};t.prototype.addWindowEventListener=function(e,t,r){if(this._isRealBrowser){this.addElementEventListener(window,e,t,r)}};t.prototype.addDocumentEventListener=function(e,t,r){if(this._isDocumentReady){this.addElementEventListener(document.documentElement,e,t,r)}return t};t.prototype.removeDocumentEventListener=function(e,t){if(this._isDocumentReady){document.documentElement.removeEventListener(e,t)}};t.prototype.addMediaListener=function(e,t){if(this._isDocumentReady&&typeof window.matchMedia==="function"){var r=window.matchMedia(e);r.addListener(t);this._onDetachDom.push(function(){return r.removeListener(t)})}};t.prototype.addElementEventListener=function(e,t,r,i){if(!this._isDestroyed){e.addEventListener(t,r,i);this._onDetachDom.push(function(){return e.removeEventListener(t,r,i)})}return r};t.prototype.detachFromDom=function(){this._onDetachDom.forEach(function(e){return e()});this._onDetachDom=null;this._emptyContainer()};t.prototype.setTimeout=function(e,t){var r=this;if(t===void 0){t=0}var i=setTimeout(function(){r._timeouts.splice(r._timeouts.indexOf(i),1);e()},t);this._timeouts.push(i);return i};t.prototype.clearTimeout=function(e){if(e){clearTimeout(e);this._timeouts.splice(this._timeouts.indexOf(e),1)}return null};t.prototype.clearAllTimeouts=function(){this._timeouts.forEach(clearTimeout);this._timeouts=[]};t.prototype.stopFrames=function(){this._isDestroyed=true;if(this._nextFrame){ee(this._nextFrame);this._nextFrame=null}};t.prototype.isDestroyed=function(){return this._isDestroyed};t.prototype.getDimensions=function(){return{width:this._width,height:this._height}};t.prototype.setDimensions=function(e){this._resize(e)};t.prototype.setLayer=function(e,t,r){var i=(r===void 0?{}:r).automaticResize,n=i===void 0?false:i;if(t){t._ogmaLayer=e;if(n){t.style.position="absolute";t.style.top="0px";t.style.left="0px";ke(t,this._width,this._height,we())}}this._layers[e]={element:t,automaticResize:n};this._updateContainerContent()};t.prototype.setContainer=function(e){if(typeof e==="string"){var t=e;e=document.getElementById(t);if(!e){throw new Error('unable to find DOM element with id "'+t+'"')}}if(e===this._container){return}var r=this._container;this._isFullScreen=false;this._container=e;this._resize();this._updateContainerContent();this._events.fire("setContainer",{element:e,prevElement:r})};t.prototype.getContainer=function(){return this._container};t.prototype.appendElement=function(e){if(this._container!==null){this._container.appendChild(e)}};t.prototype.focus=function(){this._focus=true};t.prototype.blur=function(){this._focus=false};t.prototype.hasFocus=function(){return this._focus};t.prototype.forceResize=function(){this._resize()};t.prototype._beforeOrAfterNextFrame=function(e){var t=e?this._afterNextFramePromises:this._beforeNextFramePromises;var r=new Promise(function(e){t.push(function(){e();return r})});this._refresh();return r};t.prototype.beforeNextFrame=function(){return this._beforeOrAfterNextFrame(false)};t.prototype.afterNextFrame=function(){return this._beforeOrAfterNextFrame(true)};t.prototype.refresh=function(e){if(e){this._refreshUntil=Math.max(this._refreshUntil,e)}this._refresh()};t.prototype._emptyContainer=function(){if(this._container){var e=[];for(var t=0;t<this._container.childNodes.length;++t){var r=this._container.childNodes[t];if(r._ogmaLayer){e.push(r)}}for(var t=0;t<e.length;++t){this._container.removeChild(e[t])}}};t.prototype._fillContainer=function(){var e=this;if(this._container){var t=fe(this._container,"position");if(t!=="absolute"&&t!=="relative"&&t!=="fixed"){this._container.style.position="relative"}var r=this._container.firstChild;Mt.forEach(function(t){var i=e._layers[t];if(i&&i.element){e._container.insertBefore(i.element,r)}})}};t.prototype._updateContainerContent=function(){this._emptyContainer();this._fillContainer()};t.prototype._resize=function(e){if(!this._container&&!e){return}var t=this._width;var r=this._height;var i;var n;if(this._container){var a=this._settings.get("minimumWidth");var o=this._settings.get("minimumHeight");var s=this._container.clientWidth||1;var u=this._container.clientHeight||1;i=Math.max(a,e?e.width:s);n=Math.max(o,e?e.height:u)}else{i=e.width;n=e.height}if(i!==t||n!==r){this._width=i;this._height=n;P(this._layers,function(e){var t=e.element,r=e.automaticResize;if(r){ke(t,i,n)}});this._events.fire("resize",{prevWidth:t,prevHeight:r,width:i,height:n,difWidth:i-t,difHeight:n-r})}};t.prototype._refresh=function(){var e=this;if(this._inFrame){this._mustRefresh=true}else if(!this._nextFrame&&!this._isDestroyed){this._nextFrame=$(function(){return e._playFrame()})}};t.prototype._playFrame=function(){var e=this;var t=tt();var r=t-this._currentTime;var i=E([this._beforeNextFramePromises,function(){return e._events.fire(It.BEFORE_NEW_FRAME,{elapsed:r})},function(){return e._events.fire(It.NEW_FRAME,{elapsed:r})},function(){return e._events.fire(It.AFTER_NEW_FRAME,{elapsed:r})},this._afterNextFramePromises,function(){e._inFrame=false;if(e._mustRefresh||t<e._refreshUntil+17){e._mustRefresh=false;e._refresh()}}]);this._inFrame=true;this._nextFrame=null;this._mustRefresh=false;this._currentTime=t;this._beforeNextFramePromises=[];this._afterNextFramePromises=[];i.reduce(function(t,r){return t.then(function(){if(!e._isDestroyed){return r()}})},Promise.resolve())};t.prototype.isPlayingFrame=function(){return this._inFrame||!!this._nextFrame};t.prototype.setFullScreen=function(value){if(this._container){if(value&&!this._isFullScreen){Ft(this._container)}else if(!value&&this._isFullScreen){zt()}}this._isFullScreen=value};t.prototype.isFullScreen=function(){return this._isFullScreen};t.prototype.debounceBeforeFrame=function(e){var t=this;var r=false;var i=[];var n=function(){var t=i;r=false;i=[];e();t.forEach(function(e){return e()})};return function(){return new Promise(function(e){i.push(e);if(!r){r=true;t.beforeNextFrame().then(n)}})}};t.prototype.destroy=function(){_t();this.detachFromDom();this.clearAllTimeouts();this.stopFrames()};return t}(Ct);function Ft(e){if(e.requestFullScreen){e.requestFullScreen()}else if(e.webkitRequestFullScreen){e.webkitRequestFullScreen()}else if(e.mozRequestFullScreen){e.mozRequestFullScreen()}else if(e.msRequestFullscreen){e.msRequestFullscreen()}}function zt(){if(typeof document==="undefined"){return}if(document.cancelFullScreen){document.cancelFullScreen()}else if(document.webkitCancelFullScreen){document.webkitCancelFullScreen()}else if(document.mozCancelFullScreen){document.mozCancelFullScreen()}else if(document.msExitFullscreen){document.msExitFullscreen()}}var Rt=function(e){l(t,e);function t(t){var r;var i=e.call(this)||this;i._nodeChanges=[];i._edgeChanges=[];i._shouldTriggerEvents=false;i._dom=t.dom;i._graph=t.graph;i._events=t.events;i._nodeDataList=i._graph.createAttribute(true,{name:"data",storage:"any"});i._edgeDataList=i._graph.createAttribute(false,{name:"data",storage:"any"});i._nodeList=i._graph.getNodeAttribute("object");i._edgeList=i._graph.getEdgeAttribute("object");i._events.register(["setData","updateNodeData","updateEdgeData"]);i._events.on((r={},r[It.ADD_NODES+" "+It.ADD_EDGES]=function(e){var t=e.nodes,r=e.edges,n=e.objects;var a=t||r,o=a.isNode,s=a.size,u=a._indexes;var l=i[o?"_nodeDataList":"_edgeDataList"];for(var d=0;d<s;++d){l.set(u[d],n[d].data)}},r[It.BEFORE_NEW_FRAME]=function(){if(i._shouldTriggerEvents){i._shouldTriggerEvents=false;i._triggerEvents()}},r));return i}t.prototype.setProperty=function(e,t,value,r){var i=(r===void 0?{}:r).dispatch,n=i===void 0?false:i;this._setDataProperty(e.isNode,e._indexes,t,value,n);this._events.fire("setData",{elements:e})};t.prototype.getProperty=function(e,t){return this._getDataProperty(e.isNode,e._indexes,t)};t.prototype._setDataProperty=function(e,t,r,value,i){if(i&&typeof value==="function"){i=false}r=Ot(r);var n=typeof value==="function";var a=e?this._nodeList:this._edgeList;var o=e?this._nodeDataList:this._edgeDataList;var s=e?this._nodeChanges:this._edgeChanges;var u=Pt(s,r);for(var l=0;l<t.length;++l){var d=t[l];var h=o.get(d);var f=a.get(d);var c=i?value[l]:value;var v=void 0,p=void 0;if(r===null){v=h;p=n?c(f):c;o.set(d,p)}else{if(h===null||h===undefined){h={};o.set(d,h)}var g=r.length;for(var _=0;_<g;_++){var m=r[_];var y=h[m];if(_<g-1){if(y===null||y===undefined){y={};h[m]=y}h=y}else{v=y;p=n?c(f):c;h[m]=p}}}u.indexes.push(d);u.previousValues.push(v);u.newValues.push(p)}this._scheduleEvents()};t.prototype._getDataProperty=function(e,t,r,i){r=Ot(r);if(!i){i=new Array(t.length)}var n=e?this._nodeDataList:this._edgeDataList;for(var a=0;a<t.length;++a){var o=t[a];var s=n.get(o);var u=s,value=void 0;if(r===null||!r.length){value=u}else if(u===undefined||u===null){value=undefined}else{var l=r.length;for(var d=0;d<l&&u;++d){value=u=u[r[d]]}}i[a]=value}return i};t.prototype._scheduleEvents=function(){this._shouldTriggerEvents=true;this._dom.refresh()};t.prototype._triggerEvents=function(){var e=this._prepareEvtPayload(true);var t=this._prepareEvtPayload(false);this._events.fire("updateNodeData",e);this._events.fire("updateEdgeData",t)};t.prototype._prepareEvtPayload=function(e){var t=e?this._graph.nodeList:this._graph.edgeList;var r=e?"_nodeChanges":"_edgeChanges";var i=[];var n=this[r];this[r]=[];var a=[];for(var o=0;o<n.length;++o){var s=n[o],u=s.indexes,l=s.property,d=s.newValues,h=s.previousValues;i=i.concat(u);if(e){a.push({property:l,newValues:d,previousValues:h,nodes:t(u)})}else{a.push({property:l,newValues:d,previousValues:h,edges:t(u)})}}if(e){return{nodes:t(i).dedupe(),isNode:e,changes:a}}else{return{edges:t(i).dedupe(),isNode:e,changes:a}}};return t}(Ct);function Pt(e,t){for(var r=0;r<e.length;++r){var i=e[r];var n=i.property;if(t===null&&n===null){return i}else if(t&&n&&n.length===t.length){var a=true;for(var o=0;o<n.length;++o){if(n[o]!==t[o]){a=false;break}}if(a){return i}}}var s={property:t&&t.slice(),indexes:[],previousValues:[],newValues:[],nodes:null,edges:null};e.push(s);return s}function Ot(e){if(typeof e==="string"){return e.split(".")}if(x(e)){return e}if(e===undefined||e===null){return null}}var Dt={1:Ut(1),2:Ut(2),4:Ut(4),8:Vt(),16:Vt(),32:Vt(),int8:Vt(),int16:Vt(),int32:Vt(),float:Vt(),any:Vt()};var Bt={1:Gt(1),2:Gt(2),4:Gt(4),8:jt(),16:jt(),32:jt(),int8:jt(),int16:jt(),int32:jt(),float:jt(),any:jt()};function Vt(){return new Function("array","index","return array[index];")}function jt(){return new Function("array","index","value","array[index] = value;")}function Ut(e){var t=8/e;var r="return (array[index / "+t+" | 0] >> ((index % "+t+") * "+e+")) & "+((1<<e)-1)+";";return new Function("array","index",r)}function Gt(e){return new Function("array","index","value","\n    var offset = (index % "+8/e+") * "+e+";\n    var finalIndex = index / "+8/e+" | 0;\n    var orMask = value << offset;\n    var andMask = 255 - (("+(Math.pow(2,e)-1)+" - value) << offset);\n\n    array[finalIndex] = (array[finalIndex] & andMask) | orMask;")}function qt(e,t){if(e===undefined&&t!=="any"&&t!=="resource"){return 0}else{return e}}var Ht={get:function(e){return this._getArrayElt(this._buffer,e)},set:function(e,value){this._setArrayElt(this._buffer,e,value)}};var Wt={get:function(e){return this._byIndex[this._getArrayElt(this._buffer,e)]},set:function(e,value){var t=this._byName[value];if(t===undefined){t=this._nextIndex++;this._byIndex.push(value);var r=this._getElementBitSize();if(r>this._elementSize){this.increaseElementSize()}this._byName[value]=t}this._setArrayElt(this._buffer,e,t)}};var Xt=function(){function e(e){this._initialized=false;var t=e.name;var r=e.storage;var i=e.size||0;var n=qt(e.default,r);var a=Math.max(8,Yt(i+1));var o=r==="resource"?1:r;this._name=t;this._storage=r;this._getArrayElt=Dt[o];this._setArrayElt=Bt[o];this._elementSize=o;this._nbElements=a;this._fallback=null;this._byName=undefined;this._byIndex=undefined;this._nextIndex=undefined;this._defaultValue=n;this._BASE_VALUE=r==="any"?undefined:0;this._methods=Ht;this._initialized=false;this._buffer=null;if(r==="resource"){this._methods=Wt;this._byName={};this._byIndex=[];this._nextIndex=1;this._byName[n]=0;this._byIndex.push(n)}}e.prototype.getValues=function(){return Object.keys(this._byName)};e.prototype.getName=function(){return this._name};e.prototype.get=function(e){return this._get(e)};e.prototype.set=function(e,value){this._set(e,value)};e.prototype._get=function(e){return this._defaultValue};e.prototype._set=function(e,value){if(value===this._defaultValue){return}this._initialize();this._set(e,value)};e.prototype.setFallback=function(e){this._fallback=e;this.get=this._getWithFallback};e.prototype._getWithFallback=function(e){var value=this._get(e);if(value===undefined){return this._fallback.get(e)}return value};e.prototype._initialize=function(){this._initialized=true;this._buffer=Zt(this._nbElements,this._elementSize);this._get=this._methods.get;this._set=this._methods.set;if(this._storage!=="resource"&&this._defaultValue!==this._BASE_VALUE){this._reset(0)}};e.prototype.increaseNbElements=function(e){var t=Yt(e+1);if(t<=this._nbElements){return}if(this._initialized){if(this._elementSize==="any"){for(var r=this._nbElements;r<t;++r){this._buffer.push(this._defaultValue)}}else{var i=Zt(t,this._elementSize);i.set(this._buffer);this._buffer=i;if(this._storage!=="resource"&&this._defaultValue!==this._BASE_VALUE){this._reset(this._nbElements)}}}this._nbElements=t};e.prototype.increaseElementSize=function(){var e=this._elementSize;if(typeof e!=="number"||e===32){throw new Error("FlexArray: cannot increase element size")}var t=e*2;var r=Dt[t];var i=Bt[t];if(this._initialized){var n=this._nbElements;var a=this._getArrayElt;var o=this._buffer;var s=Zt(n,t);if(e>=8){s.set(o)}else{for(var u=0;u<n;++u){i(s,u,a(o,u))}}this._buffer=s}this._elementSize=t;this._getArrayElt=r;this._setArrayElt=i};e.prototype.buffer=function(){if(!this._buffer){throw new Error("FlexArray: buffer not instantiated")}return this._buffer};e.prototype.elementBitSize=function(){return this._elementSize};e.prototype.capacity=function(){return this._nbElements};e.prototype.byteSize=function(){return this._nbElements*this._elementSize/8};e.prototype.isInitialized=function(){return this._initialized||this._fallback&&this._fallback.isInitialized()};e.prototype.getMultiple=function(e,t){var r=e.length;if(t===undefined){t=new Array(r)}for(var i=0,n=r;i<n;++i){t[i]=this.get(e[i])}return t};e.prototype.fill=function(e,value){for(var t=0,r=e.length;t<r;++t){this.set(e[t],value)}};e.prototype.setMultiple=function(e,t,r){if(!r&&(Array.isArray(t)||ArrayBuffer.isView(t))){for(var i=0,n=e.length;i<n;++i){this.set(e[i],t[i])}}else{for(var i=0,n=e.length;i<n;++i){this.set(e[i],t)}}};e.prototype.reset=function(){if(this._initialized){this._reset(0)}return this};e.prototype._reset=function(e){var value=this._storage==="resource"?0:this._defaultValue;if(typeof this._elementSize!=="number"||this._elementSize>=8){this._buffer.fill(value,e)}else{var t=8/this._elementSize;var r=0;for(var i=0;i<t;++i){r=r<<this._elementSize;r+=value}if(e===undefined){this._buffer.fill(r)}else{var n=8-e%8;var a=e+n;for(var i=e;i<a;++i){this._setArrayElt(this._buffer,i,value)}this._buffer.fill(r,a/8)}}};e.prototype._getElementBitSize=function(){return Math.pow(2,Math.ceil(Math.log2(Math.log2(this._nextIndex))))};return e}();function Yt(e){var t=2;while(t<e){t*=2}return t}function Zt(e,t){if(t==="any"){return new Array(e)}else if(t==="float"){return new Float32Array(e)}else if(t==="int8"){return new Int8Array(e)}else if(t==="int16"){return new Int16Array(e)}else if(t==="int32"){return new Int32Array(e)}else if(t===32){return new Uint32Array(e)}else if(t===16){return new Uint16Array(e)}else{return new Uint8Array(Math.ceil(e/8*t))}}function Kt(e){return Math.pow(2,Math.ceil(Math.log2(e)))}function Qt(e){var t=0;for(var r=0;r<e.length;++r){t+=e[r]}return t}function Jt(value,e,t){return Math.max(e,Math.min(t,value))}function $t(e,t,r){return e+(t-e)*r}function er(e,t,r){return e*(1-r)+t*r}function tr(e){if(!e.length){return-Infinity}var t=e[0];for(var r=1,i=e.length;r<i;++r){var n=e[r];if(n>t){t=n}}return t}function rr(e){if(!e.length){return Infinity}var t=e[0];for(var r=1,i=e.length;r<i;++r){var n=e[r];if(n<t){t=n}}return t}function ir(e,t){return Math.log(e)/Math.log(t)}var nr=4;var ar=function(){function e(){this._buffer=new Uint32Array(nr);this._capacity=nr;this._size=0;this._busy=false}e.prototype.isBusy=function(){return this._busy};e.prototype.markBusy=function(){this._busy=true;return this};e.prototype.sliceAndReset=function(){this._busy=false;var e=this.slice(0,this._size);this.reset();return e};e.prototype.reset=function(){this._size=0;return this};e.prototype.reserve=function(value){if(value>this._capacity){this._setCapacity(Kt(value))}return this};e.prototype._setCapacity=function(e){var t=new Uint32Array(e);t.set(this._buffer);this._buffer=t;this._capacity=e};e.prototype.push=function(value){if(this._size===this._capacity){this._setCapacity(this._capacity*2)}this._buffer[this._size++]=value;return this};e.prototype.pushUnchecked=function(value){this._buffer[this._size++]=value;return this};e.prototype.slice=function(e,t){if(e===void 0){e=0}if(t===void 0){t=this._size}return this._buffer.slice(e,t)};e.prototype.getBuffer=function(){return this._buffer};e.prototype.getLength=function(){return this._size};e.prototype.getCapacity=function(){return this._capacity};e.prototype.setLength=function(value){this._size=value;return this};e.prototype.isEmpty=function(){return this._size===0};return e}();var or=function(){function e(e){var t=this;this._nextIndex=1;this._freeIndexes=[];this._indexesToBeFreed=[];this._idToIndex=Object.create(null);this._indexToId=[undefined];this._flexArrays=[];this._defaultValues=[];this._flexArraysByName={};this._indexLists=[];this._name=e?"node":"edge";this._nextIndex=1;this._freeIndexes=[];this._indexesToBeFreed=[];this._idToIndex=Object.create(null);this._indexToId=[undefined];this._idFlexArray=new Xt({storage:"int32"});this._idFlexArray.get=function(e){return t._indexToId[e]};this._idFlexArray.getMultiple=function(e){var r=new Array(e.length);for(var i=0;i<e.length;++i){r[i]=t._indexToId[e[i]]}return r};this._flexArraysByName["id"]=this._idFlexArray}e.prototype.addElements=function(e){var t=[];for(var r=0,i=e.length;r<i;++r){var n=e[r];var a=this._idToIndex[n];if(a===undefined){a=this._getNextIndex();this._idToIndex[n]=a;this._indexToId[a]=n}t.push(a)}for(var o=0,s=this._flexArrays;o<s.length;o++){var u=s[o];u.increaseNbElements(this._nextIndex)}for(var l=0,d=this._indexLists;l<d.length;l++){var h=d[l];h.reserve(this._nextIndex)}return new Uint32Array(t)};e.prototype.removeElements=function(e){for(var t=0,r=e.length;t<r;++t){var i=e[t];var n=this._indexToId[i];if(n!==undefined){delete this._idToIndex[n];this._removeIndex(i)}}};e.prototype.clear=function(){this._idToIndex=Object.create(null);this._indexToId=[undefined];this._nextIndex=1;this._freeIndexes=[];for(var e=0,t=this._flexArrays;e<t.length;e++){var r=t[e];r.reset()}for(var i=0,n=this._indexLists;i<n.length;i++){var a=n[i];a.reset()}};e.prototype.has=function(e){return this._indexToId[e]!==undefined};e.prototype.getIndex=function(e,t){if(t===void 0){t=false}var r=this._idToIndex[e];if(r===undefined&&t){throw new Error(this._name+' id "'+e+'" not found')}return r};e.prototype.createFlexArray=function(e){var t=e.name;if(t&&this._flexArraysByName[t]){throw new Error(this._name+' flexArray "'+t+'" already exists')}var r=e.default;if(r===undefined&&e.storage!=="any"&&e.storage!=="resource"){r=0}var i=this._nextIndex;var n={storage:e.storage,size:i,name:t,default:r};var a;if(r===undefined&&e.storage!=="any"&&e.storage!=="resource"){a=new Xt(n)}else{a=new Xt(n)}this._flexArrays.push(a);this._defaultValues.push(e.default);if(t){this._flexArraysByName[t]=a}return a};e.prototype.getFlexArray=function(e){return this._flexArraysByName[e]||null};e.prototype.getAllFlexArrays=function(){return this._flexArraysByName};e.prototype.createIndexList=function(){var e=new ar;e.reserve(this._nextIndex);this._indexLists.push(e);return e};e.prototype.getId=function(e){return this._indexToId[e]};e.prototype.getMaxIndex=function(){return this._nextIndex-1};e.prototype._removeIndex=function(e){this._indexesToBeFreed.push(e)};e.prototype._getNextIndex=function(){var e=this._freeIndexes.pop();if(e===undefined){e=this._nextIndex++}return e};e.prototype.freeIndexes=function(){for(var e=0,t=this._indexesToBeFreed;e<t.length;e++){var r=t[e];this._indexToId[r]=undefined;this._freeIndexes.push(r)}for(var i=0;i<this._flexArrays.length;++i){var n=this._flexArrays[i];var a=this._defaultValues[i];for(var o=0,s=this._indexesToBeFreed;o<s.length;o++){var r=s[o];n.set(r,a)}}this._indexesToBeFreed=[]};return e}();var sr=8;var ur=function(){function e(){this._BIG_LIST=255;this._MAX_LIST_SIZE=8;this._capacity=sr;this._buffer=new Uint32Array(this._capacity*this._MAX_LIST_SIZE);this._sizes=new Uint8Array(this._capacity);this._bigLists=[];this._nextIndex=0;this._constList=new Array(this._MAX_LIST_SIZE)}e.prototype.addEntry=function(e){if(e===undefined){e=this._nextIndex++}if(e>=this._capacity){this._reserve(e+1)}this._sizes[e]=0;return e};e.prototype.get=function(e){var t=this._sizes[e];var r=this._MAX_LIST_SIZE*e;if(t<=this._MAX_LIST_SIZE){this._constList.length=t;for(var i=0,n=t;i<n;++i){this._constList[i]=this._buffer[r+i]}return this._constList}else if(t===this._BIG_LIST){var a=this._buffer[r];return this._bigLists[a]}};e.prototype.size=function(e){var t=this._sizes[e];return t<=this._MAX_LIST_SIZE?t:this._bigLists[this._buffer[e*this._MAX_LIST_SIZE]].length};e.prototype.sizes=function(e){var t=this._sizes;var r=this._bigLists;var i=this._buffer;var n=this._MAX_LIST_SIZE;var a=e.length;var o=new Array(a);for(var s=0;s<a;s++){var u=e[s];var l=t[u];o[s]=l<=n?l:r[i[u*n]].length}return o};e.prototype.addTo=function(e,value){var t=this._sizes[e];var r=e*this._MAX_LIST_SIZE;if(t<this._MAX_LIST_SIZE){this._buffer[r+t]=value;this._sizes[e]=t+1}else if(t===this._BIG_LIST){var i=this._buffer[r];this._bigLists[i].push(value)}else{var n=new Array(this._MAX_LIST_SIZE);for(var a=0;a<this._MAX_LIST_SIZE;++a){n[a]=this._buffer[r+a]}n.push(value);this._bigLists.push(n);this._sizes[e]=this._BIG_LIST;this._buffer[r]=this._bigLists.length-1}return this};e.prototype.removeFrom=function(e,value){this.removeFromAndGetSize(e,value);return this};e.prototype.removeFromAndGetSize=function(e,value){var t=this._MAX_LIST_SIZE*e;var r=this._sizes[e];if(r<=this._MAX_LIST_SIZE){for(var i=t,n=t+r;i<n;++i){if(this._buffer[i]===value){r-=1;this._buffer[i]=this._buffer[n-1];this._sizes[e]=r;return r}}}else if(r===this._BIG_LIST){var a=this._buffer[t];var o=this._bigLists[a];var i=o.indexOf(value);if(i!==-1){o.splice(i,1);return o.length}}throw new Error('topology: Table: "removeFrom" failed, should not happen')};e.prototype.reserve=function(e){if(this._capacity<e){this._reserve(e)}return this};e.prototype._reserve=function(e){this._capacity=Math.pow(2,Math.ceil(Math.log2(e)));this._buffer=lr(this._buffer,this._capacity*this._MAX_LIST_SIZE);this._sizes=lr(this._sizes,this._capacity)};return e}();function lr(e,t){var r=e.constructor;var i=new r(t);i.set(e);return i}var dr;(function(e){e["BOTH"]="both";e["IN"]="in";e["OUT"]="out"})(dr||(dr={}));var hr=function(){function e(e){this._parallelEdgesIndex=[];this._fakeDeduper={get:function(){return 0},set:function(){},reset:function(){return this}};this._fakeInvertedDeduper={get:function(){return 1},set:function(){},reset:function(){return this}};this._sourceList=null;this._targetList=null;this._graph=e;this._neighborTable=new ur;this._parallelTable=new ur;this._parallelEdgesIndex=[];this.nodeDeduper=e.createNodeAttribute({storage:1});this.edgeDeduper=e.createEdgeAttribute({storage:1});this._sourceList=e.getEdgeAttribute("source");this._targetList=e.getEdgeAttribute("target")}e.prototype.getAdjacentDirections=function(e){return this._neighborTable.get(e)};e.prototype.getEdgeIndexesInDirection=function(e){return this._parallelTable.get(e)};e.prototype.allocateNodes=function(e){this._neighborTable.reserve(e.length);for(var t=0;t<e.length;++t){this._neighborTable.addEntry(e[t])}};e.prototype.allocateEdges=function(e,t,r){this._parallelTable.reserve(Math.floor(e.length/2));for(var i=0;i<e.length;i++){var n=e[i];var a=t[i];var o=r[i];this._sourceList.set(n,a);this._targetList.set(n,o);this.addToAdjacencyList(n)}};e.prototype.getExtremity=function(e,t){var r=e?this._sourceList:this._targetList;if(t.isList){var i=this._graph.acquireIndexList(true);for(var n=0;n<t._indexes.length;n++){i.push(r.get(t._indexes[n]))}return this._graph.nodeList(i.sliceAndReset())}return this._graph.getObjectList(true).get(r.get(t._index))};e.prototype.setExtremities=function(e,t,r){for(var i=0;i<e.length;++i){this.removeFromAdjacencyList(e[i])}if(t!==null){this._sourceList.setMultiple(e,t)}if(r!==null){this._targetList.setMultiple(e,r)}for(var i=0;i<e.length;++i){this.addToAdjacencyList(e[i])}};e.prototype.addToAdjacencyList=function(e){var t=this._sourceList.get(e);var r=this._targetList.get(e);var i=fr(t,r);var n=this._parallelEdgesIndex[i];if(n===undefined){n=this._parallelTable.addEntry();this._parallelEdgesIndex[i]=n;this._neighborTable.addTo(t,n);if(t!==r){this._neighborTable.addTo(r,n)}}this._parallelTable.addTo(n,e)};e.prototype.removeFromAdjacencyList=function(e){var t=this._sourceList.get(e);var r=this._targetList.get(e);var i=fr(t,r);var n=this._parallelEdgesIndex[i];if(this._parallelTable.removeFromAndGetSize(n,e)===0){this._neighborTable.removeFrom(t,n);if(t!==r){this._neighborTable.removeFrom(r,n)}this._parallelEdgesIndex[i]=undefined}};e.prototype.getParallelEdges=function(e,t){if(t===void 0){t={}}var r=t.filter||"visible";var i=this._graph.acquireIndexList(false);var n=this._graph.getFilter(false,r);for(var a=0;a<e._indexes.length;a++){var o=e._indexes[a];var s=this._sourceList.get(o);var u=this._targetList.get(o);var l=fr(s,u);var d=this._parallelEdgesIndex[l];var h=this._parallelTable.get(+d);if(h){for(var f=0,c=h;f<c.length;f++){var v=c[f];if(n(v)){i.push(v)}}}}return this._graph.edgeList(i.sliceAndReset())};e.prototype.fastGetNodesAdjacentElements=function(e){var t=this._graph.acquireIndexList(true);var r=this._graph.acquireIndexList(false);var i=this._sourceList;var n=this._targetList;for(var a=0;a<e.length;a++){var o=e[a];var s=this._neighborTable.get(o);for(var u=0,l=s;u<l.length;u++){var d=l[u];var h=this._parallelTable.get(d);var f=h[0];var c=i.get(f);var v=n.get(f);t.push(c+v-o);for(var p=0,g=h;p<g.length;p++){var _=g[p];r.push(_)}}}return{nodes:this._graph.nodeList(t.sliceAndReset()),edges:this._graph.edgeList(r.sliceAndReset())}};e.prototype.fastGetEdgesAdjacentElements=function(e){var t=this._graph.acquireIndexList(true);var r=this._graph.acquireIndexList(false);var i=this._sourceList;var n=this._targetList;for(var a=0;a<e.length;a++){var o=e[a];var s=i.get(o);var u=n.get(o);var l=fr(s,u);var d=this._parallelEdgesIndex[l];var h=this._parallelTable.get(+d);if(h){for(var f=0,c=h;f<c.length;f++){var v=c[f];r.push(v)}}t.push(s);t.push(u)}return{nodes:this._graph.nodeList(t.sliceAndReset()),edges:this._graph.edgeList(r.sliceAndReset())}};e.prototype.getDeduper=function(e){var t=e?this.nodeDeduper:this.edgeDeduper;return t.reset()};e.prototype.collectAdjacentEdges=function(e,t,r,i,n){if(i===void 0){i=false}if(n===void 0){n=false}var a=t===dr.OUT;var o=t===dr.IN;var s=!(a||o)&&!n;var u=this._graph.acquireIndexList(false);var l=this._graph.getFilter(false,r);var d=i?this.getDeduper(false):this._fakeDeduper;var h=this._fakeInvertedDeduper;var f=this._sourceList;var c=this._targetList;if(n){h=this.getDeduper(true);for(var v=0;v<e.length;v++){h.set(e[v],1)}}for(var v=0;v<e.length;v++){var p=e[v];var g=this._neighborTable.get(p);for(var _=0,m=g;_<m.length;_++){var y=m[_];var b=this._parallelTable.get(y);if(s){for(var x=0,A=b;x<A.length;x++){var E=A[x];if(l(E)&&d.get(E)===0){u.push(E);d.set(E,1)}}}else{for(var S=0,w=b;S<w.length;S++){var E=w[S];var T=f.get(E);var C=c.get(E);var I=C===p;var M=T+C-p;if((o===I||T===C)&&l(E)&&d.get(E)===0&&h.get(M)===1){u.push(E);d.set(E,1)}}}}}return u.sliceAndReset()};e.prototype.collectAdjacentNodes=function(e,t,r,i,n,a){if(i===void 0){i=false}var o=t!==dr.IN;var s=t!==dr.OUT;var u=this._graph.acquireIndexList(true);var l=this._graph.getFilter(false,r);var d=i?this.getDeduper(true):this._fakeDeduper;var h=this._sourceList;var f=this._targetList;if(n){for(var c=0;c<n.length;c++){var v=n[c];u.push(v);d.set(v,1)}}if(a){for(var c=0;c<a.length;c++){var v=a[c];d.set(v,1)}}for(var c=0;c<e.length;c++){var p=e[c];var g=this._neighborTable.get(p);for(var _=0,m=g;_<m.length;_++){var y=m[_];var b=this._parallelTable.get(y);for(var x=0,A=b;x<A.length;x++){var E=A[x];if(l(E)){var S=h.get(E);var w=f.get(E);var T=s&&p===w||o&&p===S;var v=S+w-p;if(T&&d.get(v)===0){u.push(v);d.set(v,1);break}}}}}return u.sliceAndReset()};e.prototype.getAdjacentElements=function(e,t,r){if(r===void 0){r={}}var i=r.direction||dr.BOTH;var n=r.filter||"visible";var a=r.policy||"union";var o=!!r.bothExtremities;var s=r.includeSources;if(s===true){a="include-sources"}else if(s===false){a="exclude-sources"}if(e){var u=a==="include-sources"?t:null;var l=a==="exclude-sources"?t:null;return this.collectAdjacentNodes(t,i,n,true,u,l)}else{return this.collectAdjacentEdges(t,i,n,true,o)}};e.prototype.getEdgesBetweenTwoNodes=function(e,t){var r=fr(e,t);var i=this._parallelEdgesIndex[r];var n=this._parallelTable.get(+i);return new Uint32Array(n)};e.prototype.getConnectedComponents=function(e,t){var r=t===void 0?{}:t,i=r.filter,n=i===void 0?"visible":i,a=r.returnIds,o=a===void 0?false:a,s=r.internalIndexes,u=s===void 0?false:s;var l=this._graph;var d=[];var h={};var f=l.acquireIndexList(true);var c=l.getFilter(true,n);for(var v=0;v<e.length;v++){var p=e[v];if(c(p)){f.push(p)}}var g=f.sliceAndReset();var _={filter:n};for(var v=0;v<g.length;v++){var p=g[v];if(!h[p]){var m=[p];var y=[];while(m.length!==0){var b=m.pop();if(!h[b]){m.push.apply(m,this.getAdjacentElements(true,new Uint32Array([b]),_));h[b]=true;y.push(b)}}if(y.length>0){d.push(y)}}}if(o){var x=l.getNodeAttribute("id");for(var v=0;v<d.length;v++){d[v]=x.getMultiple(d[v])}}else if(!u){for(var v=0;v<d.length;v++){d[v]=l.nodeList(new Uint32Array(d[v]))}}return d};e.prototype.getAdjacencyList=function(e){var t=e.directed,r=e.ids,i=e.weight,n=e.nodes;var a=t?dr.OUT:dr.BOTH;var o=new Array(n.length);var s=this._graph;for(var u=0;u<n.length;++u){o[u]=this.collectAdjacentEdges(new Uint32Array([n[u]]),a,"all")}var l=s.getEdgeAttribute("source");var h=s.getEdgeAttribute("target");var f=s.getEdgeAttribute("width");var c=s.getNodeAttribute("id");var v=[];var p=1;var g=typeof i==="function";var _=typeof i==="number";var m=!g&&!_&&!!i;for(var u=0;u<o.length;u++){var y=o[u];var b=n[u];var x=y.length;var A=r?new Array(x):new Uint32Array(x);var E=new Array(x);for(var S=0;S<x;S++){var w=y[S];var T=l.get(w);var C=h.get(w);var I=t||b===T?C:T;if(r){I=c.get(I)}A[S]=I;if(i){if(_){E[S]=i}if(typeof i==="function"){E[S]=i(s.getNode(T),s.getNode(C))}if(m){E[S]=f.get(w)||p}}}var M=d({nodes:A,id:r?c.get(b):b},i&&{weights:E});v.push(M)}return v};e.prototype.degrees=function(e,t){if(t!==dr.IN&&t!==dr.OUT){return this._neighborTable.sizes(e)}var r=new Array(e.length);var i=t===dr.IN;for(var n=0,a=e.length;n<a;n++){r[n]=this._degree(e[n],i)}return r};e.prototype._degree=function(e,t){var r=this._neighborTable.get(e);var i=this._sourceList;var n=this._targetList;var a=0;for(var o=0;o<r.length;++o){var s=this._parallelTable.get(r[o]);for(var u=0;u<s.length;++u){var l=s[u];var d=i.get(l);var h=n.get(l);if(t&&h===e||!t&&d===e){a+=1;break}}}return a};e.prototype.getDegree=function(e,t){var r=this._getDegreeOptions(t),i=r.direction,n=r.filter;var a=new Array(e.length);var o=new Uint32Array(1);for(var s=0;s<e.length;++s){o[0]=e[s];a[s]=this.collectAdjacentNodes(o,i,n).length}return a};e.prototype._getDegreeOptions=function(e){var t={direction:dr.BOTH,filter:"visible"};if(typeof e==="string"){t.direction=e}else if(e){if(typeof e.direction==="string"){t.direction=e.direction}if(typeof e.filter==="string"){t.filter=e.filter}}return t};return e}();function fr(e,t){var r=e<t?e:t;var i=e+t-r;return r*67108864+i}var cr=typeof f==="object"&&f!==null&&typeof f.it!=="undefined";function vr(e){if(!cr){console.warn(it()+" "+e)}}function pr(e,t){return e===undefined?t:e}function gr(value,e,t){return X(value,e)}function _r(e,t,r){if(Array.isArray(e)){var i=e.indexOf(t);if(i===-1){throw new Error(r+" "+t+" does not exist")}return i}else{if(!(t in e)){throw new Error(r+" "+t+" does not exist")}return e[t]}}function mr(e){if(typeof e!=="object"||e===null){e={}}var t=typeof e.data==="function"?e.data:function(e){return e};var r=Array.isArray(e.attributes)?e.attributes:undefined;return{attributes:r,data:t}}function yr(e){if(e>1){vr("getData: more than one argument were specified, you probably want to "+"use a single array argument instead of multiple arguments")}}function br(e,t){var r=function(e){var r=t;Object.keys(r).forEach(function(t){var i=r[t];e.prototype[t]=function(e,r){vr('Deprecated method "'+t+'"; please use "'+i+'" instead.');return this[i](e,r)}})};for(var i=0,n=e;i<n.length;i++){var a=n[i];r(a)}}function xr(e){var t=e.getFlexArray("removed");var r=e.getFlexArray("excluded");var i=e.getFlexArray("virtual");return{all:function(e){return t.get(e)===0},visible:function(e){return r.get(e)===0},raw:function(e){return i.get(e)===0&&t.get(e)===0},_all:function(e){return true}}}function Ar(e,t,r){return{all:Er(r["all"],e,t),visible:Er(r["visible"],e,t),raw:Er(r["raw"],e,t),_all:Er(r["_all"],e,t)}}function Er(e,t,r){var i=null;return{getList:function(){if(!i){var n=t();var a=r();a.reset();for(var o=1;o<=n;++o){if(e(o)){a.push(o)}}i=a.sliceAndReset()}return i},invalidList:function(){i=null}}}function Sr(e){if(e===undefined){return Math.round(Math.random()*Number.MAX_SAFE_INTEGER)}if(typeof e!=="string"&&(typeof e!=="number"||!isFinite(e))){throw new Error(e+" is not a valid id, expected string or number")}return e}function wr(e,t,r){var i=e.getObjectList(t.isNode);for(var n=0;n<t._indexes.length;++n){var a=t._indexes[n];var o=i.get(a);r(o,n)}}function Tr(e,t,r){var i=new Array(t.size);var n=e.getObjectList(t.isNode);for(var a=0;a<t._indexes.length;++a){var o=t._indexes[a];var s=n.get(o);i[a]=r(s,a)}return i}function Cr(e,t,r){r=r||function(){return true};var i=t.isNode;var n=e.acquireIndexList(i);var a=e.getObjectList(i);var o=e.getListFactory(i);for(var s=0;s<t._indexes.length;++s){var u=t._indexes[s];var l=a.get(u);if(l){var d=r(l,s);if(d){n.push(u)}}}return o(n.sliceAndReset())}function Ir(e,t,r,i){var n=e.getListFactory(t.isNode);if(!r){return{valid:t,invalid:n()}}var a=e.acquireIndexList(t.isNode);var o=e.acquireIndexList(t.isNode);var s=e.getObjectList(t.isNode);for(var u=0;u<t._indexes.length;u++){var l=t._indexes[u];var d=s.get(l);if(d===undefined){continue}var h=r(d,i);var f=h?a:o;f.pushUnchecked(l)}return{valid:n(a.sliceAndReset()),invalid:n(o.sliceAndReset())}}function Mr(e,t,r,i){var n=e.getObjectList(t.isNode);var a=i;for(var o=0;o<t._indexes.length;++o){var s=t._indexes[o];var u=n.get(s);a=r(a,u,o)}return a}function Lr(e,t){var r=t.isNode;var i=e.topology.getDeduper(r);var n=e.acquireIndexList(r);var a=e.getListFactory(r);for(var o=0;o<t._indexes.length;o++){var s=t._indexes[o];if(i.get(s)===0){i.set(s,1);n.push(s)}}return a(n.sliceAndReset())}function kr(e,t){var r=t.isNode;var i=e.storage.fetch(r);var n=i.getFlexArray("excluded");var a=i.getMaxIndex();var o=e.topology.getDeduper(r);var s=e.acquireIndexList(r);var u=e.getListFactory(r);for(var l=0;l<t._indexes.length;l++){o.set(t._indexes[l],1)}for(var d=1;d<=a;++d){if(o.get(d)===0&&n.get(d)===0){s.push(d)}}return u(s.sliceAndReset())}function Nr(e,t,r){var i=e.getListFactory(t.isNode);var n=new Uint32Array(t._indexes.length+r._indexes.length);n.set(t._indexes);n.set(r._indexes,t._indexes.length);return i(n)}function Fr(e,t){return e.getObjectList(t.isNode).getMultiple(t._indexes)}function zr(e,t){var r=e.getStorage(t.isNode);if(t.isList){var i=new Array(t.size);for(var n=0;n<t._indexes.length;++n){i[n]=r.getId(t._indexes[n])}return i}else{return r.getId(t._index)}}function Rr(e,t){return e.topology.getExtremity(true,t)}function Pr(e,t){return e.topology.getExtremity(false,t)}function Or(e,t,r){return e.getObjectList(t.isNode).get(t._indexes[r])}function Dr(e,t,r){var i=e.getListFactory(t.isNode);var n=e.getObjectList(t.isNode);var a=t._indexes.slice();a.sort(function(e,t){var i=n.get(e);var a=n.get(t);return r(i,a)});return i(a)}var Br=new Uint32Array(1);var Vr=function(){function e(e,t){this.size=1;this.isNode=false;this.isList=false;this._index=e;this._ogma=t}Object.defineProperty(e.prototype,"_indexes",{get:function(){Br[0]=this._index;return Br},enumerable:true,configurable:true});e.prototype.setAttributes=function(e,t,r){return this._ogma.modules.individualAttributes.setMultipleAttributes(this,e,t,r)};e.prototype.setAttribute=function(e,value,t){return this._ogma.modules.individualAttributes.setSingleAttribute(this,e,value,t)};e.prototype.getAttributes=function(e){return this._ogma.modules.individualAttributes.getMultipleAttributes(this,e)[0]};e.prototype.getAttribute=function(e){return this._ogma.modules.individualAttributes.getSingleAttribute(this,e)[0]};e.prototype.resetAttributes=function(e,t){return this._ogma.modules.individualAttributes.resetMultipleAttributes(this,e,t)};e.prototype.replaceOriginalAttributes=function(e,t){return this._ogma.modules.individualAttributes.replaceOriginalAttributes(this,e,t)};e.prototype.getPreviousAttributes=function(e){return this._ogma.modules.individualAttributes.getMultiplePreviousAttributes(this,e)[0]};e.prototype.isInView=function(e){return this._ogma.modules.locate.isElementInView(this,e)};e.prototype.getParallelEdges=function(e){return this._ogma.modules.graph.getParallelEdges(this,e)};e.prototype.fastGetAdjacentElements=function(){return this._ogma.modules.graph.fastGetEdgesAdjacentElements(this)};e.prototype.isVisible=function(){return!this.isExcluded()};e.prototype.isExcluded=function(){return this._ogma.modules.graph.isExcluded(this)[0]};e.prototype.setExcluded=function(value){return this._ogma.modules.graph.setExcluded(this,value)};e.prototype.setVisible=function(value){return this.setExcluded(!value)};e.prototype.toList=function(){return this._ogma.modules.graph.edgeList(new Uint32Array([this._index]))};e.prototype.getId=function(){return zr(this._ogma.modules.graph,this)};e.prototype.getSource=function(){return Rr(this._ogma.modules.graph,this)};e.prototype.getTarget=function(){return Pr(this._ogma.modules.graph,this)};e.prototype.getExtremities=function(){return this._ogma.modules.graph.nodeList(new Uint32Array([this.getSource()._index,this.getTarget()._index]))};e.prototype.setSource=function(e){this._ogma.modules.graph.setSource(this,e)};e.prototype.setTarget=function(e){this._ogma.modules.graph.setTarget(this,e)};e.prototype.slice=function(){return this.toList()};e.prototype.toJSON=function(e){if(e===void 0){e={}}var t=mr(e),r=t.attributes,i=t.data;return{id:this.getId(),source:this.getSource().getId(),target:this.getTarget().getId(),attributes:this.getAttributes(r),data:i(O(this.getData()))}};e.prototype.get=function(e){return e===0?this:undefined};e.prototype.setSelected=function(e){this._ogma.modules.selection.setActive(this,e)};e.prototype.isSelected=function(){return this._ogma.modules.selection.areActive(this)};e.prototype.locate=function(e){return this._ogma.modules.locate.locateElements(this,e)};e.prototype.getBoundingBox=function(e){return this._ogma.modules.locate.getBoundingBox(this,e)};e.prototype.setData=function(e,value){if(arguments.length<2){value=e;e=null}this._ogma.modules.data.setProperty(this,e,value);return this};e.prototype.getData=function(e){yr(arguments.length);return this._ogma.modules.data.getProperty(this,e)[0]};e.prototype.addClass=function(e,t){return this._ogma.modules.classes.addClassesToElements([e],this,t)};e.prototype.addClasses=function(e,t){return this._ogma.modules.classes.addClassesToElements(e,this,t)};e.prototype.removeClass=function(e,t){return this._ogma.modules.classes.removeClassesFromElements([e],this,t)};e.prototype.removeClasses=function(e,t){return this._ogma.modules.classes.removeClassesFromElements(e,this,t)};e.prototype.hasClass=function(e){return this._ogma.modules.classes.hasSingleElementClass(e,this)};e.prototype.getClassList=function(){return this._ogma.modules.classes.getElementsClassList(this)[0]};e.prototype.getAnimationInformation=function(){return this._ogma.modules.graphics.getAnimationInformation(this)[0]};e.prototype.isVirtual=function(){return this._ogma.modules.transformations.isElementVirtual(this)};e.prototype.getTransformation=function(){return this._ogma.modules.transformations.getElementTransformation(this)};e.prototype.getMetaEdge=function(){return this._ogma.modules.grouping.getMetaElement(this)[0]};e.prototype.getSubEdges=function(){return this._ogma.modules.grouping.getSubElements(this)[0]};e.prototype.pulse=function(e){this._ogma.modules.pulses.pulse(this,e)};return e}();br([Vr],{setStyle:"setAttributes",resetStyle:"resetAttributes",getStyle:"getAttribute"});var jr=function(){function e(e,t){this.isList=true;this.isNode=false;this._indexes=e;this._ogma=t}Object.defineProperty(e.prototype,"size",{get:function(){return this._indexes.length},enumerable:true,configurable:true});e.prototype.setAttributes=function(e,t){return this._ogma.modules.individualAttributes.setMultipleAttributes(this,e,t)};e.prototype.setAttribute=function(e,value,t){return this._ogma.modules.individualAttributes.setSingleAttribute(this,e,value,t)};e.prototype.getAttributes=function(e){return this._ogma.modules.individualAttributes.getMultipleAttributes(this,e)};e.prototype.getAttribute=function(e){return this._ogma.modules.individualAttributes.getSingleAttribute(this,e)};e.prototype.resetAttributes=function(e,t){return this._ogma.modules.individualAttributes.resetMultipleAttributes(this,e,t)};e.prototype.replaceOriginalAttributes=function(e,t){return this._ogma.modules.individualAttributes.replaceOriginalAttributes(this,e,t)};e.prototype.getPreviousAttributes=function(e){return this._ogma.modules.individualAttributes.getMultiplePreviousAttributes(this,e)};e.prototype.getPreviousAttribute=function(e){return this._ogma.modules.individualAttributes.getSinglePreviousAttribute(this,e)};e.prototype.getParallelEdges=function(e){return this._ogma.modules.graph.getParallelEdges(this,e)};e.prototype.fastGetAdjacentElements=function(){return this._ogma.modules.graph.fastGetEdgesAdjacentElements(this)};e.prototype.isVisible=function(){return this.isExcluded().map(function(value){return!value})};e.prototype.isExcluded=function(){return this._ogma.modules.graph.isExcluded(this)};e.prototype.setExcluded=function(value){return this._ogma.modules.graph.setExcluded(this,value)};e.prototype.setVisible=function(value){return this.setExcluded(!value)};e.prototype.toList=function(){return this};e.prototype.toArray=function(){return Fr(this._ogma.modules.graph,this)};e.prototype.clone=function(){return this._ogma.modules.graph.edgeList(this._indexes.slice())};e.prototype.getId=function(){return zr(this._ogma.modules.graph,this)};e.prototype.getSource=function(){return Rr(this._ogma.modules.graph,this)};e.prototype.getTarget=function(){return Pr(this._ogma.modules.graph,this)};e.prototype.getExtremities=function(){return this.getSource().concat(this.getTarget())};e.prototype.get=function(e){return Or(this._ogma.modules.graph,this,e)};e.prototype.forEach=function(e){wr(this._ogma.modules.graph,this,e)};e.prototype.map=function(e){return Tr(this._ogma.modules.graph,this,e)};e.prototype.filter=function(e){return Cr(this._ogma.modules.graph,this,e)};e.prototype.reduce=function(e,t){return Mr(this._ogma.modules.graph,this,e,t)};e.prototype.concat=function(e){return Nr(this._ogma.modules.graph,this,e)};e.prototype.dedupe=function(){return Lr(this._ogma.modules.graph,this)};e.prototype.slice=function(e,t){return this._ogma.modules.graph.edgeList(this._indexes.slice(e,t))};e.prototype.indexOf=function(e){if(!(e instanceof Vr)){return-1}return this._indexes.indexOf(e._index)};e.prototype.includes=function(e){return this.indexOf(e)!==-1};e.prototype.sort=function(e){return Dr(this._ogma.modules.graph,this,e)};e.prototype.inverse=function(){return kr(this._ogma.modules.graph,this)};e.prototype.toJSON=function(e){if(e===void 0){e={}}return this.map(function(t){return t.toJSON(e)})};e.prototype.setSelected=function(e){this._ogma.modules.selection.setActive(this,e)};e.prototype.isSelected=function(){return this._ogma.modules.selection.areActive(this)};e.prototype.locate=function(e){return this._ogma.modules.locate.locateElements(this,e)};e.prototype.getBoundingBox=function(e){return this._ogma.modules.locate.getBoundingBox(this,e)};e.prototype.setData=function(e,t){if(arguments.length<2){t=e;e=null}if(typeof t!=="function"&&!x(t)){throw new Error("invalid argument "+t+"; expected array or function")}this._ogma.modules.data.setProperty(this,e,t,{dispatch:true});return this};e.prototype.fillData=function(e,value){if(arguments.length<2){value=e;e=null}this._ogma.modules.data.setProperty(this,e,value,{dispatch:false});return this};e.prototype.getData=function(e){yr(arguments.length);return this._ogma.modules.data.getProperty(this,e)};e.prototype.addClass=function(e,t){return this._ogma.modules.classes.addClassesToElements([e],this,t)};e.prototype.addClasses=function(e,t){return this._ogma.modules.classes.addClassesToElements(e,this,t)};e.prototype.removeClass=function(e,t){return this._ogma.modules.classes.removeClassesFromElements([e],this,t)};e.prototype.removeClasses=function(e,t){return this._ogma.modules.classes.removeClassesFromElements(e,this,t)};e.prototype.hasClass=function(e){var t=this;return this.map(function(r){return t._ogma.modules.classes.hasSingleElementClass(e,r)})};e.prototype.getClassList=function(){return this._ogma.modules.classes.getElementsClassList(this)};e.prototype.getAnimationInformation=function(){return this._ogma.modules.graphics.getAnimationInformation(this)};e.prototype.getMetaEdge=function(){return this._ogma.modules.grouping.getMetaElement(this)};e.prototype.getSubEdges=function(){return this._ogma.modules.grouping.getSubElements(this)};e.prototype.pulse=function(e){this._ogma.modules.pulses.pulse(this,e)};return e}();br([jr],{setStyle:"setAttributes",resetStyle:"resetAttributes",getStyle:"getAttribute"});var Ur="geo.latitude";var Gr="geo.longitude";var qr=85.0511287798;var Hr=1;var Wr='Map data &copy; <a target="_blank" href="http://osm.org/copyright">OpenStreetMap contributors</a>';var Xr={latitudePath:"latitude",longitudePath:"longitude",maxZoomLevel:22,minZoomLevel:0,wrapCoordinates:true,tileUrlTemplate:"https://maps.wikimedia.org/osm-intl/{z}/{x}/{y}{r}.png",tileUrlSubdomains:"abc",attribution:null,attributionOptions:undefined,backgroundColor:"silver",opacity:1,duration:0,detectRetina:false,disableNodeDragging:true,tileBuffer:1,sizeRatio:1,tiles:{url:"https://maps.wikimedia.org/osm-intl/{z}/{x}/{y}{r}.png",subdomains:"abc",tms:false,wms:false},crs:null};var Yr={maxBoundsViscosity:1,worldCopyJump:true,zoomControl:false,attributionControl:false};function Zr(){return typeof window!=="undefined"||typeof global!=="undefined"&&!global.process}function Kr(e){return Math.log2(e)+Hr}function Qr(e){return Math.pow(2,e-Hr)}function Jr(e){return e!=null&&!isNaN(e)}function $r(e,t){return ti(e,t,"longitude")}function ei(e,t){return ti(e,t,"latitude")}function ti(e,t,r){if(isNaN(t)){throw new TypeError("node "+e+": "+t+" is not a valid "+r)}}function ri(e){return Math.pow(2,Math.ceil(Math.log2(e)))}function ii(e,t){return t==null&&e.url===Xr.tiles.url?Wr:null}function ni(e,t){if(e===void 0){e={}}var r=e.tileUrlSubdomains,i=e.tileUrlTemplate,n=e.attribution,a=e.attributionOptions,o=e.latitudePath,s=e.longitudePath,u=e.sizeRatio,l=e.tiles;if(i!=null&&typeof i!=="string"){throw new TypeError("Geo mode: tileUrlTemplate must be a URL string")}if(r!=null&&typeof r!=="string"){throw new TypeError("Geo mode: tileUrlTemplate must be a string")}if(l!=null){if(!Y(l)&&!(l instanceof t.Layer)){throw new TypeError("Geo mode: tiles must be a object or L.Layer instance")}var d=l;if(d.url!=null&&typeof d.url!=="string"){throw new TypeError("Geo mode: tiles.url must be a string")}if(d.subdomains!=null&&typeof d.subdomains!=="string"){throw new TypeError("Geo mode: tiles.subdomains must be a string")}if(d.tms&&typeof d.tms!=="boolean"){throw new TypeError("Geo mode: tiles.tms must be a boolean")}if(d.wms&&typeof d.wms!=="boolean"){throw new TypeError("Geo mode: tiles.wms must be a boolean")}}if(n!=null&&typeof n!=="string"){throw new TypeError("Geo mode: Map attribution must be a string")}if(a!=null&&!Y(a)){throw new TypeError("Geo mode: attributionOptions must to be a BrandOptions object")}if(o!=null&&typeof o!=="string"&&!Array.isArray(o)){throw new TypeError("Geo mode: Latitude path must be a valid property path: "+"a string or an array of strings.")}if(s!=null&&typeof s!=="string"&&!Array.isArray(s)){throw new TypeError("Geo mode: Longitude path must be a valid property path: "+"a string or an array of strings.")}if(u!=null&&(!isFinite(u)||u<=0)){throw new TypeError("Geo mode: sizeRatio must be a positive number.")}}function ai(e,t){if(t===void 0){t={}}if(t.tiles===undefined||t.tileUrlTemplate||t.tileUrlSubdomains){var r=Xr.tiles;return d({},t.tiles||{},Xr.tiles,{url:t.tileUrlTemplate||r.url,subdomains:t.tileUrlSubdomains||r.subdomains})}if(Y(t.tiles)){return d({},e.tiles,t.tiles)}return t.tiles}function oi(e,t){if(e.attribution!==t.attribution){return true}return e.tiles!==t.tiles}var si=he().createElement("div");function ui(e){var t=he().createElement("div");t.className="ogma-geo-container";t.style.width=t.style.height="100%";var r=e||si;r.insertBefore(t,r.firstChild);return t}function li(e){var t=[[Infinity,Infinity],[-Infinity,-Infinity]];return e.getGeoCoordinates().reduce(function(e,t){var r=t.latitude,i=t.longitude;var n=e[0],a=e[1];n[0]=Math.min(n[0],r);n[1]=Math.min(n[1],i);a[0]=Math.max(a[0],r);a[1]=Math.max(a[1],i);return e},t)}function di(e,t,r){var i=r.longitudePath,n=r.latitudePath,a=r.wrapCoordinates;var o=e.getAttributes(true,[Ur,Gr]),s=o[0],u=o[1];var l=t._indexes;var d=t.getId();var h=l.length;var f=t.getData(n);var c=t.getData(i);for(var v=0;v<h;v++){var p=c[v];var g=f[v];var _=l[v];var m=d[v];if(g!=null&&p!=null){$r(m,p);ei(m,g);if(a){p=p%180;g=Jt(+g,-qr,qr)}u.set(_,p);s.set(_,g)}}}function hi(e,t,r){var i=t.longitudePath,n=t.latitudePath,a=t.wrapCoordinates;var o=e.getData(i);var s=e.getData(n);if(o==null||s==null){return false}if(a||r){return true}return Math.abs(s)<=qr&&Math.abs(o)<=180}function fi(e,t,r,i){ci(e,true,t,r,i)}function ci(e,t,r,i,n){var a=e.getAttribute(t,i);var o=e.getAttribute(t,n);var s=r._indexes;o.setMultiple(s,a.getMultiple(s))}function vi(e){return e.reduce(function(e,t){var r=t.nodes,i=t.newValues;if(!r){return e}var n=r.filter(function(e,t){return i[t]!=null});if(!e){return n}return e.concat(n)},null)}var pi=new Uint32Array(1);var gi=function(){function e(e,t){this.size=1;this.isNode=true;this.isList=false;this._index=e;this._ogma=t}Object.defineProperty(e.prototype,"_indexes",{get:function(){pi[0]=this._index;return pi},enumerable:true,configurable:true});e.prototype.setAttributes=function(e,t){return this._ogma.modules.individualAttributes.setMultipleAttributes(this,e,t)};e.prototype.setAttribute=function(e,value,t){return this._ogma.modules.individualAttributes.setSingleAttribute(this,e,value,t)};e.prototype.resetAttributes=function(e,t){return this._ogma.modules.individualAttributes.resetMultipleAttributes(this,e,t)};e.prototype.getAttributes=function(e){return this._ogma.modules.individualAttributes.getMultipleAttributes(this,e)[0]};e.prototype.getAttribute=function(e){return this._ogma.modules.individualAttributes.getSingleAttribute(this,e)[0]};e.prototype.getPosition=function(){return this.getAttributes(["x","y"])};e.prototype.getPositionOnScreen=function(){return this._ogma.modules.camera.graphToScreenCoordinates(this.getPosition())};e.prototype.isInScreen=function(){var e=this.getPositionOnScreen();var t=this._ogma.modules.camera;return e.x>=0&&e.x<=t.width&&e.y>=0&&e.y<=t.height};e.prototype.replaceOriginalAttributes=function(e,t){return this._ogma.modules.individualAttributes.replaceOriginalAttributes(this,e,t)};e.prototype.getPreviousAttributes=function(e){return this._ogma.modules.individualAttributes.getMultiplePreviousAttributes(this,e)[0]};e.prototype.isInView=function(e){return this._ogma.modules.locate.isElementInView(this,e)};e.prototype.getAdjacentNodes=function(e){return this._ogma.modules.graph.getAdjacentNodes(this,e)};e.prototype.getAdjacentEdges=function(e){return this._ogma.modules.graph.getAdjacentEdges(this,e)};e.prototype.getDegree=function(e){return this._ogma.modules.graph.getDegree(this,e)[0]};e.prototype.fastGetAdjacentElements=function(){return this._ogma.modules.graph.fastGetNodesAdjacentElements(this)};e.prototype.getConnectedComponent=function(e){return this._ogma.modules.graph.getConnectedComponentByNode(this,e)[0]};e.prototype.isVisible=function(){return!this.isExcluded()};e.prototype.isExcluded=function(){return this._ogma.modules.graph.isExcluded(this)[0]};e.prototype.setExcluded=function(value){return this._ogma.modules.graph.setExcluded(this,value)};e.prototype.setVisible=function(value){return this.setExcluded(!value)};e.prototype.toList=function(){return this._ogma.nodeList(new Uint32Array([+this._index]))};e.prototype.getId=function(){return zr(this._ogma.modules.graph,this)};e.prototype.slice=function(){return this.toList()};e.prototype.toJSON=function(e){if(e===void 0){e={}}var t=mr(e),r=t.attributes,i=t.data;return{id:this.getId(),attributes:this.getAttributes(r),data:i(O(this.getData()))}};e.prototype.get=function(e){return e===0?this:undefined};e.prototype.setSelected=function(e){this._ogma.modules.selection.setActive(this,e)};e.prototype.isSelected=function(){return this._ogma.modules.selection.areActive(this)};e.prototype.locate=function(e){return this._ogma.modules.locate.locateElements(this,e)};e.prototype.getBoundingBox=function(){return this._ogma.modules.locate.getBoundingBox(this)};e.prototype.setData=function(e,value){if(arguments.length<2){value=e;e=null}this._ogma.modules.data.setProperty(this,e,value);return this};e.prototype.getData=function(e){yr(arguments.length);return this._ogma.modules.data.getProperty(this,e)[0]};e.prototype.addClass=function(e,t){return this._ogma.modules.classes.addClassesToElements([e],this,t)};e.prototype.addClasses=function(e,t){return this._ogma.modules.classes.addClassesToElements(e,this,t)};e.prototype.removeClass=function(e,t){return this._ogma.modules.classes.removeClassesFromElements([e],this,t)};e.prototype.removeClasses=function(e,t){return this._ogma.modules.classes.removeClassesFromElements(e,this,t)};e.prototype.hasClass=function(e){return this._ogma.modules.classes.hasSingleElementClass(e,this)};e.prototype.getClassList=function(){return this._ogma.modules.classes.getElementsClassList(this)[0]};e.prototype.getGeoCoordinates=function(){var e=this._ogma.modules.graph;var t=e.getNodeAttribute(Ur).get(this._index);var r=e.getNodeAttribute(Gr).get(this._index);return{latitude:Jr(t)?t:undefined,longitude:Jr(r)?r:undefined}};e.prototype.setGeoCoordinates=function(e){var t=this;return this.toList().setGeoCoordinates([e]).then(function(){return t})};e.prototype.getAnimationInformation=function(){return this._ogma.modules.graphics.getAnimationInformation(this)[0]};e.prototype.isVirtual=function(){return this._ogma.modules.transformations.isElementVirtual(this)};e.prototype.getTransformation=function(){return this._ogma.modules.transformations.getElementTransformation(this)};e.prototype.getMetaNode=function(){return this._ogma.modules.grouping.getMetaElement(this)[0]};e.prototype.getSubNodes=function(){return this._ogma.modules.grouping.getSubElements(this)[0]};e.prototype.pulse=function(e){this._ogma.modules.pulses.pulse(this,e)};return e}();br([gi],{setStyle:"setAttributes",resetStyle:"resetAttributes",getStyle:"getAttribute",setPosition:"setAttributes"});var _i=function(){function e(e,t){this.isList=true;this.isNode=true;this._indexes=e;this._ogma=t}Object.defineProperty(e.prototype,"size",{get:function(){return this._indexes.length},enumerable:true,configurable:true});e.prototype.setAttributes=function(e,t){return this._ogma.modules.individualAttributes.setMultipleAttributes(this,e,t)};e.prototype.setAttribute=function(e,t,r){return this._ogma.modules.individualAttributes.setSingleAttribute(this,e,t,r)};e.prototype.getAttributes=function(e){return this._ogma.modules.individualAttributes.getMultipleAttributes(this,e)};e.prototype.getAttribute=function(e){return this._ogma.modules.individualAttributes.getSingleAttribute(this,e)};e.prototype.resetAttributes=function(e,t){return this._ogma.modules.individualAttributes.resetMultipleAttributes(this,e,t)};e.prototype.getPosition=function(){return this.getAttributes(["x","y"])};e.prototype.getPositionOnScreen=function(){var e=this;return this.getPosition().map(function(t){return e._ogma.modules.camera.graphToScreenCoordinates(t)})};e.prototype.replaceOriginalAttributes=function(e,t){return this._ogma.modules.individualAttributes.replaceOriginalAttributes(this,e,t)};e.prototype.getPreviousAttributes=function(e){return this._ogma.modules.individualAttributes.getMultiplePreviousAttributes(this,e)};e.prototype.getPreviousAttribute=function(e){return this._ogma.modules.individualAttributes.getSinglePreviousAttribute(this,e)};e.prototype.getAdjacentNodes=function(e){return this._ogma.modules.graph.getAdjacentNodes(this,e)};e.prototype.getAdjacentEdges=function(e){return this._ogma.modules.graph.getAdjacentEdges(this,e)};e.prototype.getDegree=function(e){return this._ogma.modules.graph.getDegree(this,e)};e.prototype.getConnectedComponents=function(e){return this._ogma.modules.graph.getConnectedComponents(this,e)};e.prototype.fastGetAdjacentElements=function(){return this._ogma.modules.graph.fastGetNodesAdjacentElements(this)};e.prototype.isVisible=function(){return this.isExcluded().map(function(value){return!value})};e.prototype.isExcluded=function(){return this._ogma.modules.graph.isExcluded(this)};e.prototype.setExcluded=function(value){return this._ogma.modules.graph.setExcluded(this,value)};e.prototype.setVisible=function(value){return this.setExcluded(!value)};e.prototype.toList=function(){return this};e.prototype.toArray=function(){return Fr(this._ogma.modules.graph,this)};e.prototype.clone=function(){return this._ogma.modules.graph.nodeList(this._indexes.slice())};e.prototype.getId=function(){return zr(this._ogma.modules.graph,this)};e.prototype.get=function(e){return Or(this._ogma.modules.graph,this,e)};e.prototype.forEach=function(e){wr(this._ogma.modules.graph,this,e)};e.prototype.map=function(e){return Tr(this._ogma.modules.graph,this,e)};e.prototype.filter=function(e){return Cr(this._ogma.modules.graph,this,e)};e.prototype.reduce=function(e,t){return Mr(this._ogma.modules.graph,this,e,t)};e.prototype.concat=function(e){return Nr(this._ogma.modules.graph,this,e)};e.prototype.dedupe=function(){return Lr(this._ogma.modules.graph,this)};e.prototype.slice=function(e,t){return this._ogma.modules.graph.nodeList(this._indexes.slice(e,t))};e.prototype.indexOf=function(e){if(!(e instanceof gi)){return-1}return this._indexes.indexOf(e._index)};e.prototype.includes=function(e){return this.indexOf(e)!==-1};e.prototype.inverse=function(){return kr(this._ogma.modules.graph,this)};e.prototype.sort=function(e){return Dr(this._ogma.modules.graph,this,e)};e.prototype.toJSON=function(e){if(e===void 0){e={}}return this.map(function(t){return t.toJSON(e)})};e.prototype.setSelected=function(e){this._ogma.modules.selection.setActive(this,e)};e.prototype.isSelected=function(){return this._ogma.modules.selection.areActive(this)};e.prototype.locate=function(e){return this._ogma.modules.locate.locateElements(this,e)};e.prototype.getBoundingBox=function(){return this._ogma.modules.locate.getBoundingBox(this)};e.prototype.setData=function(e,t){if(arguments.length<2){t=e;e=null}if(typeof t!=="function"&&!x(t)){throw new Error("invalid argument "+t+"; expected array or function")}this._ogma.modules.data.setProperty(this,e,t,{dispatch:true});return this};e.prototype.fillData=function(e,value){if(arguments.length<2){value=e;e=null}this._ogma.modules.data.setProperty(this,e,value,{dispatch:false});return this};e.prototype.getData=function(e){yr(arguments.length);return this._ogma.modules.data.getProperty(this,e)};e.prototype.addClass=function(e,t){return this._ogma.modules.classes.addClassesToElements([e],this,t)};e.prototype.addClasses=function(e,t){return this._ogma.modules.classes.addClassesToElements(e,this,t)};e.prototype.removeClass=function(e,t){return this._ogma.modules.classes.removeClassesFromElements([e],this,t)};e.prototype.removeClasses=function(e,t){return this._ogma.modules.classes.removeClassesFromElements(e,this,t)};e.prototype.hasClass=function(e){var t=this;return this.map(function(r){return t._ogma.modules.classes.hasSingleElementClass(e,r)})};e.prototype.getClassList=function(){return this._ogma.modules.classes.getElementsClassList(this)};e.prototype.getGeoCoordinates=function(){var e=this._ogma.modules.graph;var t=new Array(this._indexes.length);var r=e.getNodeAttribute(Ur).getMultiple(this._indexes);var i=e.getNodeAttribute(Gr).getMultiple(this._indexes);for(var n=0,a=this._indexes.length;n<a;n++){t[n]={latitude:r[n],longitude:i[n]}}return t};e.prototype.setGeoCoordinates=function(e){var t=this;var r=this._ogma.modules.geo;var i=this._ogma.modules.graph;var n=this.getId();var a=this._indexes;var o=new Array(a.length);var s=new Array(a.length);if(e===null){e=new Array(a.length).fill(null)}if(e.length!==a.length){throw new RangeError("You must provide coordinates for each node in the NodeList")}for(var u=0,l=a.length;u<l;u++){var d=e[u]||{latitude:null,longitude:null},h=d.latitude,f=d.longitude;var c=n[u];if(h==null&&f==null){h=f=undefined}else{ei(c,h);$r(c,f)}o[u]=h;s[u]=f}this.setData(r.latitudePath,o);this.setData(r.longitudePath,s);i.getNodeAttribute(Ur).setMultiple(a,o);i.getNodeAttribute(Gr).setMultiple(a,s);return this._ogma.modules.transformations.refresh().then(function(){return t})};e.prototype.getAnimationInformation=function(){return this._ogma.modules.graphics.getAnimationInformation(this)};e.prototype.getMetaNode=function(){return this._ogma.modules.grouping.getMetaElement(this)};e.prototype.getSubNodes=function(){return this._ogma.modules.grouping.getSubElements(this)};e.prototype.pulse=function(e){this._ogma.modules.pulses.pulse(this,e)};return e}();br([_i],{setStyle:"setAttributes",resetStyle:"resetAttributes",getStyle:"getAttribute",setPosition:"setAttributes"});var mi=function e(){this._values=[]};var yi={size:{configurable:true}};yi.size.get=function(){return this._values.length};mi.prototype.clear=function e(){this._values=[]};mi.prototype.add=function e(value){if(this._getIndex(value)===-1){this._values.push(value);return true}return false};mi.prototype.addMultiple=function e(t){for(var r=0;r<t.length;++r){this.add(t[r])}};mi.prototype.remove=function e(value){var t=this._getIndex(value);if(t!==-1){this._values.splice(t,1);return true}return false};mi.prototype.has=function e(value){return this._getIndex(value)!==-1};mi.prototype.values=function e(){return this._values.slice()};mi.prototype.keys=function e(){return this._values};mi.prototype._getIndex=function e(value){return this._values.indexOf(value)};Object.defineProperties(mi.prototype,yi);var bi=function e(){this._set=new Set};var xi={size:{configurable:true}};xi.size.get=function(){return this._set.size};bi.prototype.clear=function e(){this._set.clear()};bi.prototype.add=function e(value){var t=this._set.size;this._set.add(value);var r=this._set.size;return r!==t};bi.prototype.addMultiple=function e(t){for(var r=0;r<t.length;++r){this.add(t[r])}};bi.prototype.remove=function e(value){return this._set.delete(value)};bi.prototype.has=function e(value){return this._set.has(value)};bi.prototype.values=function e(){return Array.from(this._set.values())};bi.prototype.keys=function e(){return Array.from(this._set.keys())};Object.defineProperties(bi.prototype,xi);var Ai=mi;if(typeof Set!=="undefined"){Ai=bi;if(!Set.prototype.values){Ai.prototype.values=function(){var e=new Array(this._set.size);var t=0;this._set.forEach(function(value){return e[t++]=value});return e}}}var Ei=Ai;function Si(e,t,r,i){if(r===void 0){r={}}if(i===void 0){i={}}return Ci(e,t,[r],i).get(0)}function wi(e,t,r){var i=t.nodes,n=i===void 0?[]:i,a=t.edges,o=a===void 0?[]:a;if(r===void 0){r={}}if(!r.batchSize){return Promise.resolve({nodes:Ci(e,true,n,r),edges:Ci(e,false,o,r)})}else{var s;return Ti(e,true,n,r).then(function(t){s=t;return Ti(e,false,o,r)}).then(function(e){return{nodes:s,edges:e}})}}function Ti(e,t,r,i){if(i===void 0){i={}}if(!i.batchSize){return Promise.resolve(Ci(e,t,r,i))}else{var n=[];for(var a=0;a<r.length;a+=i.batchSize){n.push(r.slice(a,a+i.batchSize))}return n.reduce(function(r,n){var a=null;return r.then(function(t){a=t;return e.getDom().afterNextFrame()}).then(function(){return Ci(e,t,n,i)}).then(function(e){return a.concat(e)})},Promise.resolve(t?e.nodeList():e.edgeList()))}}function Ci(e,t,r,i){var n=e.storage.fetch(t);var a=[];var o=[];var s=[];var u=[];var l=new Ei;var d=i.virtual,h=d===void 0?false:d;for(var f=0,c=r;f<c.length;f++){var v=c[f];if(typeof v!=="object"||v===null||Array.isArray(v)){throw new Error(v+" is not a valid "+(t?"node":"edge"))}var p=Sr(v.id);if(!n.getIndex(p,false)&&!l.has(p)){o.push(p);a.push(v);l.add(p);if(!t){var g=v;var _=e.getExtremityIndex(p,g.source,"source");var m=e.getExtremityIndex(p,g.target,"target");s.push(_);u.push(m)}}}var y=n.addElements(o);if(t){e.topology.allocateNodes(y)}else{e.topology.allocateEdges(y,s,u)}var b=n.getFlexArray("object");var x=n.getFlexArray("excluded");var A=n.getFlexArray("removed");var E=n.getFlexArray("virtual");var S=t?e.node:e.edge;var w=t?e.nodeList:e.edgeList;var T=e.getCacheLists(t);var C=w(y);for(var I=0;I<y.length;I++){var M=y[I];b.set(M,S(M))}x.setMultiple(y,0);A.setMultiple(y,0);E.setMultiple(y,h?1:0);T.visible.invalidList();T.all.invalidList();T._all.invalidList();if(!h){T.raw.invalidList()}if(C.size!==0){if(t){e.fireEvent(It.ADD_NODES,{virtual:h,objects:a,nodes:C})}else{e.fireEvent(It.ADD_EDGES,{virtual:h,objects:a,edges:C})}}return C}var Ii=function(e){l(t,e);function t(t,r){var i=t.dom,n=t.events;var a=e.call(this)||this;a.storage={nodes:new or(true),edges:new or(false),fetch:function(e){return e?this.nodes:this.edges}};a._promisesToResolve=[];a._indexFreeStep=0;a._nodeIndexLists=[];a._edgeIndexLists=[];a._events=n;a._dom=i;a._events.register(["addNodes","addEdges","excludedStateChange"],["clear","beforeRemoveNodes","removeNodes","beforeRemoveEdges","removeEdges"]);var o=[{name:"excluded",storage:1,default:1},{name:"removed",storage:1,default:1},{name:"virtual",storage:1,default:0}];o.forEach(function(e){a.createNodeAttribute(e);a.createEdgeAttribute(e)});a.node=r.node;a.edge=r.edge;a.nodeList=r.nodeList;a.edgeList=r.edgeList;a._nodes=a.createAttribute(true,{name:"object",storage:"any"});a._edges=a.createAttribute(false,{name:"object",storage:"any"});a.createAttribute(false,{name:"source",storage:32});a.createAttribute(false,{name:"target",storage:32});a._nodeFilters=xr(a.storage.nodes);a._edgeFilters=xr(a.storage.edges);a._initialize();a._events.on({newFrame:function(){if(a._indexFreeStep===1){a._indexFreeStep=2}else if(a._indexFreeStep===2){a.storage.nodes.freeIndexes();a.storage.edges.freeIndexes();a._indexFreeStep=0}}});return a}t.prototype.onMounted=function(e,t){if(t.graph){var r=t.graph,i=r.nodes,n=r.edges;if(i){this.addNodes(i)}if(n){this.addEdges(n)}}};t.prototype.createIndexList=function(e){return this.storage.fetch(e).createIndexList()};t.prototype.setIndexFreeStep=function(e){this._indexFreeStep=e};t.prototype.getDom=function(){return this._dom};t.prototype.acquireIndexList=function(e){var t=e?this._nodeIndexLists:this._edgeIndexLists;var r=t.find(function(e){return!e.isBusy()});if(!r){r=this.createIndexList(e);t.push(r)}r.markBusy();return r};t.prototype.getObjectList=function(e){return e?this._nodes:this._edges};t.prototype.getListFactory=function(e){return e?this.nodeList:this.edgeList};t.prototype.getStorage=function(e){return e?this.storage.nodes:this.storage.edges};t.prototype.getFilter=function(e,t){var r=e?this._nodeFilters:this._edgeFilters;var i=r[t];return i||r.visible};t.prototype.fireEvent=function(e,t){this._events.fire(e,t)};t.prototype.getCacheLists=function(e){return e?this._nodeCacheLists:this._edgeCacheLists};t.prototype._resolvePromises=function(){var e=this._promisesToResolve;this._promisesToResolve=[];e.forEach(function(e){return e()})};t.prototype._initialize=function(){var e=this;this._nodeCacheLists=Ar(function(){return e.getNodeMaxIndex()},function(){return e.acquireIndexList(true)},this._nodeFilters);this._edgeCacheLists=Ar(function(){return e.getEdgeMaxIndex()},function(){return e.acquireIndexList(false)},this._edgeFilters);this.topology=new hr(this);this._resolvePromises()};t.prototype.getNodeMaxIndex=function(){return this.storage.nodes.getMaxIndex()};t.prototype.getEdgeMaxIndex=function(){return this.storage.edges.getMaxIndex()};t.prototype.isExcluded=function(e){var t=this.storage.fetch(e.isNode).getFlexArray("excluded");return t.getMultiple(e._indexes)};t.prototype.setExcluded=function(e,value){var t=value?1:0;var r=e.isNode;var i=this.storage.fetch(r);var n=i.getFlexArray("excluded");var a=i.getFlexArray("removed");var o=this.acquireIndexList(r);var s=this.getListFactory(r);for(var u=0;u<e._indexes.length;u++){var l=e._indexes[u];var d=n.get(l);var h=a.get(l);if(t!==d&&h===0){o.push(l)}}var f=o.sliceAndReset();if(f.length){this.getCacheLists(e.isNode).visible.invalidList();var c=s(f);n.setMultiple(f,t);this._events.fire(It.EXCLUDED_STATE_CHANGE,{elements:c,value:value})}};t.prototype.addNode=function(e,t){return Si(this,true,e,t)};t.prototype.addEdge=function(e,t){return Si(this,false,e,t)};t.prototype.addNodes=function(e,t){return Ti(this,true,e,t)};t.prototype.addEdges=function(e,t){return Ti(this,false,e,t)};t.prototype.getExtremityIndex=function(e,t,r){if(t instanceof gi){return t._index}else{var i=this.storage.nodes.getIndex(t);if(!i){throw new Error("addEdge(s): invalid "+r+' for edge "'+e+'"; node "'+t+'" does not exist')}return i}};t.prototype.getNodes=function(e){return this.getElements(true,e)};t.prototype.getEdges=function(e){return this.getElements(false,e)};t.prototype.getElements=function(e,t){var r=e?this.nodeList:this.edgeList;var i=e?_i:jr;var n=e?gi:Vr;if(!t||typeof t==="string"){var a=t||"visible";var o=this.getCacheLists(e);var s=o[a];if(!s){throw new Error('getNodes/getEdges: unexpected argument "'+a+'"')}return r(s.getList())}else{var u=this.acquireIndexList(e);var l=this.storage.fetch(e);if(t instanceof n){u.push(t._index)}else if(x(t)){var d=t;for(var h=0,f=d;h<f.length;h++){var c=f[h];if(c instanceof n){u.push(c._index)}else{var v=l.getIndex(c);if(v){u.push(v)}}}}else if(t instanceof i){var p=this.getFilter(e,"all");var g=t;for(var _=0;_<g._indexes.length;_++){var v=g._indexes[_];if(p(v)){u.push(v)}}}return r(u.sliceAndReset())}};t.prototype.getNode=function(e){return this._getElement(true,e)};t.prototype.getEdge=function(e){return this._getElement(false,e)};t.prototype._getElement=function(e,t){var r=e?gi:Vr;if(t instanceof r){return t}else{var i=this.getStorage(e);var n=this.getObjectList(e);var a=i.getIndex(t);return a?n.get(a):undefined}};t.prototype.clear=function(){this._events.fire(It.CLEAR_GRAPH);this.storage.nodes.clear();this.storage.edges.clear();this._initialize()};t.prototype.createAttribute=function(e,t){return this.storage.fetch(e).createFlexArray(t)};t.prototype.createNodeAttribute=function(e){return this.createAttribute(true,e)};t.prototype.createEdgeAttribute=function(e){return this.createAttribute(false,e)};t.prototype.getAttribute=function(e,t){var r=this.storage.fetch(e);return r.getFlexArray(t)};t.prototype.getAttributes=function(e,t){var r=this;return t.map(function(t){return r.getAttribute(e,t)})};t.prototype.getNodeAttribute=function(e){return this.storage.nodes.getFlexArray(e)};t.prototype.getNodeAttributes=function(e){return this.getAttributes(true,e)};t.prototype.getEdgeAttribute=function(e){return this.storage.edges.getFlexArray(e)};t.prototype.getEdgeAttributes=function(e){return this.getAttributes(false,e)};t.prototype.getAllNodeAttributes=function(){return this.storage.nodes.getAllFlexArrays()};t.prototype.getAllEdgeAttributes=function(){return this.storage.edges.getAllFlexArrays()};t.prototype.setSource=function(e,t){var r=this.getNode(t);this.topology.setExtremities(e._indexes,r._indexes,null)};t.prototype.setTarget=function(e,t){var r=this.getNode(t);this.topology.setExtremities(e._indexes,null,r._indexes)};t.prototype.getParallelEdges=function(e,t){if(t===void 0){t={}}return this.topology.getParallelEdges(e,t)};t.prototype.getEdgesBetweenTwoNodes=function(e,t){return this.edgeList(this.topology.getEdgesBetweenTwoNodes(e._index,t._index))};t.prototype.getAdjacentDirections=function(e){return this.topology.getAdjacentDirections(e)};t.prototype.getEdgeIndexesInDirection=function(e){return this.topology.getEdgeIndexesInDirection(e)};t.prototype.fastGetNodesAdjacentElements=function(e){return this.topology.fastGetNodesAdjacentElements(e._indexes)};t.prototype.fastGetEdgesAdjacentElements=function(e){return this.topology.fastGetEdgesAdjacentElements(e._indexes)};t.prototype.getAdjacentNodes=function(e,t){return this.nodeList(this.topology.getAdjacentElements(true,e._indexes,t))};t.prototype.getAdjacentEdges=function(e,t){return this.edgeList(this.topology.getAdjacentElements(false,e._indexes,t))};t.prototype.getDegree=function(e,t){return this.topology.getDegree(e._indexes,t)};t.prototype.degrees=function(e,t){return this.topology.degrees(e,t)};t.prototype.getAdjacencyList=function(e){var t=e===void 0?{}:e,r=t.directed,i=r===void 0?false:r,n=t.internalIndexes,a=n===void 0?false:n,o=t.weight,s=o===void 0?1:o,u=t.nodes,l=t.indexes;return this.topology.getAdjacencyList({directed:i,weight:s,ids:!a,nodes:l||this.getNodes(u)._indexes})};t.prototype.getConnectedComponents=function(e,t){return this.topology.getConnectedComponents(e._indexes,t)};t.prototype.getConnectedComponentByNode=function(e,t){return this.topology.getConnectedComponents(e._indexes,t)};return t}(Ct);var Mi=["AliceBlue","#F0F8FF","AntiqueWhite","#FAEBD7","Aqua","#00FFFF","Aquamarine","#7FFFD4","Azure","#F0FFFF","Beige","#F5F5DC","Bisque","#FFE4C4","Black","#000000","BlanchedAlmond","#FFEBCD","Blue","#0000FF","BlueViolet","#8A2BE2","Brown","#A52A2A","BurlyWood","#DEB887","CadetBlue","#5F9EA0","Chartreuse","#7FFF00","Chocolate","#D2691E","Coral","#FF7F50","CornflowerBlue","#6495ED","Cornsilk","#FFF8DC","Crimson","#DC143C","Cyan","#00FFFF","DarkBlue","#00008B","DarkCyan","#008B8B","DarkGoldenRod","#B8860B","DarkGray","#A9A9A9","DarkGrey","#A9A9A9","DarkGreen","#006400","DarkKhaki","#BDB76B","DarkMagenta","#8B008B","DarkOliveGreen","#556B2F","DarkOrange","#FF8C00","DarkOrchid","#9932CC","DarkRed","#8B0000","DarkSalmon","#E9967A","DarkSeaGreen","#8FBC8F","DarkSlateBlue","#483D8B","DarkSlateGray","#2F4F4F","DarkSlateGrey","#2F4F4F","DarkTurquoise","#00CED1","DarkViolet","#9400D3","DeepPink","#FF1493","DeepSkyBlue","#00BFFF","DimGray","#696969","DimGrey","#696969","DodgerBlue","#1E90FF","FireBrick","#B22222","FloralWhite","#FFFAF0","ForestGreen","#228B22","Fuchsia","#FF00FF","Gainsboro","#DCDCDC","GhostWhite","#F8F8FF","Gold","#FFD700","GoldenRod","#DAA520","Gray","#808080","Grey","#808080","Green","#008000","GreenYellow","#ADFF2F","HoneyDew","#F0FFF0","HotPink","#FF69B4","IndianRed","#CD5C5C","Indigo","#4B0082","Ivory","#FFFFF0","Khaki","#F0E68C","Lavender","#E6E6FA","LavenderBlush","#FFF0F5","LawnGreen","#7CFC00","LemonChiffon","#FFFACD","LightBlue","#ADD8E6","LightCoral","#F08080","LightCyan","#E0FFFF","LightGoldenRodYellow","#FAFAD2","LightGray","#D3D3D3","LightGrey","#D3D3D3","LightGreen","#90EE90","LightPink","#FFB6C1","LightSalmon","#FFA07A","LightSeaGreen","#20B2AA","LightSkyBlue","#87CEFA","LightSlateGray","#778899","LightSlateGrey","#778899","LightSteelBlue","#B0C4DE","LightYellow","#FFFFE0","Lime","#00FF00","LimeGreen","#32CD32","Linen","#FAF0E6","Magenta","#FF00FF","Maroon","#800000","MediumAquaMarine","#66CDAA","MediumBlue","#0000CD","MediumOrchid","#BA55D3","MediumPurple","#9370DB","MediumSeaGreen","#3CB371","MediumSlateBlue","#7B68EE","MediumSpringGreen","#00FA9A","MediumTurquoise","#48D1CC","MediumVioletRed","#C71585","MidnightBlue","#191970","MintCream","#F5FFFA","MistyRose","#FFE4E1","Moccasin","#FFE4B5","NavajoWhite","#FFDEAD","Navy","#000080","OldLace","#FDF5E6","Olive","#808000","OliveDrab","#6B8E23","Orange","#FFA500","OrangeRed","#FF4500","Orchid","#DA70D6","PaleGoldenRod","#EEE8AA","PaleGreen","#98FB98","PaleTurquoise","#AFEEEE","PaleVioletRed","#DB7093","PapayaWhip","#FFEFD5","PeachPuff","#FFDAB9","Peru","#CD853F","Pink","#FFC0CB","Plum","#DDA0DD","PowderBlue","#B0E0E6","Purple","#800080","RebeccaPurple","#663399","Red","#FF0000","RosyBrown","#BC8F8F","RoyalBlue","#4169E1","SaddleBrown","#8B4513","Salmon","#FA8072","SandyBrown","#F4A460","SeaGreen","#2E8B57","SeaShell","#FFF5EE","Sienna","#A0522D","Silver","#C0C0C0","SkyBlue","#87CEEB","SlateBlue","#6A5ACD","SlateGray","#708090","SlateGrey","#708090","Snow","#FFFAFA","SpringGreen","#00FF7F","SteelBlue","#4682B4","Tan","#D2B48C","Teal","#008080","Thistle","#D8BFD8","Tomato","#FF6347","Turquoise","#40E0D0","Violet","#EE82EE","Wheat","#F5DEB3","White","#FFFFFF","WhiteSmoke","#F5F5F5","Yellow","#FFFF00","YellowGreen","#9ACD32"];var Li=/^rgba?\((\d+),?\s*(\d+),?\s*(\d+),?\s*((\d+)?\.?\d+)*\)$/;function ki(e,t){if(t===void 0){t=[0,0,0,0]}var r=Li.exec(e);if(r){t[0]=parseInt(r[1])/255;t[1]=parseInt(r[2])/255;t[2]=parseInt(r[3])/255;t[3]=r[4]===undefined?1:parseFloat(r[4]);return t}else{return null}}function Ni(e){if(e<16){return"0"+e.toString(16)}return e.toString(16)}function Fi(e){var t=e[0],r=e[1],i=e[2],n=e[3],a=n===void 0?1:n;return"rgba("+(t*256|0)+","+(r*256|0)+","+(i*256|0)+","+a+")"}function zi(e){var t=/^#?([a-f\d])([a-f\d])([a-f\d])$/i;e=e.replace(t,function(e,t,r,i){return t+t+r+r+i+i});var r=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);if(r){return[parseInt(r[1],16)/255,parseInt(r[2],16)/255,parseInt(r[3],16)/255,1]}else{return null}}var Ri=[0,0,0,0];var Pi=function(){function e(){this._colorByName={};this._colorByName["null"]=[0,0,0,0];this._colorByName["transparent"]=[0,0,0,0];for(var e=0;e<Mi.length;e+=2){var t=Mi[e].toLowerCase();var value=Mi[e+1];this._colorByName[t]=zi(value)}}e.prototype.parseColor=function(e){var t=this._colorByName[e];if(t===undefined){var r=e+"";t=r.charAt(0)==="#"?zi(r):ki(r);this._colorByName[e]=t}return t};e.prototype.toHexa=function(e){var t=this.parseColor(e),r=t[0],i=t[1],n=t[2];return"#"+Ni(r*255)+Ni(i*255)+Ni(n*255)};e.prototype.rgbaToRgb=function(e){var t=1;var r=e;if(r&&ki(e,Ri)){r="rgb("+ +Ri[0]*255+","+ +Ri[1]*255+","+ +Ri[2]*255+")";t=parseFloat(Ri[3].toString())}return{color:r,opacity:t}};return e}();var Oi=1;var Di=2;var Bi=3;var Vi=1;var ji=2;var Ui=3;var Gi=4;var qi=5;var Hi=6;var Wi=7;var Xi=1;var Yi=2;var Zi=3;var Ki=4;var Qi=5;var Ji=1;var $i=2;var en=3;var tn;var rn=(tn={},tn[ji]="image",tn[Gi]="piechart",tn[Ui]="text",tn[qi]="icon",tn[Hi]="badge",tn);var nn=function(){function e(){this._pixelRatio=1;this._nextPatternId=1;this._version=0;this._init_()}e.prototype.reset=function(){this._init_()};e.prototype._init_=function(){this._mustUpdate=true;this._nextPatternId=1;this._patterns=[null];this._patternsByHash={};this._pixelRatio=1;this._nullPattern={id:-1,type:Vi,attributes:{}}};e.prototype._increaseNextId=function(){var e=this._nextPatternId++;if(e%256===255){e=this._nextPatternId++}while(this._patterns.length<=e){this._patterns.push(undefined)}return e};e.prototype._createPattern=function(e){var t=e.type,r=e.attributes;var i={id:this._increaseNextId(),type:t,attributes:this._cloneAttributes(t,r)};this._patterns[i.id]=i;this._mustUpdate=true;return i};e.prototype._cloneAttributes=function(e,t){if(e===ji){return{image:t.image,scaled:t.scaled,duplicated:t.duplicated}}else if(e===Ui||e===qi||e===Hi){return{font:t.font,size:t.size,style:t.style,text:t.text,align:t.align||"center",offset:t.offset||0}}else if(e===Gi){return{colors:t.colors,colorArray:t.colors.split(";").map(function(e){return e.trim()})}}};e.prototype.getPatternList=function(){return this._patterns.filter(function(e){return e})};e.prototype.update=function(){if(this._mustUpdate){this._version+=1;this._mustUpdate=false}};e.prototype.setPixelRatio=function(value){if(value!==this._pixelRatio){this._pixelRatio=value;this._mustUpdate=true}};e.prototype.getPixelRatio=function(){return this._pixelRatio};e.prototype.notifyUpdate=function(){this._mustUpdate=true};e.prototype.getIdFromDefinition=function(e){var t=e.type,r=e.attributes;var i=t===Ui||t===qi||t===Hi;var n=t&&t!==Vi&&t!==Wi&&(t!==ji||r.image)&&(!i||r.text&&r.font);var a=0;if(n){a=this._addPattern(e);if(t===Ui&&r.style==="normal"){r.style="bold";this._addPattern(e)}}return a};e.prototype._addPattern=function(e){var t=this._getPatternHash(e);var r=this._patternsByHash[t];if(!r){if(this._nextPatternId>65500){vr("maximum number of pattern exceeded")}else{r=this._createPattern(e).id;this._patternsByHash[t]=r}}return r};e.prototype._getPatternHash=function(e){var t=e.type,r=e.attributes;var i=[rn[t]];if(t===ji){i.push(r.scaled?"scaled":"non-scaled",r.duplicated?"duplicated":"non-duplicated",r.image.src||r.image.toDataURL())}else if(t===Ui){i.push(r.text,r.font,r.style,r.size,r.align||"center",r.offset||0)}else if(t===qi||t===Hi){i.push(r.text,r.font,r.style,r.size)}else{i.push(r.colors)}return i.join("+")};e.prototype.getDefinitionFromId=function(e){return e?this._patterns[e]:this._nullPattern};e.prototype.getVersion=function(){return this._version};return e}();var an=512;var on=128;var sn=Math.round(Math.log2(an));var un=Math.round(Math.log2(on));var ln=sn+un;var dn=255;var hn=32767;var fn=65535;var cn=15;var vn=3;var pn=15;var gn=32;var _n=128;var mn=8;var yn=1/16;var bn=Math.round(Math.sqrt(pn+1));var xn=_n*bn;var An=16;var En=1;var Sn=256;var wn=128;var Tn=128;var Cn=1.5;var In=1.2;var Mn=52;var Ln=16;var kn=Mn*2+Ln;var Nn=4;var Fn=3;var zn=41;var Rn=5;var Pn=5;var On=.9721;var Dn=function(){function e(){this._version=0;this._mustUpdate=true;this._byName={};this._byId=new Array(pn+1)}e.prototype.register=function(e,t){var r=t.getDistanceFromStrokeVertically,i=t.getDistanceFromStrokeHorizontally,n=t.points,a=t.hole,o=t.isSimple;if(this._byName[e]){return}var s=o?1:mn;var u=o?mn-1:pn;while(this._byId[s]){s+=1}if(s>u){throw new Error("max number of shape exceeded")}var l={id:s,name:e,getDistanceFromStrokeVertically:r,getDistanceFromStrokeHorizontally:i,points:n.slice(),hole:a?a.slice():null,isSimple:!!o};this._mustUpdate=true;this._byId[s]=l;this._byName[e]=l;return l};e.prototype.getIdFromName=function(e){return this._byName[e].id};e.prototype.getNameFromId=function(e){var t=this._byId[e];return t?t.name:null};e.prototype.getDefinitionFromName=function(e){return this._byName[e]||null};e.prototype.update=function(){if(this._mustUpdate){this._version+=1;this._mustUpdate=false}};e.prototype.getVersion=function(){return this._version};e.prototype.getShapeList=function(){return this._byId.filter(function(e){return e})};return e}();var Bn=function e(t){var r=t.elementSize;var i=t.sideElementSize;var n=t.nbSideElementsPerMainElement;var a=t.id;var o=t.depth;var s=t.elementType;var u=t.animated;var l=t.stencilUsage;this._id=a;this._depth=o;this._elementType=s;this._animated=u;this._stencilUsage=l;this._version=0;this._elementSize=r;this._sideElementSize=i;this._nbSideElementsPerMainElement=n;this._totalSideElementsSize=n*i;this._capacity=an;this._byteCapacity=this._capacity*this._elementSize;this._byteArray=new Uint8Array(this._byteCapacity);this._dataView=new DataView(this._byteArray.buffer);this._sideByteCapacity=this._capacity*this._totalSideElementsSize;this._sideByteArray=new Uint8Array(this._sideByteCapacity);this._sideDataView=new DataView(this._sideByteArray.buffer);this._nbCellsAllocated=0;this._nbCellsFreed=0;this._isFullyAllocated=false;this._isFullyFreed=false;this._mustUpdate=true};Bn.prototype.update=function e(){if(this._mustUpdate){this._version+=1;this._mustUpdate=false;if(this._isFullyAllocated&&this._nbCellsFreed===this._nbCellsAllocated){this._isFullyFreed=true}}};Bn.prototype.allocate=function e(t){var r=-1;if(!this._isFullyAllocated&&this._nbCellsAllocated+t<=this._capacity){r=this._nbCellsAllocated;this._nbCellsAllocated+=t;this._mustUpdate=true}else{this._isFullyAllocated=true}return r};Bn.prototype.free=function e(t,r){for(var i=0;i<r;++i){var n=(t+i)*this._elementSize;if(this._dataView.getUint16(n)===0){throw new Error('"free": invalid address provided')}this._dataView.setUint16(n,0)}this._mustUpdate=true;this._nbCellsFreed+=r};Bn.prototype.triggerUpdate=function e(){this._mustUpdate=true};Bn.prototype.isEmpty=function e(){return this._nbCellsFreed===this._nbCellsAllocated};Bn.prototype.isFullyFreed=function e(){return this._isFullyFreed};Bn.prototype.getId=function e(){return this._id};Bn.prototype.getDepth=function e(){return this._depth};Bn.prototype.getElementType=function e(){return this._elementType};Bn.prototype.getDataView=function e(){return this._dataView};Bn.prototype.getByteArray=function e(){return this._byteArray};Bn.prototype.getElementSize=function e(){return this._elementSize};Bn.prototype.isAnimated=function e(){return this._animated};Bn.prototype.getCapacity=function e(){return this._capacity};Bn.prototype.getSize=function e(){return this._nbCellsAllocated};Bn.prototype.getNbSideElementsPerMainElement=function e(){return this._nbSideElementsPerMainElement};Bn.prototype.hasSideData=function e(){return this._nbSideElementsPerMainElement>0};Bn.prototype.getSideDataView=function e(){return this._sideDataView};Bn.prototype.getSideByteArray=function e(){return this._sideByteArray};Bn.prototype.getTotalSideElementsSize=function e(){return this._totalSideElementsSize};Bn.prototype.getVersion=function e(){return this._version};Bn.prototype.getStencilUsage=function e(){return this._stencilUsage};var Vn=8;var jn=function e(){this._version=0;this._blockInfo={buffer:null,offset:0,size:0,address:0};this._init_()};jn.prototype.reset=function e(){this._init_()};jn.prototype._init_=function e(){this._buffersByDepth=new Array(100);this._buffersById=[];this._buffersByAscendingDepth=[];this._buffersByDescendingDepth=[];this._mustUpdate=true};jn.prototype._fillBlockInfo=function e(t,r,i,n){this._blockInfo.buffer=t;this._blockInfo.offset=r;this._blockInfo.size=i;this._blockInfo.address=n;return this._blockInfo};jn.prototype._createBuffer=function e(t,r,i,n,a){var o=r?kn:Mn;var s=this._buffersById.length;var u=new Bn({elementSize:o,sideElementSize:Nn,nbSideElementsPerMainElement:n,id:s,depth:i,elementType:t,animated:r,stencilUsage:a});this._buffersById.push(u);return u};jn.prototype.getBlockInfo=function e(t){return this._getBlockInfo(t)};jn.prototype._getBlockInfo=function e(t){return this._fillBlockInfo(this._buffersById[t>>ln],(t>>un)%an,t%on,t)};jn.prototype.allocateBlock=function e(t,r,i,n,a,o,s){var u=Gn(o,Vn);this._mustUpdate=true;var l=null;var d=-1;if(t){var h=this._getBlockInfo(t);var f=h.buffer;var c=h.offset;var v=h.size;var p=h.size===a;var g=f.getDepth()===n;var _=f.getElementType()===r;var m=f.isAnimated()===i;var y=f.getNbSideElementsPerMainElement()===u;var b=f.getStencilUsage()===s;if(p&&g&&_&&m&&y&&b){f.triggerUpdate();l=f;d=c}else{f.free(c,v)}}if(d===-1){var x=u/Vn;var A=this._buffersByDepth[n]||(this._buffersByDepth[n]=new Array(2));var E=A[+i]||(A[+i]=[]);var S=E[r]||(E[r]=new Array(16));var w=S[x]||(S[x]=new Array(4));var T=w[s]||(w[s]=[]);var C=T[T.length-1];if(C){l=C;d=C.allocate(a)}if(d===-1){l=this._createBuffer(r,i,n,u,s);d=l.allocate(a);T.push(l)}}var I=Un(l.getId(),d,a);return this._fillBlockInfo(l,d,a,I)};jn.prototype.freeBlock=function e(t){if(t){this._mustUpdate=true;var r=this._getBlockInfo(t);r.buffer.free(r.offset,r.size)}return 0};jn.prototype._sortBuffersByDepth=function e(){var t=[];for(var r=0;r<this._buffersByDepth.length;++r){var i=this._buffersByDepth[r];if(!i){continue}for(var n=0;n<i.length;++n){var a=i[n];if(!a){continue}for(var o=0;o<a.length;++o){var s=a[o];if(!s){continue}for(var u=0;u<s.length;++u){var l=s[u];if(!l){continue}for(var d=0;d<l.length;++d){var h=l[d];if(!h){continue}for(var f=0;f<h.length;++f){var c=h[f];c.update();if(c.isFullyFreed()){this._buffersById[c.getId()]=undefined;h.splice(f,1);f-=1}else{t.push(c)}}}}}}}this._buffersByAscendingDepth=t;this._buffersByDescendingDepth=t.slice().reverse()};jn.prototype.update=function e(){if(this._mustUpdate){this._sortBuffersByDepth();this._version+=1;this._mustUpdate=false}};jn.prototype.getBuffers=function e(){return this._buffersById};jn.prototype.getBuffersByAscendingDepth=function e(){return this._buffersByAscendingDepth};jn.prototype.getBuffersByDescendingDepth=function e(){return this._buffersByDescendingDepth};jn.prototype.getVersion=function e(){return this._version};function Un(e,t,r){return((e<<sn)+t<<un)+r}function Gn(e,t){var value=0;while(value<e){value+=t}return value}function qn(){return{pieceId:0,shape:"circle",x1:0,y1:0,x2:0,y2:0,rectWidthOrSourceRadiusScaled:0,rectWidthOrSourceRadiusFixed:0,rectHeightTargetRadiusScaled:0,rectHeightTargetRadiusFixed:0,thicknessOrFontSizeScaled:0,thicknessOrFontSizeFixed:0,strokeWidthScaled:0,strokeWidthFixed:0,offsetScaled:0,offsetFixed:0,pattern:{type:0,attributes:{}},opacity:1,fillColor:null,strokeColor:null,patternColor:null,globalMinVisibleSize:0,strokeMinVisibleSize:0,patternMinVisibleSize:0,offsetAngle:0,patternScale:0,symbolicSize:-1,curvature:0,dashLength:0,gapLength:0,hasHead:false,hasTail:false,isBodyTriangle:false,isSelfLoop:false,isText:false,adjustTextAngle:false,unusedFlag1:false,unusedFlag2:false,unusedFlag3:false}}function Hn(e){e.pieceId=0;e.shape="";e.x1=0;e.y1=0;e.x2=0;e.y2=0;e.rectWidthOrSourceRadiusScaled=0;e.rectWidthOrSourceRadiusFixed=0;e.rectHeightTargetRadiusScaled=0;e.rectHeightTargetRadiusFixed=0;e.thicknessOrFontSizeScaled=0;e.thicknessOrFontSizeFixed=0;e.strokeWidthScaled=0;e.strokeWidthFixed=0;e.offsetScaled=0;e.offsetFixed=0;e.pattern.type=0;e.opacity=1;e.fillColor=null;e.strokeColor=null;e.patternColor=null;e.globalMinVisibleSize=0;e.strokeMinVisibleSize=0;e.patternMinVisibleSize=0;e.offsetAngle=0;e.patternScale=0;e.symbolicSize=0;e.curvature=0;e.dashLength=0;e.gapLength=0;e.hasHead=false;e.hasTail=false;e.isBodyTriangle=false;e.isSelfLoop=false;e.isText=false;e.adjustTextAngle=false;e.unusedFlag1=false;e.unusedFlag2=false;e.unusedFlag3=false;return e}function Wn(e){e.duration=0;e.beginTime=-1;e.easing="linear"}function Xn(){return{valid:false,id:undefined,end:qn(),start:qn(),animation:{duration:0,beginTime:-1,easing:"linear"}}}function Yn(e,t,r,i){e.width=t*i;e.height=r*i;e.style.width=t+"px";e.style.height=r+"px"}var Zn=function e(t){this._bufferList=t.bufferList;this._shapeManager=t.shapeManager;this._patternManager=t.patternManager;this._boundariesManager=t.boundariesManager;this._textManager=t.textManager;this._colorManager=t.colorManager;this._easingManager=t.easingManager;this._idRecorder=t.idRecorder;this._firstFrame=true;this._width=0;this._height=0;this._pixelRatio=0;this._viewX=0;this._viewY=0;this._viewZoom=0;this._viewAngle=0;this._viewAngleCos=0;this._viewAngleSin=0;this._currentTime=0;this._bytesToActualCoord=0;this._bytesToActualScaledSize=0;this._bytesToActualMinVisibleSize=0;this._bytesToActualSymbolicSize=0;this._bytesToActualDashLength=0;this._bytesToActualGapLength=0;this._bytesToActualPatternScale=0;this._shapesVersion=0;this._patternsVersion=0;this._boundariesVersion=0;this._textsVersion=0;this._backgroundColor=null;this._backgroundRgba=[1,1,1,0];this._renderBackground=false;this._isBufferDisplayable=null;this._hideImages=false;this._rgbaToString=new Array(65535);this._genericObject=Xn();this._littleEndian=N()};Zn.createInitData=function e(){return null};Zn.getName=function e(){return null};Zn.isAvailable=function e(){return true};Zn.prototype.getDomElement=function e(){return null};Zn.prototype._initCanvas=function e(t){t.style.touchAction="none"};Zn.prototype.export=function e(){return Promise.resolve()};Zn.prototype._bytesToColor=function e(value){var t=this._rgbaToString[value];if(!t){var r=Kn(value,0,4)/15;var i=Kn(value,4,8)/15;var n=Kn(value,8,12)/15;var a=Kn(value,12,16)/15;t="rgba("+(r*255|0)+", "+(i*255|0)+", "+(n*255|0)+", "+a+")";if(r+i+n+a===0){t=null}this._rgbaToString[value]=t}return t};Zn.prototype._unsignedToSignedByte=function e(value){return value-128};Zn.prototype._bytesToCoord=function e(value){return value*this._bytesToActualCoord};Zn.prototype._bytesToScaledSize=function e(value){return value*this._bytesToActualScaledSize};Zn.prototype._bytesToFixedSize=function e(value){return value};Zn.prototype._bytesToMinVisibleSize=function e(value){return value*this._bytesToActualMinVisibleSize};Zn.prototype._extractGenericObject=function e(t,r,i){var n=r;var a=i;var o=this._littleEndian;var s=n.getUint16(a,o);var u=Kn(s,0,4);var l=Kn(s,4,8);var d=Kn(s,8,10);var h=Kn(s,10,12);var f=Kn(s,12,13);var c=Kn(s,13,14);var v=Kn(s,14,15);var p=Kn(s,15,16);var g=n.getUint16(a+2,o);var _=Kn(g,0,8);var m=Kn(g,8,11);var y=Kn(g,11,12);var b=Kn(g,12,13);var x=Kn(g,13,14);var A=Kn(g,14,15);var E=Kn(g,15,16);var S=n.getUint16(a+4,o);var w=Kn(S,0,4);var T=Kn(S,4,8);var C=Kn(S,8,12);var I=Kn(S,12,16);var M=n.getUint16(a+6,o);var L=Kn(M,0,8);var k=Kn(M,8,16);var N=n.getUint16(a+8,o);var F=n.getUint16(a+10,o);var z=n.getUint16(a+12,o);var R=n.getUint16(a+14,o);var P=n.getFloat32(a+16,o);var O=n.getFloat32(a+20,o);var D=n.getFloat32(a+24,o);var B=n.getFloat32(a+28,o);var V=n.getUint16(a+32,o);var j=n.getUint16(a+34,o);var U=n.getUint16(a+36,o);var G=n.getUint16(a+38,o);var q=n.getUint16(a+40,o);var H=n.getUint16(a+42,o);var W=n.getUint16(a+44,o);var X=n.getUint16(a+46,o);var Y=n.getUint16(a+48,o);var Z=n.getUint16(a+50,o);t.pieceId=l;t.shape=this._shapeManager.getNameFromId(u);t.x1=this._bytesToCoord(P);t.y1=this._bytesToCoord(O);t.x2=this._bytesToCoord(D);t.y2=this._bytesToCoord(B);t.rectWidthOrSourceRadiusScaled=this._bytesToScaledSize(V);t.rectWidthOrSourceRadiusFixed=this._bytesToFixedSize(j);t.rectHeightOrTargetRadiusScaled=this._bytesToScaledSize(U);t.rectHeightOrTargetRadiusFixed=this._bytesToFixedSize(G);t.thicknessOrFontSizeScaled=this._bytesToScaledSize(q);t.thicknessOrFontSizeFixed=this._bytesToFixedSize(H);t.strokeWidthScaled=this._bytesToScaledSize(W);t.strokeWidthFixed=this._bytesToFixedSize(X);t.offsetScaled=this._bytesToScaledSize(Y);t.offsetFixed=this._bytesToFixedSize(Z);t.pattern=this._patternManager.getDefinitionFromId(N);t.opacity=w/15;t.fillColor=this._bytesToColor(F);t.strokeColor=this._bytesToColor(z);t.patternColor=this._bytesToColor(R);t.globalMinVisibleSize=this._bytesToMinVisibleSize(T);t.strokeMinVisibleSize=this._bytesToMinVisibleSize(C);t.patternMinVisibleSize=this._bytesToMinVisibleSize(I);t.offsetAngle=m*(Math.PI*2/8);t.patternScale=_*this._bytesToActualPatternScale;t.symbolicSize=L*this._bytesToActualSymbolicSize;t.curvature=this._unsignedToSignedByte(k);t.dashLength=d*this._bytesToActualDashLength;t.gapLength=h*this._bytesToActualGapLength;t.hasHead=!!f;t.hasTail=!!c;t.isBodyTriangle=!!v;t.isSelfLoop=!!p;t.isText=!!y;t.adjustTextAngle=!!b;t.unusedFlag1=!!x;t.unusedFlag2=!!A;t.unusedFlag3=!!E};Zn.prototype._extractAnimationInformation=function e(t,r,i){var n=r;var a=i;var o=this._littleEndian;var s=n.getFloat32(a,o);var u=n.getFloat32(a+4,o);var l=n.getUint16(a+8,o);var d=n.getUint16(a+10,o);var h=n.getUint16(a+12,o);var f=n.getUint16(a+14,o);var c=(l>>8)-128;var v=(d>>8)-128;var p=(h>>8)-128;var g=(f>>8)-128;var _=l%256-128;var m=d%256-128;var y=h%256-128;var b=f%256-128;t.beginTime=s;t.duration=u;t.easing=this._easingManager.getNameFromPolygon(c,v,p,g,_,m,y,b)};Zn.prototype._extractTextCharacters=function e(t,r,i,n){t.pattern=this._textManager.extractTextFromDataView(r,i,n)};Zn.prototype.extractElement=function e(t,r){var i=t.getElementType();var n=t.isAnimated();var a=t.getDataView();var o=t.getElementSize();var s=r*o;var u=this._genericObject;u.valid=false;if(a.getUint16(s)){u.valid=true;this._extractGenericObject(u.end,a,s);if(n){this._extractGenericObject(u.start,a,s+Mn);this._extractAnimationInformation(u.animation,a,s+Mn*2)}u.id=this._idRecorder.get(t,r);if(i===Di){var l=t.getSideDataView();var d=r*t.getTotalSideElementsSize();var h=d+t.getTotalSideElementsSize();var f=u.end;this._extractTextCharacters(f,l,d,h)}}return u};Zn.prototype._compareDimensions=function e(t,r,i){if(t!==this._width||r!==this._height||i!==this._pixelRatio){this._width=t;this._height=r;this._pixelRatio=i;return true}return false};Zn.prototype._compareView=function e(t,r,i,n){if(t!==this._viewX||r!==this._viewY||i!==this._viewZoom||n!==this._viewAngle){this._viewX=t;this._viewY=r;this._viewZoom=i;this._viewAngle=n;this._viewAngleCos=Math.cos(n);this._viewAngleSin=Math.sin(n);return true}return false};Zn.prototype._compareCurrentTime=function e(t){if(t!==this._currentTime){this._currentTime=t;return true}return false};Zn.prototype._compareBackgroundColor=function e(t,r){if(t!==this._backgroundColor||r!==this._renderBackground){this._renderBackground=r;this._backgroundColor=t;this._backgroundRgba=this._colorManager.parseColor(this._backgroundColor);return true}return false};Zn.prototype._compareShapes=function e(){if(this._shapesVersion!==this._shapeManager.getVersion()){this._shapesVersion=this._shapeManager.getVersion();return true}return false};Zn.prototype._comparePatterns=function e(){if(this._patternsVersion!==this._patternManager.getVersion()){this._patternsVersion=this._patternManager.getVersion();return true}return false};Zn.prototype._compareBoundaries=function e(){if(this._boundariesVersion!==this._boundariesManager.getVersion()){this._boundariesVersion=this._boundariesManager.getVersion();return true}return false};Zn.prototype._compareTexts=function e(){if(this._textsVersion!==this._textManager.getVersion()){this._textsVersion=this._textManager.getVersion();return true}return false};Zn.prototype._compareIsDisplayableBuffer=function e(t){if(this._isBufferDisplayable!==t){this._isBufferDisplayable=t;return true}return false};Zn.prototype._compareHideImages=function e(t){if(this._hideImages!==t){this._hideImages=t;return true}return false};Zn.prototype.renderFrame=function e(t){var r=t.x;var i=t.y;var n=t.zoom;var a=t.angle;var o=t.width;var s=t.height;var u=t.pixelRatio;var l=t.backgroundColor;var d=t.currentTime;var h=t.isBufferDisplayable;var f=t.hideImages;var c=t.renderBackground;var v=this._compareShapes();var p=this._comparePatterns();var g=this._compareBoundaries();var _=this._compareTexts();var m=this._compareDimensions(o,s,u);var y=this._compareView(r,i,n,a);var b=this._compareCurrentTime(d);var x=this._compareBackgroundColor(l,c);var A=this._compareIsDisplayableBuffer(h);var E=this._compareHideImages(f);if(g){var S=this._boundariesManager;this._bytesToActualCoord=1;this._bytesToActualScaledSize=S.maxScaledSize/fn;this._bytesToActualMinVisibleSize=S.maxMinVisibleSize/cn;this._bytesToActualSymbolicSize=S.maxSymbolicSize/dn;this._bytesToActualDashLength=S.maxDashLength/vn;this._bytesToActualGapLength=S.maxGapLength/vn;this._bytesToActualPatternScale=S.maxPatternScale/dn}if(this._firstFrame){this._beforeFirstFrame()}this._render({shapesChanged:v,patternsChanged:p,boundariesChanged:g,textsChanged:_,dimensionsChanged:m,viewChanged:y,currentTimeChanged:b,backgroundColorChanged:x,isBufferDisplayableChanged:A,isHideImagesChanged:E});if(this._firstFrame){this._afterFirstFrame();this._firstFrame=false}};Zn.prototype._render=function e(){};Zn.prototype._beforeFirstFrame=function e(){};Zn.prototype._afterFirstFrame=function e(){};Zn.prototype.destroy=function e(){};Zn.prototype.ensureAnimationsReady=function e(){};Zn.prototype.getImageData=function e(){return null};function Kn(value,e,t){return value%(1<<t)>>e}var Qn="#define D3D9_FIX 0\n#define ANIMATED 0\nprecision highp float;\nprecision mediump int;\nattribute /*ushort*/ vec4 a_final_shapeInfo_miscInfo_opacityAndAllMinVisibleSizes_symbolicSizeAndCurvature;\nattribute /*ushort*/ vec4 a_final_patternId_fillRGBA_strokeRGBA_patternRGBA;\nattribute /*float*/ vec4 a_final_x1_y1_x2_y2;\nattribute /*ushort*/ vec4 a_final_rectWidthOrSourceRadiusScaled_rectWidthOrSourceRadiusFixed_rectHeightOrTargetRadiusScaled_rectHeightOrTargetRadiusFixed;\nattribute /*ushort*/ vec4 a_final_thicknessOrFontSizeScaled_thicknessOrFontSizeFixed_strokeWidthScaled_strokeWidthFixed;\nattribute /*ushort*/ vec2 a_final_offsetScaled_offsetFixed;\nattribute /*ushort*/ vec4 a_prev_shapeInfo_miscInfo_opacityAndAllMinVisibleSizes_symbolicSizeAndCurvature;\nattribute /*ushort*/ vec4 a_prev_patternId_fillRGBA_strokeRGBA_patternRGBA;\nattribute /*float*/ vec4 a_prev_x1_y1_x2_y2;\nattribute /*ushort*/ vec4 a_prev_rectWidthOrSourceRadiusScaled_rectWidthOrSourceRadiusFixed_rectHeightOrTargetRadiusScaled_rectHeightOrTargetRadiusFixed;\nattribute /*ushort*/ vec4 a_prev_thicknessOrFontSizeScaled_thicknessOrFontSizeFixed_strokeWidthScaled_strokeWidthFixed;\nattribute /*ushort*/ vec2 a_prev_offsetScaled_offsetFixed;\nattribute /*float*/ vec2 a_animationBeginTime_animationDuration; \nattribute /*ushort*/ vec4 a_animationEasing; \nattribute /*ushort*/ vec2 a_text_charId_charOffsetXY; \nattribute vec3 a_vertexInfo;\nuniform float u_viewWidth;\nuniform float u_viewHeight;\nuniform float u_viewX;\nuniform float u_viewY;\nuniform float u_viewAngle;\nuniform float u_viewZoom;\nuniform float u_currentTime;\nuniform float u_pixelRatio;\nuniform sampler2D u_patternInfoTexture;\nvarying vec4 a;\nvarying vec4 b;\nvarying vec4 c;\nvarying vec2 d;\nvarying vec2 e;\n#if D3D9_FIX\nvarying vec4 f;\nvarying vec3 g;\nvarying vec4 h;\nvarying vec4 i;\n#else\nvarying float j;\nvarying vec2 k;\nvarying vec2 l;\nvarying vec2 m;\nvarying float n;\nvarying float o;\nvarying vec2 p;\nvarying vec2 q;\nvarying float r;\nvarying float s;\n#endif\nconst float EPSILON = 0.000001;\nconst float INFINITY = 10000000.0;\nconst float PI = 3.14159265359;\nconst float P2_12 = 4096.0;\nconst float P2_8 = 256.0;\nconst float P2_7 = 128.0;\nconst float P2_6 = 64.0;\nconst float P2_5 = 32.0;\nconst float P2_4 = 16.0;\nconst float P2_3 = 8.0;\nconst float P2_2 = 4.0;\nconst float P2_1 = 2.0;\nuniform float BYTES_TO_COORD;\nuniform float BYTES_TO_SCALED_SIZE;\nuniform float BYTES_TO_MIN_VISIBLE_SIZE;\nuniform float BYTES_TO_SYMBOLIC_SIZE;\nuniform float BYTES_TO_CURVATURE;\nuniform float BYTES_TO_DASH_LENGTH;\nuniform float BYTES_TO_GAP_LENGTH;\nuniform float BYTES_TO_PATTERN_SCALE;\nuniform float PATTERN_POSITION_GRANULARITY;\nuniform float PATTERN_INFO_TEXTURE_SIZE;\nuniform float PATTERN_NEAREST_TEXTURE_SIZE;\nuniform float PATTERN_LINEAR_TEXTURE_SIZE;\nuniform float PATTERN_LINEAR_SDF_TEXTURE_SIZE;\nuniform float PATTERN_MIPMAP_TEXTURE_SIZE;\nconst float BYTES_TO_OFFSET_ANGLE = 0.0;\nconst float BYTES_TO_COLOR = 0.0;\nconst float SDF_FONT_SIZE = 0.0;\nconst float CURVATURE_RATIO = 0.0;\nconst float PATTERN_MARGIN = 0.0;\nconst float TEXT_WIDTH_MULTIPLIER = 0.0;\nconst float TEXT_HEIGHT_MULTIPLIER = 0.0;\nconst float SELF_LOOP_CURVATURE_MULTIPLIER = 0.0;\nconst float EDGE_ARROW_SIZE_RATIO = 0.0;\nconst float NB_PIECES_PER_CURVE = 0.0;\nconst float PIECE_NODE_COMPONENT = 0.0;\nconst float PIECE_EDGE_BODY = 0.0;\nconst float PIECE_EDGE_HEAD = 0.0;\nconst float PIECE_EDGE_TAIL = 0.0;\nconst float PIECE_EDGE_TEXT = 0.0;\nconst float MAX_TEXT_SIZE = 0.0;\nconst float BYTES_TO_TEXT_OFFSET = 0.0;\nconst float FILTER_NEAREST = 0.0;\nconst float FILTER_LINEAR = 0.0;\nconst float FILTER_LINEAR_SDF = 0.0;\nconst float FILTER_MIPMAP = 0.0;\nconst float SHAPE_TEXTURE_SIZE = 0.0;\nconst float SIMPLE_SHAPE_SAMPLING_SIZE = 0.0;\nconst float COMPLEX_SHAPE_SAMPLING_SIZE = 0.0;\nconst float SHAPE_SAMPLING_BUFFER_RATIO = 0.0;\nconst float MAX_NB_SHAPES = 0.0;\nconst float FIRST_COMPLEX_SHAPE_ID = 0.0;\nconst float SELF_LOOP_TO_CIRCLE_APPROX = 0.0;\nconst float NB_SHAPES_BY_SIDE = SHAPE_TEXTURE_SIZE / COMPLEX_SHAPE_SAMPLING_SIZE;\nconst float SHAPE_FILL_PERCENT = 1.0 - SHAPE_SAMPLING_BUFFER_RATIO;\nconst float T_STEP_PER_CURVE_PIECE = 1.0 / NB_PIECES_PER_CURVE;\nconst float HEAD_TAIL_PX_ADJUST = 1.5;\nstruct ne {\nfloat nf;\nfloat ng;\nfloat nh;\nfloat ni;\nfloat nj;\nfloat nk;\nfloat nl;\nfloat nm;\n};\nstruct nn {\nfloat no;\nfloat np;\nfloat nq;\nfloat nr;\nfloat ns;\nfloat nt;\nfloat nu;\n};\nstruct nv {\nfloat nf;\nfloat ng;\nfloat nh;\nfloat ni;\nfloat nj;\nfloat nk;\nfloat nl;\nfloat nm;\nfloat no;\nfloat np;\nfloat nq;\nfloat nr;\nfloat ns;\nfloat nt;\nfloat nu;\nfloat bu;\nfloat nw;\nfloat nx;\nfloat ny;\nfloat nz;\nfloat oa;\nfloat ob;\nvec4 az;\nvec4 ba;\nvec4 bl;\nfloat oc;\nfloat od;\nfloat oe;\nfloat of;\nfloat og;\nfloat oh;\nfloat oi;\nfloat oj;\nfloat ok;\nfloat ol;\nfloat om;\nfloat on;\nfloat oo;\nfloat op;\nfloat oq;\nfloat or;\nfloat os;\n};\nstruct ot {\nfloat ou;\nvec2 ov;\nvec4 az;\nvec4 ba;\nfloat bu;\nfloat ow;\nfloat ox;\nfloat nh;\nfloat oy;\nvec2 oz;\nfloat pa;\nvec2 bb;\nvec2 pb;\nvec2 pc;\nfloat pd;\nfloat pe;\nvec4 bl;\nvec2 pf;\nfloat pg;\nfloat ph;\nvec2 pi;\nvec2 pj;\nvec2 pk;\n};\nfloat pl(float lh, float pm, float pn) {\nfloat po = mod(lh, pow(2.0, pn));\nreturn floor(po / pow(2.0, pm));\n}\nne pp(float lh) {\nne pq;\npq.nf = pl(lh, 0.0, 4.0);\npq.ng = pl(lh, 4.0, 8.0);\npq.nh = pl(lh, 8.0, 10.0);\npq.ni = pl(lh, 10.0, 12.0);\npq.nj = pl(lh, 12.0, 13.0);\npq.nk = pl(lh, 13.0, 14.0);\npq.nl = pl(lh, 14.0, 15.0);\npq.nm = pl(lh, 15.0, 16.0);\nreturn pq;\n}\nnn pr(float lh) {\nnn pq;\npq.no = pl(lh, 0.0, 8.0);\npq.np = pl(lh, 8.0, 11.0);\npq.nq = pl(lh, 11.0, 12.0);\npq.nr = pl(lh, 12.0, 13.0);\npq.ns = pl(lh, 13.0, 14.0);\npq.nt = pl(lh, 14.0, 15.0);\npq.nu = pl(lh, 15.0, 16.0);\nreturn pq;\n}\nvec4 ps(in float lh) {\nreturn vec4(\npl(lh, 0.0, 4.0),\npl(lh, 4.0, 8.0),\npl(lh, 8.0, 12.0),\npl(lh, 12.0, 16.0)\n);\n}\nvec2 pt(in float lh) {\nreturn vec2(mod(lh, 256.0), floor(lh / 256.0));\n}\nvec2 pu(in float lh) {\nfloat pv = floor(lh / P2_6);\nfloat pw = lh - (pv * P2_6);\nreturn vec2(pv, pw);\n}\nvec2 px(in float lh) {\nfloat py = floor(lh / P2_7);\nfloat pz = lh - (py * P2_7);\nreturn vec2(py, pz);\n}\nvec2 qa(in vec2 qb, in float qc) {\nfloat qd = cos(qc);\nfloat qe = sin(qc);\nreturn vec2(qd * qb.x + qe * qb.y, -qe * qb.x + qd * qb.y);\n}\nvec4 qf(in vec4 qg) {\nreturn floor(qg / 256.0) - 128.0;\n}\nvec4 qh(in vec4 qg) {\nreturn mod(qg, 256.0) - 128.0;\n}\nfloat qi(float lh) {\nreturn lh - 128.0;\n}\nvec2 qi(vec2 lh) {\nreturn lh - 128.0;\n}\nvec2 qj(vec2 qk) {\nreturn vec2(-qk.y, qk.x);\n}\nvec2 ql(vec2 qm, vec2 fn, vec2 qn, float t) {\nfloat qo = 1.0 - t;\nreturn (qo * qo * qm) + (2.0 * qo * t * fn) + (t * t * qn);\n}\nvec2 qp(vec2 qm, vec2 qq, vec2 qr, vec2 qn, float t) {\nfloat qo = 1.0 - t;\nfloat qs = qo * qo;\nfloat qt = qs * qo;\nfloat qu = t * t;\nfloat qv = qu * t;\nreturn (qt * qm) + (3.0 * qs * t * qq) + (3.0 * qo * qu * qr) + (qv * qn);\n}\nvec2 qw(vec2 qm, vec2 fn, vec2 qn, float t) {\nfloat qo = (1.0 - t);\nvec2 qb = (qo * fn + t * qn) - (qo * qm + t * fn);\nreturn normalize(qb);\n}\nvec2 qx(vec2 qm, vec2 fn, vec2 qn, float t) {\nreturn qj(qw(qm, fn, qn, t));\n}\nvec2 qy(vec2 qm, vec2 qq, vec2 qr, vec2 qn, float t) {\nfloat qo = 1.0 - t;\nfloat qs = qo * qo;\nfloat qu = t * t;\nvec2 qb = qs * (qq - qm) + 2.0 * qo * t * (qr - qq) + qu * (qn - qr);\nreturn normalize(qb);\n}\nvec2 qz(vec2 qm, vec2 qq, vec2 qr, vec2 qn, float t) {\nreturn qj(qy(qm, qq, qr, qn, t));\n}\nfloat rk(float oa, float rl, float t) {\nfloat y = abs(oa) / CURVATURE_RATIO + EPSILON;\nfloat of = y * y;\nfloat qo = t - 0.5;\nfloat qs = qo * qo;\nfloat rm = 1.0 / (16.0 * of);\nfloat rn = sqrt(qs + rm);\nfloat ro = (0.5 / y) * sqrt(of + 0.25);\nfloat rp = (abs(2.0 * y)) * ((qo * rn) + (0.5 * ro) + (rm * log(abs((qo + rn) / (-0.5 + ro)))));\nreturn rp * rl;\n}\nfloat rq(vec2 qm, vec2 rr, vec2 rs, vec2 qn, float rt) {\nvec2 pf = (qm + rr + rs) / 3.0;\nvec2 ru = pf - rr;\nvec2 rv = rr - rs;\nfloat rw = dot(ru, ru);\nfloat rx = dot(rv, rv) / 4.0;\nfloat sf = sqrt(rw - rx) * SELF_LOOP_TO_CIRCLE_APPROX * 1.55;\nreturn 2.0 * PI * sf * rt;\n}\nfloat sg(float lh) {\nreturn lh - 32.0;\n}\nfloat sh(float lh) {\nreturn lh - 512.0;\n}\nfloat si(float lh) {\nreturn lh - 32768.0;\n}\nvoid sj() {\ngl_Position = vec4(-10.0, -10.0, 1.0, 1.0);\n}\nvec4 sk(vec2 sl) {\nreturn vec4(((vec2(sl.x, u_viewHeight - sl.y) / vec2(u_viewWidth, u_viewHeight)) * 2.0 - 1.0), 0.5, 1.0);\n}\nfloat sp(float ap, float aq) {\nreturn step(ap - EPSILON, aq) * step(aq, ap + EPSILON);\n}\nbool ao(float ap, float aq) {\nreturn abs(ap - aq) < EPSILON;\n}\nbool sq(float lh) {\nreturn lh > 0.5;\n}\nvec2 sr(vec2 ss) {\nreturn qa((ss - vec2(u_viewX, u_viewY)) * u_viewZoom, u_viewAngle) + vec2(u_viewWidth, u_viewHeight) / 2.0;\n}\nfloat st(float ph) {\nreturn ph * EDGE_ARROW_SIZE_RATIO;\n}\nfloat su(float sv, float sw) {\nreturn sv * BYTES_TO_SCALED_SIZE * u_viewZoom + sw;\n}\nfloat tc(float ow, float ta, float tb) {\nfloat td = tb - ta;\nfloat a = 1.0 / td;\nfloat b = -ta / td;\nreturn ow * a + b;\n}\nstruct te {\nvec2 tf;\nvec2 tg;\n};\nte th(vec2 ti, float sf, float oa) {\nte lj;\nfloat tj = (sf + sf / SELF_LOOP_CURVATURE_MULTIPLIER * oa) * SELF_LOOP_CURVATURE_MULTIPLIER;\nfloat tk = -u_viewAngle + PI;\nfloat tl = -u_viewAngle + PI / 2.0;\nlj.tf = ti + vec2(cos(tk), sin(tk)) * tj;\nlj.tg = ti + vec2(cos(tl), sin(tl)) * tj;\nreturn lj;\n}\nfloat tq(vec2 tr, vec2 rr, vec2 rs, vec2 ts, float tt) {\nvec2 tu = tr;\nfloat t = 0.0;\nfloat tv = 0.0;\nfloat tw = rq(tr, rr, rs, ts, 1.0);\nreturn tt / tw;\n}\nnv tx(\nvec4 ty,\nvec4 tz,\nvec4 ua,\nvec4 ub,\nvec4 uc,\nvec2 ud,\nvec2 ue\n) {\nnv a;\nne av = pp(ty.x);\nnn uf = pr(ty.y);\nvec4 ug = ps(ty.z);\nvec2 uh = pt(ty.w);\nvec2 ui = pu(ue.y);\na.nf = av.nf;\na.ng = av.ng;\na.nh = av.nh;\na.ni = av.ni;\na.nj = av.nj;\na.nk = av.nk;\na.nl = av.nl;\na.nm = av.nm;\na.no = uf.no;\na.np = uf.np;\na.nq = uf.nq;\na.nr = uf.nr;\na.ns = uf.ns;\na.nt = uf.nt;\na.nu = uf.nu;\na.bu = ug.x;\na.nw = ug.y;\na.nx = ug.z;\na.ny = ug.w;\na.nz = uh.x;\na.oa = uh.y;\na.ob = tz.x;\na.az = ps(tz.y);\na.ba = ps(tz.z);\na.bl = ps(tz.w);\na.oc = ua.x;\na.od = ua.y;\na.oe = ua.z;\na.of = ua.w;\na.og = ub.x;\na.oh = ub.y;\na.oi = ub.z;\na.oj = ub.w;\na.ok = uc.x;\na.ol = uc.y;\na.om = uc.z;\na.on = uc.w;\na.oo = ud.x;\na.op = ud.y;\na.oq = ue.x;\na.or = sh(ui.x);\na.os = sg(ui.y);\nreturn a;\n}\nbool uu(const in nv a, out ot lj) {\nfloat nf = a.nf;\nfloat ng = a.ng;\nfloat nh = a.nh * BYTES_TO_DASH_LENGTH;\nfloat ni = a.ni * BYTES_TO_GAP_LENGTH;\nfloat nj = a.nj;\nfloat nk = a.nk;\nfloat nl = a.nl;\nfloat nm = a.nm;\nfloat no = a.no * BYTES_TO_PATTERN_SCALE;\nfloat np = a.np * BYTES_TO_OFFSET_ANGLE;\nfloat nq = a.nq;\nfloat nr = a.nr;\nfloat ns = a.ns;\nfloat nt = a.nt;\nfloat nu = a.nu;\nfloat bu = a.bu * BYTES_TO_COLOR;\nfloat nw = a.nw * BYTES_TO_MIN_VISIBLE_SIZE - EPSILON;\nfloat nx = a.nx * BYTES_TO_MIN_VISIBLE_SIZE - EPSILON;\nfloat ny = a.ny * BYTES_TO_MIN_VISIBLE_SIZE - EPSILON;\nfloat nz = a.nz * BYTES_TO_SYMBOLIC_SIZE * u_viewZoom + step(a.nz, EPSILON) * INFINITY;\nfloat oa = qi(a.oa);\nfloat ob = a.ob;\nvec4 az = a.az * BYTES_TO_COLOR;\nvec4 ba = a.ba * BYTES_TO_COLOR;\nvec4 bl = a.bl * BYTES_TO_COLOR;\nvec2 uv = vec2(a.oc, a.od) * BYTES_TO_COORD;\nvec2 uw = vec2(a.oe, a.of) * BYTES_TO_COORD;\nvec2 tr = sr(uv);\nvec2 ts = sr(uw);\nfloat ux = su(a.og, a.oh);\nfloat uy = su(a.oi, a.oj);\nfloat uz = su(a.ok, a.ol);\nfloat ou = su(a.om, a.on);\nfloat va = su(a.oo, a.op);\nvec2 vb = a_vertexInfo.xy;\nvec2 vc = vec2(0.0, 0.0);\nfloat vd = ux;\nfloat ve = uy;\nfloat vf = uy * no;\nif (nq > EPSILON) {\nif (a.oq < EPSILON) {\nreturn false;\n}\nvf = uz;\nob = a.oq;\nux = vf * TEXT_WIDTH_MULTIPLIER * u_pixelRatio;\nuy = vf * TEXT_HEIGHT_MULTIPLIER * u_pixelRatio;\n}\nbool vz = abs(oa) > EPSILON && sp(ng, PIECE_EDGE_BODY) < EPSILON;\nbool wa = vz && a_vertexInfo.z > EPSILON;\nif (nf < EPSILON || ng < EPSILON || nz < nw || wa) {\nreturn false;\n}\nou *= step(nx, nz);\nfloat wo = 0.0;\nfloat wp = 1.0;\nfloat wl = 0.0;\nfloat wn = 1.0;\nfloat wq = 0.0;\nfloat xa = 1.0;\nfloat xc = 1.0;\nfloat xn = 0.0;\nfloat xo = 0.0;\nvec2 pf;\nvec2 pi;\nvec2 pj;\nvec2 pk;\nfloat ph;\nfloat pg;\nfloat yh = 0.0;\nfloat yi = 1.0;\nif (sp(ng, PIECE_NODE_COMPONENT) > EPSILON) {\npf = ceil((tr + ts) / 2.0);\npi = normalize(vec2(uw.x - uv.x + 0.001, uv.y - uw.y));\npj = qj(pi);\npk = pj;\nph = ux;\npg = uy;\n} else {\nxc = 0.0;\nfloat yy = distance(tr, ts);\nvec2 yz = normalize(ts - tr);\nvec2 za = (tr + ts) / 2.0;\nvec2 zb = qj(yz);\nvec2 zc = za + (zb * yy * -oa / CURVATURE_RATIO);\nif (sp(ng, PIECE_EDGE_TEXT) > 0.0) {\nfloat zd;\nfloat ze = ou;\nou = 0.0;\nif (nm > EPSILON) {\nte fn = th(tr, ze / 2.0, oa);\npf = qp(tr, fn.tf, fn.tg, ts, 0.5);\npi = qy(tr, fn.tf, fn.tg, ts, 0.5);\npj = qj(pi);\npk = pj;\nzd = rq(tr, fn.tf, fn.tg, ts, 0.5);\n} else if (abs(oa) > EPSILON) {\npf = ql(tr, zc, ts, 0.5);\npi = qw(tr, zc, ts, 0.5);\npj = qj(pi);\npk = pj;\nzd = rk(oa, yy, 1.0);\n} else {\npf = za;\npi = yz;\npj = zb;\npk = zb;\nzd = yy;\n}\nph = ux;\npg = uy;\nif (nr > EPSILON && nm < EPSILON && vd > zd - ze) {\npi = vec2(1.0, 0.0);\npj = vec2(0.0, 1.0);\npk = vec2(0.0, 1.0);\n} else {\nfloat qc = -atan(pi.y, pi.x);\nyh = qc;\nnp -= qc;\nif ((qc > PI / 2.0 || qc < -PI / 2.0)) {\nnp += (1.0 - nm) * PI;\nyi = -1.0;\npi *= -1.0;\npj *= -1.0;\npk *= -1.0;\n}\n}\n} else {\nfloat xg = uz;\nfloat zm = ux;\nfloat zn = uy;\nfloat zo = nj + nk;\nfloat zp = st(xg);\nfloat zq = nj * zp;\nfloat zr = nk * zp;\nfloat zs = sp(ng, PIECE_EDGE_HEAD);\nfloat zt = sp(ng, PIECE_EDGE_TAIL);\nfloat zu = INFINITY * nm + yy - zm - zn;\nfloat zv = min(zu / zo, zp);\nfloat aae =\nnk * (zp + max(zm + zv - zr, 0.0))\n+ (1.0 - nk) * nl * zm;\nfloat aaf =\nnj * (zp + max(zn + zv - zq, 0.0))\n+ (1.0 - nj) * nl * zn;\nif (zs > EPSILON || zt > EPSILON) {\nvec2 aai = zs * ts + zt * tr;\nfloat va = zs * aaf + zt * aae + (HEAD_TAIL_PX_ADJUST - 0.5);\nfloat aaj = zs * zq + zt * zr;\nvec2 aak;\nif (nm > EPSILON) {\nte fn = th(tr, zm, oa);\nfloat zd = rq(tr, fn.tf, fn.tg, ts, 1.0);\nfloat tt = zs * (zd - aaf) + zt * aae;\nfloat t = tq(tr, fn.tf, fn.tg, ts, tt);\naak = qp(tr, fn.tf, fn.tg, ts, t);\n} else {\nfloat zd = rk(oa, yy, 1.0);\nfloat t = (zs * (zd - aaf) + zt * aae) / zd;\naak = ql(tr, zc, ts, t);\n}\npi = normalize(aai - aak);\npj = qj(pi);\npk = pj;\npf = aai - pi * (va - aaj / 2.0);\nph = aaj;\npg = aaj;\nnh = 0.0;\nni = 0.0;\n} else {\nfloat aao;\nfloat aap;\nfloat aaq;\nif (abs(oa) < EPSILON) {\npf = za;\npi = yz;\npj = zb;\npk = pj;\nph = yy;\naao = yy;\naap = 0.0;\naaq = yy;\n} else {\nfloat aas = a_vertexInfo.z;\nfloat aat = aas * T_STEP_PER_CURVE_PIECE;\nfloat qu = aat + T_STEP_PER_CURVE_PIECE;\nif (nm < EPSILON) {\nvec2 aau = ql(tr, zc, ts, aat);\nvec2 aav = ql(tr, zc, ts, qu);\npf = (aau + aav) / 2.0;\npi = normalize(aav - aau);\npj = qx(tr, zc, ts, aat);\npk = qx(tr, zc, ts, qu);\nph = distance(aau, aav);\naao = rk(oa, yy, 1.0);\naap = rk(oa, yy, aat);\naaq = rk(oa, yy, qu);\n} else {\nte fn = th(tr, zm, oa);\nvec2 rr = fn.tf;\nvec2 rs = fn.tg;\nvec2 aau = qp(tr, rr, rs, ts, aat);\nvec2 aav = qp(tr, rr, rs, ts, qu);\npf = (aau + aav) / 2.0;\npi = normalize(aav - aau);\npj = qz(tr, rr, rs, ts, aat);\npk = qz(tr, rr, rs, ts, qu);\nph = distance(aau, aav);\naao = rq(tr, rr, rs, ts, 1.0);\naap = rq(tr, rr, rs, ts, aat);\naaq = rq(tr, rr, rs, ts, qu);\n}\n}\npg = uz;\nwl = (aae - 1.0) / aao;\nwn = 1.0 - (aaf - HEAD_TAIL_PX_ADJUST) / aao;\nwo = aap / aao;\nwp = aaq / aao;\nwq = aao;\nif (nl > 0.0 && zu > 5.0) {\nfloat abb = (aao * pg) / (aao - aae);\nfloat tw = aao;\nfloat oc = aae;\nfloat oe = aao - aaf;\nfloat a = -abb / tw;\nfloat b = abb;\nfloat od = a * oc + b;\nfloat of = a * oe + b;\nfloat abc = od / (oc - oe);\nfloat abd = -abc * oe;\npg = abd;\nxo = abc * tw + abd + 1.0;\n}\n}\n}\n}\nvec2 bb = vec2(0.0, 0.0);\nvec2 pb = vec2(EPSILON, EPSILON);\nvec2 pc = vec2(-EPSILON, -EPSILON);\nfloat pd = -1.0;\nfloat pe = 0.0;\nbool abe = false;\nif (ob > EPSILON && nz > ny) {\nfloat abf = floor(ob / PATTERN_INFO_TEXTURE_SIZE);\nfloat abg = ob - (abf * PATTERN_INFO_TEXTURE_SIZE);\nvec4 abh = texture2D(u_patternInfoTexture, vec2(abg, abf) / 255.0) * 255.0;\nvec2 abi = px(abh.z);\nvec2 abj = px(abh.w);\npd = abi.x * 2.0 + abj.x;\nfloat abk = 0.0;\nif (ao(pd, FILTER_NEAREST)) {\nabk = PATTERN_NEAREST_TEXTURE_SIZE;\n} else if (ao(pd, FILTER_LINEAR)) {\nabk = PATTERN_LINEAR_TEXTURE_SIZE;\n} else if (ao(pd, FILTER_LINEAR_SDF)) {\nabk = PATTERN_LINEAR_SDF_TEXTURE_SIZE;\nabe = true;\n} else if (ao(pd, FILTER_MIPMAP)) {\nabk = PATTERN_MIPMAP_TEXTURE_SIZE;\n}\nfloat abl = 1.0 / abk;\nvec2 abm = (vec2(abi.y, abj.y) * PATTERN_POSITION_GRANULARITY) * abl / 2.0;\nvec2 abn = (abh.xy * PATTERN_POSITION_GRANULARITY * abl) + abm;\nabn += PATTERN_MARGIN * abl;\nabm -= PATTERN_MARGIN * abl * 2.0;\nvec2 abo = vec2(ph / 2.0, pg / 2.0) * abl;\nvec2 abp = vec2(ou, ou) * abl;\nfloat abq = 1.0 * u_pixelRatio;\nif (no > EPSILON) {\nif (abe) {\npe = 2.0 / vf;\nabq = SDF_FONT_SIZE / vf;\n} else {\nabq = (abm.y / abo.y) / no;\n}\n}\nvec2 abr = (abo + abp) * abq;\nabm += PATTERN_MARGIN * abl;\nbb = abn + abr * vb;\npb = abn - abm;\npc = abn + abm;\n}\nif (nq > EPSILON) {\nvc.y = a.os * vf / 2.0 - 1.0;\nxa = 0.0;\nxc = 0.0;\nif (abe) {\nvc.x = ceil(a.or * BYTES_TO_TEXT_OFFSET * vf);\n} else {\nvc.x = floor(a.or);\n}\nvc += vec2(1.0, 1.0);\nvc = qa(vc, yh);\nvc *= yi;\n}\nvec2 abu = vec2(cos(np), sin(np)) * va;\nvec2 abv = pf + abu + vc;\nif (nq > EPSILON && sp(ng, PIECE_NODE_COMPONENT) > EPSILON) {\nabv = ceil(abv);\n}\nfloat abw = ou * 2.0;\nfloat abx = ph + xc * (abw + 1.0);\nfloat aby = pg + xa * (abw + 1.0);\nvec2 abz = pi * abx / 2.0;\nvec2 aca = pj * aby / 2.0;\nvec2 acb = pk * aby / 2.0;\nfloat acc = (wp - wo);\nfloat acd = vb.x / 2.0 + 0.5;\nfloat ow = wo + acc * acd;\nfloat pa = xn + (xo - xn) * ow / 2.0;\nfloat ace = step(nf, FIRST_COMPLEX_SHAPE_ID - EPSILON);\nfloat acf = ace * SIMPLE_SHAPE_SAMPLING_SIZE + (1.0 - ace) * COMPLEX_SHAPE_SAMPLING_SIZE;\nfloat acg = acf / COMPLEX_SHAPE_SAMPLING_SIZE;\nfloat ach = acg * SHAPE_SAMPLING_BUFFER_RATIO / 2.0;\nfloat aci = acg * (1.0 - SHAPE_SAMPLING_BUFFER_RATIO);\nvec2 acr = vec2(mod(nf, NB_SHAPES_BY_SIDE), floor(nf / NB_SHAPES_BY_SIDE));\nvec2 acs = acr + vec2(ach) + vec2(wo * aci, 0.0);\nvec2 acv = vec2(acc, 1.0) * aci;\nvec2 ov = (acs + acv * (vb / 2.0 + 0.5)) / NB_SHAPES_BY_SIDE;\nvec2 oz = vec2(abx / acc, aby) / 2.0;\nfloat adc = nh * uz;\nfloat add = ni * uz;\nfloat ox = adc + add;\nfloat oy = (ow * wq) / ox;\nlj.ov = ov;\nlj.oz = oz;\nlj.ou = ou;\nlj.az = az;\nlj.ba = ba;\nlj.bu = bu;\nlj.ow = tc(ow, wl, wn);\nlj.ox = ox;\nlj.nh = adc;\nlj.oy = oy;\nlj.pa = pa;\nlj.bb = bb;\nlj.pb = pb;\nlj.pc = pc;\nlj.pd = pd;\nlj.pe = pe;\nlj.bl = bl;\nlj.pf = abv;\nlj.ph = abx;\nlj.pg = aby;\nlj.pi = pi;\nlj.pj = pj;\nlj.pk = pk;\nreturn true;\n}\nfloat ade(float adf, float adg, vec4 adh) {\nfloat adi = clamp(((u_currentTime - adf) / adg), 0.0, 1.0);\nfloat r = adi;\nfloat adj = r * r;\nfloat adk = adj * r;\nvec4 adl = adi < 0.5 ? qf(adh) : qh(adh);\nfloat adm = adl.x;\nfloat adn = adl.y;\nfloat ado = adl.z;\nfloat adp = adl.w;\nfloat adq = adm + adn * r + ado * adj + adp * adk;\nreturn adq;\n}\nvoid main() {\nnv a_final = tx(\na_final_shapeInfo_miscInfo_opacityAndAllMinVisibleSizes_symbolicSizeAndCurvature,\na_final_patternId_fillRGBA_strokeRGBA_patternRGBA,\na_final_x1_y1_x2_y2,\na_final_rectWidthOrSourceRadiusScaled_rectWidthOrSourceRadiusFixed_rectHeightOrTargetRadiusScaled_rectHeightOrTargetRadiusFixed,\na_final_thicknessOrFontSizeScaled_thicknessOrFontSizeFixed_strokeWidthScaled_strokeWidthFixed,\na_final_offsetScaled_offsetFixed,\na_text_charId_charOffsetXY\n);\n#if ANIMATED\nfloat adf = a_animationBeginTime_animationDuration.x;\nfloat adg = a_animationBeginTime_animationDuration.y;\nvec4 adh = a_animationEasing;\nfloat ut = ade(adf, adg, adh);\nnv a_prev = tx(\na_prev_shapeInfo_miscInfo_opacityAndAllMinVisibleSizes_symbolicSizeAndCurvature,\na_prev_patternId_fillRGBA_strokeRGBA_patternRGBA,\na_prev_x1_y1_x2_y2,\na_prev_rectWidthOrSourceRadiusScaled_rectWidthOrSourceRadiusFixed_rectHeightOrTargetRadiusScaled_rectHeightOrTargetRadiusFixed,\na_prev_thicknessOrFontSizeScaled_thicknessOrFontSizeFixed_strokeWidthScaled_strokeWidthFixed,\na_prev_offsetScaled_offsetFixed,\na_text_charId_charOffsetXY\n);\nconst float ONE = 1.0;\na_final.nf = mix(a_prev.nf, a_final.nf, ONE);\na_final.nh = mix(a_prev.nh, a_final.nh, ut);\na_final.ni = mix(a_prev.ni, a_final.ni, ut);\na_final.nj = mix(a_prev.nj, a_final.nj, ONE);\na_final.nk = mix(a_prev.nk, a_final.nk, ONE);\na_final.ng = mix(a_prev.ng, a_final.ng, ONE);\na_final.no = mix(a_prev.no, a_final.no, ONE);\na_final.nq = mix(a_prev.nq, a_final.nq, ONE);\na_final.nr = mix(a_prev.nr, a_final.nr, ONE);\na_final.ns = mix(a_prev.ns, a_final.ns, ONE);\na_final.nt = mix(a_prev.nt, a_final.nt, ONE);\na_final.nm = mix(a_prev.nm, a_final.nm, ONE);\na_final.np = mix(a_prev.np, a_final.np, ut);\na_final.bu = mix(a_prev.bu, a_final.bu, ut);\na_final.nw = mix(a_prev.nw, a_final.nw, ut);\na_final.nx = mix(a_prev.nx, a_final.nx, ut);\na_final.ny = mix(a_prev.ny, a_final.ny, ut);\na_final.nz = mix(a_prev.nz, a_final.nz, ut);\na_final.oa = mix(a_prev.oa, a_final.oa, ut);\na_final.ob = mix(a_prev.ob, a_final.ob, ONE);\na_final.az = mix(a_prev.az, a_final.az, ut);\na_final.ba = mix(a_prev.ba, a_final.ba, ut);\na_final.bl = mix(a_prev.bl, a_final.bl, ut);\na_final.oc = mix(a_prev.oc, a_final.oc, ut);\na_final.od = mix(a_prev.od, a_final.od, ut);\na_final.oe = mix(a_prev.oe, a_final.oe, ut);\na_final.of = mix(a_prev.of, a_final.of, ut);\na_final.og = mix(a_prev.og, a_final.og, ut);\na_final.oh = mix(a_prev.oh, a_final.oh, ut);\na_final.oi = mix(a_prev.oi, a_final.oi, ut);\na_final.oj = mix(a_prev.oj, a_final.oj, ut);\na_final.ok = mix(a_prev.ok, a_final.ok, ut);\na_final.ol = mix(a_prev.ol, a_final.ol, ut);\na_final.om = mix(a_prev.om, a_final.om, ut);\na_final.on = mix(a_prev.on, a_final.on, ut);\na_final.oo = mix(a_prev.oo, a_final.oo, ut);\na_final.op = mix(a_prev.op, a_final.op, ut);\na_final.oq = mix(a_prev.oq, a_final.oq, ONE);\na_final.or = mix(a_prev.or, a_final.or, ONE);\na_final.os = mix(a_prev.os, a_final.os, ONE);\n#endif\not lj;\nbool adr = uu(a_final, lj);\nif (!adr) {\nsj();\nreturn;\n}\nvec2 vb = a_vertexInfo.xy;\na = lj.az;\nb = lj.ba;\nc = lj.bl;\nd = lj.ov;\ne = lj.bb;\n#if D3D9_FIX\nf = vec4(lj.pb, lj.pc);\ng = vec3(lj.ou, lj.bu, lj.pa);\nh = vec4(lj.ow, lj.ox, lj.nh, lj.oy);\ni = vec4(lj.oz, lj.pe, lj.pd);\n#else\nj = lj.ou;\nk = lj.pb;\nl = lj.pc;\nm = vec2(lj.bu, lj.pa);\nn = lj.ow;\no = lj.ox;\np = vec2(lj.nh, lj.oy);\nq = lj.oz;\nr = lj.pe;\ns = lj.pd;\n#endif\nfloat ads = step(vb.x, 0.0);\nfloat adt = 1.0 - ads;\nvec2 sl = lj.pf\n+ (lj.pi * (lj.ph / 2.0) * vb.x)\n+ ((ads * lj.pj + adt * lj.pk) * (lj.pg / 2.0) * vb.y);\ngl_Position = sk(sl);\n}\n";var Jn="#define D3D9_FIX 0\nprecision highp float;\nprecision mediump int;\nuniform vec3 u_backgroundColor;\nuniform sampler2D u_patternNearestTexture;\nuniform sampler2D u_patternLinearTexture;\nuniform sampler2D u_patternLinearSdfTexture;\nuniform sampler2D u_patternMipmapTexture;\nuniform sampler2D u_shapeTexture;\nvarying vec4 a;\nvarying vec4 b;\nvarying vec4 c;\nvarying vec2 d;\nvarying vec2 e;\n#if D3D9_FIX\nvarying vec4 f;\nvarying vec3 g;\nvarying vec4 h;\nvarying vec4 i;\n#else\nvarying float j;\nvarying vec2 k;\nvarying vec2 l;\nvarying vec2 m;\nvarying float n;\nvarying float o;\nvarying vec2 p;\nvarying vec2 q;\nvarying float r;\nvarying float s;\n#endif\nconst float FILTER_NEAREST = 0.0;\nconst float FILTER_LINEAR = 0.0;\nconst float FILTER_LINEAR_SDF = 0.0;\nconst float FILTER_MIPMAP = 0.0;\nconst float EPSILON = 0.000000001;\nconst float SDF_BUFFER = (256.0 - 64.0) / 256.0; \nvec4 ad(in vec4 ae, in vec4 af) {\nfloat ag = af.a;\nfloat ah = ae.a + EPSILON;\nfloat ai = min(ag + ah, 1.0);\nfloat r = ag / ai;\nreturn vec4(mix(ae.rgb, af.rgb, r), ai);\n}\nfloat aj(in float ak, in float al) {\nfloat am = (ak * 256.0 + al) * 256.0;\nfloat an = am / 32768.0;\nreturn an * 2.0 - 1.0;\n}\nbool ao(float ap, float aq) {\nreturn abs(ap - aq) < EPSILON;\n}\nvoid main() {\n#if D3D9_FIX\nfloat j = g.x;\nfloat ar = g.y;\nfloat as = g.z;\nvec2 k = f.xy;\nvec2 l = f.zw;\nfloat n = h.x;\nfloat o = h.y;\nfloat at = h.z;\nfloat au = h.w;\nvec2 q = i.xy;\nfloat r = i.z;\nfloat s = i.w;\n#else\nfloat ar = m.x;\nfloat as = m.y;\nfloat at = p.x;\nfloat au = p.y;\n#endif\nvec4 av = texture2D(u_shapeTexture, d);\nfloat aw = aj(av.b, av.a) * q.x;\nfloat ax = aj(av.r, av.g) * q.y;\nax += as;\nfloat ay = min(aw, ax);\nvec4 az = a;\nvec4 ba = b;\nif (s > -EPSILON) {\nvec2 bb = e;\nfloat bj =\nstep(k.x, bb.x) *\nstep(bb.x, l.x) *\nstep(k.y, bb.y) *\nstep(bb.y, l.y);\nfloat bk = bj;\nvec4 bl;\nif (ao(s, FILTER_NEAREST)) {\nbl = texture2D(u_patternNearestTexture, bb);\n} else if (ao(s, FILTER_LINEAR)) {\nbl = texture2D(u_patternLinearTexture, bb);\n} else if (ao(s, FILTER_LINEAR_SDF)) {\nbl = texture2D(u_patternLinearSdfTexture, bb);\nbl.a = smoothstep(SDF_BUFFER - r, SDF_BUFFER + r, bl.a);\n} else if (ao(s, FILTER_MIPMAP)) {\nbl = texture2D(u_patternMipmapTexture, bb);\n}\nbl.rgb += c.rgb;\nbl.a *= bk;\naz = ad(az, bl);\n}\nfloat bm = clamp(ay, 0.0, 1.0);\nfloat bn = clamp(ay - j, 0.0, 1.0);\nfloat bo = bm - bn;\nbo = 1.0 - clamp(ay - j, 0.0, 1.0);\naz.a *= bn;\nba.a *= bo;\nvec4 bp = ad(az, ba);\nfloat bq = bm;\nbp.rgb = mix(u_backgroundColor, bp.rgb, ar);\nif (o > EPSILON) {\nfloat ch = fract(au) * o;\nfloat ci = clamp(min(ch, at - ch), 0.0, 1.0);\nbq *= ci;\n}\nif (n < 0.0 || n > 1.0 || bq < EPSILON) {\ndiscard;\n}\nbp.a *= bq;\nbp.rgb *= bp.a;\ngl_FragColor = bp;\n}\n";var $n=function e(t,r){var i=r.vertex;var n=r.fragment;var a=r.constants;var o=r.macros;this._gl=t;this._vertexSource=i;this._fragmentSource=n;this._constants=O(a||{});this._macros=O(o||{});this._program=null;this._vertexShader=null;this._fragmentShader=null;this._state="init"};$n.prototype.setConstant=function e(t,value){this._constants[t]=value};$n.prototype.setMacro=function e(t,value){this._macros[t]=value};$n.prototype.getState=function e(){return this._state};$n.prototype.getProgram=function e(){return this._program};$n.prototype.compile=function e(){var t=this._gl;var r=ea(this._vertexSource,this._macros,this._constants);var i=ea(this._fragmentSource,this._macros,this._constants);if(this._program){t.deleteProgram(this._program);t.deleteShader(this._vertexShader);t.deleteShader(this._fragmentShader)}this._program=t.createProgram();this._vertexShader=t.createShader(t.VERTEX_SHADER);this._fragmentShader=t.createShader(t.FRAGMENT_SHADER);t.shaderSource(this._vertexShader,r);t.compileShader(this._vertexShader);t.attachShader(this._program,this._vertexShader);t.shaderSource(this._fragmentShader,i);t.compileShader(this._fragmentShader);t.attachShader(this._program,this._fragmentShader);t.linkProgram(this._program);this._state="compiling"};$n.prototype.getError=function e(){var t=this._gl;if(!t.getShaderParameter(this._vertexShader,t.COMPILE_STATUS)){return{step:"vertex",message:t.getShaderInfoLog(this._vertexShader)}}if(!t.getShaderParameter(this._fragmentShader,t.COMPILE_STATUS)){return{step:"fragment",message:t.getShaderInfoLog(this._fragmentShader)}}if(!t.getProgramParameter(this._program,t.LINK_STATUS)){return{step:"link",message:t.getProgramInfoLog(this._program)}}this._state="done";return null};function ea(e,t,r){var i=Object.keys(t);var n=Object.keys(r);for(var a=0;a<i.length;++a){var o=i[a];var s=t[o];e=e.replace("#define "+o+" 0","#define "+o+" "+s)}for(var u=0;u<n.length;++u){var l=n[u];var value=r[l];var d=value+(value%1===0?".0":"");e=e.replace("const float "+l+" = 0.0;","const float "+l+" = "+d+";")}return e}var ta=function(){function e(e,t){this._gl=e;this._glTextureUnit=t;this._simpleShapePixels=new Uint8Array(gn*gn*4);this._complexShapePixels=new Uint8Array(_n*_n*4);this._texture=null;this._shapesWritten=[]}e.prototype.refresh=function(e){var t=e.getShapeList();for(var r=0,i=t;r<i.length;r++){var n=i[r];if(!this._shapesWritten.includes(n.id)){var a=n.isSimple?gn:_n;var o=n.isSimple?this._simpleShapePixels:this._complexShapePixels;ra(n,a,yn,o);this._loadShapeInGpu(n.id,a,o);this._shapesWritten.push(n.id)}}};e.prototype._loadShapeInGpu=function(e,t,r){var i=this._gl;var n=xn;var a=e%bn*_n;var o=Math.floor(e/bn)*_n;if(!this._texture){var s=new Uint8Array(n*n*4);this._texture=i.createTexture();i.activeTexture(i.TEXTURE0+this._glTextureUnit);i.bindTexture(i.TEXTURE_2D,this._texture);i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MAG_FILTER,i.LINEAR);i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,i.LINEAR);i.texImage2D(i.TEXTURE_2D,0,i.RGBA,n,n,0,i.RGBA,i.UNSIGNED_BYTE,s)}else{i.bindTexture(i.TEXTURE_2D,this._texture)}i.texSubImage2D(i.TEXTURE_2D,0,a,o,t,t,i.RGBA,i.UNSIGNED_BYTE,r)};e.prototype.getTextureSize=function(){return xn};e.prototype.getSamplingSize=function(){return _n};e.prototype.getBufferRatio=function(){return yn};e.prototype.getTextureUnit=function(){return this._glTextureUnit};return e}();function ra(e,t,r,i){var n=e.getDistanceFromStrokeVertically,a=e.getDistanceFromStrokeHorizontally;var o=t*(1-r)/2;var s=(t-1)/2;for(var u=0;u<t;++u){for(var l=0;l<t;++l){var d=u;var h=l;var f=(h*t+d)*4;var c=(u-s)/o;var v=(l-s)/o;var p=Jt(n(c,v),-1,1);var g=Jt(a(c,v),-1,1);var _=ia(p);var m=ia(g);na(i,f,_,m)}}}function ia(value){var e=(value+1)/2;return e*32768}function na(e,t,r,i){e[t]=r>>8;e[t+1]=r%256;e[t+2]=i>>8;e[t+3]=i%256}function aa(){var e=he();var t=e.styleSheets;if(!t||!e.location){return Promise.resolve([])}var r=Qe(e);var i=[];var n=[];for(var a=0;a<t.length;a++){var o=t[a];if(o.href===null){i.push({href:r,content:o.ownerNode.textContent})}else{n.push(o.href)}}var s=/@font-face\s*\{[^}]+\}/g;return Promise.all(n.map(function(e){return Ve(e).then(function(t){return{href:e,content:t}}).catch(function(){return null})})).then(function(e){return e.concat(i)}).then(function(e){var t=[];for(var r=0;r<e.length;r++){var i=e[r];if(i!==null){var n=i.href,a=i.content;var o=a.match(s);if(o){var u=ua(o,n);t.push.apply(t,u)}}}return t})}function oa(e,t){return Promise.all(e.map(function(e){var r=e.formats,i=e.originalRule;return Promise.all(r.map(function(e){var r=e.format,i=e.url;if(t){return Xe(i).then(function(e){return{format:r,src:e}}).catch(function(){return null})}else{return{format:r,src:i}}})).then(function(e){var t=[];for(var r=0;r<e.length;r++){var n=e[r];if(n!==null){t.push("url('"+n.src+"') format('"+n.format+"')")}}if(t.length!==0){var a="src: "+t.join(",")+";";return i.replace(/src\s*:[^;]+;/g,a)}return i})}))}var sa={"embedded-opentype":true,svg:true};function ua(e,t){var r=/url\(['"]?([^'")]+)['"]?\)\s+format\(['"]?([^'")]+)['"]?\)/g;var i=/font-family\s*:\s*['"]?([^;'"]+)['"]?;/;var n=[];for(var a=0;a<e.length;a++){var o=e[a];var s=o.match(i)[1];var u=[];var l=void 0;while(l=r.exec(o)){var d=l[1];var h=l[2];if(!sa[h.toLowerCase()]){u.push({format:h,url:la(d,t)})}}n.push({name:s,formats:u,originalRule:o})}return n}function la(e,t){if(/^http(s)?:/.test(e)){return e}if(e[0]==="/"){var r=t.match(/((\w+:\/\/)([^/]+))/);if(r){return r[1]+e}else{return e}}var i=e.split("/");var n=t.split("/");if(t[t.length-1]!=="/"){n.pop()}while(i[0]===".."){i.shift();n.pop()}return n.concat(i).join("/").replace(/[\w](\/{2,})/g,function(e){return e[0]+"/"})}var da={};function ha(e){return typeof e==="number"&&isNaN(e)}var fa=function e(){this._keys=[];this._values=[]};fa.prototype.set=function e(t,value){var r=this._getIndex(t);if(r===-1){this._keys.push(t.slice());this._values.push(value);return true}else{this._values[r]=value;return false}};fa.prototype.get=function e(t){var r=this._getIndex(t);return r===-1?undefined:this._values[r]};fa.prototype.has=function e(t){return this._getIndex(t)!==-1};fa.prototype.delete=function e(t){var r=this._getIndex(t);if(r!==-1){this._keys.splice(r,1);this._values.splice(r,1);return true}else{return false}};fa.prototype.keys=function e(){return this._keys.map(function(e){return e.slice()})};fa.prototype.values=function e(){return this._values.slice()};fa.prototype._getIndex=function e(t){for(var r=0;r<this._keys.length;++r){var i=this._keys[r];if(i.length===t.length){var n=true;for(var a=0;a<t.length;++a){var o=i[a],s=t[a];if(o!==s&&(!ha(o)||!ha(s))){n=false;break}}if(n){return r}}}return-1};var ca=function e(){this.clear()};var va={size:{configurable:true}};ca.prototype.clear=function e(){this._keys=[];this._values=[];this._arrays=new fa;this._size=0};va.size.get=function(){return this._size};ca.prototype.delete=function e(t){if(x(t)){if(this._arrays.delete(t)){this._size-=1;return true}else{return false}}else{var r=pa(this,t);if(r===-1){return false}else{this._keys.splice(r,1);this._values.splice(r,1);this._size-=1;return true}}};ca.prototype.get=function e(t){if(x(t)){return this._arrays.get(t)}else{var r=pa(this,t),value=r===-1?undefined:this._values[r];return value}};ca.prototype.has=function e(t){return x(t)?pa(this,t)!==-1:this._arrays.has(t)};ca.prototype.set=function e(t,value){if(x(t)){if(this._arrays.set(t,value)){this._size+=1}}else{var r=pa(this,t);if(r===-1){this._size+=1;this._keys.push(ha(t)?da:t);this._values.push(value)}else{this._values[r]=value}}return this};ca.prototype.keys=function e(){var e=this._keys.slice();for(var t=0;t<e.length;++t){if(e[t]===da){e[t]=NaN}}return e.concat(this._arrays.keys())};ca.prototype.values=function e(){return this._values.slice().concat(this._arrays.values())};Object.defineProperties(ca.prototype,va);function pa(e,t){if(ha(t)){return e._keys.indexOf(da)}else{return e._keys.indexOf(t)}}var ga=function e(){this._map=new Map;this._arrays=new fa};var _a={size:{configurable:true}};ga.prototype.clear=function e(){this._arrays=new fa;return this._map.clear()};ga.prototype.delete=function e(t){return x(t)?this._arrays.delete(t):this._map.delete(t)};ga.prototype.get=function e(t){return x(t)?this._arrays.get(t):this._map.get(t)};ga.prototype.set=function e(t,value){if(x(t)){this._arrays.set(t,value)}else{this._map.set(t,value)}return this};ga.prototype.keys=function e(){return Array.from(this._map.keys()).concat(this._arrays.keys())};ga.prototype.values=function e(){return Array.from(this._map.values()).concat(this._arrays.values())};_a.size.get=function(){return this._map.size+this._arrays._keys.length};Object.defineProperties(ga.prototype,_a);var ma=ca;if(typeof Map!=="undefined"&&typeof Map.prototype.keys!=="undefined"&&typeof Map.prototype.values!=="undefined"){try{(new Map).keys().next();(new Map).values().next();ma=ga}catch(e){}}var ya=ma;var ba=8;var xa=function e(t){this._constructor=t;this._array=new t(ba);this._capacity=ba;this.length=0};xa.prototype.reserve=function e(t){if(this._capacity<t){t=Math.pow(2,Math.ceil(Math.log2(t+1)));var r=new this._constructor(t);r.set(this._array);this._capacity=t;this._array=r}};xa.prototype.has=function e(value){var t=Aa(this._array,value,0,this.length);return t<this.length&&this._array[t]===value};xa.prototype.add=function e(value){var t=Aa(this._array,value,0,this.length),r=t<this.length&&this._array[t]===value;if(!r){if(this.length===this._capacity){this.reserve(this.length+1)}this._array.copyWithin(t+1,t,this.length);this._array[t]=value;this.length+=1}return!r};xa.prototype.remove=function e(value){var t=Aa(this._array,value,0,this.length),r=t<this.length&&this._array[t]===value;if(r){this._array.copyWithin(t,t+1,this.length);this.length-=1}return r};xa.prototype.removeByPosition=function e(t){if(t>=this.length){return false}this._array.copyWithin(t,t+1,this.length);this.length-=1;return true};xa.prototype.get=function e(t){return this._array[t]};xa.prototype.clear=function e(){this.length=0};xa.prototype.slice=function e(){return this._array.slice(0,this.length)};function Aa(e,t,r,i){if(r===i){return r}else{var n=r+((i-r)/2|0),value=e[n],a=t-value;if(a===0){return n}else if(a<0){return Aa(e,t,r,n)}else{return Aa(e,t,n+1,i)}}}var Ea=[];var Sa=[RegExp,Date];if(typeof HTMLElement!=="undefined"){Ea.push(HTMLElement)}function wa(e,t){for(var r=0;r<t.length;++r){if(e instanceof t[r]){return true}}return false}var Ta=function(e){return typeof e!=="object"||e===null||x(e)||wa(e,Sa)};function Ca(e,t,r,i){if(t===void 0)t=Ta;if(r===void 0)r=[];if(i===void 0)i=[];if(wa(e,Ea)){return}if(t(e)){r.push({path:i.slice(),value:e})}else{var n=Object.keys(e);for(var a=0;a<n.length;++a){var o=n[a],s=i.slice();s.push(o);Ca(e[o],t,r,s)}}return r}var Ia=function e(){this._keys=[];this._values=[];this._size=0;this._cachedPath=[];this._cachedIndex=-1};var Ma={size:{configurable:true}};Ma.size.get=function(){return this._size};Ia.prototype.set=function e(t,value){var r=La(this,t);if(r!==-1){this._values=value}else{if(ka(this._cachedPath,t)){this._cachedIndex=this._keys.length}this._keys.push(t);this._values.push(value);this._size+=1}};Ia.prototype.get=function e(t){var r=La(this,t);if(r!==-1){return this._values[r]}else{return undefined}};Ia.prototype.has=function e(t){return La(this,t)!==-1};Ia.prototype.keys=function e(){return this._keys.slice()};Object.defineProperties(Ia.prototype,Ma);function La(e,t){if(ka(t,e._cachedPath)){return e._cachedIndex}e._cachedPath=t.slice();for(var r=0;r<e._keys.length;++r){if(ka(e._keys[r],t)){e._cachedIndex=r;return r}}e._cachedIndex=-1;return-1}function ka(e,t){if(e.length!==t.length){return false}for(var r=0;r<e.length;++r){if(e[r]!==t[r]){return false}}return true}var Na=m("webworker-threads");var Fa=Na?Na.Worker:null;function za(e){if(Fa){return Ra(e)}else{return e}}function Ra(e){if(ArrayBuffer.isView(e)){return Array.from(e)}else if(Array.isArray(e)){for(var t=0;t<e.length;++t){e[t]=Ra(e[t])}return e}else if(Y(e)){var r=Object.keys(e);for(var i=0,n=r;i<n.length;i+=1){var a=n[i];e[a]=Ra(e[a])}return e}return e}function Pa(e){if(Fa){return Ba(e)}else if(typeof URL==="undefined"||navigator.appVersion.indexOf("MSIE 10")!==-1){return Da(e)}else{return Oa(e)}}function Oa(e){try{var t=new Blob([e],{type:"application/javascript"});var r=URL.createObjectURL(t);var i=new Worker(r);return i}catch(t){return new Va(e)}}function Da(e){return new Va(e)}function Ba(e){return new Fa(new Function(e))}var Va=function e(t){this._f=new Function("self",t);this._main=true;this._listeners=[];this._terminated=false;this._otherSide=new ja(this);this._f(this._otherSide)};Va.prototype.terminate=function e(){this._terminated=false;this._otherSide._terminated=true};Va.prototype.addEventListener=Ua;Va.prototype.postMessage=Ga;var ja=function e(t){this._main=false;this._listeners=[];this._terminated=false;this._otherSide=t};ja.prototype.addEventListener=Ua;ja.prototype.postMessage=Ga;function Ua(e,t){this._listeners.push(t)}function Ga(e){setTimeout(qa,0,this._otherSide,{data:e})}function qa(e,t){if(e._terminated){return}for(var r=0;r<e._listeners.length;++r){e._listeners[r](t)}}var Ha=function e(t){this._name=t;this._attributes={};this._children=[]};var Wa={tagName:{configurable:true},children:{configurable:true},childNodes:{configurable:true},firstChild:{configurable:true}};Ha.prototype.setAttribute=function e(t,value){this._attributes[t]=value};Ha.prototype.appendChild=function e(t){this._children.push(t)};Wa.tagName.get=function(){return this._name};Wa.children.get=function(){return this._children};Wa.childNodes.get=function(){return this._children};Wa.firstChild.get=function(){return this._children[0]||null};Ha.prototype.serialize=function e(){var t=this._name;var r=this._attributes;var i=this._children;var n=Object.keys(r).filter(function(e){return r[e]!==undefined});var a=n.map(function(e){return" "+e+'="'+(""+r[e])+'"'}).join("");var o=i.map(function(e){return e.serialize()}).join("");if(!o.length){return"<"+t+a+"/>"}else{return"<"+t+a+">"+o+"</"+t+">"}};Ha.prototype.cloneNode=function e(t){var r=new Ha(this._name);var i=Object.keys(this._attributes);for(var n=0,a=i;n<a.length;n+=1){var o=a[n];r.setAttribute(o,this._attributes[o])}if(t){for(var s=0;s<this._children.length;s++){r.appendChild(this._children[s].cloneNode(t))}}return r};Object.defineProperties(Ha.prototype,Wa);var Xa=function e(t){this._text=t};Xa.prototype.serialize=function e(){return this._text};Xa.prototype.cloneNode=function e(){return new Xa(this._text)};var Ya=function e(){this._children=[];this._meta=[]};Ya.prototype.appendChild=function e(t){this._children.push(t)};Ya.prototype.serialize=function e(){return this._meta.concat(this._children.map(function(e){return e.serialize()})).join("")};Ya.prototype.createElement=function e(t){return new Ha(t)};Ya.prototype.createTextNode=function e(t){return new Xa(t)};function Za(){return new Ya}var Ka=function e(t){this._keyToValue=t;this._keyToIndex=new Int32Array(t.length);this._heap=[];this._size=0;this._keyToIndex.fill(-1)};Ka.prototype.add=function e(t){var r=this._keyToIndex[t];if(r===-1){r=this._size++;this._heap[r]=t}this._keyToIndex[t]=this._bubble(r)};Ka.prototype.removeMin=function e(){if(this._size===0){return NaN}var t=this._heap[0];this._heap[0]=this._heap[--this._size];this._bubble(0);return t};Ka.prototype.isEmpty=function e(){return this._size===0};Ka.prototype.has=function e(t){return this._keyToIndex[t]!==-1};Ka.prototype._bubble=function e(t){var value=this._indexToValue(t);var r=this._getParentIndex(t);var i=this._indexToValue(r);var n=t;if(t!==0&&i>value){n=this._swap(t,r)}else{var a=this._getLeftChildIndex(t);var o=this._getRightChildIndex(t);var s=this._indexToValue(a);var u=this._indexToValue(o);var l=Math.min(value,s,u);if(l===value);else if(l===s){n=this._swap(t,a)}else{n=this._swap(t,o)}}if(n===t){return t}else{return this._bubble(n)}};Ka.prototype._indexToValue=function e(t){if(t>=this._size){return Infinity}else{return this._keyToValue[this._heap[t]]}};Ka.prototype._getParentIndex=function e(t){return(t-1)/2|0};Ka.prototype._getLeftChildIndex=function e(t){return t*2+1};Ka.prototype._getRightChildIndex=function e(t){return t*2+2};Ka.prototype._swap=function e(t,r){var i=this._heap[t];var n=this._heap[r];this._heap[t]=n;this._heap[r]=i;this._keyToIndex[i]=r;this._keyToIndex[n]=t;return r};var Qa=function(){function e(e,t){this._graph=e;this._nodes={elementList:e.nodeList,flexArray:e.createNodeAttribute({storage:1,name:t}),indexList:e.createIndexList(true)};this._edges={elementList:e.edgeList,flexArray:e.createEdgeAttribute({storage:1,name:t}),indexList:e.createIndexList(false)}}e.prototype._get=function(e){return e.isNode?this._nodes:this._edges};e.prototype.addOrRemoveElements=function(e,t){return t?this.addElements(e):this.removeElements(e)};e.prototype.addElements=function(e){var t=this._get(e),r=t.elementList,i=t.flexArray,n=t.indexList;var a=n.getLength();for(var o=0;o<e._indexes.length;o++){var s=e._indexes[o];if(i.get(s)!==1){i.set(s,1);n.pushUnchecked(s)}}var u=n.slice(a);return r(u)};e.prototype.removeElements=function(e){var t=this._get(e),r=t.elementList,i=t.flexArray,n=t.indexList;var a=n.getLength();var o=n.getBuffer();var s=0;for(var u=0;u<e._indexes.length;u++){var l=e._indexes[u];if(i.get(l)!==0){i.set(l,0);s+=1}}if(s===a){return r(n.sliceAndReset())}else if(s===0){return r()}else{var d=this._graph.acquireIndexList(e.isNode);var h=0;for(var u=0;u<a;++u){var l=o[u];if(i.get(l)===0){h+=1;d.pushUnchecked(l)}else{o[u-h]=l}}n.setLength(a-s);return r(d.sliceAndReset())}};e.prototype.hasElement=function(e){return!!this._get(e).flexArray.get(e._index)};e.prototype.clear=function(){if(!this._nodes.indexList.isEmpty()){this._nodes.indexList.reset();this._nodes.flexArray.reset()}if(!this._edges.indexList.isEmpty()){this._edges.indexList.reset();this._edges.flexArray.reset()}};e.prototype.isEmpty=function(){return this._nodes.indexList.isEmpty()&&this._edges.indexList.isEmpty()};e.prototype.getElements=function(){return{nodes:this._nodes.elementList(this._nodes.indexList.slice()),edges:this._edges.elementList(this._edges.indexList.slice())}};return e}();function Ja(e,t,r,i){if(i===void 0){i=0}if(t===undefined){t=r=Math.sqrt(e.length/4)}if(r===undefined){r=t}var n=document.createElement("canvas");var a=n.getContext("2d");var o=a.createImageData(t,r);n.style.imageRendering="pixelated";n.style.border="1px solid black";n.style.margin="2px";n.style.position="absolute";n.style.top=n.style.left="0px";n.width=t;n.height=r;o.data.set(e);a.putImageData(o,0,0);var s=document.getElementById("graph-container");if(s){s.style.position="static"}setTimeout(function(){return document.body.appendChild(n)},i)}var $a=function(){return{minX:Infinity,minY:Infinity,maxX:-Infinity,maxY:-Infinity}};var eo=function(){function e(e){if(e===void 0){e={}}var t=e.xValues,r=t===void 0?[]:t,i=e.yValues,n=i===void 0?[]:i,a=e.scaledSizeValues,o=a===void 0?[]:a,s=e.fixedSizeValues,u=s===void 0?[]:s;this.minX=rr(r);this.minY=rr(n);this.maxX=tr(r);this.maxY=tr(n);this.minScaledSize=rr(o);this.maxScaledSize=tr(o);this.minFixedSize=rr(u);this.maxFixedSize=tr(u);this.cx=this.minX+(this.maxX-this.minX)/2;this.cy=this.minY+(this.maxY-this.minY)/2;this.width=this.maxX-this.minX;this.height=this.maxY-this.minY}e.prototype.reset=function(){this.minX=Infinity;this.minY=Infinity;this.maxX=-Infinity;this.maxY=-Infinity;this.minScaledSize=Infinity;this.maxScaledSize=-Infinity;this.minFixedSize=Infinity;this.maxFixedSize=-Infinity;this.width=0;this.height=0;this.cx=0;this.cy=0;return this};e.prototype.addPoint=function(e,t,r,i){this.minX=Math.min(this.minX,e);this.minY=Math.min(this.minY,t);this.maxX=Math.max(this.maxX,e);this.maxY=Math.max(this.maxY,t);if(r!==undefined&&i!==undefined){if(i==="scaled"){this.minScaledSize=Math.min(this.minScaledSize,r);this.maxScaledSize=Math.max(this.maxScaledSize,r)}else{this.minFixedSize=Math.min(this.minFixedSize,r);this.maxFixedSize=Math.max(this.maxFixedSize,r)}}this.cx=this.minX+(this.maxX-this.minX)/2;this.cy=this.minY+(this.maxY-this.minY)/2;this.width=this.maxX-this.minX;this.height=this.maxY-this.minY;return this};e.prototype.computeForZoom=function(t){var r=Math.max(this.maxScaledSize,this.maxFixedSize/t);return e.from({minX:this.minX-r/2,minY:this.minY-r/2,maxX:this.maxX+r/2,maxY:this.maxY+r/2,width:this.width+r,height:this.height+r})};e.from=function(t){var r=t===void 0?{}:t,i=r.minX,n=r.minY,a=r.maxX,o=r.maxY,s=r.width,u=r.height;var l=new e;l.minX=i;l.minY=n;l.maxX=a;l.maxY=o;l.width=s||(a-i)/2;l.height=u||(o-n)/2;l.cx=(i+a)/2;l.cy=(n+o)/2;return l};e.fromValues=function(t,r,i){var n=Infinity,a=Infinity;var o=-Infinity,s=-Infinity;var u=-Infinity;for(var l=0;l<t.length;l++){var d=t[l],h=r[l],f=i[l];if(d-f<n){n=d-f}if(h-f<a){a=h-f}if(d+f>o){o=d+f}if(h+f>s){s=h+f}if(f>u){u=f}}var c=e.from({minX:n,minY:a,maxX:o,maxY:s});c.maxScaledSize=u;return c};e.prototype.pad=function(value){this.minX-=value;this.minY-=value;this.maxX+=value;this.maxY+=value;this.width+=2*value;this.height+=2*value;return this};e.prototype.isValid=function(){return isFinite(this.width)&&isFinite(this.height)};e.prototype.extend=function(e){this.addPoint(e.minX,e.minY);this.addPoint(e.maxX,e.maxY);return this};e.prototype.bottomLeft=function(){return{x:this.minX,y:this.minY}};e.prototype.topRight=function(){return{x:this.maxX,y:this.maxY}};return e}();var to=function(){function e(){}e.prototype.on=function(e,t){if(typeof e!=="string"){throw new TypeError("Event name must be string")}if(typeof t!=="function"){throw new TypeError("Event handler must be function")}var r=this._events=this._events||{};var i=r[e]=r[e]||[];i.push(t);return this};e.prototype.off=function(e,t){if(typeof e!=="string"){throw new TypeError("Event name must be string")}var r=this._events=this._events||{};var i=r[e];if(x(i)){if(typeof t!=="function"){r[e]=null}else{var n=i.indexOf(t);if(n!==-1){i.splice(n,1)}if(i.length===0){r[e]=null}}}return this};e.prototype.fire=function(e){var t=arguments;var r=[];for(var i=1;i<arguments.length;i++){r[i-1]=t[i]}if(typeof e!=="string"){throw new TypeError("Event name must be string")}var n=this._events=this._events||{};var a=n[e];if(x(a)){var o=r;for(var s=0;s<a.length;s++){var u=a[s];if(u){u.apply(this,o)}}}return this};e.prototype.once=function(e,t){var r=this;var i=function(){var n=arguments;var a=[];for(var o=0;o<arguments.length;o++){a[o]=n[o]}t.apply(r,a);r.off(e,i)};i.handler=t;return this.on(e,i)};e.prototype.hasListener=function(e,t){if(!e||!t){return false}var r=this._events=this._events||{};var i=r[e];if(x(i)){for(var n=0,a=i.length;n<a;n++){var o=i[n];if(o===t||o.handler===t){return true}}}return false};e.prototype.getListeners=function(e){var t=this._events=this._events||{};return t[e]};return e}();var ro=Object.freeze({__proto__:null,BoundingBox:eo,FlexArray:Xt,EventTarget:to,ColorManager:Pi,Table:ur,requestAnimFrame:$,cancelAnimFrame:ee,getDocumentFontRules:aa,getEmbeddedFontRules:oa,resolvePath:la,IndexList:ar,isInteger:T,toPropertyPath:C,throttle:I,debounce:M,processQueue:k,isLittleEndian:N,promiseQueue:F,isRawObject:z,getValues:R,forEach:P,deepCopy:O,updateObject:D,extendList:B,setProperty:V,getProperty:j,flatten:U,unflatten:G,getFlattenedKeys:q,getLeafValues:H,ensureTransferable:W,getOptions:X,isObject:Y,mergeValues:Z,pick:K,PathMap:Ia,objToValueList:Ca,smartRequire:m,DummyXHR:le,DummyFileReader:de,getDocument:he,getStyle:fe,isWebGLSupported:ce,getWebglContext:ve,DummyDomElement:pe,DummyCanvas:_e,DummyCanvasRenderingContext2D:ye,createDummyDomElement:xe,createXmlDocument:Ae,serializeXMLDocument:Ee,createCanvas:Se,getPixelRatio:we,dataUrlToBlob:Te,createBlob:Ie,isBlob:Me,promptDownload:Le,resizeElement:ke,setAttributes:Ne,SVG_NS:Fe,XML_NS:ze,XLINK:Re,createSvgElement:Pe,createTextNode:Oe,getImage:De,fetch:Ve,isHTMLElement:je,applyCursorStyle:Ue,DummyImage:Ge,getBoundingClientRect:He,fetchBinary:We,fetchBinaryAsBase64:Xe,setCtxFont:Ye,escapeDOMAttribute:Ze,BUTTON_MAPPING:Ke,baseURI:Qe,fadeElement:Je,getCurrentTime:tt,getDate:rt,getTime:it,formatWorkerMessage:za,createWorker:Pa,insertSortAsc:y,insertSortDesc:b,isArray:x,toArray:A,flattenArray:E,concatenateArrays:S,removeFromArray:w,parseColorRgba:ki,toHexa:Ni,componentsToRGBA:Fi,parseColorHex:zi,createDummyXmlDocument:Za,PrioritySet:Ka,nextPowerOfTwo:Kt,computeSum:Qt,clamp:Jt,mix:$t,lerp:er,computeMax:tr,computeMin:rr,getBaseLog:ir,ElementSet:Qa,displayPixelsOnScreen:Ja});var io=1e20;var no=24;var ao=6;var oo=8;var so=.25;var uo=(no+2*ao)/no;var lo=24;var ho=function e(){this._fontSize=no;this._buffer=ao;this._radius=oo;this._cutoff=so;this._height=Math.ceil(this._fontSize+this._buffer*2*Cn);this._maxDimension=1;this._gridSize=1;this._canvas=Se();this._canvas.height=this._height;this._canvas.width=1;this._ctx=this._canvas.getContext("2d");this._ctx.textBaseline="middle";this._ctx.textAlign="center";this._ctx.fillStyle="black";this._gridOuter=null;this._gridInner=null;this._f=null;this._d=null;this._z=null;this._v=null};var fo={SDF_DIV:{configurable:true}};fo.SDF_DIV.get=function(){return uo};ho.prototype.getFontToImageSizeRatio=function e(){return 1+this._buffer*2/this._fontSize};ho.prototype.draw=function e(t,r,i){Ye(this._ctx,r,this._fontSize,i);var n=this._ctx.measureText(t).width+this._buffer*2,a=po(n)-En*2,o=a,s=this._height,u=o*s,l=Math.max(o,s);if(this._canvas.width<o){this._canvas.width=o;Ye(this._ctx,r,this._fontSize,i);this._ctx.textAlign="center";this._ctx.textBaseline="middle";this._ctx.fillStyle="black"}if(u>this._gridSize){this._gridOuter=new Float64Array(u);this._gridInner=new Float64Array(u);this._gridSize=u}if(l>this._maxDimension){this._f=new Float64Array(l);this._d=new Float64Array(l);this._z=new Float64Array(l+1);this._v=new Int16Array(l);this._maxDimension=l}this._ctx.clearRect(0,0,o,s);this._ctx.fillText(t,o/2,s/2);var d=this._ctx.getImageData(0,0,o,s),h=new Uint8ClampedArray(u);for(var f=0;f<u;f++){var c=d.data[f*4+3]/255;this._gridOuter[f]=c===1?0:c===0?io:Math.pow(Math.max(0,.5-c),2);this._gridInner[f]=c===1?io:c===0?0:Math.pow(Math.max(0,c-.5),2)}co(this._gridOuter,o,s,this._f,this._d,this._v,this._z);co(this._gridInner,o,s,this._f,this._d,this._v,this._z);for(var v=0;v<u;v++){var p=this._gridOuter[v]-this._gridInner[v];h[v]=Math.max(0,Math.min(255,Math.round(255-255*(p/this._radius+this._cutoff))))}return{height:s,width:o,distance:h}};Object.defineProperties(ho,fo);function co(e,t,r,i,n,a,o){for(var s=0;s<t;s++){for(var u=0;u<r;u++){i[u]=e[u*t+s]}vo(i,n,a,o,r);for(var l=0;l<r;l++){e[l*t+s]=n[l]}}for(var d=0;d<r;d++){for(var h=0;h<t;h++){i[h]=e[d*t+h]}vo(i,n,a,o,t);for(var f=0;f<t;f++){e[d*t+f]=Math.sqrt(n[f])}}}function vo(e,t,r,i,n){r[0]=0;i[0]=-io;i[1]=+io;for(var a=1,o=0;a<n;a++){var s=(e[a]+a*a-(e[r[o]]+r[o]*r[o]))/(2*a-2*r[o]);while(s<=i[o]){o--;s=(e[a]+a*a-(e[r[o]]+r[o]*r[o]))/(2*a-2*r[o])}o++;r[o]=a;i[o]=s;i[o+1]=+io}for(var u=0,l=0;u<n;u++){while(i[l+1]<u){l++}t[u]=(u-r[l])*(u-r[l])+e[r[l]]}}function po(value){return Math.ceil((value+En*2)/An)*An}var go,_o;var mo=256;var yo=0;var bo=1;var xo=2;var Ao=3;var Eo=4;var So=0;var wo=1;var To=(go={},go[yo]={min:"NEAREST",mag:"NEAREST",mipmap:false},go[bo]={min:"LINEAR",mag:"LINEAR",mipmap:false},go[xo]={min:"LINEAR",mag:"LINEAR",mipmap:false},go[Ao]={min:"LINEAR_MIPMAP_LINEAR",mag:"LINEAR",mipmap:true},go);var Co=(_o={},_o[So]="ALPHA",_o[wo]="RGBA",_o);var Io=Tn-En*2;var Mo=wn-En*2;var Lo=function(){function e(e,t){this._patternIdToInfoTexture=new Uint8Array(mo*mo*4);this._glTextureInfo=null;this._glTextures=[];this._textureSizes=[];this._pixelRatio=1;this._warned=false;this._gl=e;this._glUnit=t;this._imageCanvas=Se();this._imageCanvas.width=Sn;this._imageCanvas.height=Sn;this._imageCanvasContext=this._imageCanvas.getContext("2d");this._canvasForDuplicatedImage=null;this._sdfGenerator=new ho;this._maxTextureSize=Math.min(4096,e.getParameter(e.MAX_TEXTURE_SIZE))}e.prototype._warn=function(){if(!this._warned){vr("exceeded max WebGL texture size of "+this._maxTextureSize+"; some texts/icons/images won't be displayed");this._warned=true}};e.prototype.refresh=function(e){this._pixelRatio=e.getPixelRatio();var t=this._gl;var r=this._getPatternsByFilter(e.getPatternList());for(var i=0;i<r.length;++i){var n=i;var a=r[i];var o=this._getApproximateRequestedTextureSize(a);var s=this._fillAtlas(n,a,o),u=s.texture,l=s.size;var d=this._glTextures[n]||(this._glTextures[n]=t.createTexture());var h=n===yo?So:wo;this._setupTexture(d,this._glUnit+1+n,u,l,n,h);this._textureSizes[n]=l}var f=this._glTextureInfo||(this._glTextureInfo=t.createTexture());var c=this._patternIdToInfoTexture;this._setupTexture(f,this._glUnit,c,mo,yo,wo)};e.prototype._setupTexture=function(e,t,r,i,n,a){var o=this._gl;var s=To[n],u=s.min,l=s.mag,d=s.mipmap;var h=o[Co[a]];if(a===So){var f=new Uint8Array(i*i);for(var c=0;c<f.length;++c){f[c]=r[c*4+3]}r=f}o.activeTexture(o.TEXTURE0+t);o.bindTexture(o.TEXTURE_2D,e);o.texImage2D(o.TEXTURE_2D,0,h,i,i,0,h,o.UNSIGNED_BYTE,r);o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MAG_FILTER,o[l]);o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MIN_FILTER,o[u]);if(d){o.generateMipmap(o.TEXTURE_2D)}};e.prototype.bindMetDataTexture=function(){var e=this._gl;e.activeTexture(e.TEXTURE0+this._glUnit);e.bindTexture(e.TEXTURE_2D,this._glTextureInfo)};e.prototype.getGranularity=function(){return An};e.prototype.getInfoTextureUnit=function(){return this._glUnit};e.prototype.getNearestTextureUnit=function(){return this._glUnit+1+yo};e.prototype.getLinearTextureUnit=function(){return this._glUnit+1+bo};e.prototype.getLinearSdfTextureUnit=function(){return this._glUnit+1+xo};e.prototype.getMipmapTextureUnit=function(){return this._glUnit+1+Ao};e.prototype.getInfoTextureSize=function(){return mo};e.prototype.getNearestTextureSize=function(){return this._textureSizes[yo]};e.prototype.getLinearTextureSize=function(){return this._textureSizes[bo]};e.prototype.getLinearSdfTextureSize=function(){return this._textureSizes[xo]};e.prototype.getMipmapTextureSize=function(){return this._textureSizes[Ao]};e.prototype._getPatternsByFilter=function(e){var t=new Array(Eo);for(var r=0;r<Eo;++r){t[r]=[]}for(var r=0;r<e.length;++r){var i=this._getPatternPixels(e[r]);t[i.filter].push(i)}return t};e.prototype._getApproximateRequestedTextureSize=function(e){var t=0;var r=4;for(var i=0;i<e.length;++i){var n=e[i],a=n.width,o=n.height;var s=ko(a);var u=ko(o);t+=s*u;r=Math.max(r,Math.max(s,u))}var l=Kt(Math.max(r,Math.sqrt(t)));return Math.min(l,this._maxTextureSize)};e.prototype._adjustDimension=function(e,t){return Math.floor((t-e)/2)};e.prototype._fillAtlas=function(e,t,r){var i=new Uint8Array(r*r*4);var n=Math.ceil(r/An);var a=new Uint8Array(n*n);var o=[{x:0,y:0}];for(var s=0;s<t.length;++s){var u=t[s];var l=u.id;var d=ko(u.width)/An;var h=ko(u.height)/An;var f=this._setPositionOnCanvas(o,a,n,d,h);if(f){var c=u.width;var v=u.height;var p=u.pixels;var g=d*An;var _=h*An;var m=f.x*An+this._adjustDimension(c,g);var y=f.y*An+this._adjustDimension(v,_);this._copyPixelsOnTexture(i,r,p,m,y,c,v);this._writePatternMetaData(l,e,m,y,g,_)}else if(r<this._maxTextureSize){return this._fillAtlas(e,t,r*2)}else{this._warn();this._writePatternMetaData(l,e,0,0,0,0)}}return{texture:i,size:r}};e.prototype._copyPixelsOnTexture=function(e,t,r,i,n,a,o){i=i|0;n=n|0;a=a|0;o=o|0;t=t|0;for(var s=0;s<a;++s){for(var u=0;u<o;++u){var l=(i+s+(n+u)*t)*4;var d=(s+u*a)*4;e[l]=r[d];e[l+1]=r[d+1];e[l+2]=r[d+2];e[l+3]=r[d+3]}}};e.prototype._writePatternMetaData=function(e,t,r,i,n,a){var o=e*4;var s=t>>1<<7;var u=t%2<<7;this._patternIdToInfoTexture[o]=r/An;this._patternIdToInfoTexture[o+1]=i/An;this._patternIdToInfoTexture[o+2]=s+n/An;this._patternIdToInfoTexture[o+3]=u+a/An};e.prototype._setPositionOnCanvas=function(e,t,r,i,n){for(var a=0,o=e.length;a<o;++a){var s=e[a];var u=s.x;var l=s.y;var d=u+i;var h=l+n;var f=d<r&&h<r;if(f){for(var c=u;c<d;++c){if(t[c+l*r]===1){f=false;break}}}if(f){for(var c=l;c<h;++c){if(t[u+c*r]===1){f=false;break}}}if(f){for(var c=u;c<d;++c){for(var v=l;v<h;++v){t[c+v*r]=1}}e.splice(a,1);e.push({x:u,y:h},{x:d,y:l});return s}}return null};e.prototype._getPatternPixels=function(e){var t=e.id,r=e.type,i=e.attributes;var n=null;if(r===ji){if(i.duplicated){n=this._getDuplicatedImagePixels(i.image)}else if(i.scaled){n=this._getScaledImagePixels(i.image)}else{n=this._getNonScaledImagePixels(i.image)}}else if(r===Ui){var a=i.text,o=i.font,s=i.style,u=i.size,l=i.offset;if(i.size==="sdf"){n=this._getSdfTextPixels(a,o,s)}else{n=this._getRegularTextPixels(a,o,s,u,l)}}else if(r===qi){n=this._getIconPixels(i.text,i.font,i.style)}else if(r===Hi){n=this._getBadgeIconPixels(i.text,i.font,i.style)}else if(r===Gi){n=this._getPieChartPixels(i.colorArray)}else{throw new Error('pattern type "'+r+'" does not exist')}n.id=t;return n};e.prototype._getScaledImagePixels=function(e){var t=e.width;var r=e.height;if(t>Sn||r>Sn){var i=Sn/Math.max(e.width,e.height);t*=i;r*=i}if(t&&r){t=ko(t);r=ko(r)}t-=En*2;r-=En*2;return this._getImagePixels(e,t,r)};e.prototype._getNonScaledImagePixels=function(e){return this._getImagePixels(e,e.width,e.height)};e.prototype._getDuplicatedImagePixels=function(e){if(e.width===0||e.height===0){return this._getImagePixels(e,0,0)}if(!this._canvasForDuplicatedImage){this._canvasForDuplicatedImage=Se();this._canvasForDuplicatedImage.width=Sn;this._canvasForDuplicatedImage.height=Sn}var t=this._canvasForDuplicatedImage;var r=t.getContext("2d");var i=e.width;var n=e.height;var a=(Sn-i)/2;var o=(Sn-n)/2;while(a>0){a-=i}while(o>0){o-=n}for(var s=a;s<Sn;s+=i){for(var u=o;u<Sn;u+=n){r.drawImage(e,s,u)}}return this._getImagePixels(t,Sn,Sn)};e.prototype._getImagePixels=function(e,t,r){var i;if(t===0||r===0){i=new Uint8Array(0)}else{if(this._imageCanvas.width<t||this._imageCanvas.height<r){this._imageCanvas.width=t;this._imageCanvas.height=r}var n=this._imageCanvasContext;No(n,0,0,t,r);try{n.drawImage(e,0,0,t,r)}catch(e){}i=n.getImageData(0,0,t,r).data}return{width:t,height:r,pixels:i,filter:Ao}};e.prototype._getPieChartPixels=function(e){var t=Mo;var r=this._imageCanvasContext;var i=t/2;var n=t/2;var a=0;var o=Math.PI*2/e.length;No(r,0,0,t,t);r.save();r.rect(0,0,t,t);r.clip();for(var s=0;s<e.length;++s){var u=a+o;r.beginPath();r.moveTo(i,n);r.arc(i,n,t,a,u);r.fillStyle=e[s];r.fill();a=u}r.restore();return{width:t,height:t,pixels:r.getImageData(0,0,t,t).data,filter:bo}};e.prototype._getTextPixels=function(e,t,r,i,n,a){var o=this._imageCanvasContext;var s=n*this._pixelRatio;Ye(o,r,s,i);var u=o.measureText(t).width;if(u===0){u=s}var l=0;var d=0;var h=e===Ao;if(!h){l=Math.ceil(s*Cn/2)*2;d=Math.ceil(u*In/2)*2}var f=Math.ceil(u+d);var c=Math.ceil(s+l);var v=this._imageCanvas.height<c||this._imageCanvas.width<f;if(this._imageCanvas.height<c){this._imageCanvas.height=c}if(this._imageCanvas.width<f){this._imageCanvas.width=f}if(v){Ye(o,r,s,i)}o.clearRect(0,0,f,c);o.fillStyle="black";o.textBaseline="middle";o.textAlign="left";o.fillText(t,a+d/2,c/2);return{width:f,height:c,pixels:o.getImageData(0,0,f,c).data,filter:e}};e.prototype._getRegularTextPixels=function(e,t,r,i,n){return this._getTextPixels(yo,e,t,r,i,n)};e.prototype._getIconPixels=function(e,t,r){return this._getTextPixels(Ao,e,t,r,Io,0)};e.prototype._getBadgeIconPixels=function(e,t,r){return this._getSdfTextPixels(e,t,r)};e.prototype._getSdfTextPixels=function(e,t,r){var i=this._sdfGenerator.draw(e,t,r),n=i.width,a=i.height,distance=i.distance;var o=new Uint8Array(n*a*4);for(var s=0;s<distance.length;++s){o[s*4+3]=distance[s]}return{width:n,height:a,pixels:o,filter:xo}};return e}();function ko(value){return Math.ceil((value+En*2)/An)*An}function No(e,t,r,i,n){e.clearRect(t,r,i,n)}var Fo={byte:1,ubyte:1,short:2,ushort:2,float:4};var zo={byte:"BYTE",ubyte:"UNSIGNED_BYTE",short:"SHORT",ushort:"UNSIGNED_SHORT",float:"FLOAT"};var Ro=function e(t){var r=t.gl;var i=t.ext;var n=t.specialGlBuffers;var a=t.metaData;var o=t.programWrapper;this._gl=r;this._ext=i;this._specialGlBuffers=n;this._metaData=O(a);this._programWrapper=o;this._program=null;this._setupUniforms=null;this._specialAttributes=null;this._baseAttributes=null;this._textAttributes=null;this._stencilUsage=Ji};Ro.prototype._finishInit=function e(){var t=this;var r=this._gl;var i=this._programWrapper.getError();if(i){throw new Error('WebGL compilation at step "'+i.step+":\n"+i.message+'"')}this._program=this._programWrapper.getProgram();r.useProgram(this._program);this._metaData.attributes.forEach(function(e){e.location=r.getAttribLocation(t._program,e.name);e.byteSize=e.size*Fo[e.type];e.glType=zo[e.type]});this._specialAttributes=this._createSpecialAttributesFunctions();this._baseAttributes=this._createAttributesFunctions(function(e){return!e.name.startsWith("a_text")});this._textAttributes=this._createAttributesFunctions(function(e){return e.name.startsWith("a_text")});this._setupUniforms=this._createSetupUniformFunction()};Ro.prototype._createSetupUniformFunction=function e(){var t={int:function(e){return"gl.uniform1i(l."+e+", u."+e+");"},sampler2D:function(e){return"gl.uniform1i(l."+e+", u."+e+");"},float:function(e){return"gl.uniform1f(l."+e+", u."+e+");"},vec2:function(e){return"gl.uniform2f(l."+e+", u."+e+"[0], u."+e+"[1]);"},vec3:function(e){return"gl.uniform3f(l."+e+", u."+e+"[0], u."+e+"[1], u."+e+"[2]);"},vec4:function(e){return"gl.uniform4f(l."+e+", u."+e+"[0], u."+e+"[1], u."+e+"[2], u."+e+"[3]);"}};var r=this._gl;var i={};var n=[];for(var a=0;a<this._metaData.uniforms.length;++a){var o=this._metaData.uniforms[a];var s=o.id;var u=o.name;var l=o.type;var d=r.getUniformLocation(this._program,u);var h=t[l](s);i[s]=d;n.push(h)}var f=new Function("gl","l","u",n.join("\n"));return function(e){return f(r,i,e)}};Ro.prototype._createEnableAttributesFunction=function e(t){var r=this;var i=t.map(function(e){var t=e.location;return"gl.enableVertexAttribArray("+t+");"}).join("\n");var n=new Function("gl",i);return function(){return n(r._gl)}};Ro.prototype._createDisableAttributesFunction=function e(t){var r=this;var i=t.map(function(e){var t=e.location;return"gl.disableVertexAttribArray("+t+");"}).join("\n");var n=new Function("gl",i);return function(){return n(r._gl)}};Ro.prototype._createSetupAttributesFunction=function e(t){var r=this;var i=t.reduce(function(e,t){var r=t.byteSize;return e+r},0);var n=0;var a=["gl.bindBuffer(gl.ARRAY_BUFFER, glBuffer);","if (dataBuffer) { gl.bufferData(gl.ARRAY_BUFFER, dataBuffer, gl.STATIC_DRAW); }"].concat(t.map(function(e){var t=e.location;var r=e.size;var a=e.glType;var o=e.byteSize;var s="gl.vertexAttribPointer("+t+", "+r+", gl."+a+", false, "+i+", "+n+");";n+=o;return s})).concat(t.map(function(e){var t=e.location;return"ext.vertexAttribDivisorANGLE("+t+", divisor);"})).join("\n");var o=new Function("gl","ext","glBuffer","dataBuffer","divisor",a);return function(e,t,i){o(r._gl,r._ext,e,t,i)}};Ro.prototype._createAttributesFunctions=function e(t){if(typeof t==="function"){t=this._metaData.attributes.filter(function(e){return e.location!==-1}).filter(t)}var r=this._createEnableAttributesFunction(t);var i=this._createDisableAttributesFunction(t);return{enable:function(){r();this.enabled=true},disable:function(){i();this.enabled=false},setup:this._createSetupAttributesFunction(t),enabled:false}};Ro.prototype._createSpecialAttributesFunctions=function e(){return this._createAttributesFunctions([{location:this._gl.getAttribLocation(this._program,this._metaData.vertexInfoAttribute),size:3,glType:"BYTE",byteSize:3}])};Ro.prototype.startPass=function e(t){if(!this._program){this._finishInit()}this._gl.useProgram(this._program);this._resetStencil();this._setupUniforms(t);this._specialAttributes.enable();this._specialAttributes.setup(this._specialGlBuffers.vertexInfo,null,0)};Ro.prototype._setupAttributes=function e(t,r){var i=r.glBuffer;var n=r.dataBuffer;var a=r.divisor;if(t.enabled&&!i){t.disable()}else if(!t.enabled&&i){t.enable()}if(i){t.setup(i,n,a)}};Ro.prototype.setupBaseAttributes=function e(t){this._setupAttributes(this._baseAttributes,t)};Ro.prototype.setupTextAttributes=function e(t){this._setupAttributes(this._textAttributes,t)};Ro.prototype._resetStencil=function e(){var t=this._gl;this._stencilUsage=Ji;t.disable(t.STENCIL_TEST)};Ro.prototype.setupStencil=function e(t){if(t!==this._stencilUsage){var r=this._gl;if(t!==Ji){r.enable(r.STENCIL_TEST);if(t===$i){r.stencilOp(r.KEEP,r.KEEP,r.REPLACE);r.stencilFunc(r.ALWAYS,1,1)}else if(t===en){r.stencilOp(r.KEEP,r.KEEP,r.KEEP);r.stencilFunc(r.EQUAL,0,1)}}else{r.disable(r.STENCIL_TEST)}this._stencilUsage=t}};Ro.prototype.endPass=function e(){this._specialAttributes.disable();this._baseAttributes.disable();this._textAttributes.disable()};var Po=function e(t){var r=t.gl;var i=t.ext;var n=t.staticProgram;var a=t.animationProgram;this._gl=r;this._ext=i;this._staticProgram=n;this._animationProgram=a;this._program=null;this._dataBuffer=null;this._version=0;this._glBuffer=this._gl.createBuffer();this._sideGlBuffer=null;this._used=false;this._dataBufferChanged=false};Po.prototype.setDataBuffer=function e(t){if(this._dataBuffer!==t){this._program=t.isAnimated()?this._animationProgram:this._staticProgram;this._dataBuffer=t;this._dataBufferChanged=true;if(t.hasSideData()&&!this._sideGlBuffer){this._sideGlBuffer=this._gl.createBuffer()}else if(!t.hasSideData()&&this._sideGlBuffer){this._gl.deleteBuffer(this._sideGlBuffer);this._sideGlBuffer=null}}};Po.prototype.markAsUnused=function e(){this._used=false;return this};Po.prototype.getProgram=function e(){return this._program};Po.prototype.markAsUsed=function e(){this._used=true;return this};Po.prototype.isUsed=function e(){return this._used};Po.prototype.draw=function e(){var t=this._gl;var r=this._dataBuffer.getElementType();var i=r===Di;var n=i?this._dataBuffer.getNbSideElementsPerMainElement():1;var a=r===Bi?zn:1;var o=this._dataBuffer.getSize();var s=this._dataBuffer.getStencilUsage();var u=this._dataBuffer.getVersion();var l=this._version!==u||this._dataBufferChanged;this._program.setupBaseAttributes({glBuffer:this._glBuffer,dataBuffer:l?this._dataBuffer.getByteArray():null,divisor:n});this._program.setupTextAttributes({glBuffer:this._sideGlBuffer,dataBuffer:l&&i?this._dataBuffer.getSideByteArray():null,divisor:1});this._program.setupStencil(s);if(l){this._version=u;this._dataBufferChanged=false}this._ext.drawArraysInstancedANGLE(t.TRIANGLES,0,6*a,o*n)};Po.prototype.destroy=function e(){this._gl.deleteBuffer(this._glBuffer);if(this._sideGlBuffer){this._gl.deleteBuffer(this._sideGlBuffer)}};function Oo(e,t){if(t<2){return e}var r=e.split("\n");var i=[];for(var n=0;n<r.length;++n){var a=r[n];if(a.length<t){i.push(a)}else{var o=Do(r[n],t);for(var s=0;s<o.length;++s){i.push(o[s])}}}return i.join("\n")}function Do(e,t){var r=e.split(" ");var i=[];var n=0;var a=-1;var o=[];var s=true;for(var u=0;u<r.length;++u){if(s){if(r[u].length>t){var l=Bo(r[u],t);for(var d=0;d<l.length;++d){i.push([l[d]]);++a}n=l[l.length-1].length}else{i.push([r[u]]);++a;n=r[u].length+1}s=false}else if(n+r[u].length<=t){i[a].push(r[u]);n+=r[u].length+1}else{s=true;--u}}for(var u=0;u<i.length;++u){o.push(i[u].join(" "))}return o}function Bo(e,t){var r=[];for(var i=0;i<e.length;i+=t-1){r.push(e.substr(i,t-1)+"-")}var n=r[r.length-1].length;r[r.length-1]=r[r.length-1].substr(0,n-1)+" ";return r}function Vo(e,t){if(e===null){return null}e=e.toString();var r=e.split("\n");var i=[];var n=0;for(var a=0;a<r.length;a++){var o=r[a];if(!t||t<=1||o.length<t){i.push(o);n=Math.max(n,o.length)}else{var s=Do(r[a],t);for(var u=0;u<s.length;u++){o=s[u];i.push(o);n=Math.max(n,o.length)}}}return{data:i,maxLength:n,lines:i.length}}function jo(){var e=m("@mapbox/mapbox-gl-rtl-text")||m("mapbox-gl-rtl-text");var t=typeof window!=="undefined";var r=e?e.processBidirectionalText:t?window.processBidirectionalText:null;var i=e?e.applyArabicShaping:t?window.applyArabicShaping:null;return{processBidirectionalText:r?function(e){return r(e,[]).join("")}:function(e){return e},applyArabicShaping:i?function(e){if(e===null){return null}else if(typeof e==="number"){return e.toString()}else{return i(e)}}:function(e){return e===null?null:e.toString()}}}var Uo=N();var Go="\n".charCodeAt(0);var qo=4;var Ho=12;var Wo=25;var Xo=511/Wo;var Yo=3;var Zo=function(){function e(e){this._patternManager=e;this._canvas=Se();this._ctx=this._canvas.getContext("2d");this._processBidirectionalText=jo().processBidirectionalText;this._textPattern={id:0,type:Wi,attributes:{text:"",font:"",size:0,style:"normal",align:"center"},dimensions:{width:0,height:0}};this._textDimensions={width:0,height:0};this._lineWidthList=new Array(64);this._init_()}e.prototype._init_=function(){this._mustClear=false;this._byFont={};this._widthAtlases={normal:{},bold:{},italic:{}}};e.prototype.reset=function(){this._init_()};e.prototype.clear=function(){this._mustClear=true};e.prototype._measureChar=function(e,t,r){Ye(this._ctx,t,Ho,r);return this._ctx.measureText(e).width/Ho};e.prototype._getAtlas=function(e,t,r){var i=r==="sdf"?0:r;var n=this._byFont[e]||(this._byFont[e]={});var a=n[t]||(n[t]=new Array(50));var o=a[i]||(a[i]=new Array(256));return o};e.prototype._getMeasurementAtlas=function(e,t){var r=this._widthAtlases[t];var i=r[e]||(r[e]=new Array(256));return i};e.prototype.measureText=function(e,t,r,i){if(i===void 0){i=1}if(!t){this._textDimensions.width=0;this._textDimensions.height=0;return this._textDimensions}var n=this._getMeasurementAtlas(t,r);var a=0,o=0;var s=1;for(var u=0;u<e.length;++u){var l=e.charCodeAt(u);if(l===Go){if(o>a){a=o}o=0;s+=1}else{var d=n[l];if(d===undefined){d=this._measureChar(e[u],t,r);n[l]=d}o+=d}}if(o>a){a=o}this._textDimensions.width=a*i;this._textDimensions.height=s*i;return this._textDimensions};e.prototype._getCharInfo=function(e,t,r,i,n,a){var o=e[t];if(!o){var s=String.fromCharCode(t);var u=n==="sdf"?1:Yo;o={ratio:this._measureChar(s,r,i),patternId:new Array(u)};for(var l=0;l<u;++l){var d=l/u;o.patternId[l]=this._patternManager.getIdFromDefinition({id:0,type:Ui,attributes:{text:s,font:r,style:i,size:n,align:a,offset:d}})}e[t]=o}return o};e.prototype.storeTextInDataView=function(e,t,r,i){var n=t;if(i&&i.type===Wi){var a=i.attributes,o=a.text,s=a.font,u=a.style,l=a.size,d=a.align;var h=d==="center";var f=this._getAtlas(s,u,l);var c=0;var v=1;var p=0;var g=0;var _=this._lineWidthList;o=this._processBidirectionalText(o);for(var m=0;m<o.length;++m){var y=o.charCodeAt(m);if(y===Go){if(p>c){c=p}_[g]=p;g+=1;p=0;v+=1}else{var b=this._getCharInfo(f,y,s,u,l,d);p+=b.ratio}}_[g]=p;if(p>c){c=p}if(l==="sdf"){var x=0;var A=-(h?_[x]:c)/2;var E=(-v+1)/2;var S=0;for(var m=0;m<o.length;++m){var y=o.charCodeAt(m);var b=f[y];if(y===Go){x+=1;A=-(h?_[x]:c)/2;E+=1;S=0}else{var w=b.ratio;var T=b.patternId[0];A+=(w+S)/2;S=w;var C=Qo(A*Xo);var I=Ko(E*2);e.setUint16(n,T,Uo);e.setUint16(n+2,(C<<6)+I,Uo);n+=qo}}}else{var M=0;var A=Math.ceil(-(h?_[M]:c)*l/2);var E=(-v+1)/2;for(var m=0;m<o.length;++m){var y=o.charCodeAt(m);var b=f[y];if(y===Go){M+=1;A=Math.ceil(-(h?_[M]:c)*l/2);E+=1}else{var L=b.ratio*l;var k=Math.floor(A);var N=A-k;var F=Math.round(N*Yo);if(F===Yo){F=0;k+=1}k+=Math.ceil(L/2);A+=L;var T=b.patternId[F];var C=Qo(k);var I=Ko(E*2);e.setUint16(n,T,Uo);e.setUint16(n+2,(C<<6)+I,Uo);n+=qo}}}}this._fillWithZeros(e,n,r)};e.prototype.extractTextFromDataView=function(e,t,r){var i=e;var n=Uo;var a=i.getUint16(t,n);var o=this._textPattern;var s=this._patternManager.getDefinitionFromId(a);var u=s.attributes,l=u.font,d=u.style,h=u.size,f=u.align;var c=this._getAtlas(l,d,h);var v=[];var p=0;var g=0;var _=0;var m=null;for(var y=t;y<r;y+=qo){var b=i.getUint16(y,n);if(!b){break}var x=Jo(i.getUint16(y+2,n)%64);var A=this._patternManager.getDefinitionFromId(b);if(!A){break}var E=A.attributes.text.charCodeAt(0);var S=c[E];if(m===null){m=x}else if(x>m){if(p>g){g=p}p=0;_+=1;v.push(Go);m=x}v.push(E);if(S){p+=S.ratio}}if(p>g){g=p}var w=String.fromCharCode.apply(null,v);o.attributes.style=d;o.attributes.font=l;o.attributes.size=h;o.attributes.align=f;o.attributes.text=this._processBidirectionalText(w);o.dimensions.width=g;o.dimensions.height=_;return o};e.prototype._fillWithZeros=function(e,t,r){for(var i=t;i<r;i+=qo){e.setUint16(i,0)}};e.prototype._clear=function(){this._byFont={};this._widthAtlases={normal:{},bold:{},italic:{}}};e.prototype.update=function(){if(this._mustClear){this._clear();this._mustClear=false}};e.prototype.getVersion=function(){};return e}();function Ko(value){return Jt(value+32,0,63)}function Qo(value){return Jt(value+512,0,1023)}function Jo(value){return value-32}function $o(){return typeof window!=="undefined"&&window.FORCE_WEBGL}var es=ce();var ts={stencil:true,antialias:false,alpha:true,premultipliedAlpha:true,failIfMajorPerformanceCaveat:!$o()};var rs=0;var is=1;var ns={NO_WEBGL:'Unable to create a WebGL context: `canvas.getContext("webgl")` and `canvas.getContext("experimental-webgl")` returned `null`',NO_ANGLE_INSTANCED_ARRAYS:'WebGL extension "ANGLE_instanced_arrays" unavailable: `gl.getExtension("ANGLE_instanced_arrays")` returned `null`'};function as(value,e){if(!value){var t=new Error(ns[e]);t.code=e;throw t}}var os=function(e){function t(r){e.call(this,r);var i=r.initData||t.createInitData();var n=i.canvas;var a=i.gl;var o=i.ext;var s=i.staticProgramWrapper;var u=i.animationProgramWrapper;as(a,"NO_WEBGL");as(o,"NO_ANGLE_INSTANCED_ARRAYS");this._glCanvas=n;this._gl=a;this._ext=o;this._staticProgramWrapper=s;this._animationProgramWrapper=u;this._shapeTexture=new ta(this._gl,rs);this._patternTexture=new Lo(this._gl,is);this._2dcanvas=Se();this._ctx=this._2dcanvas.getContext("2d");this._glCanvas.style.imageRendering="pixelated";this._initCanvas(this._glCanvas);this._glBuffers=[];this._staticProgram=null;this._animationProgram=null;this._currentProgram=null;this._specialGlBuffers=null;this._shaderMetadata=null;this._mustResize=false;this._computeShaderInfo();this._initSpecialGlBuffers();this._initGlPrograms();this._initGl()}if(e)t.__proto__=e;t.prototype=Object.create(e&&e.prototype);t.prototype.constructor=t;t.isAvailable=function e(){return es};t.createInitData=function e(){var t=Se();var r=ve(t,ts);var i=r&&typeof r.getExtension==="function"?r.getExtension("ANGLE_instanced_arrays"):null;var n=ds();var a=new $n(r,{vertex:Qn,fragment:Jn,constants:n,macros:{ANIMATED:0}});var o=new $n(r,{vertex:Qn,fragment:Jn,constants:n,macros:{ANIMATED:1}});if(r&&i){a.compile();r.flush()}return{canvas:t,gl:r,ext:i,staticProgramWrapper:a,animationProgramWrapper:o}};t.getName=function e(){return"WebGL"};t.prototype._afterFirstFrame=function e(){if(this._animationProgramWrapper.getState()==="init"){this._animationProgramWrapper.compile()}};t.prototype.ensureAnimationsReady=function e(){var t=this._animationProgramWrapper.getState();if(t!=="done"){if(t==="init"){this._animationProgramWrapper.compile()}this._animationProgramWrapper.getError()}};t.prototype.getDomElement=function e(){return this._glCanvas};t.prototype._initGl=function e(){var t=this._gl;t.clearColor(0,0,0,0);t.enable(t.BLEND);t.blendFunc(t.ONE,t.ONE_MINUS_SRC_ALPHA)};t.prototype._computeShaderInfo=function e(){this._shaderMetadata=ss(Qn,Jn)};t.prototype._initGlPrograms=function e(){this._staticProgram=new Ro({gl:this._gl,ext:this._ext,specialGlBuffers:this._specialGlBuffers,metaData:this._shaderMetadata,programWrapper:this._staticProgramWrapper});this._animationProgram=new Ro({gl:this._gl,ext:this._ext,specialGlBuffers:this._specialGlBuffers,metaData:this._shaderMetadata,programWrapper:this._animationProgramWrapper})};t.prototype._initSpecialGlBuffers=function e(){var t=this._gl;var r=t.createBuffer();var i=new Int8Array(18*zn);for(var n=0;n<zn;++n){var a=n;var o=[-1,-1,a,1,-1,a,1,1,a,-1,-1,a,-1,1,a,1,1,a];var s=n*o.length;for(var u=0;u<o.length;u++){i[u+s]=o[u]}}t.bindBuffer(t.ARRAY_BUFFER,r);t.bufferData(t.ARRAY_BUFFER,i,t.STATIC_DRAW);this._specialGlBuffers={vertexInfo:r}};t.prototype._computeUniforms=function e(){return{viewWidth:this._width,viewHeight:this._height,viewX:this._viewX,viewY:this._viewY,viewZoom:this._viewZoom,viewAngle:this._viewAngle,currentTime:this._currentTime,pixelRatio:this._pixelRatio,backgroundColor:this._backgroundRgba,patternInfoTexture:this._patternTexture.getInfoTextureUnit(),patternNearestTexture:this._patternTexture.getNearestTextureUnit(),patternLinearTexture:this._patternTexture.getLinearTextureUnit(),patternLinearSdfTexture:this._patternTexture.getLinearSdfTextureUnit(),patternMipmapTexture:this._patternTexture.getMipmapTextureUnit(),shapeTexture:this._shapeTexture.getTextureUnit(),BYTES_TO_COORD:this._bytesToActualCoord,BYTES_TO_SCALED_SIZE:this._bytesToActualScaledSize,BYTES_TO_MIN_VISIBLE_SIZE:this._bytesToActualMinVisibleSize,BYTES_TO_SYMBOLIC_SIZE:this._bytesToActualSymbolicSize,BYTES_TO_DASH_LENGTH:this._bytesToActualDashLength,BYTES_TO_GAP_LENGTH:this._bytesToActualGapLength,BYTES_TO_PATTERN_SCALE:this._bytesToActualPatternScale,PATTERN_INFO_TEXTURE_SIZE:this._patternTexture.getInfoTextureSize(),PATTERN_NEAREST_TEXTURE_SIZE:this._patternTexture.getNearestTextureSize(),PATTERN_LINEAR_TEXTURE_SIZE:this._patternTexture.getLinearTextureSize(),PATTERN_LINEAR_SDF_TEXTURE_SIZE:this._patternTexture.getLinearSdfTextureSize(),PATTERN_MIPMAP_TEXTURE_SIZE:this._patternTexture.getMipmapTextureSize(),PATTERN_POSITION_GRANULARITY:this._patternTexture.getGranularity(),SHAPE_TEXTURE_SIZE:this._shapeTexture.getTextureSize(),SHAPE_SAMPLING_SIZE:this._shapeTexture.getSamplingSize(),SHAPE_SAMPLING_BUFFER_RATIO:this._shapeTexture.getBufferRatio(),NB_SHAPES_BY_SIDE:this._shapeTexture.getTextureSize()/this._shapeTexture.getSamplingSize(),SHAPE_DIMENSIONS:this._shapeTexture.getSamplingSize()/this._shapeTexture.getTextureSize(),SHAPE_ACTUAL_RATIO:1-this._shapeTexture.getBufferRatio()}};t.prototype._render=function e(t){var r=t.shapesChanged;var i=t.patternsChanged;var n=t.dimensionsChanged;var a=t.backgroundColorChanged;var o=this._gl;if(r){this._shapeTexture.refresh(this._shapeManager);this._patternTexture.bindMetDataTexture()}if(i){this._patternTexture.refresh(this._patternManager)}if(n){this._mustResize=true}if(a){var s=this._renderBackground?this._backgroundRgba:[0,0,0,0];var u=s[0];var l=s[1];var d=s[2];var h=s[3];o.clearColor(u*h,l*h,d*h,h)}var f=this._computeUniforms();var c=this._startFrame();if(this._mustResize&&c.length){ke(this._glCanvas,this._width,this._height,this._pixelRatio);o.viewport(0,0,this._width*this._pixelRatio,this._height*this._pixelRatio);this._mustResize=false}o.clear(o.COLOR_BUFFER_BIT|o.STENCIL_BUFFER_BIT);for(var v=0;v<c.length;++v){this._displayBuffer(c[v],f)}this._endFrame()};t.prototype._displayBuffer=function e(t,r){var i=t.getProgram();if(i!==this._currentProgram){if(this._currentProgram){this._currentProgram.endPass()}this._currentProgram=i;this._currentProgram.startPass(r)}t.markAsUsed();t.draw()};t.prototype._startFrame=function e(){var t=this._bufferList.getBuffersByAscendingDepth();var r=[];for(var i=0;i<this._glBuffers.length;++i){var n=this._glBuffers[i];if(n){n.markAsUnused()}}for(var a=0;a<t.length;++a){var o=t[a];var s=this._getAssociatedGlBuffer(o);s.markAsUsed();if(!o.isEmpty()&&this._isBufferDisplayable(o)){r.push(s)}}for(var u=0;u<this._glBuffers.length;++u){var l=this._glBuffers[u];if(l&&!l.isUsed()){l.destroy();this._glBuffers[u]=undefined}}return r};t.prototype._endFrame=function e(){if(this._currentProgram){this._currentProgram.endPass();this._currentProgram=null}};t.prototype._getAssociatedGlBuffer=function e(t){var r=t.getId();var i=this._glBuffers[r];if(!i){while(this._glBuffers.length<=r){this._glBuffers.push(undefined)}i=new Po({gl:this._gl,ext:this._ext,staticProgram:this._staticProgram,animationProgram:this._animationProgram});this._glBuffers[r]=i}i.setDataBuffer(t);return i};t.prototype.destroy=function e(){var t=this._gl.getExtension("WEBGL_lose_context");if(t){t.loseContext()}};t.prototype.getImageData=function e(){var t=this._glCanvas.width;var r=this._glCanvas.height;if(this._2dcanvas.width<t||this._2dcanvas.height<r){this._2dcanvas.width=t;this._2dcanvas.height=r}this._ctx.drawImage(this._glCanvas,0,0);return this._ctx.getImageData(0,0,t,r)};t.prototype._getImageDataFlippedYAxis=function e(){var t=this._gl;var r=this._glCanvas.width;var i=this._glCanvas.height;var n=this._ctx.createImageData(r,i);var a=new Uint8Array(n.data.buffer);t.readPixels(0,0,r,i,t.RGBA,t.UNSIGNED_BYTE,a);return n};return t}(Zn);function ss(e,t){var r={vertexInfoAttribute:"a_vertexInfo",attributes:[],uniforms:[]};ls(r,e);ls(r,t);return r}var us={float:1,vec2:2,vec3:3,vec4:4};function ls(e,t){var r=/(?:attribute\s+\/\*\s*(byte|ubyte|short|ushort|float)\s*\*\/\s*(float|vec2|vec3|vec4)\s+(\w+)\s*;)|(?:#if\s*(\w+))|(?:#endif)/g;var i=/uniform\s+(float|vec2|vec3|vec4|sampler2D|int)\s+(\w+)\s*;/g;var n=[];var a=r.exec(t);while(a){var o=a[0];if(o==="#endif"){n.pop()}else if(o.startsWith("#if")){n.push(a[4])}else{e.attributes.push({name:a[3],size:us[a[2]],type:a[1],tags:n.slice()})}a=r.exec(t)}a=i.exec(t);while(a){if(!e.uniforms.some(function(e){var t=e.id;return t===a[1]})){var s=a[1];var u=a[2];var l=u.replace("u_","");e.uniforms.push({id:l,name:u,type:s})}a=i.exec(t)}}function ds(){return{BYTES_TO_OFFSET_ANGLE:Math.PI*2/8,BYTES_TO_COLOR:1/15,SDF_FONT_SIZE:lo,CURVATURE_RATIO:Rn,PATTERN_MARGIN:En,TEXT_WIDTH_MULTIPLIER:In,TEXT_HEIGHT_MULTIPLIER:Cn,SELF_LOOP_CURVATURE_MULTIPLIER:Pn,EDGE_ARROW_SIZE_RATIO:Fn,NB_PIECES_PER_CURVE:zn,PIECE_NODE_COMPONENT:Xi,PIECE_EDGE_BODY:Yi,PIECE_EDGE_HEAD:Zi,PIECE_EDGE_TAIL:Ki,PIECE_EDGE_TEXT:Qi,MAX_TEXT_SIZE:Wo,BYTES_TO_TEXT_OFFSET:1/Xo,FILTER_NEAREST:yo,FILTER_LINEAR:bo,FILTER_LINEAR_SDF:xo,FILTER_MIPMAP:Ao,SHAPE_TEXTURE_SIZE:xn,SIMPLE_SHAPE_SAMPLING_SIZE:gn,COMPLEX_SHAPE_SAMPLING_SIZE:_n,SHAPE_SAMPLING_BUFFER_RATIO:yn,MAX_NB_SHAPES:pn.toString(),FIRST_COMPLEX_SHAPE_ID:mn,SELF_LOOP_TO_CIRCLE_APPROX:On}}var hs=0;var fs=1;var cs=2;var vs=3;var ps=4;var gs=5;var _s=6;var ms=7;var ys=8;var bs=9;var xs=10;var As=0;var Es=1;var Ss=2;var ws=3;var Ts=0;var Cs=1;var Is=2;var Ms=3;var Ls=4;var ks=5;var Ns=6;var Fs=1e-6;var zs=Math.PI;var Rs=Math.PI*2;var Ps=zs*(5/4);var Os=zs*(7/4);var Ds=zs*(3/4);var Bs=zs*(1/4);var Vs=1.1;var js=.07;var Us=1;var Gs=1;var qs=.17;var Hs=1;var Ws=-zs/2;var Xs=zs/2;var Ys=2/3;var Zs={plain:{dash:0,gap:0},dashed:{dash:3,gap:1},dotted:{dash:1,gap:3}};var Ks={right:0,top:-Math.PI/2,left:Math.PI,bottom:Math.PI/2,center:0};var Qs={right:Math.PI,top:-Math.PI/2,left:0,bottom:Math.PI/2,center:0};function Js(e,t,r,i,n){var a=1-n;var o=a*a*a;var s=3*n*a*a;var u=3*n*n*a;var l=n*n*n;return o*e+s*t+u*r+l*i}function $s(e,t,r,i){var n=1-i;return n*n*e+2*n*i*t+i*i*r}function eu(e,t,r,i,n,a){var o=a||{x:0,y:0};var s=(e+r)/2;var u=(t+i)/2;var l=e-r;var d=t-i;var distance=Math.sqrt(l*l+d*d);if(distance===0){o.x=s;o.y=u;return o}var h=d/distance;var f=-l/distance;var c=-distance*n/Rn;o.x=s+h*c;o.y=u+f*c;return o}function tu(e,t,r,i,n,a){var o=a||{x1:0,y1:0,x2:0,y2:0};var distance=i+i/Pn*r;var s=distance*Pn;var u=-n+zs;var l=-n+zs/2;o.x1=e+Math.cos(u)*s;o.y1=t+Math.sin(u)*s;o.x2=e+Math.cos(l)*s;o.y2=t+Math.sin(l)*s;return o}var ru=1/zn;var iu=function(e){function t(t){e.call(this,t);this._cachePoints=[];this._nextCachePoint=0;this._tmp={x1:0,y1:0,x2:0,y2:0};this._pointCopies=new Array(128);this._renderInfo={bounds:[]};this._clipViewport=true}if(e)t.__proto__=e;t.prototype=Object.create(e&&e.prototype);t.prototype.constructor=t;t.prototype._resetCachePoints=function e(){this._nextCachePoint=0};t.prototype._point=function e(t,r){var i=this._cachePoints[this._nextCachePoint++];if(!i){i={x:0,y:0};this._cachePoints.push(i)}i.x=t;i.y=r;return i};t.prototype.setViewportClipping=function e(t){this._clipViewport=t};t.prototype._getShapePoints=function e(t){return this._shapeManager.getDefinitionFromName(t).points};t.prototype._formatAngle=function e(t){if(t<-Math.PI){return t+Math.PI*2}else if(t>Math.PI){return t-Math.PI*2}else{return t}};t.prototype._computeSymbolicSize=function e(t){return t===0?Infinity:t*this._viewZoom};t.prototype._computeAnimationRatio=function e(t){var r=t.beginTime;var i=t.duration;var n=t.easing;var a=(this._currentTime-r)/i;var o=a*a;var s=o*a;var u=this._easingManager.getPolygonFromName(n);var l=a<.5?0:4;var d=u[l];var h=u[l+1];var f=u[l+2];var c=u[l+3];return Jt(d+h*a+f*o+c*s,0,1)};t.prototype._mix=function e(t,r,i){return t*(1-i)+r*i};t.prototype._mixColor=function e(t,r,i,n){if(t===r){return t}var a=this._colorManager.parseColor(t);var o=this._colorManager.parseColor(r);var s=Math.round(er(a[0],o[0],i)*255);var u=Math.round(er(a[1],o[1],i)*255);var l=Math.round(er(a[2],o[2],i)*255);var d=er(a[3],o[3],n);return"rgba("+s+","+u+","+l+","+d+")"};t.prototype._displayBuffer=function e(t){var r=t.getSize();var i=t.isAnimated();for(var n=0;n<r;++n){var a=this.extractElement(t,n);if(!a.valid){continue}this._displayElement(a,i)}};t.prototype._mixAttributes=function e(t,r,i){var n=this._computeAnimationRatio(i);t.dashLength=er(r.dashLength,t.dashLength,n);t.gapLength=er(r.gapLength,t.gapLength,n);t.offsetAngle=er(r.offsetAngle,t.offsetAngle,n);t.opacity=er(r.opacity,t.opacity,n);t.globalMinVisibleSize=er(r.globalMinVisibleSize,t.globalMinVisibleSize,n);t.strokeMinVisibleSize=er(r.strokeMinVisibleSize,t.strokeMinVisibleSize,n);t.patternMinVisibleSize=er(r.patternMinVisibleSize,t.patternMinVisibleSize,n);t.symbolicSize=er(r.symbolicSize,t.symbolicSize,n);t.curvature=er(r.curvature,t.curvature,n);t.fillColor=this._mixColor(r.fillColor,t.fillColor,n,n);t.strokeColor=this._mixColor(r.strokeColor,t.strokeColor,n,n);t.patternColor=this._mixColor(r.patternColor,t.patternColor,n,n);t.x1=er(r.x1,t.x1,n);t.y1=er(r.y1,t.y1,n);t.x2=er(r.x2,t.x2,n);t.y2=er(r.y2,t.y2,n);t.rectWidthOrSourceRadiusScaled=er(r.rectWidthOrSourceRadiusScaled,t.rectWidthOrSourceRadiusScaled,n);t.rectWidthOrSourceRadiusFixed=er(r.rectWidthOrSourceRadiusFixed,t.rectWidthOrSourceRadiusFixed,n);t.rectHeightOrTargetRadiusScaled=er(r.rectHeightOrTargetRadiusScaled,t.rectHeightOrTargetRadiusScaled,n);t.rectHeightOrTargetRadiusFixed=er(r.rectHeightOrTargetRadiusFixed,t.rectHeightOrTargetRadiusFixed,n);t.thicknessOrFontSizeScaled=er(r.thicknessOrFontSizeScaled,t.thicknessOrFontSizeScaled,n);t.thicknessOrFontSizeFixed=er(r.thicknessOrFontSizeFixed,t.thicknessOrFontSizeFixed,n);t.strokeWidthScaled=er(r.strokeWidthScaled,t.strokeWidthScaled,n);t.strokeWidthFixed=er(r.strokeWidthFixed,t.strokeWidthFixed,n);t.offsetScaled=er(r.offsetScaled,t.offsetScaled,n);t.offsetFixed=er(r.offsetFixed,t.offsetFixed,n);return t};t.prototype._computeRenderInfo=function e(t){var r=this._renderInfo;var i=this._viewZoom;r.shape=this._shapeManager.getDefinitionFromName(t.shape);r.pieceId=t.pieceId;r.dashLength=t.dashLength;r.gapLength=t.gapLength;r.hasHead=t.hasHead;r.hasTail=t.hasTail;r.isBodyTriangle=t.isBodyTriangle;r.isSelfLoop=t.isSelfLoop;r.patternScale=t.patternScale;r.offsetAngle=this._formatAngle(t.offsetAngle);r.isText=t.isText;r.adjustTextAngle=t.adjustTextAngle;r.unusedFlag1=t.unusedFlag1;r.unusedFlag2=t.unusedFlag2;r.unusedFlag3=t.unusedFlag3;r.opacity=t.opacity;r.globalMinVisibleSize=t.globalMinVisibleSize;r.strokeMinVisibleSize=t.strokeMinVisibleSize;r.patternMinVisibleSize=t.patternMinVisibleSize;r.symbolicSize=t.symbolicSize===0?Infinity:t.symbolicSize*i;r.curvature=t.curvature;r.pattern=t.pattern;r.fillColor=t.fillColor;r.strokeColor=t.strokeColor;r.patternColor=t.patternColor;r.pos1OnGraph=this._point(t.x1,t.y1);r.pos2OnGraph=this._point(t.x2,t.y2);r.pos1=this._graphToScreenCoordinates(r.pos1OnGraph);r.pos2=this._graphToScreenCoordinates(r.pos2OnGraph);r.rectWidthOrSourceRadius=t.rectWidthOrSourceRadiusScaled*i+t.rectWidthOrSourceRadiusFixed;r.rectHeightOrTargetRadius=t.rectHeightOrTargetRadiusScaled*i+t.rectHeightOrTargetRadiusFixed;r.thicknessOrFontSize=t.thicknessOrFontSizeScaled*i+t.thicknessOrFontSizeFixed;r.strokeWidth=t.strokeWidthScaled*i+t.strokeWidthFixed;r.offset=t.offsetScaled*i+t.offsetFixed;return r};t.prototype._applyBackgroundBlending=function e(t){if(t.opacity!==1){t.fillColor=this._blendColor(t.fillColor,t.opacity);t.strokeColor=this._blendColor(t.strokeColor,t.opacity);t.textColor=this._blendColor(t.textColor,t.opacity)}};t.prototype._pointArray=function e(t){var r=this._pointCopies[t];if(!r){r=new Array(t);this._pointCopies[t]=r;for(var i=0;i<t;++i){r[i]={x:0,y:0,r:0}}}return r};t.prototype._scalePoints=function e(t,r,i,n){var a=t.shape.points.length;var o=this._pointArray(a);for(var s=0;s<a;++s){var u=t.shape.points[s];var l=o[s];l.x=r.x+u.x*i;l.y=r.y+u.y*n;l.r=u.r*i}var d=t.pos2OnGraph.x-t.pos1OnGraph.x;var h=t.pos2OnGraph.y-t.pos1OnGraph.y;if(d!==0||h!==0){var f=Math.sqrt(d*d+h*h);var c=d/f;var v=h/f;for(var p=0,g=o;p<g.length;p+=1){var _=g[p];var m=_.x-r.x;var y=_.y-r.y;_.x=r.x+c*m+v*y;_.y=r.y-v*m+c*y}}return o};t.prototype._drawPoints=function e(t){if(t.length===1){this._drawCircle(t[0],t[0].r)}else{this._drawPolygon(t)}};t.prototype._computeCenter=function e(t){var r=Math.cos(t.offsetAngle);var i=Math.sin(t.offsetAngle);var n=(t.pos1.x+t.pos2.x)/2+r*t.offset;var a=(t.pos1.y+t.pos2.y)/2+i*t.offset;return this._point(n,a)};t.prototype._displayNodeComponent=function e(t,r,i,n){var a=this;var o=this._computeCenter(t);if(t.pattern.type!==Wi){var s=t.rectWidthOrSourceRadius/2;var u=t.rectHeightOrTargetRadius/2;var l=this._scalePoints(t,o,s,u);if(r||n){this._drawPoints(l)}if(r){this._fill(t.fillColor)}if(n){this._startClip();if(t.pattern.type===Gi){var d=t.pattern.attributes.colorArray;if(t.opacity!==1){d=d.map(function(e){return a._blendColor(e,t.opacity)})}this._displayPieChart(o,s,d)}else if(t.pattern.type===qi||t.pattern.type===Hi){var h=0;var f=Math.round(t.rectHeightOrTargetRadius*t.patternScale);var c=t.pattern.attributes.text;var v=t.patternColor;var p=t.pattern.attributes.font;var g=t.pattern.attributes.style;var _=t.pattern.attributes.align;var m=t.rectWidthOrSourceRadius;this._displayText(o,h,c,v,p,f,g,_,m)}else if(t.pattern.type===ji){var y=t.pattern.attributes.image;if(y.isDummy||y.width&&y.height){var b=t.pattern.attributes.duplicated;var x=b?1:t.patternScale;var A=t.rectWidthOrSourceRadius*x;var E=t.rectHeightOrTargetRadius*x;var S=t.pattern.attributes.scaled;var w=t.opacity;this._displayImage(o,A,E,y,S,b,w)}}this._endClip()}if(i){var T=t.strokeWidth/2;var C=this._scalePoints(t,o,s+T,u+T);this._drawPoints(C);this._stroke(t.strokeColor,t.strokeWidth)}}else if(n){var I=0;var M=t.thicknessOrFontSize;var L=t.pattern.attributes.text;var k=t.patternColor;var N=t.pattern.attributes.font;var F=t.pattern.attributes.style;var z=t.pattern.attributes.align;var R=t.rectWidthOrSourceRadius;this._displayText(o,I,L,k,N,M,F,z,R)}};t.prototype._displayElement=function e(t,r){if(!t.end.shape||!t.end.pieceId){return}this._resetCachePoints();var i=r?this._mixAttributes(t.end,t.start,t.animation):t.end;var n=this._computeRenderInfo(i);if(n.symbolicSize<n.globalMinVisibleSize||n.opacity===0){return}this._applyBackgroundBlending(n);var a=n.strokeColor&&n.strokeWidth>0&&n.symbolicSize>=n.strokeMinVisibleSize;var o=n.pattern.type!==Vi&&n.symbolicSize>=n.patternMinVisibleSize;var s=!!n.fillColor;if(n.pieceId===Xi){this._displayNodeComponent(n,s,a,o)}else{var u=n.pos2.x-n.pos1.x;var l=n.pos2.y-n.pos1.y;var d=Math.sqrt(u*u+l*l);var h=null;var f=null;var c=null;if(n.isSelfLoop){var v=n.pieceId===Qi?n.strokeWidth/2:n.rectWidthOrSourceRadius;var p=this._getSelfLoopControlPoints(n.pos1,n.curvature,v);var g=p.x1;var _=p.y1;var m=p.x2;var y=p.y2;h=this._point(g,_);f=this._point(m,y);c=au(n.pos1,h,f,n.pos2,1)}else if(n.curvature){h=this._getQuadraticCurveControlPoint(n);c=nu(n.curvature,d,1)}else{c=d}if(n.pieceId===Qi){var b=n.strokeWidth;var x=this._getPointOnLine(n.pos1,h,f,n.pos2,.5);var A=this._getTangentOnLine(n.pos1,h,f,n.pos2,.5);if(n.adjustTextAngle&&!n.isSelfLoop&&n.rectWidthOrSourceRadius>=c-b){A.x=1;A.y=0;n.offset=0}var E=-Math.atan2(A.y,A.x);var S=this._formatAngle(n.offsetAngle-E);if(!n.isSelfLoop&&S<0||n.isSelfLoop&&n.offsetAngle<0){A.x*=-1;A.y*=-1}if(E>Math.PI/2||E<-Math.PI/2){E+=Math.PI}var w=this._getOrthogonal(A);var T=x.x+w.x*n.offset;var C=x.y+w.y*n.offset;if(n.fillColor){var I=this._pointArray(4);var M=n.rectWidthOrSourceRadius/2;var L=n.rectHeightOrTargetRadius/2;var k=A.x*M;var N=A.y*M;var F=w.x*L;var z=w.y*L;var R=I[0];var P=I[1];var O=I[2];var D=I[3];R.x=T+k+F;R.y=C+N+z;P.x=T+k-F;P.y=C+N-z;O.x=T-k-F;O.y=C-N-z;D.x=T-k+F;D.y=C-N+z;this._drawPoints(I);this._fill(n.fillColor)}else{var B=this._point(T,C);var V=E;var j=n.thicknessOrFontSize;var U=n.pattern.attributes.text;var G=n.patternColor;var q=n.pattern.attributes.font;var H=n.pattern.attributes.style;var W=n.pattern.attributes.align;var X=n.rectWidthOrSourceRadius;this._displayText(B,V,U,G,q,j,H,W,X)}}else{var Y=n.pieceId===Zi;var Z=n.pieceId===Ki;var K=Math.cos(n.offsetAngle);var Q=Math.sin(n.offsetAngle);n.pos1.x+=K*n.offset;n.pos1.y+=Q*n.offset;n.pos2.x+=K*n.offset;n.pos2.y+=Q*n.offset;var J=n.shape.name==="line";var $=n.thicknessOrFontSize;var ee=n.rectWidthOrSourceRadius;var te=n.rectHeightOrTargetRadius;var re=+n.hasHead;var ie=+n.hasTail;var ne=+n.isBodyTriangle;var ae=re+ie;var oe=ou($);var se=re*oe;var ue=ie*oe;var le=n.isSelfLoop?Infinity:d-ee-te;var de=Math.min(le/ae,oe);var he=oe+Math.max(ee+de-ue,0);var fe=ie*he+(1-ie)*ne*ee;var ce=oe+Math.max(te+de-se,0);var ve=re*ce+(1-re)*ne*te;if(Y||Z){var pe=Z?-1:1;var ge=(Y?c-ve:fe)-pe;var _e=null;var me=null;if(n.isSelfLoop){var ye=this._getTFromLengthOnCubicCurve(n.pos1,h,f,n.pos2,ge-n.strokeWidth/2*pe);_e=this._getPointOnCubicCurve(n.pos1,h,f,n.pos2,ye);me=this._getTangentOnCubicCurve(n.pos1,h,f,n.pos2,ye)}else if(n.curvature){var be=this._getTFromLengthOnQuadraticCurve(n.pos1,h,n.pos2,ge-n.strokeWidth/2*pe);_e=this._getPointOnQuadraticCurve(n.pos1,h,n.pos2,be);me=this._getTangentOnQuadraticCurve(n.pos1,h,n.pos2,be)}else{var xe=ge/c;_e=this._mixPoints(n.pos1,n.pos2,xe);me=this._point(u/d,l/d)}me.x*=pe;me.y*=pe;if(s){if(n.shape.hole){var Ae=this._makeEdgeExtremityPoints(_e,me,oe,n.shape.hole);this._drawPoints(Ae);this._startReverseClip()}var Ee=this._makeEdgeExtremityPoints(_e,me,oe,n.shape.points);this._drawPoints(Ee);this._fill(n.fillColor);if(n.shape.hole){this._endReverseClip()}}if(a){if(n.shape.hole){var Se=this._makeEdgeExtremityPoints(_e,me,oe,n.shape.hole);this._drawPoints(Se);this._stroke(n.strokeColor,n.strokeWidth)}var we=oe+n.strokeWidth/2;var Te=this._makeEdgeExtremityPoints(_e,me,we,n.shape.points);this._drawPoints(Te);this._stroke(n.strokeColor,n.strokeWidth)}}else{var Ce=c-fe-ve;if(Ce<=0){return}if(J){var Ie=this._computeLineDash(c,$,fe,ve,n.dashLength,n.gapLength);if(a){this._drawLine(n.pos1,h,f,n.pos2);this._stroke(n.strokeColor,$+n.strokeWidth*2,Ie)}if(s){this._drawLine(n.pos1,h,f,n.pos2);this._stroke(n.fillColor,$,Ie)}}else{var Me=fe;var Le=c-ve;if(a){var ke=this._makeTriangleEdgeBody(n.pos1,h,f,n.pos2,Me,Le,$+n.strokeWidth/2,n.strokeWidth/2);this._drawPoints(ke);this._stroke(n.strokeColor,n.strokeWidth)}if(s){var Ne=this._makeTriangleEdgeBody(n.pos1,h,f,n.pos2,Me,Le,$,0);this._drawPoints(Ne);this._fill(n.fillColor)}}}}}};t.prototype._makeTriangleEdgeBody=function e(t,r,i,n,a,o,s,u){if(!r){return this._makeStraightTriangleEdge(t,n,a,o,s,u)}else if(!i){return this._makeCurveTriangleEdge(t,r,n,a,o,s,u)}else{return this._makeSelfLoopTriangleEdge(t,r,i,n,a,o,s,u)}};t.prototype._makeCurveTriangleEdge=function e(t,r,i,n,a,o,s){var u=zn*2+2;var l=this._pointArray(u);var d=this._getTFromLengthOnQuadraticCurve(t,r,i,n);var h=this._getTFromLengthOnQuadraticCurve(t,r,i,a);var f=(h-d)/zn;var c=(s-o)/zn/2;var v=o/2;var p=d;for(var g=0;g<=zn;++g){var _=this._getPointOnQuadraticCurve(t,r,i,p);var m=this._getTangentOnQuadraticCurve(t,r,i,p);var y=this._getOrthogonal(m);var b=y.x*v;var x=y.y*v;var A=l[g];var E=l[u-1-g];A.x=_.x+b;A.y=_.y+x;E.x=_.x-b;E.y=_.y-x;p+=f;v+=c}return l};t.prototype._makeSelfLoopTriangleEdge=function e(t,r,i,n,a,o,s,u){var l=zn*2+2;var d=this._pointArray(l);var h=this._getTFromLengthOnCubicCurve(t,r,i,n,a);var f=this._getTFromLengthOnCubicCurve(t,r,i,n,o);var c=(f-h)/zn;var v=(u-s)/zn/2;var p=s/2;var g=h;for(var _=0;_<=zn;++_){var m=this._getPointOnCubicCurve(t,r,i,n,g);var y=this._getTangentOnCubicCurve(t,r,i,n,g);var b=this._getOrthogonal(y);var x=b.x*p;var A=b.y*p;var E=d[_];var S=d[l-1-_];E.x=m.x+x;E.y=m.y+A;S.x=m.x-x;S.y=m.y-A;g+=c;p+=v}return d};t.prototype._makeStraightTriangleEdge=function e(t,r,i,n,a,o){var s=r.x-t.x;var u=r.y-t.y;var l=Math.sqrt(s*s+u*u);var d=this._point(s/l,u/l);var h=this._getOrthogonal(d);var f=a/2;var c=o/2;var v=this._pointArray(4);var p=v[0];var g=v[1];var _=v[2];var m=v[3];var y=t.x+d.x*i;var b=t.y+d.y*i;var x=t.x+d.x*n;var A=t.y+d.y*n;var E=h.x*f;var S=h.y*f;var w=h.x*c;var T=h.y*c;p.x=y+E;p.y=b+S;g.x=y-E;g.y=b-S;_.x=x-w;_.y=A-T;m.x=x+w;m.y=A+T;return v};t.prototype._makeEdgeExtremityPoints=function e(t,r,i,n){var a=this._pointArray(n.length);var o=i/2;var s=t.x+r.x*o;var u=t.y+r.y*o;var l=r.x;var d=r.y;for(var h=0;h<n.length;++h){var f=n[h];var c=a[h];var v=(l*f.x-d*f.y)*o;var p=(d*f.x+l*f.y)*o;c.x=s+v;c.y=u+p;c.r=f.r*o}return a};t.prototype._computeLineDash=function e(t,r,i,n,a,o){var s=[];if(i){s.push(0,i)}if(a&&o){var u=a*r;var l=o*r;var d=u+l;var h=t-n-i-d;var f=0;while(f<h){s.push(u,l);f+=d}var c=t-n-i-f;var v=Math.min(u,c);var p=Math.max(c-v,0);s.push(v,p)}else{s.push(t-n-i,0)}if(n){s.push(0,n)}return s};t.prototype._drawLine=function e(t,r,i,n){if(!r){this._drawStraightLine(t,n)}else if(!i){this._drawQuadraticCurve(t,r,n)}else{this._drawCubicCurve(t,r,i,n)}};t.prototype._getSelfLoopControlPoints=function e(t,r,i){return tu(t.x,t.y,r,i,this._viewAngle,this._tmp)};t.prototype._getQuadraticCurveControlPoint=function e(t){return eu(t.pos1.x,t.pos1.y,t.pos2.x,t.pos2.y,t.curvature,this._point(0,0))};t.prototype._graphToScreenCoordinates=function e(t){var r=this._width/2;var i=this._height/2;var n=(t.x-this._viewX)*this._viewZoom;var a=(t.y-this._viewY)*this._viewZoom;var o=this._viewAngleCos;var s=this._viewAngleSin;var u=o*n+s*a+r;var l=-s*n+o*a+i;return this._point(u,l)};t.prototype._blendColor=function e(t,r){return t?this._mixColor(this._backgroundColor,t,r,1):null};t.prototype._getTangentOnLine=function e(t,r,i,n,a){if(!r){return this._getTangentOnStraightLine(t,n)}else if(!i){return this._getTangentOnQuadraticCurve(t,r,n,a)}else{return this._getTangentOnCubicCurve(t,r,i,n,a)}};t.prototype._getTangentOnStraightLine=function e(t,r){var i=r.x-t.x;var n=r.y-t.y;var a=Math.sqrt(i*i+n*n);return this._point(i/a,n/a)};t.prototype._getTangentOnQuadraticCurve=function e(t,r,i,n){var a=1-n;var o=a*r.x+n*i.x-(a*t.x+n*r.x);var s=a*r.y+n*i.y-(a*t.y+n*r.y);var u=Math.sqrt(o*o+s*s);return this._point(o/u,s/u)};t.prototype._getTangentOnCubicCurve=function e(t,r,i,n,a){var o=1-a;var s=o*o;var u=a*a;var l=s*(r.x-t.x)+2*o*a*(i.x-r.x)+u*(n.x-i.x);var d=s*(r.y-t.y)+2*o*a*(i.y-r.y)+u*(n.y-i.y);var h=Math.sqrt(l*l+d*d);return this._point(l/h,d/h)};t.prototype._mixPoints=function e(t,r,i){var n=er(t.x,r.x,i);var a=er(t.y,r.y,i);return this._point(n,a)};t.prototype._getOrthogonal=function e(t){return this._point(-t.y,t.x)};t.prototype._getPointOnLine=function e(t,r,i,n,a){if(!r){return this._mixPoints(t,n,a)}else if(!i){return this._getPointOnQuadraticCurve(t,r,n,a)}else{return this._getPointOnCubicCurve(t,r,i,n,a)}};t.prototype._getPointOnQuadraticCurve=function e(t,r,i,n){var a=$s(t.x,r.x,i.x,n);var o=$s(t.y,r.y,i.y,n);return this._point(a,o)};t.prototype._getPointOnCubicCurve=function e(t,r,i,n,a){var o=Js(t.x,r.x,i.x,n.x,a);var s=Js(t.y,r.y,i.y,n.y,a);return this._point(o,s)};t.prototype._getTFromLengthOnCubicCurve=function e(t,r,i,n,a){var o=t.x;var s=t.y;var u=0;var l=0;for(var d=0;d<zn;++d){u+=ru;var h=Js(t.x,r.x,i.x,n.x,u);var f=Js(t.y,r.y,i.y,n.y,u);var c=h-o;var v=f-s;var p=Math.sqrt(c*c+v*v);var g=l+p;if(g>a){var _=(g-a)/p;return u-ru*_}l=g;o=h;s=f}return 1};t.prototype._getTFromLengthOnQuadraticCurve=function e(t,r,i,n){var a=t.x;var o=t.y;var s=0;var u=0;for(var l=0;l<zn;++l){s+=ru;var d=$s(t.x,r.x,i.x,s);var h=$s(t.y,r.y,i.y,s);var f=d-a;var c=h-o;var v=Math.sqrt(f*f+c*c);var p=u+v;if(p>n){var g=(p-n)/v;return s-ru*g}u=p;a=d;o=h}return 1};return t}(Zn);function nu(e,t,r){var i=Math.abs(e)/Rn+Fs;var n=i*i;var a=r-.5;var o=a*a;var s=1/(16*n);var u=Math.sqrt(o+s);var l=.5/i*Math.sqrt(n+.25);var d=Math.abs(2*i)*(a*u+.5*l+s*Math.log(Math.abs((a+u)/(-.5+l))));return d*t}function au(e,t,r,i,n){var a=(e.x+t.x+r.x)/3;var o=(e.y+t.y+r.y)/3;var s=a-t.x,u=o-t.y;var l=t.x-r.x,d=t.y-r.y;var h=s*s+u*u;var f=(l*l+d*d)/4;var c=Math.sqrt(h-f);return 2*On*c*3.14159265359*n}function ou(e){return e*Fn}var su=!Se().__dummy;var uu=function(e){function t(t){e.call(this,t);this._canvas=Se();this._ctx=this._canvas.getContext("2d");this._initCanvas(this._canvas);this._imgCanvas=Se();this._imgCtx=this._imgCanvas.getContext("2d")}if(e)t.__proto__=e;t.prototype=Object.create(e&&e.prototype);t.prototype.constructor=t;t.getName=function e(){return"Canvas"};t.isAvailable=function e(){return su};t.prototype.getDomElement=function e(){return this._canvas};t.prototype._render=function e(t){var r=t.dimensionsChanged;if(r){Yn(this._canvas,this._width,this._height,this._pixelRatio)}var i=this._ctx;var n=this._width*this._pixelRatio;var a=this._height*this._pixelRatio;i.clearRect(0,0,n,a);if(this._backgroundColor&&this._renderBackground){i.fillStyle=this._backgroundColor;i.fillRect(0,0,n,a)}var o=this._bufferList.getBuffersByAscendingDepth();for(var s=0;s<o.length;++s){var u=o[s];if(this._isBufferDisplayable(u)){this._displayBuffer(u)}}};t.prototype._drawCircle=function e(t,r){var i=this._ctx;var n=this._pixelRatio;var a=t.x*n;var o=t.y*n;var s=r*n;i.beginPath();i.arc(a,o,s,0,Math.PI*2)};t.prototype._drawPolygon=function e(t){var r=this._ctx;var i=this._pixelRatio;r.beginPath();var n=t[0];r.moveTo(n.x*i,n.y*i);for(var a=1;a<t.length;++a){var o=t[a];r.lineTo(o.x*i,o.y*i)}r.closePath()};t.prototype._drawStraightLine=function e(t,r){var i=this._ctx;var n=this._pixelRatio;i.beginPath();i.moveTo(t.x*n,t.y*n);i.lineTo(r.x*n,r.y*n)};t.prototype._drawQuadraticCurve=function e(t,r,i){var n=this._ctx;var a=this._pixelRatio;n.beginPath();n.moveTo(t.x*a,t.y*a);n.quadraticCurveTo(r.x*a,r.y*a,i.x*a,i.y*a)};t.prototype._drawCubicCurve=function e(t,r,i,n){var a=this._ctx;var o=this._pixelRatio;a.beginPath();a.moveTo(t.x*o,t.y*o);a.bezierCurveTo(r.x*o,r.y*o,i.x*o,i.y*o,n.x*o,n.y*o)};t.prototype._fill=function e(t){var r=this._ctx;r.fillStyle=t;r.fill()};t.prototype._stroke=function e(t,r,i){var n=this;if(i===void 0)i=[];var a=this._ctx;a.setLineDash(i.map(function(e){return e*n._pixelRatio}));a.lineWidth=r;a.strokeStyle=t;a.stroke()};t.prototype._startClip=function e(){this._ctx.save();this._ctx.clip()};t.prototype._endClip=function e(){this._ctx.restore()};t.prototype._startReverseClip=function e(){this._ctx.save();this._ctx.rect(0,0,this._canvas.width,this._canvas.height);this._ctx.clip("evenodd")};t.prototype._endReverseClip=function e(){this._ctx.restore()};t.prototype._displayText=function e(t,r,i,n,a,o,s,u,l){var d=this._ctx;var h=this._pixelRatio;var f=t.x*h;var c=t.y*h;var v=o*h;var p=u==="center"?0:-l/2;d.save();d.translate(f,c);d.rotate(-r);d.textAlign=u;d.textBaseline="middle";Ye(d,a,v,s);d.fillStyle=n;if(i.indexOf("\n")!==-1){var g=i.split("\n");var _=g.length;var m=(1-_)/2*v;for(var y=0;y<_;++y){d.fillText(g[y],p,m);m+=v}}else{d.fillText(i,p,-1)}d.restore()};t.prototype._displayImage=function e(t,r,i,n,a,o,s){if(this._hideImages){return}if(s!==1){n=this._blendImageOnBackground(n,s)}var u=this._ctx;var l=this._pixelRatio;var d=t.x*l;var h=t.y*l;var f=r*l;var c=i*l;var v=n.width*l;var p=n.height*l;if(a){u.drawImage(n,d-f/2,h-c/2,f,c)}else if(o){var g=d-f/2;var _=h-c/2;var m=d+f/2;var y=h+c/2;var b=d-v/2;var x=h-p/2;while(b>g){b-=v}while(x>_){x-=p}var A=x;while(b<m){while(x<y){u.drawImage(n,b,x,v,p);x+=p}b+=v;x=A}}else{u.drawImage(n,d-v/2,h-p/2,v,p)}};t.prototype._displayPieChart=function e(t,r,i){var n=this._ctx;var a=this._pixelRatio;var o=t.x*a;var s=t.y*a;var u=r*a*2;var l=u*2;if(i.length===1){n.fillStyle=i[0];n.fillRect(o-u,s-u,l,l)}else if(i.length===2){n.fillStyle=i[0];n.fillRect(o-u,s,l,u);n.fillStyle=i[1];n.fillRect(o-u,s-u,l,u)}else{var d=Math.PI*2/i.length;var h=0;for(var f=0;f<i.length;++f){var c=i[f];var v=h+d;n.beginPath();n.moveTo(o,s);n.arc(o,s,u,h,v);n.fillStyle=c;n.fill();h=v}}};t.prototype._blendImageOnBackground=function e(t,r){var i=this._backgroundRgba;var n=Math.round(i[0]*255);var a=Math.round(i[1]*255);var o=Math.round(i[2]*255);var s="rgb("+n+","+a+","+o+")";this._imgCanvas.width=t.width;this._imgCanvas.height=t.height;this._imgCtx.clearRect(0,0,t.width,t.height);this._imgCtx.globalAlpha=1;this._imgCtx.fillStyle=s;this._imgCtx.fillRect(0,0,t.width,t.height);this._imgCtx.globalAlpha=r;this._imgCtx.drawImage(t,0,0);return this._imgCanvas};t.prototype.getImageData=function e(){return this._ctx.getImageData(0,0,this._canvas.width,this._canvas.height)};return t}(iu);var lu=[Infinity,Infinity,-Infinity,-Infinity];function du(e,t,r,i,n,a){if(a===void 0){a={x:0,y:0}}var o=Math.cos(n);var s=Math.sin(n);var u=e-r;var l=t-i;a.x=o*u-s*l+r;a.y=s*u+o*l+i;return a}function hu(e,t,r,i){if(r===void 0){r=0}if(i===void 0){i={x:0,y:0}}i.x=e.x+r*Math.sin(t);i.y=e.y+r*Math.cos(t);return i}function distance(e,t,r,i){return Math.sqrt((e-r)*(e-r)+(t-i)*(t-i))}function fu(e,t,r,i){var n=e-r;var a=t-i;return n*n+a*a}function cu(e){return e*180/Math.PI}function vu(e){return e*Math.PI/180}function pu(e,t){e.minX-=t;e.minY-=t;e.maxX+=t;e.maxY+=t;e.width+=2*t;e.height+=2*t;return e}var gu=false;(function(){try{gu=!!Pe("svg")}catch(e){}})();var _u="none";var mu={left:"start",center:"middle",right:"end"};var yu="data-element-id";function bu(e,t,r,i,n,a){var o=Pe("image");o.setAttribute("width",Au(i));o.setAttribute("height",Au(n));o.setAttribute("x",Au(t));o.setAttribute("y",Au(r));o.setAttribute("href",e);if(a){a.appendChild(o)}return o}function xu(e,t,r,i,n,a,o){if(a===void 0)a=1;var s=Pe("rect");s.setAttribute("x",e);s.setAttribute("y",t);s.setAttribute("width",r);s.setAttribute("height",i);s.setAttribute("fill",n);s.setAttribute("fill-opacity",a);if(o){o.appendChild(s)}return s}function Au(e){return Math.round(e*1e3)/1e3}var Eu=function(e){function t(t){e.call(this,t);this._svg=Pe("svg");this._defs=Pe("defs");this._background=Pe("rect",{width:"100%",height:"100%",fill:"none",class:"ogma-svg-background"});this._styles=Pe("g",{class:"styles"});this._defs.appendChild(this._styles);this._svg.setAttribute("pointer-events","none");this._svg.style.userSelect="none";this._svg.appendChild(this._defs);this._svg.appendChild(this._background);this._clear();this._currentElementId=0;this._currentClipPathId=null;this._clipPathCounter=1}if(e)t.__proto__=e;t.prototype=Object.create(e&&e.prototype);t.prototype.constructor=t;t.getName=function e(){return"SVG"};t.isAvailable=function e(){return gu};t.prototype.getDomElement=function e(){return this._svg};t.prototype._render=function e(t){var r=t.dimensionsChanged;if(r){Ne(this._svg,{width:this._width,height:this._height})}if(this._backgroundColor&&this._renderBackground){var i=this._colorManager.rgbaToRgb(this._backgroundColor);this._background.setAttribute("fill",i.color);this._background.setAttribute("fill-opacity",i.opacity)}var n=this._bufferList.getBuffersByAscendingDepth();this._clear();this._svg.removeChild(this._container);for(var a=0;a<n.length;++a){var o=n[a];if(this._isBufferDisplayable(o)){this._displayBuffer(o)}}this._svg.appendChild(this._container)};t.prototype._clear=function e(){if(this._container){this._svg.removeChild(this._container)}this._container=Pe("g");this._svg.appendChild(this._container);if(this._clipPaths){this._defs.removeChild(this._clipPaths)}this._clipPaths=Pe("g");this._defs.appendChild(this._clipPaths);if(this._filters){this._defs.removeChild(this._filters)}this._filters=Pe("g");this._defs.appendChild(this._filters)};t.prototype._displayElement=function t(r,i){this._currentElementId=r.id;e.prototype._displayElement.call(this,r,i)};t.prototype._addBackgroundBlendingFilter=function e(t){var r=this._colorManager.parseColor(this._backgroundColor);var i=t;var n=1-t;var a=r[0]*n;var o=r[1]*n;var s=r[2]*n;var u=[i,0,0,0,a,0,i,0,0,o,0,0,i,0,s,0,0,0,1,0].join(" ");var l="filter-"+this._currentElementId;var d=Pe("filter",{id:l});var h=Pe("feColorMatrix",{in:"SourceGraphic",type:"matrix",values:u});d.appendChild(h);this._filters.appendChild(d);return l};t.prototype._drawCircle=function e(t,r){var i=t.x;var n=t.y;var a="M "+(i-r)+", "+n+" a "+r+","+r+" 0 1,0 "+2*r+",0 a "+r+","+r+" 0 1,0 -"+2*r+",0";var o=Pe("path");o.setAttribute("d",a);o.setAttribute("fill",_u);o.setAttribute(yu,this._currentElementId);this._container.appendChild(o);this._element=o};t.prototype._drawPolygon=function e(t){var r=Pe("path");var i="";for(var n=0;n<t.length;n++){var a=t[n];var o=a.x;var s=a.y;i+=""+(n===0?"M":"L")+o+","+s+" "}i+="Z";r.setAttribute("d",i);r.setAttribute(yu,this._currentElementId);r.setAttribute("fill",_u);this._container.appendChild(r);this._element=r};t.prototype._drawStraightLine=function e(t,r){var i=Pe("path");var n=t.x,a=t.y,o=r.x,s=r.y;var u="M "+n+","+a+" L"+o+","+s;i.setAttribute("d",u);i.setAttribute(yu,this._currentElementId);this._container.appendChild(i);this._element=i};t.prototype._drawQuadraticCurve=function e(t,r,i){var n=Pe("path");var a=t.x,o=t.y;var s=r.x,u=r.y;var l=i.x,d=i.y;var h="M "+a+","+o+" Q"+s+","+u+" "+l+","+d;n.setAttribute("d",h);n.setAttribute("fill",_u);n.setAttribute(yu,this._currentElementId);this._container.appendChild(n);this._element=n};t.prototype._drawCubicCurve=function e(t,r,i,n){var a=Pe("path");var o=t.x,s=t.y;var u=r.x,l=r.y;var d=i.x,h=i.y;var f=n.x,c=n.y;var v="M "+o+","+s+" C"+u+","+l+" "+d+","+h+" "+f+","+c;a.setAttribute("d",v);a.setAttribute("fill",_u);a.setAttribute(yu,this._currentElementId);this._container.appendChild(a);this._element=a};t.prototype._fill=function e(t){t=this._colorManager.rgbaToRgb(t);this._element.setAttribute("fill",t.color);this._element.setAttribute("fill-opacity",t.opacity);if(this._currentClipPathId){this._element.setAttribute("clip-path","url(#"+this._currentClipPathId+")")}};t.prototype._stroke=function e(t,r,i){if(i===void 0)i=[];var n=this._element;n.setAttribute("stroke-width",r);t=this._colorManager.rgbaToRgb(t);n.setAttribute("stroke",t.color);n.setAttribute("stroke-opacity",t.opacity);if(i.length>0){n.setAttribute("stroke-dasharray",i.map(Au))}};t.prototype._startClip=function e(){var t=Pe("clipPath");var r=this._element.cloneNode(false);this._currentClipPathId="clip-path-"+this._clipPathCounter++;t.appendChild(r);this._clipPaths.appendChild(t);t.setAttribute("id",this._currentClipPathId)};t.prototype._endClip=function e(){this._currentClipPathId=null};t.prototype._startReverseClip=function e(){var t=Pe("clipPath");var r=this._element.cloneNode(false);var i=r.getAttribute("d");r.setAttribute("clip-rule","evenodd");r.setAttribute("d",i+" M 0 0 L "+this._width+" 0 L "+this._width+" "+this._height+" L 0 "+this._height);this._currentClipPathId="clip-path-"+this._clipPathCounter++;t.appendChild(r);this._clipPaths.appendChild(t);t.setAttribute("id",this._currentClipPathId)};t.prototype._endReverseClip=function e(){this._currentClipPathId=null};t.prototype._displayText=function e(t,r,i,n,a,o,s,u){var l=Pe("text");l.setAttribute(yu,this._currentElementId);var d=this._colorManager.rgbaToRgb(n);var h=d.opacity;var f=this._colorManager.rgbaToRgb(d.color);var c=t.x;var v=t.y;s=s||"normal";var p=Au(c);l.setAttribute("x",p);l.setAttribute("font-family",a);l.setAttribute("font-size",o);if(s==="bold"){l.setAttribute("font-weight",s)}else{l.setAttribute("font-style",s)}l.setAttribute("fill",f.color);l.setAttribute("fill-opacity",h);if(r){l.setAttribute("transform","rotate("+cu(-r)+" "+c+", "+v+")")}l.setAttribute("text-anchor",mu[u]||"middle");var g=i.split("\n");var _=g.length;var m=(_+1)/2-1/3;l.setAttribute("y",Au(v-m*o));for(var y=0;y<_;y++){var b=Pe("tspan");b.appendChild(Oe(g[y]));b.setAttribute("x",p);b.setAttribute("dy",o);l.appendChild(b)}if(this._currentClipPathId){l.setAttribute("clip-path","url(#"+this._currentClipPathId+")")}this._container.appendChild(l)};t.prototype._displayImage=function e(t,r,i,n,a,o,s){var u=t.x;var l=t.y;if(this._hideImages||!n.isDummy&&(!n.width||!n.height)){return}var d=r;var h=i;var f=n.width;var c=n.height;var v;if(a){f=d;c=h}if(o){var p=u-d/2;var g=l-h/2;var _=u+d/2;var m=l+h/2;var y=u-f/2;var b=l-c/2;v=Pe("g");v.setAttribute(yu,this._currentElementId);while(y>p){y-=f}while(b>g){b-=c}var x=b;while(y<_){while(b<m){bu(n.src,y,b,f,c,v);b+=c}b=x;y+=f}}else{v=bu(n.src,u-f/2,l-c/2,f,c);v.setAttribute(yu,this._currentElementId)}if(this._currentClipPathId){v.setAttribute("clip-path","url(#"+this._currentClipPathId+")")}if(s!==1){var A=this._addBackgroundBlendingFilter(s);v.setAttribute("filter","url(#"+A+")")}this._container.appendChild(v)};t.prototype._displayPieChart=function e(t,r,i){var n=r*2;var a=n*2;var o=t.x,s=t.y;var u;var l=Pe("g");l.setAttribute(yu,this._currentElementId);if(i.length===1){u=xu(o-n,s-n,a,a,i[0],1,l)}else if(i.length===2){u=xu(o-n,s,a,n,i[0],1,l);u=xu(o-n,s-n,a,n,i[1],1,l)}else{var d=Math.PI*2/i.length;var h=0;for(var f=0;f<i.length;++f){var c=h+d;var v=o+r*Math.cos(c);var p=s+r*Math.sin(c);var g=o+r*Math.cos(h);var _=s+r*Math.sin(h);var m=c-h<=Math.PI?0:1;var y="M "+v+","+p+" A "+r+","+r+" 0 "+m+" 0 "+g+","+_+" L "+o+","+s+" L "+v+","+p;u=Pe("path");u.setAttribute("d",y);u.setAttribute("fill",i[f]);u.setAttribute("stroke-width",0);h=c;l.appendChild(u)}}if(this._currentClipPathId){l.setAttribute("clip-path","url(#"+this._currentClipPathId+")")}this._container.appendChild(l)};return t}(iu);var Su=function e(){this._version=0;this._init_()};Su.prototype.reset=function e(){this._init_()};Su.prototype._init_=function e(){this._mustUpdate=true;this.maxCoord=0;this.maxScaledSize=0;this.maxMinVisibleSize=0;this.maxSymbolicSize=0;this.maxDashLength=0;this.maxGapLength=0;this.maxPatternScale=0};Su.prototype._mustUpdateBoundary=function e(t,r){return r>t};Su.prototype.set=function e(t){var r=t.maxCoord;var i=t.maxScaledSize;var n=t.maxMinVisibleSize;var a=t.maxSymbolicSize;var o=t.maxDashLength;var s=t.maxGapLength;var u=t.maxPatternScale;var l=this._mustUpdateBoundary(this.maxCoord,r)||this._mustUpdateBoundary(this.maxScaledSize,i)||this._mustUpdateBoundary(this.maxMinVisibleSize,n)||this._mustUpdateBoundary(this.maxSymbolicSize,a)||this._mustUpdateBoundary(this.maxDashLength,o)||this._mustUpdateBoundary(this.maxGapLength,s)||this._mustUpdateBoundary(this.maxPatternScale,u);if(l){this.maxCoord=r;this.maxScaledSize=i;this.maxMinVisibleSize=n;this.maxSymbolicSize=a;this.maxDashLength=o;this.maxGapLength=s;this.maxPatternScale=u;this._mustUpdate=true}return l};Su.prototype.update=function e(){if(this._mustUpdate){this._version+=1;this._mustUpdate=false}};Su.prototype.getVersion=function e(){return this._version};var wu={linear:[0,1,0,0],quadraticIn:[0,0,1,0],quadraticOut:[0,2,-1,0],quadraticInOut:[0,0,2,0,-1,4,-2,0],cubicIn:[0,0,0,1],cubicOut:[0,3,-3,1],cubicInOut:[0,0,0,4,-3,12,-12,4]};var Tu=function e(){this._linearEasing=[0,1,0,0,0,1,0,0];this._nameToPolygon={};this._polygonToName={};this.add(wu)};Tu.prototype.add=function e(t){var r=this;Object.keys(t).forEach(function(e){var i=t[e].slice();if(i.length<8){i[4]=i[0];i[5]=i[1];i[6]=i[2];i[7]=i[3]}var n=Cu(i[0],i[1],i[2],i[3],i[4],i[5],i[6],i[7]);r._nameToPolygon[e]=i;r._polygonToName[n]=e})};Tu.prototype.getPolygonFromName=function e(t){return this._nameToPolygon[t]||this._linearEasing};Tu.prototype.getNameFromPolygon=function e(t,r,i,n,a,o,s,u){var l=Cu(t,r,i,n,a,o,s,u);return this._polygonToName[l]||"linear"};function Cu(e,t,r,i,n,a,o,s){return e+n+(t+a)*256+(r+o)*65536+(i+s)*16777216}var Iu=function e(){this._elementType=Oi;this._animated=false;this._size=0;this._capacity=on;this._depth=0;this._id=0;this._stencilUsage=Ji;this._baseElt=Xn();this._list=new Array(this._capacity);for(var t=0;t<this._capacity;++t){this._list[t]=Xn()}};Iu.prototype.setDepth=function e(t){this._depth=t;return this};Iu.prototype.reset=function e(t,r,i,n){this._elementType=t;this._animated=r;this._depth=i;this._id=n;this._stencilUsage=Ji;this._size=0;return this};Iu.prototype.setStencilUsage=function e(t){this._stencilUsage=t};Iu.prototype.next=function e(){if(this._size>=this._capacity){throw new Error("internal error: block.next() was called on a full block")}return this._list[this._size++]};Iu.prototype.nextAndReset=function e(){var t=this.next();Hn(t.end);Hn(t.start);Wn(t.animation);return t};Iu.prototype.forEach=function e(t){this._list.forEach(t)};Iu.prototype.getElement=function e(t){return this._list[t]};Iu.prototype.getCurrentElement=function e(){return this._list[this._size-1]};Iu.prototype.getSize=function e(){return this._size};Iu.prototype.getDepth=function e(){return this._depth};Iu.prototype.getElements=function e(){return this._list};Iu.prototype.getType=function e(){return this._elementType};Iu.prototype.getId=function e(){return this._id};Iu.prototype.isAnimated=function e(){return this._animated};Iu.prototype.getStencilUsage=function e(){return this._stencilUsage};Iu.prototype.setGlobalAnimation=function e(t,r,i){for(var n=0;n<this._size;++n){var a=this._list[n].animation;a.duration=t;a.beginTime=r;a.easing=i}};var Mu=function e(){this._maps=[]};Mu.prototype.reset=function e(){this._maps=[]};Mu.prototype.set=function e(t,r,i){var n=t.getId();while(this._maps.length<=n){this._maps.push(new Array(an))}this._maps[n][r]=i};Mu.prototype.get=function e(t,r){return this._maps[t.getId()][r]};var Lu={x:0,y:0,zoom:1,angle:0,width:80,height:60,pixelRatio:1,backgroundColor:null,currentTime:0,isBufferDisplayable:function(){return true},hideImages:false,renderBackground:false};var ku={webgl:os,canvas:uu,svg:Eu,null:Zn};var Nu=[0,0,0,0];var Fu={};var zu=function e(t){this._initData=t||{};this._colorManager=new Pi;this._easingManager=new Tu;this._patternManager=new nn;this._shapeManager=new Dn;this._boundariesManager=new Su;this._textManager=new Zo(this._patternManager);this._bufferList=new jn;this._idRecorder=new Mu;this._maxCoord=0;this._maxScaledSize=0;this._maxPixelSize=0;this._maxMinVisibleSize=0;this._maxSymbolicSize=0;this._maxDashLength=0;this._maxGapLength=0;this._maxPatternScale=0;this._actualCoordToBytes=1;this._actualScaledSizeToBytes=hn;this._actualMinVisibleSizeToBytes=cn;this._actualSymbolicSizeToBytes=dn;this._actualDashLengthToBytes=vn;this._actualGapLengthToBytes=vn;this._actualPatternScaleToBytes=dn;this._blockIdToAddress=new Uint32Array(0);this._currentDataView=null;this._currentElementSize=0;this._currentBlockOffset=0;this._currentByteOffset=0;this._view=O(Lu);this._domElement=typeof document!=="undefined"?document.createElement("div"):xe();this._renderersByType={};this._switchMainRenderer=true;this._renderType=null;this._renderer=null;this._littleEndian=N();this._additionalCanvases=[];this._refreshTexts=false;this._backgroundColor=null};zu.createInitData=function e(){var t={};for(var r=0,i=Object.keys(ku);r<i.length;r+=1){var n=i[r];var a=ku[n];if(a.createInitData){t[n]=a.createInitData()}}return t};zu.cacheInitData=function e(t){Fu=t};zu.getCachedInitData=function e(){return Fu};zu.clearCachedInitData=function e(){Fu={}};zu.prototype.addCanvas=function e(t){t.style.touchAction="none";t.style.msContentZooming="none";this._resizeCanvas(t);this._additionalCanvases.push(t);this._updateDomElement()};zu.prototype.removeCanvas=function e(t){t.style.touchAction="";t.style.msContentZooming="";w(this._additionalCanvases,t);this._updateDomElement()};zu.prototype._ensureDomElementsFitParent=function e(){if(this._domElement.offsetWidth!==this._view.width||this._domElement.offsetHeight!==this._view.height){this._domElement.style.width=this._view.width+"px";this._domElement.style.height=this._view.height+"px";for(var t=0;t<this._additionalCanvases.length;++t){this._resizeCanvas(this._additionalCanvases[t])}}};zu.prototype._ensureCorrectBackgroundColor=function e(){if(this._backgroundColor!==this._view.backgroundColor){this._domElement.style.backgroundColor=this._view.backgroundColor;this._backgroundColor=this._view.backgroundColor}};zu.prototype.createBlock=function e(){return new Iu};zu.prototype.parseColor=function e(t){return this._colorManager.parseColor(t)};zu.prototype.clear=function e(){this._blockIdToAddress.fill(0);this._patternManager.reset();this._boundariesManager.reset();this._textManager.reset();this._bufferList.reset();this._idRecorder.reset()};zu.prototype.notifyFontsReloaded=function e(){this._patternManager.notifyUpdate();this._textManager.clear();this._refreshTexts=true};zu.prototype.notifyPatternUpdate=function e(){this._patternManager.notifyUpdate()};zu.prototype.getShapePoints=function e(t){return this._shapeManager.getDefinitionFromName(t).points};zu.prototype.checkShapeHit=function e(t,r,i){var n=this._shapeManager.getDefinitionFromName(t);var a=n.getDistanceFromStrokeVertically;var o=n.getDistanceFromStrokeHorizontally;return Math.min(a(r,i),o(r,i))>=0};zu.prototype.setGlobalBoundaries=function e(t){var r=t.maxBlockId;if(r===void 0)r=0;var i=t.maxCoord;var n=t.maxScaledSize;var a=t.maxMinVisibleSize;var o=t.maxSymbolicSize;var s=t.maxDashLength;var u=t.maxGapLength;var l=t.maxPatternScale;if(r>this._blockIdToAddress.length){this._resizeBlockArray(r)}if(this._boundariesManager.set(t)){this._maxCoord=i;this._maxScaledSize=n;this._maxMinVisibleSize=a;this._maxSymbolicSize=o;this._maxDashLength=s;this._maxGapLength=u;this._maxPatternScale=l;this._actualCoordToBytes=1;this._actualScaledSizeToBytes=fn/n;this._actualMinVisibleSizeToBytes=cn/a;this._actualSymbolicSizeToBytes=dn/o;this._actualDashLengthToBytes=vn/s;this._actualGapLengthToBytes=vn/u;this._actualPatternScaleToBytes=dn/l;return true}return false};zu.prototype._resizeBlockArray=function e(t){var r=new Uint32Array(t);r.set(this._blockIdToAddress);this._blockIdToAddress=r};zu.prototype._clamp=function e(t,r,i){return Math.min(Math.max(t,r),i)};zu.prototype._signedToUnsignedShort=function e(value){return this._clamp(value+32768,0,65535)};zu.prototype._parseColor=function e(t){return this._colorManager.parseColor(t)||Nu};zu.prototype._colorToBytes=function e(t){var r=this._parseColor(t);var i=Math.round(r[0]*15);var n=Math.round(r[1]*15);var a=Math.round(r[2]*15);var o=Math.round(r[3]*15);return i+(n<<4)+(a<<8)+(o<<12)};zu.prototype._formatAngle=function e(t){return this._clampAngle(t)*(fn/Rs)};zu.prototype._clampAngle=function e(t){return(t%Rs+Rs)%Rs};zu.prototype._coordToBytes=function e(value){return value};zu.prototype._scaledSizeToBytes=function e(value){return Math.ceil(Math.min(value,this._maxScaledSize)*this._actualScaledSizeToBytes)};zu.prototype._fixedSizeToBytes=function e(value){return value};zu.prototype._minVisibleSizeToBytes=function e(value){return Math.round(Math.min(value,this._maxMinVisibleSize)*this._actualMinVisibleSizeToBytes)};zu.prototype._symbolicSizeToBytes=function e(value){return Math.round(Math.min(value,this._maxSymbolicSize)*this._actualSymbolicSizeToBytes)};zu.prototype._dashLengthToBytes=function e(value){return Math.round(Math.min(value,this._maxDashLength)*this._actualDashLengthToBytes)};zu.prototype._gapLengthToBytes=function e(value){return Math.round(Math.min(value,this._maxGapLength)*this._actualGapLengthToBytes)};zu.prototype._patternScaleToBytes=function e(value){return Math.round(Math.min(value,this._maxPatternScale)*this._actualPatternScaleToBytes)};zu.prototype._offsetAngleToBytes=function e(value){return Math.round((value+Rs)%Rs*(8/Rs))};zu.prototype._opacityToBytes=function e(value){return Math.round(Math.min(value,1)*15)};zu.prototype._curvatureToBytes=function e(value){return this._signedToUnsignedByte(value)};zu.prototype._signedToUnsignedByte=function e(value){return this._clamp(value,-128,127)+128};zu.prototype.registerShape=function e(t,r){this._shapeManager.register(t,r)};zu.prototype._bindBlock=function e(t,r,i,n,a,o,s){this._checkBlockId(t);var u=this._blockIdToAddress[t];var l=this._bufferList.allocateBlock(u,r,i,n,a,o,s);this._blockIdToAddress[t]=l.address;this._currentDataView=l.buffer.getDataView();this._currentElementSize=l.buffer.getElementSize();this._currentBlockOffset=l.offset;this._currentByteOffset=this._currentBlockOffset*this._currentElementSize;this._currentSideDataView=l.buffer.getSideDataView();this._currentSideElementSize=l.buffer.getTotalSideElementsSize();this._currentSideByteOffset=this._currentBlockOffset*this._currentSideElementSize;return l};zu.prototype._setItemIndex=function e(t){var r=this._currentBlockOffset+t;this._currentByteOffset=r*this._currentElementSize;this._currentSideByteOffset=r*this._currentSideElementSize};zu.prototype._freeBlock=function e(t){this._checkBlockId(t);var r=this._blockIdToAddress[t];var i=this._bufferList.freeBlock(r);this._blockIdToAddress[t]=i;return i};zu.prototype._checkBlockId=function e(t){if(t>=this._blockIdToAddress.length){this._resizeBlockArray(Kt(t+1))}};zu.prototype._setUint16=function e(t,value){this._currentDataView.setUint16(this._currentByteOffset+t,value,this._littleEndian)};zu.prototype._setInt16=function e(t,value){this._currentDataView.setInt16(this._currentByteOffset+t,value,this._littleEndian)};zu.prototype._setUint8=function e(t,value){this._currentDataView.setUint8(this._currentByteOffset+t,value)};zu.prototype._setInt8=function e(t,value){this._currentDataView.setInt8(this._currentByteOffset+t,value)};zu.prototype._setFloat32=function e(t,value){this._currentDataView.setFloat32(this._currentByteOffset+t,value,this._littleEndian)};zu.prototype._setAnimationBeginTime=function e(t,r){this._setFloat32(t,r)};zu.prototype._setAnimationDuration=function e(t,r){this._setFloat32(t+4,r)};zu.prototype._setAnimationEasing=function e(t,r){var i=this._easingManager.getPolygonFromName(r);this._setUint16(t+8,(i[0]+128<<8)+(i[4]+128));this._setUint16(t+10,(i[1]+128<<8)+(i[5]+128));this._setUint16(t+12,(i[2]+128<<8)+(i[6]+128));this._setUint16(t+14,(i[3]+128<<8)+(i[7]+128))};zu.prototype._setTextCharacters=function e(t){this._textManager.storeTextInDataView(this._currentSideDataView,this._currentSideByteOffset,this._currentSideByteOffset+this._currentSideElementSize,t)};zu.prototype._storeGenericObject=function e(t,r){var i=this._shapeManager.getIdFromName(r.shape);var n=r.pieceId;var a=this._dashLengthToBytes(r.dashLength);var o=this._gapLengthToBytes(r.gapLength);var s=+r.hasHead;var u=+r.hasTail;var l=+r.isBodyTriangle;var d=+r.isSelfLoop;var h=this._patternScaleToBytes(r.patternScale);var f=this._offsetAngleToBytes(r.offsetAngle);var c=+r.isText;var v=+r.adjustTextAngle;var p=+r.unusedFlag1;var g=+r.unusedFlag2;var _=+r.unusedFlag3;var m=this._opacityToBytes(r.opacity);var y=this._minVisibleSizeToBytes(r.globalMinVisibleSize);var b=this._minVisibleSizeToBytes(r.strokeMinVisibleSize);var x=this._minVisibleSizeToBytes(r.patternMinVisibleSize);var A=this._symbolicSizeToBytes(r.symbolicSize);var E=this._curvatureToBytes(r.curvature);var S=this._patternManager.getIdFromDefinition(r.pattern);var w=this._colorToBytes(r.fillColor);var T=this._colorToBytes(r.strokeColor);var C=this._colorToBytes(r.patternColor);var I=this._coordToBytes(r.x1);var M=this._coordToBytes(r.y1);var L=this._coordToBytes(r.x2);var k=this._coordToBytes(r.y2);var N=this._scaledSizeToBytes(r.rectWidthOrSourceRadiusScaled);var F=this._fixedSizeToBytes(r.rectWidthOrSourceRadiusFixed);var z=this._scaledSizeToBytes(r.rectHeightTargetRadiusScaled);var R=this._fixedSizeToBytes(r.rectHeightTargetRadiusFixed);var P=this._scaledSizeToBytes(r.thicknessOrFontSizeScaled);var O=this._fixedSizeToBytes(r.thicknessOrFontSizeFixed);var D=this._scaledSizeToBytes(r.strokeWidthScaled);var B=this._fixedSizeToBytes(r.strokeWidthFixed);var V=this._scaledSizeToBytes(r.offsetScaled);var j=this._fixedSizeToBytes(r.offsetFixed);var U=i+(n<<4)+(a<<8)+(o<<10)+(s<<12)+(u<<13)+(l<<14)+(d<<15);var G=h+(f<<8)+(c<<11)+(v<<12)+(p<<13)+(g<<14)+(_<<15);var q=m+(y<<4)+(b<<8)+(x<<12);var H=A+(E<<8);this._setUint16(t+0,U);this._setUint16(t+2,G);this._setUint16(t+4,q);this._setUint16(t+6,H);this._setUint16(t+8,S);this._setUint16(t+10,w);this._setUint16(t+12,T);this._setUint16(t+14,C);this._setFloat32(t+16,I);this._setFloat32(t+20,M);this._setFloat32(t+24,L);this._setFloat32(t+28,k);this._setUint16(t+32,N);this._setUint16(t+34,F);this._setUint16(t+36,z);this._setUint16(t+38,R);this._setUint16(t+40,P);this._setUint16(t+42,O);this._setUint16(t+44,D);this._setUint16(t+46,B);this._setUint16(t+48,V);this._setUint16(t+50,j)};zu.prototype._storeAnimationInformation=function e(t,r){this._setAnimationBeginTime(t,r.beginTime);this._setAnimationDuration(t,r.duration);this._setAnimationEasing(t,r.easing)};zu.prototype._storeElement=function e(t,r){this._storeGenericObject(0,t.end);if(r){this._storeGenericObject(Mn,t.start);this._storeAnimationInformation(Mn*2,t.animation)}};zu.prototype.storeBlock=function e(t,r){if(!r||!r.getSize()){return this._freeBlock(t)}var i=r.getType();var n=r.getDepth();var a=r.getSize();var o=r.getElements();var s=r.isAnimated();var u=r.getStencilUsage();var l=r.getId();var d=0;if(i===Di){for(var h=0;h<a;++h){var f=o[h];if(f.end.pattern.type===Wi){d=Math.max(d,f.end.pattern.attributes.text.length)}if(s&&f.start.pattern.type===Wi){d=Math.max(d,f.start.pattern.attributes.text.length)}}}var c=this._bindBlock(t,i,s,n,a,d,u);for(var v=0;v<a;++v){var p=o[v];this._setItemIndex(v);this._storeElement(p,s);this._idRecorder.set(c.buffer,c.offset+v,l)}if(i===Di){for(var g=0;g<a;++g){var _=o[g];this._setItemIndex(g);this._setTextCharacters(_.end.pattern)}}return c.address};zu.prototype.freeBlock=function e(t){return this._freeBlock(t)};zu.prototype._refreshTextElements=function e(){var t=this._bufferList.getBuffers();for(var r=0,i=t;r<i.length;r+=1){var n=i[r];if(n&&n.getElementType()===Di){var a=n.getSideDataView();var o=n.getTotalSideElementsSize();var s=n.getSize();var u=0;var l=o;for(var d=0;d<s;++d){var h=this._textManager.extractTextFromDataView(a,u,l);this._textManager.storeTextInDataView(a,u,l,h);u=l;l+=o}n.triggerUpdate()}}};zu.prototype._extractElement=function e(t,r){if(!t){return null}var i=this._bufferList.getBlockInfo(t);return this._renderer.extractElement(i.buffer,i.offset+r)};zu.prototype.extractElement=function e(t,r){if(r===void 0)r=0;return this._extractElement(t,r)};zu.prototype.getDomElement=function e(){return this._domElement};zu.prototype.measureText=function e(t,r,i,n){if(n===void 0)n=1;return this._textManager.measureText(t,r,i,n)};zu.prototype.setRenderType=function e(t){if(this._renderType!==t){this._renderType=t;this._switchMainRenderer=true}};zu.prototype._ensureMainRendererReady=function e(){if(this._switchMainRenderer){var t=ku[this._renderType];if(!t||!t.isAvailable()){this._renderType="canvas"}this._renderer=this._renderersByType[this._renderType];if(!this._renderer){this._renderer=this._instanciateRenderer(this._renderType);this._renderersByType[this._renderType]=this._renderer}this._updateDomElement()}};zu.prototype._updateDomElement=function e(){var t=this._renderer&&this._renderer.getDomElement();while(this._domElement.firstChild){this._domElement.removeChild(this._domElement.firstChild)}if(t){this._appendDomChild(t)}for(var r=0;r<this._additionalCanvases.length;++r){this._appendDomChild(this._additionalCanvases[r])}};zu.prototype._appendDomChild=function e(t){t.style.position="absolute";t.style.left="0";t.style.top="0";this._domElement.appendChild(t)};zu.prototype._instanciateRenderer=function e(t){var r=ku[t]||Zn;return new r({initData:this._initData[t],bufferList:this._bufferList,shapeManager:this._shapeManager,patternManager:this._patternManager,boundariesManager:this._boundariesManager,textManager:this._textManager,colorManager:this._colorManager,easingManager:this._easingManager,idRecorder:this._idRecorder})};zu.prototype.setView=function e(t){Object.assign(this._view,t)};zu.prototype._updateManagers=function e(){this._patternManager.setPixelRatio(this._view.pixelRatio);this._shapeManager.update();this._patternManager.update();this._textManager.update();this._boundariesManager.update();this._bufferList.update();if(this._refreshTexts){this._refreshTexts=false;this._refreshTextElements()}};zu.prototype._resizeCanvas=function e(t){Yn(t,this._view.width,this._view.height,this._view.pixelRatio)};zu.prototype.render=function e(){this._ensureMainRendererReady();this._ensureDomElementsFitParent();this._ensureCorrectBackgroundColor();this._updateManagers();this._renderer.renderFrame(this._view)};zu.prototype.ensureAnimationsReady=function e(){this._ensureMainRendererReady();this._renderer.ensureAnimationsReady()};zu.prototype.export=function e(t,r,i){var n=this._instanciateRenderer(t);var a=Object.assign({},this._view,r);n.setViewportClipping(false);a.renderBackground=true;this._updateManagers();n.renderFrame(a);return n.export(i).then(function(){return n.getDomElement()})};zu.prototype.getCurrentTime=function e(){return tt()};zu.prototype.getImageData=function e(){return this._renderer&&this._renderer.getImageData()};zu.prototype.destroy=function e(){for(var t=0,r=Object.keys(this._renderersByType);t<r.length;t+=1){var i=r[t];var n=this._renderersByType[i];if(n){n.destroy()}}};zu.prototype.transparentify=function e(t){var r=this._parseColor(t);var i=Math.round(r[0]*255);var n=Math.round(r[1]*255);var a=Math.round(r[2]*255);return"rgba("+i+","+n+","+a+",0)"};zu.prototype.initDebugRenderingLoop=function e(t){var r=this;if(t===void 0)t={};var i=t.triggerKey;if(i===void 0)i="r";var n=t.start;if(n===void 0)n=true;var a=n;document.addEventListener("keydown",function(e){var t=e.key;if(t===i){a=!a}});var o=function(force){if(a||force){r.setView({currentTime:tt()});r.render()}window.requestAnimationFrame(function(){o()})};window.requestAnimationFrame(function(){document.body.appendChild(r.getDomElement());o(true)})};var Ru=function(e){function t(){e.call(this);this.isDummy=true;this.width=0;this.height=0}if(e)t.__proto__=e;t.prototype=Object.create(e&&e.prototype);t.prototype.constructor=t;var r={src:{configurable:true}};r.src.set=function(e){var t=this;if(e){this._src=e;setTimeout(function(){if(t.onload){t.onload.call(t)}t.width=1;t.height=1;t.fire("load")},10)}};r.src.get=function(){return this._src};t.prototype.addEventListener=function e(t,r){this.on(t,r)};Object.defineProperties(t.prototype,r);return t}(to);var Pu=typeof Image!=="undefined"?Image:Ru;var Ou=function e(){this._images={};this._crossOrigin="anonymous";this._whenReady=[];this._onFetch=[];this._nbLoaded=0;this._nbToLoad=0};Ou.prototype.setImgCrossOrigin=function e(t){this._crossOrigin=t};Ou.prototype.clear=function e(){this._images={};this._nbLoaded=0;this._nbToLoad=0};Ou.prototype.getImage=function e(t){var r=this;var i=this._images[t];if(i===undefined){this._nbToLoad+=1;i=new Pu;i.crossOrigin=this._crossOrigin;i.onload=function(){return r._onImgLoad(t)};i.onerror=function(){r._onImgLoad(t);r._images[t]=null};i.src=t;this._images[t]=i}return i};Ou.prototype._onImgLoad=function e(t){this._nbLoaded+=1;this._onFetch.forEach(function(e){return e(t)});if(this._nbLoaded===this._nbToLoad){this._whenReady.forEach(function(e){return e()});this._whenReady=[]}};Ou.prototype.onFetch=function e(t){this._onFetch.push(t)};Ou.prototype.whenReady=function e(){var t=this;if(this._nbLoaded===this._nbToLoad){return Promise.resolve()}else{return new Promise(function(e){return t._whenReady.push(e)})}};Ou.prototype.destroy=function e(){this._whenReady=[];this._onFetch=[]};function Du(e,t,r,i,n,a,o,s,u){if(s===void 0){s=0}if(u===void 0){u=false}var l=distance(r,i,n,a),d=o/2*(u?distance(e,t,n,a)/l:1),h=(d+s)/l,f=(n-r)*h,c=(a-i)*h,v=r+c,p=i-f,g=r-c,_=i+f,m=n+c,y=a-f;var b=e-v,x=t-p,A=g-v,E=_-p,S=m-v,w=y-p;var T=b*A+x*E,C=A*A+E*E,I=b*S+x*w,M=S*S+w*w;return T>0&&T<C&&I>0&&I<M}function Bu(e,t,r,i,n){if(n===void 0){n=false}if(n&&(Vu(e,r)||Vu(e,i)||Vu(t,r)||Vu(t,i))){return false}var a=(e.y-r.y)*(i.x-r.x)-(e.x-r.x)*(i.y-r.y);var o=(t.x-e.x)*(i.y-r.y)-(t.y-e.y)*(i.x-r.x);if(o===0){return false}var s=a/o;a=(e.y-r.y)*(t.x-e.x)-(e.x-r.x)*(t.y-e.y);var u=a/o;return!(s<=0||s>=1||u<=0||u>=1)}function Vu(e,t){return e.x===t.x&&e.y===t.y}function ju(e,t,r,i){return Math.atan2(i-t,r-e)}function Uu(e,t,r){var i=ju(e.x,e.y,t.x,t.y)-ju(r.x,r.y,t.x,t.y);if(i<0){return i+2*Math.PI}return i}function Gu(e,t,r,i,n,a,o,s){var u=(s-a)*(r-e)-(o-n)*(i-t);if(u===0){return null}var l=t-a;var d=e-n;var h=(o-n)*l-(s-a)*d;l=h/u;return{x:e+l*(r-e),y:t+l*(i-t)}}function qu(e,t,r,i,n,a,o,s){var u=e-r;var l=t-i;var d=n-o;var h=a-s;var f=u*h-d*l;var c=(l*(e-n)-u*(t-a))/f;if(c<0||c>1){return null}var v=(d*(a-t)+h*(e-n))/f;if(v>=0&&v<=1){return{x:e-v*u,y:t-v*l}}return null}function Hu(e,t,r,i,n,a,o,s){var u;var l=[];u=qu(e,t,r,i,n,a,n,s);if(u){l.push(u)}u=qu(e,t,r,i,n,s,o,s);if(u){l.push(u)}u=qu(e,t,r,i,o,s,o,a);if(u){l.push(u)}u=qu(e,t,r,i,o,a,n,a);if(u){l.push(u)}return l}function Wu(e,t,r,i,n,a,o,s){var u=((o-n)*(t-a)-(s-a)*(e-n))/((s-a)*(r-e)-(o-n)*(i-t));var l=((r-e)*(t-a)-(i-t)*(e-n))/((s-a)*(r-e)-(o-n)*(i-t));if(u>=0&&u<=1&&l>=0&&l<=1){return true}return false}function Xu(e,t,r,i,n,a,o,s){if(e>=n&&t>=a&&e<=o&&t<=s){return true}if(r>=n&&i>=a&&r<=o&&i<=s){return true}if(Wu(e,t,r,i,n,a,n,s)){return true}if(Wu(e,t,r,i,o,a,o,s)){return true}if(Wu(e,t,r,i,n,a,o,a)){return true}if(Wu(e,t,r,i,n,s,o,s)){return true}return false}function Yu(e,t,r){return Math.sqrt(Zu(e.x,e.y,t.x,t.y,r.x,r.y))}function Zu(e,t,r,i,n,a){var o=fu(r,i,n,a);if(o===0){return fu(e,t,r,i)}var s=((e-r)*(n-r)+(t-i)*(a-i))/o;s=Math.max(0,Math.min(1,s));return fu(e,t,r+s*(n-r),i+s*(a-i))}function Ku(e,t,r,i,n,a){var o=n-r;var s=a-i;if(o===0&&s===0){return{x:r,y:i}}var u=((e-r)*o+(t-i)*s)/(o*o+s*s);if(u<0){return{x:r,y:i}}else if(u>1){return{x:n,y:a}}else{return{x:r+u*o,y:i+u*s}}}function Qu(e,t,r,i,n,a){var o=e-r;var s=t-i;var u=n-r;var l=a-i;var d=u*u+l*l;var h=o*u+s*l;var f=h/d;return{x:r+u*f,y:i+l*f}}var Ju=1e-6;var $u=1e-12;function el(){var e=arguments;var t=e.length-1;var r=t;var i=[];for(var n=0;n<=t;n++){if(Math.abs(e[n])<=$u){t--}else{break}}switch(t){case 1:tl(e[r],e[r-1],i);break;case 2:rl(e[r],e[r-1],e[r-2],i);break;case 3:il(e[r],e[r-1],e[r-2],e[r-3],i);break;default:break}return i}function tl(e,t,r){if(r===void 0)r=[];if(t!==0){r.push(-e/t)}return r}function rl(e,t,r,i){if(i===void 0)i=[];var n=r;var a=t/n;var o=e/n;var s=a*a-4*o;if(s>0){var u=Math.sqrt(s);i.push(.5*(-a+u));i.push(.5*(-a-u))}else if(s===0){i.push(.5*-a)}return i}function il(e,t,r,i,n){if(n===void 0)n=[];var a=i;var o=r/a;var s=t/a;var u=e/a;var l=(3*s-o*o)/3;var d=(2*o*o*o-9*s*o+27*u)/27;var h=o/3;var f=d*d/4+l*l*l/27;var c=d/2;var v,p;if(Math.abs(f)<=Ju){f=0}if(f>0){var g=Math.sqrt(f);v=-c+g;if(v>=0){p=Math.pow(v,1/3)}else{p=-Math.pow(-v,1/3)}v=-c-g;if(v>=0){p+=Math.pow(v,1/3)}else{p-=Math.pow(-v,1/3)}n.push(p-h)}else if(f<0){var distance=Math.sqrt(-l/3);var _=Math.atan2(Math.sqrt(-f),-c)/3;var m=Math.cos(_);var y=Math.sin(_);var b=Math.sqrt(3);n.push(2*distance*m-h);n.push(-distance*(m+b*y)-h);n.push(-distance*(m-b*y)-h)}else{if(c>=0){v=-Math.pow(c,1/3)}else{v=Math.pow(-c,1/3)}n.push(2*v-h);n.push(-v-h)}return n}function nl(e,t,r,i,n,a,o,s,u,l,d){var h,f,c,v;var p,g,_,m,y,b;var x;var A,E;var S=Math.min(o,u),w=Math.min(s,l),T=Math.max(o,u),C=Math.max(s,l);h=r*-2;f=i*-2;p=e+h+n;g=t+f+a;h=e*-2;f=t*-2;c=r*2;v=i*2;_=h+c;m=f+v;y=e;b=t;A=s-l;E=u-o;x=o*l-u*s;var I=el(A*p+E*g,A*_+E*m,A*y+E*b+x);for(var M=0;M<I.length;M++){var L=I[M];if(0<=L&&L<=1){var k=e+(r-e)*L;var N=t+(i-t)*L;var F=r+(n-r)*L;var z=i+(a-i)*L;var R=k+(F-k)*L;var P=N+(z-N)*L;if(o===u){if(w<=P&&P<=C){if(d){d.push(R,P)}else{return 1}}}else if(s===l){if(S<=R&&R<=T){if(d){d.push(R,P)}else{return 1}}}else if(R>=S&&P>=w&&R<=T&&P<=C){if(d){d.push(R,P)}else{return 1}}}}return d?d.length/2:0}function al(e,t,r,i,n,a,o,s,u,l,d){if(d){nl(e,t,r,i,n,a,o,s,u,s,d);nl(e,t,r,i,n,a,u,s,u,l,d);nl(e,t,r,i,n,a,o,l,u,l,d);nl(e,t,r,i,n,a,o,s,o,l,d);return d.length/2}else{if(o<=e&&u>=e&&s<=t&&l>=t){return 1}if(o<=n&&u>=n&&s<=a&&l>=a){return 1}if(nl(e,t,r,i,n,a,o,s,u,s)){return 1}if(nl(e,t,r,i,n,a,u,s,u,l)){return 1}if(nl(e,t,r,i,n,a,o,l,u,l)){return 1}if(nl(e,t,r,i,n,a,o,s,o,l)){return 1}return 0}}function ol(e,t,r,i,n,a,o,s,u,l,d,h,f){var c,v,p,g,_,m,y,b;var x,A,E,S,w,T,C,I;var M;var L,k;var N=Math.min(u,d),F=Math.min(l,h),z=Math.max(u,d),R=Math.max(l,h);c=e*-1;v=t*-1;p=r*3;g=i*3;_=n*-3;m=a*-3;y=c+p+_+o;b=v+g+m+s;x=y;A=b;c=e*3;v=t*3;p=r*-6;g=i*-6;_=n*3;m=a*3;y=c+p+_;b=v+g+m;E=y;S=b;c=e*-3;v=t*-3;p=r*3;g=i*3;_=c+p;m=v+g;w=_;T=m;C=e;I=t;L=l-h;k=d-u;M=u*h-d*l;var P=el(L*x+k*A,L*E+k*S,L*w+k*T,L*C+k*I+M);for(var O=0;O<P.length;O++){var D=P[O];if(0<=D&&D<=1){var B=e+(r-e)*D;var V=t+(i-t)*D;var j=r+(n-r)*D;var U=i+(a-i)*D;var G=n+(o-n)*D;var q=a+(s-a)*D;var H=B+(j-B)*D;var W=V+(U-V)*D;var X=j+(G-j)*D;var Y=U+(q-U)*D;var Z=H+(X-H)*D;var K=W+(Y-W)*D;if(u===d){if(F<=K&&K<=R){if(f){f.push(Z,K)}else{return 1}}}else if(l===h){if(N<=Z&&Z<=z){if(f){f.push(Z,K)}else{return 1}}}else if(Z>=N&&K>=F&&Z<=z&&K<=R){if(f){f.push(Z,K)}else{return 1}}}}return f?f.length/2:0}function sl(e,t,r,i,n,a,o,s,u,l,d,h,f){if(f){ol(e,t,r,i,n,a,o,s,u,l,d,l,f);ol(e,t,r,i,n,a,o,s,d,l,d,h,f);ol(e,t,r,i,n,a,o,s,u,h,d,h,f);ol(e,t,r,i,n,a,o,s,u,l,u,h,f);return f.length/2}else{if(u<=e&&d>=e&&l<=t&&h>=t){return 1}if(u<=o&&d>=o&&l<=s&&h>=s){return 1}if(ol(e,t,r,i,n,a,o,s,u,l,d,l)){return 1}if(ol(e,t,r,i,n,a,o,s,d,l,d,h)){return 1}if(ol(e,t,r,i,n,a,o,s,u,h,d,h)){return 1}if(ol(e,t,r,i,n,a,o,s,u,l,u,h)){return 1}return 0}}function ul(e,t,r,i,n,a,o,s){if(s===void 0){s={x:0,y:0}}s.x=(1-e)*(1-e)*t+2*(1-e)*e*a+e*e*i;s.y=(1-e)*(1-e)*r+2*(1-e)*e*o+e*e*n;return s}function ll(e,t,r,i,n,a,o,s,u,l,d){if(l===void 0){l=0}if(d===void 0){d=false}var h=r-2*o+n;var f=2*o-2*r;var c=r-e;var v=i-2*s+a;var p=2*s-2*i;var g=i-t;var _=-(c*v-g*h)/(f*v-p*h);if(_<0||_>1){return false}var m=u/2;if(d){m*=1-_}m+=l;var y=$s(r,o,n,_);var b=$s(i,s,a,_);return distance(y,b,e,t)<=m}function dl(e,t,r,i,n,a,o,s,u,l){if(l===void 0){l={x:0,y:0}}var d=(1-e)*(1-e)*(1-e),h=3*e*(1-e)*(1-e),f=3*e*e*(1-e),c=e*e*e;l.x=d*t+h*a+f*s+c*i;l.y=d*r+h*o+f*u+c*n;return l}function hl(e,t,r,i,n,a,o,s,u,l,d,h){var f=distance(r,i,o,s);if(Math.abs(e-r)>f||Math.abs(t-i)>f){return false}var c=distance(e,t,r,i);var v=distance(e,t,n,a);var p=.5;var g=c<v?-.01:.01;var _=.001;var m=100;var y=dl(p,r,i,n,a,o,s,u,l);var b=distance(e,t,y.x,y.y);var x;var A=d/2+h;while(m-- >0&&p>=0&&p<=1&&b>A&&(g>_||g<-_)){x=b;dl(p,r,i,n,a,o,s,u,l,y);b=distance(e,t,y.x,y.y);if(b>x){g=-g/2;p+=g}else if(p+g<0||p+g>1){g=g/2;b=x}else{p+=g}}return b<A}function fl(e,t,r,i,n,a,o){if(o===void 0){o=$a()}var s=e+2/3*(r-e);var u=t+2/3*(i-t);var l=s+1/3*(n-e);var d=u+1/3*(a-t);return cl(e,t,s,u,l,d,n,a,o)}function cl(e,t,r,i,n,a,o,s,u){if(u===void 0){u=$a()}var l=Math.min,d=Math.max,h=Math.sqrt;var f,c,v,p,g;u.minX=l(e,o);u.maxX=d(e,o);u.minY=l(t,s);u.maxY=d(t,s);for(var _=void 0,m=void 0,y=void 0,b=void 0,x=void 0,A=void 0,E=void 0,S=0;S<2;++S){if(S===0){c=e;v=r;p=n;g=o}else{c=t;v=i;p=a;g=s}m=6*c-12*v+6*p;_=-3*c+9*v-9*p+3*g;y=3*v-3*c;m=m|0;_=_|0;y=y|0;if(_===0){if(m===0){continue}b=-y/m;if(b>0&&b<1){f=vl(b,c,v,p,g);if(S===0){u.minX=l(u.minX,f);u.maxX=d(u.maxX,f)}else{u.minY=l(u.minY,f);u.maxY=d(u.maxY,f)}}continue}x=m*m-4*y*_;if(x<0){continue}A=(-m+h(x))/(2*_);if(A>0&&A<1){f=vl(A,c,v,p,g);if(S===0){u.minX=l(u.minX,f);u.maxX=d(u.maxX,f)}else{u.minY=l(u.minY,f);u.maxY=d(u.maxY,f)}}E=(-m-h(x))/(2*_);if(E>0&&E<1){f=vl(E,c,v,p,g);if(S===0){u.minX=l(u.minX,f);u.maxX=d(u.maxX,f)}else{u.minY=l(u.minY,f);u.maxY=d(u.maxY,f)}}}return u}function vl(e,t,r,i,n){return Math.pow(1-e,3)*t+3*Math.pow(1-e,2)*e*r+3*(1-e)*Math.pow(e,2)*i+Math.pow(e,3)*n}var pl=function e(t,r){this._attributesManager=t;this._id=r};pl.prototype.getDefinition=function e(){return this._attributesManager.getAttributeLayerDefinition(this._id)};pl.prototype.update=function e(t){this._attributesManager.updateAttributeLayer(this._id,t)};pl.prototype.destroy=function e(){this._attributesManager.destroyAttributeLayer(this._id)};pl.prototype.updateElements=function e(t){this._attributesManager.updateElementsForAttributeLayer(this._id,t)};pl.prototype.updateAll=function e(){this._attributesManager.updateAllForAttributeLayer(this._id)};pl.prototype.setAttributeValues=function e(t,r,i){this._attributesManager.setAttributeLayerValues(this._id,t,r,i)};pl.prototype.getUsedAttributeNames=function e(t){return this._attributesManager.getUsedAttributeLayerAttributes(this._id,t)};pl.prototype.getFlexArrays=function e(){return this._attributesManager.getAttributeLayerFlexArrays(this._id)};var gl={linear:function(e){return e},quadraticIn:function(e){return e*e},quadraticOut:function(e){return e*(2-e)},quadraticInOut:function(e){if((e*=2)<1){return.5*e*e}return-.5*(--e*(e-2)-1)},cubicIn:function(e){return e*e*e},cubicOut:function(e){return--e*e*e+1},cubicInOut:function(e){if((e*=2)<1){return.5*e*e*e}return.5*((e-=2)*e*e+2)}};var _l=1;var ml=2;var yl=3;var bl=4;var xl=5;var Al=6;var El="_visible";var Sl="_data";var wl="_hovered";var Tl="_hoverExtremityHighlighted";var Cl="_selected";var Il="_selectionExtremityHighlighted";var Ml="_dragged";var Ll="_rewirable";var kl="_export";var Nl="_faded";var Fl="_transparent";var zl=[Cl,Ml,Il,wl,Tl,Ll,kl,Nl,Fl];var Rl=2;var Pl=3;var Ol=3;var Dl=4;var Bl=["hover","zoom","panning","rotation","gesture","drag","selection","tooltip","user","interactions","resizing","rewiring","connectNodes","lasso"];var Vl={storage:1,default:0};var jl=function e(t){var r=t.graph;var i=t.isNode;var n=t.includeRemovedElements;this._isNode=i;this._graph=r;this._includeRemovedElements=n;this._eltList=i?this._graph.nodeList:this._graph.edgeList;this._flexArray=i?this._graph.createNodeAttribute(Vl):this._graph.createEdgeAttribute(Vl);this._all=false;this._indexList=this._graph.createIndexList(i)};jl.prototype._getAllIndexes=function e(){var t=this._isNode?this._graph.getNodeMaxIndex():this._graph.getEdgeMaxIndex();var r=new Uint32Array(t);for(var i=1;i<=t;++i){r[i-1]=i}return r};jl.prototype.addAll=function e(){this._all=true};jl.prototype.add=function e(t){if(this._all){return}for(var r=0,i=t._indexes;r<i.length;r+=1){var n=i[r];this._addIndex(n)}};jl.prototype._addIndex=function e(t){if(this._flexArray.get(t)===0){this._flexArray.set(t,1);this._indexList.push(t)}};jl.prototype.isEmpty=function e(){return!this._all&&this._indexList.isEmpty()};jl.prototype.isFull=function e(){return this._all};jl.prototype.getListAndClear=function e(){var t=this.getList();this.clear();return t};jl.prototype.getList=function e(){var t=null;if(this._all&&!this._includeRemovedElements){t=this._isNode?this._graph.getNodes("all"):this._graph.getEdges("all")}else{var r=this._all?this._getAllIndexes():this._indexList.slice();t=this._eltList(r)}return t};jl.prototype.clear=function e(){this._all=false;if(!this._indexList.isEmpty()){this._indexList.reset();this._flexArray.reset()}};jl.prototype.addSet=function e(t){if(t._all){this.addAll()}else{var r=t._indexList.getBuffer();var i=t._indexList.getLength();for(var n=0;n<i;++n){this._addIndex(r[n])}}};function Ul(e,t){var r=t.named,i=t.useDefaultValues;var n="resource";return{x:e.createAttribute(true,{storage:"any",default:i?0:undefined,name:r?"x":undefined}),y:e.createAttribute(true,{storage:"any",default:i?0:undefined,name:r?"y":undefined}),radius:e.createAttribute(true,{storage:n,default:i?5:undefined,name:r?"radius":undefined}),scalingMethod:e.createAttribute(true,{storage:n,default:i?"scaled":undefined,name:r?"scalingMethod":undefined}),color:e.createAttribute(true,{storage:n,default:i?"grey":undefined,name:r?"color":undefined}),opacity:e.createAttribute(true,{storage:n,default:i?1:undefined,name:r?"opacity":undefined}),shape:e.createAttribute(true,{storage:n,default:i?"circle":undefined,name:r?"shape":undefined}),layer:e.createAttribute(true,{storage:n,default:i?0:undefined,name:r?"layer":undefined}),detectable:e.createAttribute(true,{storage:n,default:i?true:undefined,name:r?"detectable":undefined}),draggable:e.createAttribute(true,{storage:n,default:i?true:undefined,name:r?"draggable":undefined}),layoutable:e.createAttribute(true,{storage:n,default:i?true:undefined,name:r?"layoutable":undefined}),innerStroke:{width:e.createAttribute(true,{storage:n,default:i?2:undefined,name:r?"innerStroke.width":undefined}),scalingMethod:e.createAttribute(true,{storage:n,default:i?"fixed":undefined,name:r?"innerStroke.scalingMethod":undefined}),color:e.createAttribute(true,{storage:n,default:i?"white":undefined,name:r?"innerStroke.color":undefined}),minVisibleSize:e.createAttribute(true,{storage:n,default:i?12:undefined,name:r?"innerStroke.minVisibleSize":undefined})},outerStroke:{width:e.createAttribute(true,{storage:n,default:i?5:undefined,name:r?"outerStroke.width":undefined}),scalingMethod:e.createAttribute(true,{storage:n,default:i?"fixed":undefined,name:r?"outerStroke.scalingMethod":undefined}),color:e.createAttribute(true,{storage:n,default:i?null:undefined,name:r?"outerStroke.color":undefined}),minVisibleSize:e.createAttribute(true,{storage:n,default:i?0:undefined,name:r?"outerStroke.minVisibleSize":undefined})},badges:{topLeft:{color:e.createAttribute(true,{storage:n,default:i?"white":undefined,name:r?"badges.topLeft.color":undefined}),scale:e.createAttribute(true,{storage:n,default:i?.45:undefined,name:r?"badges.topLeft.scale":undefined}),positionScale:e.createAttribute(true,{storage:n,default:i?1:undefined,name:r?"badges.topLeft.positionScale":undefined}),minVisibleSize:e.createAttribute(true,{storage:n,default:i?12:undefined,name:r?"badges.topLeft.minVisibleSize":undefined}),image:{url:e.createAttribute(true,{storage:n,default:i?null:undefined,name:r?"badges.topLeft.image.url":undefined}),scale:e.createAttribute(true,{storage:n,default:i?1:undefined,name:r?"badges.topLeft.image.scale":undefined})},stroke:{color:e.createAttribute(true,{storage:n,default:i?"black":undefined,name:r?"badges.topLeft.stroke.color":undefined}),width:e.createAttribute(true,{storage:n,default:i?2:undefined,name:r?"badges.topLeft.stroke.width":undefined}),scalingMethod:e.createAttribute(true,{storage:n,default:i?"fixed":undefined,name:r?"badges.topLeft.stroke.scalingMethod":undefined})},text:{content:e.createAttribute(true,{storage:n,default:i?null:undefined,name:r?"badges.topLeft.text.content":undefined}),color:e.createAttribute(true,{storage:n,default:i?"black":undefined,name:r?"badges.topLeft.text.color":undefined}),font:e.createAttribute(true,{storage:n,default:i?"Arial":undefined,name:r?"badges.topLeft.text.font":undefined}),style:e.createAttribute(true,{storage:n,default:i?"normal":undefined,name:r?"badges.topLeft.text.style":undefined}),scale:e.createAttribute(true,{storage:n,default:i?.5:undefined,name:r?"badges.topLeft.text.scale":undefined})}},topRight:{color:e.createAttribute(true,{storage:n,default:i?"white":undefined,name:r?"badges.topRight.color":undefined}),scale:e.createAttribute(true,{storage:n,default:i?.45:undefined,name:r?"badges.topRight.scale":undefined}),positionScale:e.createAttribute(true,{storage:n,default:i?1:undefined,name:r?"badges.topRight.positionScale":undefined}),minVisibleSize:e.createAttribute(true,{storage:n,default:i?12:undefined,name:r?"badges.topRight.minVisibleSize":undefined}),image:{url:e.createAttribute(true,{storage:n,default:i?null:undefined,name:r?"badges.topRight.image.url":undefined}),scale:e.createAttribute(true,{storage:n,default:i?1:undefined,name:r?"badges.topRight.image.scale":undefined})},stroke:{color:e.createAttribute(true,{storage:n,default:i?"black":undefined,name:r?"badges.topRight.stroke.color":undefined}),width:e.createAttribute(true,{storage:n,default:i?2:undefined,name:r?"badges.topRight.stroke.width":undefined}),scalingMethod:e.createAttribute(true,{storage:n,default:i?"fixed":undefined,name:r?"badges.topRight.stroke.scalingMethod":undefined})},text:{content:e.createAttribute(true,{storage:n,default:i?null:undefined,name:r?"badges.topRight.text.content":undefined}),color:e.createAttribute(true,{storage:n,default:i?"black":undefined,name:r?"badges.topRight.text.color":undefined}),font:e.createAttribute(true,{storage:n,default:i?"Arial":undefined,name:r?"badges.topRight.text.font":undefined}),style:e.createAttribute(true,{storage:n,default:i?"normal":undefined,name:r?"badges.topRight.text.style":undefined}),scale:e.createAttribute(true,{storage:n,default:i?.5:undefined,name:r?"badges.topRight.text.scale":undefined})}},bottomLeft:{color:e.createAttribute(true,{storage:n,default:i?"white":undefined,name:r?"badges.bottomLeft.color":undefined}),scale:e.createAttribute(true,{storage:n,default:i?.45:undefined,name:r?"badges.bottomLeft.scale":undefined}),positionScale:e.createAttribute(true,{storage:n,default:i?1:undefined,name:r?"badges.bottomLeft.positionScale":undefined}),minVisibleSize:e.createAttribute(true,{storage:n,default:i?12:undefined,name:r?"badges.bottomLeft.minVisibleSize":undefined}),image:{url:e.createAttribute(true,{storage:n,default:i?null:undefined,name:r?"badges.bottomLeft.image.url":undefined}),scale:e.createAttribute(true,{storage:n,default:i?1:undefined,name:r?"badges.bottomLeft.image.scale":undefined})},stroke:{color:e.createAttribute(true,{storage:n,default:i?"black":undefined,name:r?"badges.bottomLeft.stroke.color":undefined}),width:e.createAttribute(true,{storage:n,default:i?2:undefined,name:r?"badges.bottomLeft.stroke.width":undefined}),scalingMethod:e.createAttribute(true,{storage:n,default:i?"fixed":undefined,name:r?"badges.bottomLeft.stroke.scalingMethod":undefined})},text:{content:e.createAttribute(true,{storage:n,default:i?null:undefined,name:r?"badges.bottomLeft.text.content":undefined}),color:e.createAttribute(true,{storage:n,default:i?"black":undefined,name:r?"badges.bottomLeft.text.color":undefined}),font:e.createAttribute(true,{storage:n,default:i?"Arial":undefined,name:r?"badges.bottomLeft.text.font":undefined}),style:e.createAttribute(true,{storage:n,default:i?"normal":undefined,name:r?"badges.bottomLeft.text.style":undefined}),scale:e.createAttribute(true,{storage:n,default:i?.5:undefined,name:r?"badges.bottomLeft.text.scale":undefined})}},bottomRight:{color:e.createAttribute(true,{storage:n,default:i?"white":undefined,name:r?"badges.bottomRight.color":undefined}),scale:e.createAttribute(true,{storage:n,default:i?.45:undefined,name:r?"badges.bottomRight.scale":undefined}),positionScale:e.createAttribute(true,{storage:n,default:i?1:undefined,name:r?"badges.bottomRight.positionScale":undefined}),minVisibleSize:e.createAttribute(true,{storage:n,default:i?12:undefined,name:r?"badges.bottomRight.minVisibleSize":undefined}),image:{url:e.createAttribute(true,{storage:n,default:i?null:undefined,name:r?"badges.bottomRight.image.url":undefined}),scale:e.createAttribute(true,{storage:n,default:i?1:undefined,name:r?"badges.bottomRight.image.scale":undefined})},stroke:{color:e.createAttribute(true,{storage:n,default:i?"black":undefined,name:r?"badges.bottomRight.stroke.color":undefined}),width:e.createAttribute(true,{storage:n,default:i?2:undefined,name:r?"badges.bottomRight.stroke.width":undefined}),scalingMethod:e.createAttribute(true,{storage:n,default:i?"fixed":undefined,name:r?"badges.bottomRight.stroke.scalingMethod":undefined})},text:{content:e.createAttribute(true,{storage:n,default:i?null:undefined,name:r?"badges.bottomRight.text.content":undefined}),color:e.createAttribute(true,{storage:n,default:i?"black":undefined,name:r?"badges.bottomRight.text.color":undefined}),font:e.createAttribute(true,{storage:n,default:i?"Arial":undefined,name:r?"badges.bottomRight.text.font":undefined}),style:e.createAttribute(true,{storage:n,default:i?"normal":undefined,name:r?"badges.bottomRight.text.style":undefined}),scale:e.createAttribute(true,{storage:n,default:i?.5:undefined,name:r?"badges.bottomRight.text.scale":undefined})}}},halo:{color:e.createAttribute(true,{storage:n,default:i?null:undefined,name:r?"halo.color":undefined}),width:e.createAttribute(true,{storage:n,default:i?50:undefined,name:r?"halo.width":undefined}),scalingMethod:e.createAttribute(true,{storage:n,default:i?"fixed":undefined,name:r?"halo.scalingMethod":undefined}),strokeColor:e.createAttribute(true,{storage:n,default:i?null:undefined,name:r?"halo.strokeColor":undefined}),strokeWidth:e.createAttribute(true,{storage:n,default:i?1:undefined,name:r?"halo.strokeWidth":undefined}),clustering:e.createAttribute(true,{storage:n,default:i?false:undefined,name:r?"halo.clustering":undefined}),hideNonAdjacentEdges:e.createAttribute(true,{storage:n,default:i?false:undefined,name:r?"halo.hideNonAdjacentEdges":undefined})},pulse:{enabled:e.createAttribute(true,{storage:n,default:i?false:undefined,name:r?"pulse.enabled":undefined}),duration:e.createAttribute(true,{storage:n,default:i?1e3:undefined,name:r?"pulse.duration":undefined}),interval:e.createAttribute(true,{storage:n,default:i?800:undefined,name:r?"pulse.interval":undefined}),startColor:e.createAttribute(true,{storage:n,default:i?"rgba(0, 0, 0, 0.6)":undefined,name:r?"pulse.startColor":undefined}),endColor:e.createAttribute(true,{storage:n,default:i?"rgba(0, 0, 0, 0)":undefined,name:r?"pulse.endColor":undefined}),width:e.createAttribute(true,{storage:n,default:i?50:undefined,name:r?"pulse.width":undefined}),startRatio:e.createAttribute(true,{storage:n,default:i?1:undefined,name:r?"pulse.startRatio":undefined}),endRatio:e.createAttribute(true,{storage:n,default:i?2:undefined,name:r?"pulse.endRatio":undefined})},icon:{content:e.createAttribute(true,{storage:n,default:i?null:undefined,name:r?"icon.content":undefined}),font:e.createAttribute(true,{storage:n,default:i?"Arial":undefined,name:r?"icon.font":undefined}),color:e.createAttribute(true,{storage:n,default:i?"black":undefined,name:r?"icon.color":undefined}),scale:e.createAttribute(true,{storage:n,default:i?.7:undefined,name:r?"icon.scale":undefined}),style:e.createAttribute(true,{storage:n,default:i?"normal":undefined,name:r?"icon.style":undefined}),minVisibleSize:e.createAttribute(true,{storage:n,default:i?12:undefined,name:r?"icon.minVisibleSize":undefined})},image:{url:e.createAttribute(true,{storage:n,default:i?null:undefined,name:r?"image.url":undefined}),scale:e.createAttribute(true,{storage:n,default:i?1:undefined,name:r?"image.scale":undefined}),fit:e.createAttribute(true,{storage:n,default:i?true:undefined,name:r?"image.fit":undefined}),tile:e.createAttribute(true,{storage:n,default:i?false:undefined,name:r?"image.tile":undefined}),minVisibleSize:e.createAttribute(true,{storage:n,default:i?12:undefined,name:r?"image.minVisibleSize":undefined})},outline:{enabled:e.createAttribute(true,{storage:n,default:i?false:undefined,name:r?"outline.enabled":undefined}),color:e.createAttribute(true,{storage:n,default:i?"rgba(0, 0, 0, 0.36)":undefined,name:r?"outline.color":undefined}),minVisibleSize:e.createAttribute(true,{storage:n,default:i?12:undefined,name:r?"outline.minVisibleSize":undefined})},text:{content:e.createAttribute(true,{storage:n,default:i?null:undefined,name:r?"text.content":undefined}),font:e.createAttribute(true,{storage:n,default:i?"Arial":undefined,name:r?"text.font":undefined}),color:e.createAttribute(true,{storage:n,default:i?"black":undefined,name:r?"text.color":undefined}),size:e.createAttribute(true,{storage:n,default:i?12:undefined,name:r?"text.size":undefined}),scale:e.createAttribute(true,{storage:n,default:i?.1:undefined,name:r?"text.scale":undefined}),style:e.createAttribute(true,{storage:n,default:i?"normal":undefined,name:r?"text.style":undefined}),align:e.createAttribute(true,{storage:n,default:i?"center":undefined,name:r?"text.align":undefined}),margin:e.createAttribute(true,{storage:n,default:i?10:undefined,name:r?"text.margin":undefined}),padding:e.createAttribute(true,{storage:n,default:i?2:undefined,name:r?"text.padding":undefined}),backgroundColor:e.createAttribute(true,{storage:n,default:i?null:undefined,name:r?"text.backgroundColor":undefined}),tip:e.createAttribute(true,{storage:n,default:i?true:undefined,name:r?"text.tip":undefined}),minVisibleSize:e.createAttribute(true,{storage:n,default:i?24:undefined,name:r?"text.minVisibleSize":undefined}),scaling:e.createAttribute(true,{storage:n,default:i?false:undefined,name:r?"text.scaling":undefined}),position:e.createAttribute(true,{storage:n,default:i?"bottom":undefined,name:r?"text.position":undefined}),maxLineLength:e.createAttribute(true,{storage:n,default:i?0:undefined,name:r?"text.maxLineLength":undefined}),truncateLength:e.createAttribute(true,{storage:n,default:i?0:undefined,name:r?"text.truncateLength":undefined}),secondary:{content:e.createAttribute(true,{storage:n,default:i?null:undefined,name:r?"text.secondary.content":undefined}),font:e.createAttribute(true,{storage:n,default:i?"Arial":undefined,name:r?"text.secondary.font":undefined}),color:e.createAttribute(true,{storage:n,default:i?"black":undefined,name:r?"text.secondary.color":undefined}),size:e.createAttribute(true,{storage:n,default:i?10:undefined,name:r?"text.secondary.size":undefined}),scale:e.createAttribute(true,{storage:n,default:i?.08:undefined,name:r?"text.secondary.scale":undefined}),style:e.createAttribute(true,{storage:n,default:i?"normal":undefined,name:r?"text.secondary.style":undefined}),align:e.createAttribute(true,{storage:n,default:i?"center":undefined,name:r?"text.secondary.align":undefined}),margin:e.createAttribute(true,{storage:n,default:i?5:undefined,name:r?"text.secondary.margin":undefined}),padding:e.createAttribute(true,{storage:n,default:i?2:undefined,name:r?"text.secondary.padding":undefined}),backgroundColor:e.createAttribute(true,{storage:n,default:i?null:undefined,name:r?"text.secondary.backgroundColor":undefined}),minVisibleSize:e.createAttribute(true,{storage:n,default:i?24:undefined,name:r?"text.secondary.minVisibleSize":undefined})}}}}function Gl(e,t){var r=t.named,i=t.useDefaultValues;var n="resource";return{width:e.createAttribute(false,{storage:n,default:i?1:undefined,name:r?"width":undefined}),scalingMethod:e.createAttribute(false,{storage:n,default:i?"scaled":undefined,name:r?"scalingMethod":undefined}),color:e.createAttribute(false,{storage:n,default:i?"grey":undefined,name:r?"color":undefined}),opacity:e.createAttribute(false,{storage:n,default:i?1:undefined,name:r?"opacity":undefined}),minVisibleSize:e.createAttribute(false,{storage:n,default:i?0:undefined,name:r?"minVisibleSize":undefined}),layer:e.createAttribute(false,{storage:n,default:i?0:undefined,name:r?"layer":undefined}),detectable:e.createAttribute(false,{storage:n,default:i?true:undefined,name:r?"detectable":undefined}),curvature:e.createAttribute(false,{storage:n,default:i?0:undefined,name:r?"curvature":undefined}),adjustAnchors:e.createAttribute(false,{storage:n,default:i?true:undefined,name:r?"adjustAnchors":undefined}),shape:{type:e.createAttribute(false,{storage:n,default:i?"line":undefined,name:r?"shape.type":undefined}),head:e.createAttribute(false,{storage:n,default:i?null:undefined,name:r?"shape.head":undefined}),tail:e.createAttribute(false,{storage:n,default:i?null:undefined,name:r?"shape.tail":undefined}),style:e.createAttribute(false,{storage:n,default:i?"plain":undefined,name:r?"shape.style":undefined})},stroke:{color:e.createAttribute(false,{storage:n,default:i?"inherit":undefined,name:r?"stroke.color":undefined}),width:e.createAttribute(false,{storage:n,default:i?0:undefined,name:r?"stroke.width":undefined}),scalingMethod:e.createAttribute(false,{storage:n,default:i?"fixed":undefined,name:r?"stroke.scalingMethod":undefined}),minVisibleSize:e.createAttribute(false,{storage:n,default:i?0:undefined,name:r?"stroke.minVisibleSize":undefined})},halo:{color:e.createAttribute(false,{storage:n,default:i?null:undefined,name:r?"halo.color":undefined}),width:e.createAttribute(false,{storage:n,default:i?10:undefined,name:r?"halo.width":undefined}),scalingMethod:e.createAttribute(false,{storage:n,default:i?"fixed":undefined,name:r?"halo.scalingMethod":undefined})},pulse:{enabled:e.createAttribute(false,{storage:n,default:i?false:undefined,name:r?"pulse.enabled":undefined}),duration:e.createAttribute(false,{storage:n,default:i?1e3:undefined,name:r?"pulse.duration":undefined}),interval:e.createAttribute(false,{storage:n,default:i?800:undefined,name:r?"pulse.interval":undefined}),startColor:e.createAttribute(false,{storage:n,default:i?"rgba(0, 0, 0, 0.6)":undefined,name:r?"pulse.startColor":undefined}),endColor:e.createAttribute(false,{storage:n,default:i?"rgba(0, 0, 0, 0)":undefined,name:r?"pulse.endColor":undefined}),width:e.createAttribute(false,{storage:n,default:i?10:undefined,name:r?"pulse.width":undefined}),startRatio:e.createAttribute(false,{storage:n,default:i?1:undefined,name:r?"pulse.startRatio":undefined}),endRatio:e.createAttribute(false,{storage:n,default:i?2:undefined,name:r?"pulse.endRatio":undefined})},outline:{enabled:e.createAttribute(false,{storage:n,default:i?false:undefined,name:r?"outline.enabled":undefined}),color:e.createAttribute(false,{storage:n,default:i?"rgba(0, 0, 0, 0.36)":undefined,name:r?"outline.color":undefined}),minVisibleSize:e.createAttribute(false,{storage:n,default:i?0:undefined,name:r?"outline.minVisibleSize":undefined})},text:{content:e.createAttribute(false,{storage:n,default:i?null:undefined,name:r?"text.content":undefined}),font:e.createAttribute(false,{storage:n,default:i?"Arial":undefined,name:r?"text.font":undefined}),color:e.createAttribute(false,{storage:n,default:i?"black":undefined,name:r?"text.color":undefined}),size:e.createAttribute(false,{storage:n,default:i?12:undefined,name:r?"text.size":undefined}),scale:e.createAttribute(false,{storage:n,default:i?1:undefined,name:r?"text.scale":undefined}),style:e.createAttribute(false,{storage:n,default:i?"normal":undefined,name:r?"text.style":undefined}),align:e.createAttribute(false,{storage:n,default:i?"center":undefined,name:r?"text.align":undefined}),margin:e.createAttribute(false,{storage:n,default:i?2:undefined,name:r?"text.margin":undefined}),padding:e.createAttribute(false,{storage:n,default:i?2:undefined,name:r?"text.padding":undefined}),backgroundColor:e.createAttribute(false,{storage:n,default:i?null:undefined,name:r?"text.backgroundColor":undefined}),minVisibleSize:e.createAttribute(false,{storage:n,default:i?4:undefined,name:r?"text.minVisibleSize":undefined}),adjustAngle:e.createAttribute(false,{storage:n,default:i?true:undefined,name:r?"text.adjustAngle":undefined}),scaling:e.createAttribute(false,{storage:n,default:i?false:undefined,name:r?"text.scaling":undefined}),maxLineLength:e.createAttribute(false,{storage:n,default:i?0:undefined,name:r?"text.maxLineLength":undefined}),secondary:{content:e.createAttribute(false,{storage:n,default:i?null:undefined,name:r?"text.secondary.content":undefined}),font:e.createAttribute(false,{storage:n,default:i?"Arial":undefined,name:r?"text.secondary.font":undefined}),color:e.createAttribute(false,{storage:n,default:i?"black":undefined,name:r?"text.secondary.color":undefined}),size:e.createAttribute(false,{storage:n,default:i?12:undefined,name:r?"text.secondary.size":undefined}),scale:e.createAttribute(false,{storage:n,default:i?.8:undefined,name:r?"text.secondary.scale":undefined}),style:e.createAttribute(false,{storage:n,default:i?"normal":undefined,name:r?"text.secondary.style":undefined}),align:e.createAttribute(false,{storage:n,default:i?"center":undefined,name:r?"text.secondary.align":undefined}),margin:e.createAttribute(false,{storage:n,default:i?2:undefined,name:r?"text.secondary.margin":undefined}),padding:e.createAttribute(false,{storage:n,default:i?2:undefined,name:r?"text.secondary.padding":undefined}),backgroundColor:e.createAttribute(false,{storage:n,default:i?null:undefined,name:r?"text.secondary.backgroundColor":undefined}),minVisibleSize:e.createAttribute(false,{storage:n,default:i?4:undefined,name:r?"text.secondary.minVisibleSize":undefined})}}}}function ql(e){return e===null?e:undefined}function Hl(e){return typeof e==="boolean"||e===0||e===1?e:undefined}function Wl(e){return typeof e==="number"&&isFinite(e)?e:undefined}function Xl(e){return typeof e==="number"&&isFinite(e)&&e>=0?e:undefined}function Yl(e){return typeof e==="number"&&isFinite(e)&&e>0?e:undefined}var Zl=-1;var Kl=4;var Ql=new Function("x","return (typeof x === 'number' && isFinite(x) && x % 1 === 0 && x >= "+Zl+" && x <= "+Kl+") ? x : undefined;");function Jl(e){return e===null||typeof e==="string"||typeof e==="number"?e:undefined}function $l(e){return e==="fixed"||e==="scaled"?e:undefined}function ed(e,t){return t.parseColor(e)?e:undefined}function td(e,t){return e==="inherit"||t.parseColor(e)?e:undefined}function rd(e,t){return e==="source"||e==="target"||!!t.parseColor(e)?e:undefined}function id(e){if(e===null){return null}if(typeof e!=="string"){return undefined}return e.split(",").map(function(e){var t=e.trim();var r=t.indexOf(" ")!==-1;var i=t[0];return r&&i!=='"'&&i!=="'"?'"'+t+'"':t}).join(",")}function nd(e){if(e==="none"){return"normal"}return e==="normal"||e==="italic"||e==="bold"||e==="italic bold"?e:undefined}function ad(e){return e==="left"||e==="center"?e:undefined}function od(e){if(e==="equilateral"){return"pentagon"}return e==="circle"||e==="square"||e==="cross"||e==="diamond"||e==="pentagon"||e==="star"?e:undefined}function sd(e){return["line","tapered","arrow","dashed","dotted"].includes(e)?e:undefined}function ud(e){return e==="line"||e==="triangle"?e:undefined}function ld(e){return[null,"arrow","circle-hole-arrow","triangle-hole-arrow","short-arrow","sharp-arrow","circle","square"].includes(e)?e:undefined}function dd(e){return e==="plain"||e==="dashed"||e==="dotted"?e:undefined}function hd(e){return e==="top"||e==="bottom"||e==="left"||e==="right"||e==="center"?e:undefined}function fd(e,t){if(t.parseColor(e)){return e}if(Array.isArray(e)){if(e.length<1){return undefined}for(var r=0;r<e.length;++r){if(!t.parseColor(e[r])){return undefined}}return e}return undefined}function cd(e){return new Function("x",["if (typeof x === 'number') { return (typeof x === 'number' && isFinite(x) && x >= 0) ? x : undefined; }","else if (typeof x !== 'string' || x.charAt(x.length - 1) !== '%') { return undefined; }","else { var p = parseFloat(x); return isNaN(p) ? undefined : ("+e+" * p / 100); }"].join("\n"))}function vd(e){return{_check:Jl,_set:new Function("flexArrays","index","value",["flexArrays.badges."+e+".text.content.set(index, value);","if (value === null || value === undefined) flexArrays.badges."+e+".image.url.set(index, value);"].join("\n")),_get:new Function("flexArrays","index","return flexArrays.badges."+e+".text.content.get(index);"),color:{_flexArray:"white",_check:td},scale:{_flexArray:.45,_check:cd(.45)},positionScale:{_flexArray:1,_check:Xl},minVisibleSize:{_flexArray:12,_check:cd(12)},image:{_alias:"badges."+e+".image.url",url:{_flexArray:null,_check:Jl},scale:{_flexArray:1,_check:cd(1)}},stroke:{color:{_flexArray:"black",_check:td},width:{_flexArray:2,_check:cd(2)},scalingMethod:{_flexArray:"fixed",_check:$l}},text:{_alias:"badges."+e+".text.content",content:{_flexArray:null,_check:Jl},color:{_flexArray:"black",_check:td},font:{_flexArray:"Arial",_check:id},style:{_flexArray:"normal",_check:nd},scale:{_flexArray:.5,_check:cd(.5)}},threshold:"badges."+e+".minVisibleSize"}}var pd={_check:Hl,_get:function e(t,r){return t.opacity.get(r)===0},_set:function e(t,r,value){t.opacity.set(r,value===undefined?undefined:+!value)}};var gd={x:{_flexArray:0,_check:Wl,_disableMemoryOptimization:true},y:{_flexArray:0,_check:Wl,_disableMemoryOptimization:true},radius:{_flexArray:5,_check:cd(5)},scalingMethod:{_flexArray:"scaled",_check:$l},color:{_flexArray:"grey",_check:fd},opacity:{_flexArray:1,_check:Xl},hidden:pd,shape:{_flexArray:"circle",_check:od},layer:{_flexArray:0,_check:Ql},detectable:{_flexArray:true,_check:Hl},draggable:{_flexArray:true,_check:Hl},layoutable:{_flexArray:true,_check:Hl},innerStroke:{_alias:"outerStroke.color",width:{_flexArray:2,_check:cd(2)},scalingMethod:{_flexArray:"fixed",_check:$l},color:{_flexArray:"white",_check:td},minVisibleSize:{_flexArray:12,_check:cd(12)},threshold:"innerStroke.minVisibleSize"},outerStroke:{_alias:"outerStroke.color",width:{_flexArray:5,_check:cd(5)},scalingMethod:{_flexArray:"fixed",_check:$l},color:{_flexArray:null,_check:td},minVisibleSize:{_flexArray:0,_check:cd(0)},threshold:"outerStroke.minVisibleSize"},badges:{_check:ql,_set:function e(t,r,value){t.badges.topLeft.text.content.set(r,value);t.badges.topLeft.image.url.set(r,value);t.badges.topRight.text.content.set(r,value);t.badges.topRight.image.url.set(r,value);t.badges.bottomLeft.text.content.set(r,value);t.badges.bottomLeft.image.url.set(r,value);t.badges.bottomRight.text.content.set(r,value);t.badges.bottomRight.image.url.set(r,value)},topLeft:vd("topLeft"),topRight:vd("topRight"),bottomLeft:vd("bottomLeft"),bottomRight:vd("bottomRight")},halo:{_alias:"halo.color",color:{_flexArray:null,_check:ed},width:{_flexArray:50,_check:cd(50)},scalingMethod:{_flexArray:"fixed",_check:$l},strokeColor:{_flexArray:null,_check:ed},strokeWidth:{_flexArray:1,_check:cd(1)},clustering:{_flexArray:false,_check:Hl},hideNonAdjacentEdges:{_flexArray:false,_check:Hl},size:"halo.width"},pulse:{enabled:{_flexArray:false,_check:Hl},duration:{_flexArray:1e3,_check:Xl},interval:{_flexArray:800,_check:Xl},startColor:{_flexArray:"rgba(0, 0, 0, 0.6)",_check:td},endColor:{_flexArray:"rgba(0, 0, 0, 0)",_check:td},width:{_flexArray:50,_check:Xl},startRatio:{_flexArray:1,_check:Xl},endRatio:{_flexArray:2,_check:Xl}},icon:{_alias:"icon.content",content:{_flexArray:null,_check:Jl},font:{_flexArray:"Arial",_check:id},color:{_flexArray:"black",_check:ed},scale:{_flexArray:.7,_check:cd(.7)},style:{_flexArray:"normal",_check:nd},minVisibleSize:{_flexArray:12,_check:cd(12)},threshold:"icon.minVisibleSize"},image:{_alias:"image.url",url:{_flexArray:null,_check:Jl},scale:{_flexArray:1,_check:cd(1)},fit:{_flexArray:true,_check:Hl},tile:{_flexArray:false,_check:Hl},minVisibleSize:{_flexArray:12,_check:cd(12)},rescale:"image.fit",duplicate:"image.tile",threshold:"image.minVisibleSize"},outline:{_alias:"outline.enabled",enabled:{_flexArray:false,_check:Hl},color:{_flexArray:"rgba(0, 0, 0, 0.36)",_check:ed},minVisibleSize:{_flexArray:12,_check:cd(12)}},text:{_alias:"text.content",content:{_flexArray:null,_check:Jl},font:{_flexArray:"Arial",_check:id},color:{_flexArray:"black",_check:td},size:{_flexArray:12,_check:cd(12)},scale:{_flexArray:.1,_check:Xl},style:{_flexArray:"normal",_check:nd},align:{_flexArray:"center",_check:ad},margin:{_flexArray:10,_check:cd(10)},padding:{_flexArray:2,_check:cd(2)},backgroundColor:{_flexArray:null,_check:td},tip:{_flexArray:true,_check:Hl},minVisibleSize:{_flexArray:24,_check:cd(24)},scaling:{_flexArray:false,_check:Hl},position:{_flexArray:"bottom",_check:hd},maxLineLength:{_flexArray:0,_check:Xl},truncateLength:{_flexArray:0,_check:Xl},backgroundArrowBaseSize:"text.margin",backgroundMargin:"text.padding",threshold:"text.minVisibleSize",secondary:{_alias:"text.secondary.content",content:{_flexArray:null,_check:Jl},font:{_flexArray:"Arial",_check:id},color:{_flexArray:"black",_check:td},size:{_flexArray:10,_check:cd(10)},scale:{_flexArray:.08,_check:Xl},style:{_flexArray:"normal",_check:nd},align:{_flexArray:"center",_check:ad},margin:{_flexArray:5,_check:cd(5)},padding:{_flexArray:2,_check:cd(2)},backgroundColor:{_flexArray:null,_check:td},minVisibleSize:{_flexArray:24,_check:cd(24)},backgroundArrowBaseSize:"text.secondary.margin",backgroundMargin:"text.secondary.padding",threshold:"text.secondary.minVisibleSize"}}};function _d(e,t,value){var r=undefined;var i=undefined;var n=undefined;var a=undefined;if(value==="line"){r="line";i="plain";n=null;a=null}else if(value==="arrow"){r="line";i="plain";n="arrow";a=null}else if(value==="tapered"){r="triangle";i="plain";n=null;a=null}else if(value==="dashed"){r="line";i="dashed";n=null;a=null}else if(value==="dotted"){r="line";i="dotted";n=null;a=null}e.shape.type.set(t,r);e.shape.style.set(t,i);e.shape.head.set(t,n);e.shape.tail.set(t,a)}var md={width:{_flexArray:1,_check:cd(1)},scalingMethod:{_flexArray:"scaled",_check:$l},color:{_flexArray:"grey",_check:rd},opacity:{_flexArray:1,_check:Xl},hidden:pd,minVisibleSize:{_flexArray:0,_check:Xl},threshold:"minVisibleSize",layer:{_flexArray:0,_check:Ql},detectable:{_flexArray:true,_check:Hl},curvature:{_flexArray:0,_check:Wl},adjustAnchors:{_flexArray:true,_check:Hl},shape:{_check:sd,_set:_d,type:{_flexArray:"line",_check:ud},head:{_flexArray:null,_check:ld},tail:{_flexArray:null,_check:ld},style:{_flexArray:"plain",_check:dd}},stroke:{color:{_flexArray:"inherit",_check:td},width:{_flexArray:0,_check:cd(0)},scalingMethod:{_flexArray:"fixed",_check:$l},minVisibleSize:{_flexArray:0,_check:Xl}},strokeWidth:"stroke.width",halo:{_alias:"halo.color",color:{_flexArray:null,_check:ed},width:{_flexArray:10,_check:cd(10)},scalingMethod:{_flexArray:"fixed",_check:$l},size:"halo.width"},pulse:{enabled:{_flexArray:false,_check:Hl},duration:{_flexArray:1e3,_check:Xl},interval:{_flexArray:800,_check:Xl},startColor:{_flexArray:"rgba(0, 0, 0, 0.6)",_check:td},endColor:{_flexArray:"rgba(0, 0, 0, 0)",_check:td},width:{_flexArray:10,_check:Xl},startRatio:{_flexArray:1,_check:Xl},endRatio:{_flexArray:2,_check:Xl}},outline:{_alias:"outline.enabled",enabled:{_flexArray:false,_check:Hl},color:{_flexArray:"rgba(0, 0, 0, 0.36)",_check:ed},minVisibleSize:{_flexArray:0,_check:Xl}},text:{_alias:"text.content",content:{_flexArray:null,_check:Jl},font:{_flexArray:"Arial",_check:id},color:{_flexArray:"black",_check:ed},size:{_flexArray:12,_check:cd(12)},scale:{_flexArray:1,_check:Xl},style:{_flexArray:"normal",_check:nd},align:{_flexArray:"center",_check:ad},margin:{_flexArray:2,_check:cd(2)},padding:{_flexArray:2,_check:cd(2)},backgroundColor:{_flexArray:null,_check:td},minVisibleSize:{_flexArray:4,_check:Xl},threshold:"text.minVisibleSize",adjustAngle:{_flexArray:true,_check:Hl},scaling:{_flexArray:false,_check:Hl},maxLineLength:{_flexArray:0,_check:Xl},secondary:{_alias:"text.secondary.content",content:{_flexArray:null,_check:Jl},font:{_flexArray:"Arial",_check:id},color:{_flexArray:"black",_check:ed},size:{_flexArray:12,_check:cd(12)},scale:{_flexArray:.8,_check:Xl},style:{_flexArray:"normal",_check:nd},align:{_flexArray:"center",_check:ad},margin:{_flexArray:2,_check:cd(2)},padding:{_flexArray:2,_check:cd(2)},backgroundColor:{_flexArray:null,_check:td},minVisibleSize:{_flexArray:4,_check:Xl},threshold:"text.secondary.minVisibleSize"}}};var yd={name:"animationStart",storage:32,default:0};var bd={name:"animationDuration",storage:16,default:0};var xd={name:"animationEasing",storage:"resource",default:"linear"};var Ad={self:{attributes:"all",tags:[],selection:true,hover:false,data:true},adjacentNodes:{attributes:"all",tags:[],selection:true,hover:false,data:true},adjacentEdges:{attributes:"all",tags:[],selection:true,hover:false,data:true},allNodes:null,allEdges:null};var Ed={self:{attributes:"all",tags:[],selection:true,hover:false,data:true},extremities:{attributes:"all",tags:[],selection:true,hover:false,data:true},parallelEdges:{attributes:"all",tags:[],selection:true,hover:false,data:true},allNodes:null,allEdges:null};var Sd=["x","y","radius","halo.hideNonAdjacentEdges"];var wd=Rd(gd);var Td=Rd(md);var Cd=function e(t,r,i){this._colorManager=r;this._graph=t.graph;this._isNode=i;this._eltName=i?"node":"edge";this._accessors=i?wd:Td;this._createFlexArrays=i?Ul:Gl;this._finalFlexArrays=this._createFlexArrays(this._graph,{named:true,useDefaultValues:true});this._prevFlexArrays=this._createFlexArrays(this._graph,{named:false,useDefaultValues:true});this._defaultFlexArrays=this._createFlexArrays(this._graph,{named:false,useDefaultValues:true});this._allAttributePaths=q(this._defaultFlexArrays);this._currentFlexArrays=this._defaultFlexArrays;this._lastFlexArrays=null;this.setLastFlexArrays(this._defaultFlexArrays);this._elementsToRedraw=new jl({graph:this._graph,isNode:i,includeRemovedElements:true});this._elementsUpdated=new jl({graph:this._graph,isNode:i,includeRemovedElements:false});this._updatedAttributes=new Ei;this._updatedAttributesTmp=new Ei;this._allUsedAttributes=new Ei;this._finalFlexArraysWrapped=Object.assign({},this._finalFlexArrays,{excluded:this._graph.getAttribute(i,"excluded"),textHidden:this._graph.getAttribute(i,"textHidden"),animationStart:this._graph.createAttribute(i,yd),animationDuration:this._graph.createAttribute(i,bd),animationEasing:this._graph.createAttribute(i,xd),id:this._graph.getAttribute(i,"id")});if(!i){Object.assign(this._finalFlexArraysWrapped,{source:this._graph.getEdgeAttribute("source"),target:this._graph.getEdgeAttribute("target")})}};Cd.prototype.clear=function e(){this._elementsToRedraw.clear();this._elementsUpdated.clear();this._updatedAttributes.clear();this._updatedAttributesTmp.clear()};Cd.prototype.getAttributeFlexArrays=function e(){return this._finalFlexArraysWrapped};Cd.prototype.getPrevAttributeFlexArrays=function e(){return this._prevFlexArrays};Cd.prototype.getAnimationInformation=function e(t){var r=t._indexes;var i=new Array(r.length);for(var n=0;n<r.length;++n){var a=r[n];i[n]={duration:this._finalFlexArraysWrapped.animationDuration.get(a),start:this._finalFlexArraysWrapped.animationStart.get(a),easing:this._finalFlexArraysWrapped.animationEasing.get(a)}}return i};Cd.prototype.startUpdate=function e(){};Cd.prototype.prepareFlexArraysUpdate=function e(t){this._currentFlexArrays=t.inputFlexArrays};Cd.prototype.setLastFlexArrays=function e(t){this._lastFlexArrays=t};Cd.prototype.updateFlexArrays=function e(t){var r=t.attributes;var i=t.selector;var n=t.context;var a=t.outputFlexArrays;var o=t.toUpdate;var s=t.formattedOutput;this._elementsUpdated.addSet(o);this._elementsToRedraw.addSet(o);var u=o.getListAndClear(true);if(r&&u.size){var l=Ir(this._graph,u,i,n);var d=l.valid;var h=l.invalid;for(var f=0,c=s.attributes;f<c.length;f+=1){var v=c[f];var p=j(a,v);for(var g=0,_=h._indexes;g<_.length;g+=1){var m=_[g];p.set(m,undefined)}}this._assignAttributesToFlexArrays(this._accessors,a,d,r,n);this._addUpdatedAttributes(t)}};Cd.prototype.endUpdate=function e(){var t=this._elementsUpdated.getList();var r=this._updatedAttributesTmp.values();for(var i=0,n=r;i<n.length;i+=1){var a=n[i];var o=j(this._lastFlexArrays,a);var s=j(this._finalFlexArrays,a);for(var u=0,l=t._indexes;u<l.length;u+=1){var d=l[u];s.set(d,o.get(d))}}this._updatedAttributesTmp.clear();this._currentFlexArrays=this._finalFlexArrays};Cd.prototype.setAttributeValues=function e(t,r,i,n){var a=t.outputFlexArrays;var o=this._accessors;var s=null;this._assignAttributesToFlexArrays(o,a,r,i,s);this._addUpdatedAttributes(t,n);this._elementsUpdated.add(r);this._elementsToRedraw.add(r)};Cd.prototype.notifyLayerDestroyed=function e(t){this._addUpdatedAttributes(t)};Cd.prototype._addUpdatedAttributes=function e(t,r){var i=t.outputFlexArrays;var n=t.formattedOutput;var a=Array.isArray(r)?qd(r):n.attributes;for(var o=0,s=a;o<s.length;o+=1){var u=s[o];var l=j(i,u);if(l.isInitialized()){this._updatedAttributes.add(u);this._updatedAttributesTmp.add(u);this._allUsedAttributes.add(u)}}};Cd.prototype.getUsedAttributeNames=function e(t){return Md(t.outputFlexArrays)};Cd.prototype.redrawElements=function e(t){this._elementsToRedraw.add(t)};Cd.prototype.redrawAll=function e(){this._elementsToRedraw.addAll()};Cd.prototype.getAndResetElementsToRedraw=function e(){return this._elementsToRedraw.getListAndClear()};Cd.prototype.getAndResetElementsUpdated=function e(){return this._elementsUpdated.getListAndClear()};Cd.prototype.getAndResetAttributesUpdated=function e(){var t=this._updatedAttributes.values();this._updatedAttributes.clear();return t};Cd.prototype.createFlexArrays=function e(){return this._createFlexArrays(this._graph,{named:false,useDefaultValues:false})};Cd.prototype.getAttributeValues=function e(t,r,i,n){var a=n?this._prevFlexArrays:this._currentFlexArrays;if(i){return this._getMultipleAttributeValues(t,r,a)}else{return this._getSingleAttributeValues(t,r,a)}};Cd.prototype._getAccessor=function e(t){if(t===void 0)t="";var r=this._accessors;var i=C(t);for(var n=0,a=i;n<a.length;n+=1){var o=a[n];r=r.nested[o];if(!r){throw new Error(this._eltName+' attribute "'+i.join("")+'" does not exist')}}return r};Cd.prototype._getSingleAttributeValues=function e(t,r,i){var n=this._getAccessor(r);var a=t._indexes;var o=new Array(a.length);for(var s=0;s<a.length;++s){o[s]=n.get(i,a[s])}return o};Cd.prototype._getMultipleAttributeValues=function e(t,r,i){if(!r||r==="all"){return this._getSingleAttributeValues(t,"",i)}var n=new Array(t.size);for(var a=0;a<n.length;++a){n[a]={}}for(var o=0;o<r.length;++o){var s=r[o];var u=this._getSingleAttributeValues(t,s,i);for(var l=0;l<n.length;++l){var d=n[l];var value=u[l];V(d,s,value)}}return n};Cd.prototype.setAnimationAttributes=function e(t,r){var i=r.duration;var n=r.startTime;var a=r.easing;var o=t._indexes;var s=this._finalFlexArraysWrapped.animationDuration;var u=this._finalFlexArraysWrapped.animationStart;var l=this._finalFlexArraysWrapped.animationEasing;var d=this._allUsedAttributes.values();if(i){var h=false;for(var f=0,c=d;f<c.length;f+=1){var v=c[f];if(v==="x"||v==="y"){h=true;continue}var p=j(this._finalFlexArrays,v);var g=j(this._prevFlexArrays,v);for(var _=0,m=o;_<m.length;_+=1){var y=m[_];g.set(y,p.get(y))}}if(h){var b=tt();var x=this._finalFlexArrays.x;var A=this._finalFlexArrays.y;var E=this._prevFlexArrays.x;var S=this._prevFlexArrays.y;for(var w=0;w<o.length;++w){var T=o[w];var C=s.get(T);if(C){var I=u.get(T);var M=l.get(T);var L=gl[M]||gl.linear;var k=Math.min((b-I)/C,1);var N=L(k);var F=$t(E.get(T),x.get(T),N);var z=$t(S.get(T),A.get(T),N);E.set(T,F);S.set(T,z)}else{E.set(T,x.get(T));S.set(T,A.get(T))}}}}s.fill(o,i);u.fill(o,n);l.fill(o,a)};Cd.prototype.resetAnimationAttributes=function e(t){this._finalFlexArraysWrapped.animationDuration.fill(t._indexes,0)};Cd.prototype.getUsedAttributes=function e(){return this._allUsedAttributes.values()};Cd.prototype.getDefaultFlexArrays=function e(){return this._defaultFlexArrays};Cd.prototype._assignAttributesToFlexArrays=function e(t,r,i,n,a,o){if(o===void 0)o=[];if(typeof n==="function"){var s=o.join(".");for(var u=0;u<i.size;++u){var l=i.get(u);var d=n(l,a,s);this._assignSingleValueToFlexArray(r,l,t,d,o)}}else if(Y(n)){var h=Object.keys(n);for(var f=0;f<h.length;++f){var c=h[f];o.push(c);var v=this._getNestedAccessor(t,c,o);var p=n[c];this._assignAttributesToFlexArrays(v,r,i,p,a,o);o.pop()}}else if((Array.isArray(n)||ArrayBuffer.isView(n))&&o[0]!=="color"){if(!o.length){for(var g=0;g<i.size;++g){this._assignSingleValueToFlexArray(r,i.get(g),t,n[g],o)}}else{for(var _=0;_<i.size;++_){var m=i._indexes[_];var y=t.check(n[_],this._colorManager);t.set(r,m,y)}}}else{var b=t.check(n,this._colorManager);for(var x=0;x<i.size;++x){var A=i.get(x);t.set(r,A._index,b)}}};Cd.prototype._getNestedAccessor=function e(t,r,i){var n=t.nested[r];if(!n){throw new Error(this._eltName+' attribute "'+i.join(".")+'" does not exist')}return n};Cd.prototype._assignSingleValueToFlexArray=function e(t,r,i,value,n){if(Y(value)){var a=Object.keys(value);for(var o=0,s=a;o<s.length;o+=1){var u=s[o];n.push(u);var l=value[u];var d=this._getNestedAccessor(i,u,n);this._assignSingleValueToFlexArray(t,r,d,l,n);n.pop()}}else{var h=i.check(value,this._colorManager);i.set(t,r._index,h)}};var Id=function e(t,r){this._ogma=r;this._graph=t.graph;this._dom=t.dom;this._colorManager=new Pi;this._textHiddenSet=new Qa(this._graph,"textHidden");this._nodes=new Cd(t,this._colorManager,true);this._edges=new Cd(t,this._colorManager,false);this._layerIdCounter=0;this._layers=[];this._destroyedLayers=[];this._layersNeedUpdate=false;this._updateOngoing=false;this._needUpdate=false};Id.prototype._getLayerById=function e(t){for(var r=0;r<this._layers.length;++r){var i=this._layers[r];if(i.id===t){i.index=r;return i}}throw new Error("usage of a destroyed style rule or class")};Id.prototype._fetch=function e(t){return t.isNode?this._nodes:this._edges};Id.prototype.getFlexArrays=function e(){return{nodes:{current:this._nodes.getAttributeFlexArrays(),previous:this._nodes.getPrevAttributeFlexArrays()},edges:{current:this._edges.getAttributeFlexArrays(),previous:this._edges.getPrevAttributeFlexArrays()}}};Id.prototype.createFlexArrays=function e(){return{nodes:this._nodes.createFlexArrays(),edges:this._edges.createFlexArrays()}};Id.prototype.clear=function e(){this._updateOngoing=false;this._needUpdate=false;this._destroyedLayers=[];this._nodes.clear();this._edges.clear();this.updateAllForAllAttributeLayers()};Id.prototype.redrawElements=function e(t){if(t.size){this._fetch(t).redrawElements(t);this._dom.refresh()}};Id.prototype.redrawAll=function e(){this._nodes.redrawAll();this._edges.redrawAll();this._dom.refresh()};Id.prototype._triggerUpdate=function e(){this._needUpdate=true;this._dom.refresh()};Id.prototype._reconstructAttributeLayersIfNecessary=function e(){if(this._layersNeedUpdate){this._reconstructAttributeLayers();this._layersNeedUpdate=false;this._dom.refresh();return true}return false};Id.prototype.getAnimationInformation=function e(t){return this._fetch(t).getAnimationInformation(t)};Id.prototype.update=function e(){if(!this._needUpdate||this._updateOngoing||!this._ogma._token){return false}this._reconstructAttributeLayersIfNecessary();this._updateOngoing=true;this._nodes.startUpdate();this._edges.startUpdate();for(var t=0,r=this._destroyedLayers;t<r.length;t+=1){var i=r[t];if(i.initialized){this._nodes.notifyLayerDestroyed(i.nodes);this._edges.notifyLayerDestroyed(i.edges)}}for(var n=0,a=this._layers;n<a.length;n+=1){var o=a[n];var s=o;var u=s.nodes;var l=s.edges;this._nodes.prepareFlexArraysUpdate(u);this._edges.prepareFlexArraysUpdate(l);this._nodes.updateFlexArrays(u);this._edges.updateFlexArrays(l)}this._nodes.endUpdate();this._edges.endUpdate();this._updateOngoing=false;this._needUpdate=false;return true};Id.prototype.setAttributeLayerValues=function e(t,r,i,n){var a=this._getLayerById(t);var o=r.isNode?a.nodes:a.edges;this._reconstructAttributeLayersIfNecessary();this._fetch(r).setAttributeValues(o,r,i,n);this._updateElementsForAttributeLayers([a],r)};Id.prototype.getAttributeLayerFlexArrays=function e(t){var r=this._getLayerById(t);return{nodes:r.nodes.outputFlexArrays,edges:r.edges.outputFlexArrays}};Id.prototype.getUsedAttributeLayerAttributes=function e(t,r){var i=this._getLayerById(t);return this._fetch(r).getUsedAttributeNames(r.isNode?i.nodes:i.edges)};Id.prototype.getAndResetElementsUpdated=function e(){return{nodes:this._nodes.getAndResetElementsUpdated(),edges:this._edges.getAndResetElementsUpdated(),nodeAttributes:this._nodes.getAndResetAttributesUpdated(),edgeAttributes:this._edges.getAndResetAttributesUpdated()}};Id.prototype.getAndResetElementsToRedraw=function e(){return{nodes:this._nodes.getAndResetElementsToRedraw(),edges:this._edges.getAndResetElementsToRedraw()}};Id.prototype.addAttributeLayer=function e(t){if(t===void 0)t={};if(t.name&&this._layers.find(function(e){return e.name===t.name})){throw new Error('attribute layer with name "'+t.name+'" already exists')}var r={id:++this._layerIdCounter,name:t.name,tag:t.tag,priority:0,depsNodeSelf:[],depsNodeAdjacentNodes:[],depsNodeAdjacentEdges:[],depsNodeAllNodes:[],depsNodeAllEdges:[],depsEdgeSelf:[],depsEdgeExtremities:[],depsEdgeParallelEdges:[],depsEdgeAllNodes:[],depsEdgeAllEdges:[],initialized:false,nodes:{name:t.name,standaloneSelector:!!t.standaloneSelectors,toUpdate:new jl({graph:this._graph,isNode:true,includeRemovedElements:false}),outputFlexArrays:this._nodes.createFlexArrays(),inputFlexArrays:null,formattedDependencies:null,formattedOutput:null},edges:{name:t.name,standaloneSelector:!!t.standaloneSelectors,toUpdate:new jl({graph:this._graph,isNode:false,includeRemovedElements:false}),outputFlexArrays:this._edges.createFlexArrays(),inputFlexArrays:null,formattedDependencies:null,formattedOutput:null}};this._layers.push(r);this._updateLayer(r,t);return new pl(this,this._layerIdCounter)};Id.prototype._reconstructAttributeLayers=function e(){this._layers.sort(function(e,t){return e.priority-t.priority});var t=O(this._nodes.getDefaultFlexArrays());var r=O(this._edges.getDefaultFlexArrays());var i=q(t);var n=q(r);for(var a=0,o=this._layers;a<o.length;a+=1){var s=o[a];s.nodes.allAttributePaths=i;s.edges.allAttributePaths=n;s.nodes.formattedDependencies=jd(s.nodes);s.edges.formattedDependencies=Ud(s.edges);s.nodes.formattedOutput=Od(s.nodes,s.tag);s.edges.formattedOutput=Od(s.edges,s.tag);s.nodes.redrawAdjacentEdges=s.nodes.formattedOutput.attributes.some(function(e){return Sd.includes(e)});s.initialized=true}for(var u=0,l=this._layers;u<l.length;u+=1){var d=l[u];d.nodes.inputFlexArrays=O(t);d.edges.inputFlexArrays=O(r);d.depsNodeSelf=[];d.depsNodeAdjacentNodes=[];d.depsNodeAdjacentEdges=[];d.depsNodeAllNodes=[];d.depsNodeAllEdges=[];d.depsEdgeSelf=[];d.depsEdgeExtremities=[];d.depsEdgeParallelEdges=[];d.depsEdgeAllNodes=[];d.depsEdgeAllEdges=[];d.nodes.toUpdate.addAll();d.edges.toUpdate.addAll();for(var h=0,f=d.nodes.formattedOutput.attributes;h<f.length;h+=1){var c=f[h];var v=j(t,c);var p=j(d.nodes.outputFlexArrays,c);p.setFallback(v);V(t,c,p)}for(var g=0,_=d.edges.formattedOutput.attributes;g<_.length;g+=1){var m=_[g];var y=j(r,m);var b=j(d.edges.outputFlexArrays,m);b.setFallback(y);V(r,m,b)}for(var x=0,A=this._layers;x<A.length;x+=1){var E=A[x];if(d===E){continue}var S=d.priority;var w=E.priority;var T=d.nodes.formattedOutput;var C=d.edges.formattedOutput;var I=E.nodes.formattedDependencies;var M=E.edges.formattedDependencies;Vd(d.depsNodeSelf,E,T,I.self,S,w);Vd(d.depsNodeAdjacentNodes,E,T,I.adjacentNodes,S,w);Vd(d.depsNodeAdjacentEdges,E,C,M.extremities,S,w);Vd(d.depsNodeAllNodes,E,T,I.allNodes,S,w);Vd(d.depsNodeAllEdges,E,C,M.allNodes,S,w);Vd(d.depsEdgeSelf,E,C,M.self,S,w);Vd(d.depsEdgeExtremities,E,T,I.adjacentEdges,S,w);Vd(d.depsEdgeParallelEdges,E,C,M.parallelEdges,S,w);Vd(d.depsEdgeAllNodes,E,T,I.allEdges,S,w);Vd(d.depsEdgeAllEdges,E,C,M.allEdges,S,w)}}this._nodes.setLastFlexArrays(t);this._edges.setLastFlexArrays(r);for(var L=0,k=this._layers;L<k.length;L+=1){var N=k[L];N.nodes.needAdjacentElements=N.nodes.redrawAdjacentEdges||N.depsNodeAdjacentNodes.length>0||N.depsNodeAdjacentEdges.length>0;N.edges.needAdjacentElements=N.depsEdgeExtremities.length>0||N.depsEdgeParallelEdges.length>0}};Id.prototype._updateLayer=function e(t,r){if(r===void 0)r={};var i=r.priority;var n=r.fullOverwrite;var a=r.nodeAttributes;var o=r.nodeSelector;var s=r.nodeContext;var u=r.nodeDependencies;var l=r.nodeOutput;var d=r.edgeAttributes;var h=r.edgeSelector;var f=r.edgeContext;var c=r.edgeDependencies;var v=r.edgeOutput;if(a!==undefined){t.nodes.attributes=n?a:Z(t.nodes.attributes,a)}if(o!==undefined){t.nodes.selector=o}if(s!==undefined){t.nodes.context=s}if(u!==undefined){t.nodes.dependencies=u}if(l!==undefined){t.nodes.output=l}if(d!==undefined){t.edges.attributes=n?d:Z(t.edges.attributes,d)}if(h!==undefined){t.edges.selector=h}if(f!==undefined){t.edges.context=f}if(c!==undefined){t.edges.dependencies=c}if(v!==undefined){t.edges.output=v}if(i!==undefined){t.priority=i}this._triggerLayerUpdate()};Id.prototype._triggerLayerUpdate=function e(){this._layersNeedUpdate=true;this._triggerUpdate()};Id.prototype.updateAllForAttributeLayer=function e(t){var r=this._getLayerById(t);this._updateAllForAttributeLayer(r)};Id.prototype.updateAllForAllAttributeLayers=function e(){for(var t=0,r=this._layers;t<r.length;t+=1){var i=r[t];this._updateAllForAttributeLayer(i)}};Id.prototype._updateAllForAttributeLayer=function e(t,r,i){if(r===void 0)r=true;if(i===void 0)i=true;if(r&&!t.nodes.toUpdate.isFull()){t.nodes.toUpdate.addAll();for(var n=0,a=t.depsNodeSelf;n<a.length;n+=1){var o=a[n];this._updateAllForAttributeLayer(o,true,false)}for(var s=0,u=t.depsNodeAdjacentNodes;s<u.length;s+=1){var l=u[s];this._updateAllForAttributeLayer(l,true,false)}for(var d=0,h=t.depsNodeAdjacentEdges;d<h.length;d+=1){var f=h[d];this._updateAllForAttributeLayer(f,false,true)}for(var c=0,v=t.depsNodeAllNodes;c<v.length;c+=1){var p=v[c];this._updateAllForAttributeLayer(p,true,false)}for(var g=0,_=t.depsNodeAllEdges;g<_.length;g+=1){var m=_[g];this._updateAllForAttributeLayer(m,false,true)}}if(i&&!t.edges.toUpdate.isFull()){t.edges.toUpdate.addAll();for(var y=0,b=t.depsEdgeSelf;y<b.length;y+=1){var x=b[y];this._updateAllForAttributeLayer(x,false,true)}for(var A=0,E=t.depsEdgeExtremities;A<E.length;A+=1){var S=E[A];this._updateAllForAttributeLayer(S,true,false)}for(var w=0,T=t.depsEdgeParallelEdges;w<T.length;w+=1){var C=T[w];this._updateAllForAttributeLayer(C,false,true)}for(var I=0,M=t.depsEdgeAllNodes;I<M.length;I+=1){var L=M[I];this._updateAllForAttributeLayer(L,true,false)}for(var k=0,N=t.depsEdgeAllEdges;k<N.length;k+=1){var F=N[k];this._updateAllForAttributeLayer(F,false,true)}}this._triggerUpdate()};Id.prototype.updateElementsForAttributeLayer=function e(t,r){var i=this._getLayerById(t);this._updateElementsForAttributeLayers([i],r)};Id.prototype.updateForAllAttributeLayers=function e(t){this._updateElementsForAttributeLayers(this._layers,t)};Id.prototype._updateElementsForAttributeLayers=function e(t,r){var i=null;if(r.isNode){for(var n=0,a=t;n<a.length;n+=1){var o=a[n];if(!o.nodes.toUpdate.isFull()){if(o.nodes.needAdjacentElements){i=i||r.fastGetAdjacentElements()}o.nodes.toUpdate.add(r);for(var s=0,u=o.depsNodeSelf;s<u.length;s+=1){var l=u[s];l.nodes.toUpdate.add(r)}for(var d=0,h=o.depsNodeAdjacentNodes;d<h.length;d+=1){var f=h[d];f.nodes.toUpdate.add(i.nodes)}for(var c=0,v=o.depsNodeAdjacentEdges;c<v.length;c+=1){var p=v[c];p.edges.toUpdate.add(i.edges)}for(var g=0,_=o.depsNodeAllNodes;g<_.length;g+=1){var m=_[g];this._updateAllForAttributeLayer(m,true,false)}for(var y=0,b=o.depsNodeAllEdges;y<b.length;y+=1){var x=b[y];this._updateAllForAttributeLayer(x,false,true)}if(o.nodes.redrawAdjacentEdges){this._edges.redrawElements(i.edges)}}}}else{for(var A=0,E=t;A<E.length;A+=1){var S=E[A];if(!S.edges.toUpdate.isFull()){if(S.edges.needAdjacentElements){i=i||r.fastGetAdjacentElements()}S.edges.toUpdate.add(r);for(var w=0,T=S.depsEdgeSelf;w<T.length;w+=1){var C=T[w];C.edges.toUpdate.add(r)}for(var I=0,M=S.depsEdgeExtremities;I<M.length;I+=1){var L=M[I];L.nodes.toUpdate.add(i.nodes)}for(var k=0,N=S.depsEdgeParallelEdges;k<N.length;k+=1){var F=N[k];F.edges.toUpdate.add(i.edges)}for(var z=0,R=S.depsEdgeAllNodes;z<R.length;z+=1){var P=R[z];this._updateAllForAttributeLayer(P,true,false)}for(var O=0,D=S.depsEdgeAllEdges;O<D.length;O+=1){var B=D[O];this._updateAllForAttributeLayer(B,false,true)}}}}this._triggerUpdate()};Id.prototype.destroyAttributeLayer=function e(t){var r=this._getLayerById(t);this._destroyedLayers.push(r);this._layers.splice(r.index,1);this._triggerLayerUpdate()};Id.prototype.updateAttributeLayer=function e(t,r){var i=this._getLayerById(t);this._updateLayer(i,r)};Id.prototype.getAttributeLayerDefinition=function e(t){var r=this._getLayerById(t);var i=r.priority;var n=r.nodes;var a=r.edges;return{priority:i,nodeAttributes:n.attributes,nodeSelector:n.selector,nodeContext:n.context,nodeDependencies:n.dependencies,nodeOutput:n.output,edgeAttributes:a.attributes,edgeSelector:a.selector,edgeContext:a.context,edgeDependencies:a.dependencies,edgeOutput:a.output}};Id.prototype.getAttributeValues=function e(t,r,i,n){this.update();return this._fetch(t).getAttributeValues(t,r,i,n)};Id.prototype.setAnimationAttributes=function e(t,r){var i=t.nodes;var n=t.edges;this._nodes.setAnimationAttributes(i,r);this._edges.setAnimationAttributes(n,r)};Id.prototype.resetAnimationAttributes=function e(t){var r=t.nodes;var i=t.edges;this._nodes.resetAnimationAttributes(r);this._edges.resetAnimationAttributes(i)};Id.prototype.setTextHidden=function e(t,value){var r=this._textHiddenSet.addOrRemoveElements(t,value);this.redrawElements(r)};Id.prototype.resetTextHidden=function e(){var t=this._textHiddenSet.getElements();var r=t.nodes;var i=t.edges;this._textHiddenSet.clear();this._nodes.redrawElements(r);this._edges.redrawElements(i)};Id.prototype.getUsedNodeAttributes=function e(){return this._nodes.getUsedAttributes()};Id.prototype.getUsedEdgeAttributes=function e(){return this._edges.getUsedAttributes()};function Md(e,t,r){if(t===void 0)t=[];if(r===void 0)r="";if(e.constructor===Xt){if(e.isInitialized()){t.push(r)}}else if(e.constructor===Object){Object.keys(e).forEach(function(i){Md(e[i],t,kd(r,i))})}return t}function Ld(e){return typeof e==="string"}function kd(e,t){return e?e+"."+t:t}function Nd(e,t){if(!e._check){throw new Error("error somewhere for "+t)}return{check:e._check,set:new Function("flexArrays","index","value","flexArrays."+t+".set(index, value);"),get:new Function("flexArrays","index","return flexArrays."+t+".get(index);"),nested:{}}}function Fd(){}function zd(){return undefined}function Rd(e,t,r){t=t||e;if(t._flexArray!==undefined){return Nd(t,r)}else{var i={};if(Ld(t)||t._alias){var n=Ld(t)?t:t._alias;var a=j(e,n);i=Nd(a,n)}else{if(t._set){i.set=t._set;i.check=t._check}else{i.set=Fd;i.check=zd}if(t._get){i.get=t._get}else{var o="return "+Pd(t,r)+";";i.get=new Function("flexArrays","index",o)}i.nested={}}if(!Ld(t)){var s=Object.keys(t);for(var u=0,l=s;u<l.length;u+=1){var d=l[u];var h=t[d];if(!d.startsWith("_")){i.nested[d]=Rd(e,h,kd(r,d))}}}return i}}function Pd(e,t){if(e._flexArray!==undefined){return"flexArrays."+t+".get(index)"}else{var r=[];var i=Object.keys(e);for(var n=0,a=i;n<a.length;n+=1){var o=a[n];var s=e[o];if(!o.startsWith("_")&&Y(s)){var u=Pd(e[o],kd(t,o));if(u){r.push(o+": "+u)}}}if(r.length){return"{\n"+r.join(",\n").split("\n").map(function(e){return"  "+e}).join("\n")+"\n}"}else{return""}}}function Od(e,t){return{attributes:Dd(e),tags:t?[t]:[]}}function Dd(e){var t=null;if(e.output===undefined){if(typeof e.attributes==="function"){t="all"}else if(Y(e.attributes)){t=q(e.attributes)}else{t=null}}else{t=e.output&&e.output.attributes}return qd(t,e.allAttributePaths)}function Bd(e,t,r,i){if(i>r){for(var n=0,a=t.attributes;n<a.length;n+=1){var o=a[n];for(var s=0,u=e.attributes;s<u.length;s+=1){var l=u[s];if(l===o){return true}}}}for(var d=0,h=t.tags;d<h.length;d+=1){var f=h[d];for(var c=0,v=e.tags;c<v.length;c+=1){var p=v[c];if(f===p){return true}}}return false}function Vd(e,t,r,i,n,a){if(Bd(r,i,n,a)){e.push(t)}}function jd(e){var t=e.dependencies;if(t===undefined){t=Ad}else if(!Y(t)){t={}}var r=H(e.attributes).some(function(value){return typeof value==="function"});var i=e.selector&&!e.standaloneSelector;var n=r||i;var a=t.adjacentEdges;if(!a&&t.adjacentNodes){a=true}return{self:Gd(t.self,n,e.allAttributePaths),adjacentNodes:Gd(t.adjacentNodes,n,e.allAttributePaths),adjacentEdges:Gd(a,n,e.allAttributePaths),allNodes:Gd(t.allNodes,n,e.allAttributePaths),allEdges:Gd(t.allEdges,n,e.allAttributePaths)}}function Ud(e){var t=e.dependencies;if(t===undefined){t=Ed}else if(!Y(t)){t={}}var r=H(e.attributes).some(function(value){return typeof value==="function"});var i=e.selector&&!e.standaloneSelector;var n=r||i;return{self:Gd(t.self,n,e.allAttributePaths),extremities:Gd(t.extremities,n,e.allAttributePaths),parallelEdges:Gd(t.parallelEdges,n,e.allAttributePaths),allNodes:Gd(t.allNodes,n,e.allAttributePaths),allEdges:Gd(t.allEdges,n,e.allAttributePaths)}}function Gd(e,t,r){if(!t){return{attributes:[],tags:[]}}if(e===true){return{attributes:[],tags:[El]}}e=e||{};var i={attributes:qd(e.attributes,r),tags:Hd(e.tags)};if(e.data){i.tags.push(Sl)}if(e.selection){i.tags.push(Cl)}if(e.hover){i.tags.push(wl)}return i}function qd(value,e){if(value==="all"){return e.slice()}else if(!Array.isArray(value)){return[]}else{value=value.map(function(e){return Array.isArray(e)?e.join("."):e});value=value.filter(function(e){return typeof e==="string"});if(e){return e.filter(function(e){return value.some(function(t){return e.startsWith(t)})})}else{return value}}}function Hd(value){if(!Array.isArray(value)){return[]}else{return value.filter(function(e){return typeof e==="string"})}}function circleCircleIntersection(e,t,r,i,n,a){var o,s,u,l,d,h,f;var c,v;s=i-e;u=n-t;l=Math.sqrt(s*s+u*u);if(l>r+a){return null}if(l<Math.abs(r-a)){return null}o=(r*r-a*a+l*l)/(2*l);c=e+s*o/l;v=t+u*o/l;d=Math.sqrt(r*r-o*o);h=-u*(d/l);f=s*(d/l);return[[c+h,v+f],[c-h,v-f]]}function circleSortCompare(e,t,r,i,n,a){if(e-n>=0&&r-n<0){return 1}if(e-n<0&&r-n>=0){return-1}if(e-n===0&&r-n===0){return t-i>=0||i-a>=0?t-i:i-t}var o=(e-n)*(i-a)-(r-n)*(t-a);if(o<0){return 1}if(o>0){return-1}var s=(e-n)*(e-n)+(t-a)*(t-a);var u=(r-n)*(r-n)+(i-a)*(i-a);return s-u}function Wd(e,t,r){var i=e[0],n=e[1],a=e[2];var o=Math.abs(i-t);var s=Math.abs(n-r);if(o+s<=a){return true}if(o>a||s>a){return false}return Math.sqrt(o*o+s*s)<a+1e-12}function Xd(e,t,r,i){var n=e[0]-t;var a=e[1]-r;var o=e[2]-i;return n*n+a*a<o*o+1e-6}function Yd(e,t,r,i,n,a,o){var s=Math.max(i,Math.min(a,e));var u=Math.max(n,Math.min(o,t));var l=e-s;var d=t-u;return l*l+d*d<r*r}function Zd(e,t,r,i,n,a,o,s){if(s===void 0){s={x:0,y:0}}var u=s||{x:0,y:0};var l,d,h,f;if(r===e){var c=e-n;var v=o*o-c*c;if(v<0){return null}var p=Math.sqrt(v);l=e;h=e;d=a+p;f=a-p}else{var g=(i-t)/(r-e);var _=t-g*e;var m=_-a;var y=g*g+1;var b=2*(g*m-n);var x=n*n+m*m-o*o;var A=b*b-4*y*x;if(A<0){return null}var E=-b;var S=Math.sqrt(A);var w=2*y;l=(E+S)/w;h=(E-S)/w;d=g*l+_;f=g*h+_}var T=e-l;var C=t-d;var I=e-h;var M=t-f;if(T*T+C*C<I*I+M*M){u.x=l;u.y=d}else{u.x=h;u.y=f}return u}function Kd(e){return e||e===0}function Qd(e,t,r){if(r===void 0)r=0;if(e==="inherit"){if(!Array.isArray(t)){return t}else{var i=r/(2*Math.PI)*t.length|0;return t[i]}}else{return e}}function Jd(e,t,r){if(e==="source"){return t}else if(e==="target"){return r}else{return e}}function $d(e,t){var r=e();var i=q(r);var n=i.map(function(e){var value=j(r,e);if(!Array.isArray(value)){return"target."+e+" = source."+e+"."+t+";"}else{return"for (var i = 0; i < "+value.length+"; ++i) target."+e+"[i] = source."+e+"[i]."+t+";"}}).join("\n");return new Function("target, source",n)}function eh(e){var t=e();var r=q(t);var i=r.map(function(e){var value=j(t,e);if(!Array.isArray(value)){return"target."+e+" = target."+e+" || source."+e+";"}else{return"for (var i = 0; i < "+value.length+"; ++i) target."+e+"[i] = target."+e+"[i] || source."+e+"[i];"}}).join("\n");return new Function("target","source",i)}function th(e){var t=e.getDepth();if(t===Ss||t===Es){return true}return(t-ws)%Ns>=Ms}function rh(e){var t=(e.getDepth()-ws)%Ns;return t>=0&&t!==Ts&&t!==Ms}function ih(e,t,r,i){nh(e,t,r,i);ah(e,t.texts.primary,r.text,i,t);ah(e,t.texts.secondary,r.text.secondary,i,t);oh(e,t.badges.topLeft,r.badges.topLeft,i);oh(e,t.badges.topRight,r.badges.topRight,i);oh(e,t.badges.bottomLeft,r.badges.bottomLeft,i);oh(e,t.badges.bottomRight,r.badges.bottomRight,i)}function nh(e,t,r,i){var n=+(r.scalingMethod.get(i)==="scaled");var a=r.radius.get(i)*2;var o=r.innerStroke.width.get(i);var s=+(r.innerStroke.scalingMethod.get(i)==="scaled");var u=r.outerStroke.width.get(i);var l=+(r.outerStroke.scalingMethod.get(i)==="scaled");t.x=r.x.get(i);t.y=r.y.get(i);t.shape=r.shape.get(i);t.color=r.color.get(i);t.opacity=r.opacity.get(i);t.diameterScaled=a*n;t.diameterFixed=a*(1-n);t.innerStroke.color=Qd(r.innerStroke.color.get(i),t.color);t.innerStroke.widthScaled=o*s;t.innerStroke.widthFixed=o*(1-s);t.innerStroke.minVisibleSize=r.innerStroke.minVisibleSize.get(i);t.outerStroke.color=Qd(r.outerStroke.color.get(i),t.color);t.outerStroke.widthScaled=u*l;t.outerStroke.widthFixed=u*(1-l);t.halo.color=r.halo.color.get(i);t.halo.strokeColor=r.halo.strokeColor.get(i);t.icon.content=e.formatText(r.icon.content.get(i));t.image.url=r.image.url.get(i);t.outline.enabled=r.outline.enabled.get(i);t.textHidden=r.textHidden.get(i)}function ah(e,t,r,i,n){var a=t===n.texts.primary;t.hidden=n.textHidden;t.content=e.formatText(r.content.get(i));t.backgroundColor=Qd(r.backgroundColor.get(i),n.color);t.tip=a&&r.tip.get(i);t.position=a?r.position.get(i):"bottom"}function oh(e,t,r,i){t.textContent=e.formatText(r.text.content.get(i));t.imageUrl=r.image.url.get(i)}function sh(){return{x:0,y:0,shape:"",color:"",opacity:0,diameterScaled:0,diameterFixed:0,innerStroke:{color:"",widthScaled:0,widthFixed:0,minVisibleSize:0},outerStroke:{color:"",widthScaled:0,widthFixed:0,minVisibleSize:0},icon:{content:"",font:"",color:"",scale:0,size:0,minVisibleSize:0},image:{url:"",content:null,scale:0,rescale:false,duplicate:false,minVisibleSize:0},halo:{widthScaled:0,widthFixed:0,strokeWidthScaled:0,strokeWidthFixed:0,color:"",strokeColor:""},outline:{enabled:false,color:"",minVisibleSize:""},badges:{topLeft:uh(Ps),topRight:uh(Os),bottomLeft:uh(Ds),bottomRight:uh(Bs)},textHidden:false,texts:{primary:lh(),secondary:lh()}}}function uh(e){return{angle:e,color:"",scale:0,positionScale:0,minVisibleSize:0,strokeColor:"",strokeWidthScaled:0,strokeWidthFixed:0,textContent:"",textFont:"",textColor:"",textScale:"",textStyle:"",imageUrl:"",imageContent:null,imageScale:0}}function lh(){return{hidden:false,content:"",position:"",backgroundColor:"",tip:false,font:"",color:"",sizeScaled:0,sizeFixed:0,style:"",align:"",minVisibleSize:0,margin:0,padding:0,maxLineLength:0,widthScaled:0,widthFixed:0,heightScaled:0,heightFixed:0,positionAngle:0,isPositionCenter:false,isPositionVertical:false,isPositionHorizontal:false}}function dh(){return{edgeHalo:0,nodeHaloStroke:0,nodeHalo:0,edgeBody:0,edgeTextBackground:0,edgeText:0,nodeBody:0,nodeTextBackground:0,nodeText:0}}function hh(e,t){var r=t||dh();var i=(e-Zl)*Ns+ws;r.edgeHalo=As;r.nodeHaloStroke=Es;r.nodeHalo=Ss;r.edgeBody=i+Ts;r.edgeTextBackground=i+Cs;r.edgeText=i+Is;r.nodeBody=i+Ms;r.nodeTextBackground=i+Ls;r.nodeText=i+ks;return r}function fh(e,t){ch(e,t);vh(e.texts.primary,t.texts.primary);vh(e.texts.secondary,t.texts.secondary);ph(e.badges.topLeft,t.badges.topLeft);ph(e.badges.topRight,t.badges.topRight);ph(e.badges.bottomLeft,t.badges.bottomLeft);ph(e.badges.bottomRight,t.badges.bottomRight)}function ch(e,t){e.body=true;e.icon=!!t.icon.content;e.image=!!t.image.url;e.pieChart=Array.isArray(t.color);e.outerStroke=!!t.outerStroke.color;e.outline=!!t.outline.enabled;e.halo=!!t.halo.color;e.haloStroke=e.halo&&!!t.halo.strokeColor}function vh(e,t){e.text=!t.hidden&&!!t.content;e.background=e.text&&!!t.backgroundColor;e.tip=e.background&&t.tip&&t.position!=="center"}function ph(e,t){e.text=!!t.textContent;e.image=!!t.imageUrl}function gh(e,t,r){_h(e,t);e.fillColor=Array.isArray(t.color)?null:t.color;e.strokeColor=t.innerStroke.color;e.strokeMinVisibleSize=t.innerStroke.minVisibleSize;e.strokeWidthScaled=t.innerStroke.widthScaled;e.strokeWidthFixed=t.innerStroke.widthFixed;if(r){e.pattern.type=0}}function _h(e,t){e.pieceId=Xi;e.x1=t.x;e.y1=t.y;e.x2=t.x;e.y2=t.y;e.rectWidthOrSourceRadiusScaled=t.diameterScaled;e.rectWidthOrSourceRadiusFixed=t.diameterFixed;e.rectHeightTargetRadiusScaled=t.diameterScaled;e.rectHeightTargetRadiusFixed=t.diameterFixed;e.shape=t.shape;e.opacity=t.opacity;e.symbolicSize=t.diameterScaled;e.thicknessOrFontSizeScaled=0;e.thicknessOrFontSizeFixed=0;e.strokeWidthScaled=0;e.strokeWidthFixed=0;e.offsetScaled=0;e.offsetFixed=0;e.fillColor=null;e.strokeColor=null;e.globalMinVisibleSize=0;e.strokeMinVisibleSize=0;e.offsetAngle=0;e.curvature=0;e.dashLength=0;e.gapLength=0;e.hasHead=false;e.hasTail=false;e.isSelfLoop=false;e.isText=false}function mh(e,t){var r=t.image.fit&&!t.image.tile;_h(e,t);e.pattern.type=ji;e.pattern.attributes.image=t.image.content;e.pattern.attributes.scaled=r;e.pattern.attributes.duplicated=t.image.tile;e.patternScale=r?t.image.scale:0;e.patternMinVisibleSize=t.image.minVisibleSize;e.patternColor=null}function yh(e,t){var r=t.diameterScaled+t.halo.widthScaled*2;var i=t.diameterFixed+t.halo.widthFixed*2;e.pieceId=Xi;e.shape="circle";e.x1=t.x;e.y1=t.y;e.x2=t.x;e.y2=t.y;e.rectWidthOrSourceRadiusScaled=r;e.rectWidthOrSourceRadiusFixed=i;e.rectHeightTargetRadiusScaled=r;e.rectHeightTargetRadiusFixed=i;e.thicknessOrFontSizeScaled=0;e.thicknessOrFontSizeFixed=0;e.strokeWidthScaled=0;e.strokeWidthFixed=0;e.offsetScaled=0;e.offsetFixed=0;e.pattern.type=0;e.opacity=t.opacity;e.fillColor=t.halo.color;e.strokeColor=null;e.patternColor=null;e.globalMinVisibleSize=0;e.strokeMinVisibleSize=0;e.patternMinVisibleSize=0;e.offsetAngle=0;e.patternScale=0;e.symbolicSize=t.diameterScaled;e.curvature=0;e.dashLength=0;e.gapLength=0;e.hasHead=false;e.hasTail=false;e.isSelfLoop=false;e.isText=false}function bh(e,t){var r=t.diameterScaled+t.halo.widthScaled*2;var i=t.diameterFixed+t.halo.widthFixed*2;e.pieceId=Xi;e.shape="circle";e.x1=t.x;e.y1=t.y;e.x2=t.x;e.y2=t.y;e.rectWidthOrSourceRadiusScaled=r;e.rectWidthOrSourceRadiusFixed=i;e.rectHeightTargetRadiusScaled=r;e.rectHeightTargetRadiusFixed=i;e.thicknessOrFontSizeScaled=0;e.thicknessOrFontSizeFixed=0;e.strokeWidthScaled=t.halo.strokeWidthScaled;e.strokeWidthFixed=t.halo.strokeWidthFixed;e.offsetScaled=0;e.offsetFixed=0;e.pattern.type=0;e.opacity=t.opacity;e.fillColor=null;e.strokeColor=t.halo.strokeColor;e.patternColor=null;e.globalMinVisibleSize=0;e.strokeMinVisibleSize=0;e.patternMinVisibleSize=0;e.offsetAngle=0;e.patternScale=0;e.symbolicSize=t.diameterScaled;e.curvature=0;e.dashLength=0;e.gapLength=0;e.hasHead=false;e.hasTail=false;e.isSelfLoop=false;e.isText=false}function xh(e,t){var r=t.diameterScaled*Vs;var i=t.diameterFixed*Vs;var n=t.diameterScaled*js;var a=t.diameterFixed*js+Us;if(t.outerStroke.color){n+=t.outerStroke.widthScaled/2;a+=t.outerStroke.widthFixed/2}e.pieceId=Xi;e.shape=t.shape;e.x1=t.x;e.y1=t.y;e.x2=t.x;e.y2=t.y;e.rectWidthOrSourceRadiusScaled=r;e.rectWidthOrSourceRadiusFixed=i;e.rectHeightTargetRadiusScaled=r;e.rectHeightTargetRadiusFixed=i;e.thicknessOrFontSizeScaled=0;e.thicknessOrFontSizeFixed=0;e.strokeWidthScaled=0;e.strokeWidthFixed=0;e.offsetScaled=n;e.offsetFixed=a;e.pattern.type=0;e.opacity=t.opacity;e.fillColor=t.outline.color;e.strokeColor=null;e.patternColor=null;e.globalMinVisibleSize=t.outline.minVisibleSize;e.strokeMinVisibleSize=0;e.patternMinVisibleSize=0;e.offsetAngle=1.5707963267948966;e.patternScale=0;e.symbolicSize=t.diameterScaled;e.curvature=0;e.dashLength=0;e.gapLength=0;e.hasHead=false;e.hasTail=false;e.isSelfLoop=false;e.isText=false}function Ah(e,t){_h(e,t);e.pattern.type=qi;e.pattern.attributes.text=t.icon.content;e.pattern.attributes.font=t.icon.font;e.pattern.attributes.style=t.icon.style;e.pattern.attributes.size="sdf";e.patternMinVisibleSize=t.icon.minVisibleSize;e.patternColor=t.icon.color;e.patternScale=t.icon.scale}function Eh(e,t){_h(e,t);if(Array.isArray(t.color)){e.pattern.type=Gi;e.pattern.attributes.colors=t.color.join(";");e.patternScale=1;e.patternMinVisibleSize=0;e.patternColor=null}}function Sh(e,t){var r=t.diameterScaled+t.innerStroke.widthScaled*2;var i=t.diameterFixed+t.innerStroke.widthFixed*2;e.pieceId=Xi;e.shape=t.shape;e.x1=t.x;e.y1=t.y;e.x2=t.x;e.y2=t.y;e.rectWidthOrSourceRadiusScaled=r;e.rectWidthOrSourceRadiusFixed=i;e.rectHeightTargetRadiusScaled=r;e.rectHeightTargetRadiusFixed=i;e.thicknessOrFontSizeScaled=0;e.thicknessOrFontSizeFixed=0;e.strokeWidthScaled=t.outerStroke.widthScaled;e.strokeWidthFixed=t.outerStroke.widthFixed;e.offsetScaled=0;e.offsetFixed=0;e.pattern.type=0;e.opacity=t.opacity;e.fillColor=null;e.strokeColor=t.outerStroke.color;e.patternColor=null;e.globalMinVisibleSize=t.outerStroke.minVisibleSize;e.strokeMinVisibleSize=0;e.patternMinVisibleSize=0;e.offsetAngle=0;e.patternScale=0;e.symbolicSize=t.diameterScaled;e.curvature=0;e.dashLength=0;e.gapLength=0;e.hasHead=false;e.hasTail=false;e.isSelfLoop=false;e.isText=false}function wh(e,t,r){Ch(e,t,r);if(t.imageContent){e.pattern.type=ji;e.pattern.attributes.image=t.imageContent;e.pattern.attributes.scaled=true;e.pattern.attributes.duplicated=false;e.patternScale=t.imageScale;e.patternMinVisibleSize=0;e.patternColor=null}else{e.fillColor=null;e.strokeColor=null}}function Th(e,t,r){Ch(e,t,r);if(t.textContent){e.pattern.type=Hi;e.pattern.attributes.text=t.textContent;e.pattern.attributes.font=t.textFont;e.pattern.attributes.style=t.textStyle;e.pattern.attributes.size="sdf";e.patternMinVisibleSize=0;e.patternColor=t.textColor;e.patternScale=t.textScale}if(t.imageUrl||!t.textContent){e.fillColor=null;e.strokeColor=null}}function Ch(e,t,r){var i=r.diameterScaled*t.scale;var n=r.diameterFixed*t.scale;var a=r.diameterScaled*t.positionScale/2;var o=r.diameterFixed*t.positionScale/2;e.pieceId=Xi;e.shape="circle";e.x1=r.x;e.y1=r.y;e.x2=r.x;e.y2=r.y;e.rectWidthOrSourceRadiusScaled=i;e.rectWidthOrSourceRadiusFixed=n;e.rectHeightTargetRadiusScaled=i;e.rectHeightTargetRadiusFixed=n;e.thicknessOrFontSizeScaled=0;e.thicknessOrFontSizeFixed=0;e.strokeWidthScaled=t.strokeWidthScaled;e.strokeWidthFixed=t.strokeWidthFixed;e.offsetScaled=a;e.offsetFixed=o;e.pattern.type=0;e.opacity=r.opacity;e.fillColor=t.color;e.strokeColor=t.strokeColor;e.patternColor=null;e.globalMinVisibleSize=t.minVisibleSize;e.strokeMinVisibleSize=0;e.patternMinVisibleSize=0;e.offsetAngle=t.angle;e.patternScale=0;e.symbolicSize=r.diameterScaled;e.curvature=0;e.dashLength=0;e.gapLength=0;e.hasHead=false;e.hasTail=false;e.isSelfLoop=false;e.isText=false}function Ih(e,t,r){kh(e,t,r);e.pattern.type=Wi;e.pattern.attributes.text=t.content;e.pattern.attributes.font=t.font;e.pattern.attributes.style=t.style;e.pattern.attributes.align=t.align;e.patternMinVisibleSize=0;e.patternColor=t.color;e.thicknessOrFontSizeScaled=t.sizeScaled;e.thicknessOrFontSizeFixed=t.sizeFixed;e.isText=true}function Mh(e,t,r){kh(e,t,r);e.fillColor=t.backgroundColor}function Lh(e,t,r){var i=Math.ceil(t.margin/2)+1;var n=r.diameterScaled/2+r.innerStroke.widthScaled+r.outerStroke.widthScaled;var a=r.diameterFixed/2+r.innerStroke.widthFixed+r.outerStroke.widthFixed+i;var o=Qs[t.position];var s=Math.cos(o);var u=Math.sin(o);e.pieceId=Xi;e.shape="triangle";e.x1=r.x-s;e.y1=r.y-u;e.x2=r.x+s;e.y2=r.y+u;e.rectWidthOrSourceRadiusScaled=0;e.rectWidthOrSourceRadiusFixed=t.margin;e.rectHeightTargetRadiusScaled=0;e.rectHeightTargetRadiusFixed=t.margin*Ys;e.thicknessOrFontSizeScaled=0;e.thicknessOrFontSizeFixed=0;e.strokeWidthScaled=0;e.strokeWidthFixed=0;e.offsetScaled=n;e.offsetFixed=a;e.pattern.type=0;e.opacity=r.opacity;e.fillColor=t.backgroundColor;e.strokeColor=null;e.patternColor=null;e.globalMinVisibleSize=t.minVisibleSize;e.strokeMinVisibleSize=0;e.patternMinVisibleSize=0;e.offsetAngle=t.positionAngle;e.patternScale=0;e.symbolicSize=r.diameterScaled;e.curvature=0;e.dashLength=0;e.gapLength=0;e.hasHead=false;e.hasTail=false;e.isSelfLoop=false}function kh(e,t,r){var i=0;var n=0;var a,o;if(!t.isPositionCenter){i+=r.innerStroke.widthScaled+r.outerStroke.widthScaled+r.diameterScaled/2;n+=r.innerStroke.widthFixed+r.outerStroke.widthFixed+r.diameterFixed/2+t.margin+t.padding}if(t.isPositionVertical){i+=t.heightScaled/2;n+=t.heightFixed/2;if(t===r.texts.secondary&&r.texts.primary.position==="bottom"){var s=r.texts.primary;i+=s.heightScaled;n+=s.heightFixed+s.margin+s.padding*2}}else if(t.isPositionHorizontal){i+=t.widthScaled/2;n+=t.widthFixed/2}if(t.sizeScaled>0){a="sdf";o=1}else{a=t.sizeFixed;o=0}e.pieceId=Xi;e.shape="square";e.x1=r.x;e.y1=r.y;e.x2=r.x;e.y2=r.y;e.rectWidthOrSourceRadiusScaled=t.widthScaled;e.rectWidthOrSourceRadiusFixed=t.widthFixed+t.padding*2;e.rectHeightTargetRadiusScaled=t.heightScaled;e.rectHeightTargetRadiusFixed=t.heightFixed+t.padding*2;e.thicknessOrFontSizeScaled=0;e.thicknessOrFontSizeFixed=0;e.strokeWidthScaled=0;e.strokeWidthFixed=0;e.offsetScaled=i;e.offsetFixed=n;e.pattern.type=0;e.pattern.attributes.size=a;e.opacity=r.opacity;e.fillColor=null;e.strokeColor=null;e.patternColor=null;e.globalMinVisibleSize=t.minVisibleSize;e.strokeMinVisibleSize=0;e.patternMinVisibleSize=0;e.offsetAngle=t.positionAngle;e.patternScale=o;e.symbolicSize=r.diameterScaled;e.curvature=0;e.dashLength=0;e.gapLength=0;e.hasHead=false;e.hasTail=false;e.isSelfLoop=false;e.isText=false}function Nh(e,t,r,i,n,a){var o=n;var s=i;var u=a;var l=n.badges;var d=i.badges;var h=a.badges;Fh(e,t,r,i,n,a);Rh(e,t,r,s.text,o.texts.primary,u.texts.primary,u);Rh(e,t,r,s.text.secondary,o.texts.secondary,u.texts.secondary,u);zh(e,t,r,d.topLeft,l.topLeft,h.topLeft,u);zh(e,t,r,d.topRight,l.topRight,h.topRight,u);zh(e,t,r,d.bottomLeft,l.bottomLeft,h.bottomLeft,u);zh(e,t,r,d.bottomRight,l.bottomRight,h.bottomRight,u)}function Fh(e,t,r,i,n,a){if(n.halo){var o=i.halo.width.get(r);var s=+(i.halo.scalingMethod.get(r)==="scaled");a.halo.widthScaled=o*s;a.halo.widthFixed=o*(1-s);yh(n.halo,a);if(n.haloStroke){a.halo.strokeWidthScaled=0;a.halo.strokeWidthFixed=i.halo.strokeWidth.get(r);bh(n.haloStroke,a)}}if(n.outline){a.outline.color=i.outline.color.get(r);a.outline.minVisibleSize=i.outline.minVisibleSize.get(r);xh(n.outline,a)}if(n.outerStroke){a.outerStroke.minVisibleSize=i.outerStroke.minVisibleSize.get(r);Sh(n.outerStroke,a)}if(n.pieChart){Eh(n.pieChart,a)}if(n.image){a.image.content=t.imageManager.getImage(a.image.url);a.image.fit=i.image.fit.get(r);a.image.tile=i.image.tile.get(r);a.image.scale=i.image.scale.get(r);a.image.minVisibleSize=i.image.minVisibleSize.get(r);mh(n.image,a)}if(n.icon){a.icon.font=t.fontManager.getFont(i.icon.font.get(r));a.icon.style=i.icon.style.get(r);a.icon.color=i.icon.color.get(r);a.icon.scale=i.icon.scale.get(r);a.icon.minVisibleSize=i.icon.minVisibleSize.get(r);Ah(n.icon,a)}if(n.body){var u=!n.pieChart&&!n.image&&!n.icon;gh(n.body,a,u)}}function zh(e,t,r,i,n,a,o){if(n.image||n.text){var s=i.stroke.width.get(r);var u=+(i.stroke.scalingMethod.get(r)==="scaled");a.color=Qd(i.color.get(r),o.color,a.angle);a.strokeColor=i.stroke.color.get(r);a.strokeWidthScaled=s*u;a.strokeWidthFixed=s*(1-u);a.minVisibleSize=i.minVisibleSize.get(r);a.positionScale=i.positionScale.get(r);a.scale=i.scale.get(r)}if(n.image){a.imageContent=t.imageManager.getImage(a.imageUrl);a.imageScale=i.image.scale.get(r);wh(n.image,a,o)}if(n.text){a.textFont=t.fontManager.getFont(i.text.font.get(r));a.textStyle=i.text.style.get(r);a.textColor=Qd(i.text.color.get(r),o.color);a.textScale=i.text.scale.get(r);var l=e.measureText(a.textContent,a.textFont,a.textStyle,a.textScale).width;if(l>1){var d=0;var h=0;while(h<a.textContent.length&&d<1){d+=e.measureText(a.textContent[h],a.textFont,a.textStyle,a.textScale).width;h+=1}if(h!==a.textContent.length){a.textContent=a.textContent.substring(0,h-1)+"‥"}}Th(n.text,a,o)}}function Rh(e,t,r,i,n,a,o){if(n.text){var s=i.scaling.get(r);a.font=t.fontManager.getFont(i.font.get(r));a.color=Qd(i.color.get(r),o.color);a.style=i.style.get(r);a.align=i.align.get(r);a.minVisibleSize=i.minVisibleSize.get(r);a.margin=i.margin.get(r);a.padding=i.padding.get(r);a.maxLineLength=i.maxLineLength.get(r);a.content=Oo(a.content,a.maxLineLength);if(s){var u=i.scale.get(r);a.sizeScaled=o.diameterScaled*u;a.sizeFixed=o.diameterFixed*u}else{a.sizeFixed=i.size.get(r);a.sizeScaled=0}var l=e.measureText(a.content,a.font,a.style);a.widthScaled=l.width*a.sizeScaled;a.widthFixed=l.width*a.sizeFixed;a.heightScaled=l.height*a.sizeScaled;a.heightFixed=l.height*a.sizeFixed;a.positionAngle=Ks[a.position];a.isPositionCenter=a.position==="center";a.isPositionVertical=a.position==="top"||a.position==="bottom";a.isPositionHorizontal=a.position==="left"||a.position==="right";Ih(n.text,a,o);if(n.background){Mh(n.background,a,o);if(n.tip){Lh(n.tip,a,o)}}}}var Ph=$d(jh,"start");var Oh=$d(jh,"end");var Dh=eh(jh);var Bh=function e(t){var r=t.engine;var i=t.imageManager;var n=t.fontManager;var a=t.formatText;var o=t.attributes;var s=t.attributesPrev;this._engine=r;this._attributes=o;this._attributesPrev=s;this._helper={imageManager:i,fontManager:n,formatText:a};this._blocks=Vh(function(){return r.createBlock()});this._blockIds=Vh();this._fullComponents=jh();this._startComponents=jh();this._endComponents=jh();this._startFlags=jh();this._endFlags=jh();this._startInput=sh();this._endInput=sh();this._depthInfo=dh();this._nodePatternAssigned=false;this._nullElt={start:null,end:null}};Bh.prototype.drawNode=function e(t){this._computeBlockIds(t);var r=this._attributes.excluded.get(t);if(r){this._freeBlocks()}else{var i=this._engine;var n=this._helper;var a="n"+t;var o=this._attributes.layer.get(t);var s=hh(o,this._depthInfo);var u=this._attributes.animationDuration.get(t);var l=u>0;this._prepareBlocks(l,s,a);ih(n,this._endInput,this._attributes,t);fh(this._endFlags,this._endInput);if(l){ih(n,this._startInput,this._attributesPrev,t);fh(this._startFlags,this._startInput);Dh(this._endFlags,this._startFlags)}this._initComponents(this._fullComponents,this._endFlags,this._blocks);Oh(this._endComponents,this._fullComponents);Nh(i,n,t,this._attributes,this._endComponents,this._endInput);if(l){Ph(this._startComponents,this._fullComponents);Nh(i,n,t,this._attributesPrev,this._startComponents,this._startInput)}if(l){var d=this._attributes.animationStart.get(t);var h=this._attributes.animationEasing.get(t);this._setBlocksAnimation(u,d,h)}if(this._endFlags.halo){var f=this._attributes.halo.hideNonAdjacentEdges.get(t);if(f){this._blocks.halo.setStencilUsage($i);this._blocks.haloStroke.setStencilUsage($i)}}this._storeBlocks()}};Bh.prototype._computeBlockIds=function e(t){var r=t*xs;this._blockIds.body=r+hs;this._blockIds.text=r+fs;this._blockIds.textBg=r+cs;this._blockIds.halo=r+vs;this._blockIds.haloStroke=r+ps};Bh.prototype._prepareBlocks=function e(t,r,i){this._blocks.body.reset(Oi,t,r.nodeBody,i);this._blocks.text.reset(Di,t,r.nodeText,i);this._blocks.textBg.reset(Oi,t,r.nodeTextBackground,i);this._blocks.halo.reset(Oi,t,r.nodeHalo,i);this._blocks.haloStroke.reset(Oi,t,r.nodeHaloStroke,i)};Bh.prototype._storeBlocks=function e(){this._engine.storeBlock(this._blockIds.body,this._blocks.body);this._engine.storeBlock(this._blockIds.text,this._blocks.text);this._engine.storeBlock(this._blockIds.textBg,this._blocks.textBg);this._engine.storeBlock(this._blockIds.halo,this._blocks.halo);this._engine.storeBlock(this._blockIds.haloStroke,this._blocks.haloStroke)};Bh.prototype._freeBlocks=function e(){this._engine.freeBlock(this._blockIds.body);this._engine.freeBlock(this._blockIds.text);this._engine.freeBlock(this._blockIds.textBg);this._engine.freeBlock(this._blockIds.halo);this._engine.freeBlock(this._blockIds.haloStroke)};Bh.prototype._setBlocksAnimation=function e(t,r,i){this._blocks.body.setGlobalAnimation(t,r,i);this._blocks.text.setGlobalAnimation(t,r,i);this._blocks.textBg.setGlobalAnimation(t,r,i);this._blocks.halo.setGlobalAnimation(t,r,i);this._blocks.haloStroke.setGlobalAnimation(t,r,i)};Bh.prototype._initComponents=function e(t,r,i){this._nodePatternAssigned=false;this._initBaseComponents(t,r,i);this._initBadgeComponents(t.badges.topLeft,r.badges.topLeft,i);this._initBadgeComponents(t.badges.topRight,r.badges.topRight,i);this._initBadgeComponents(t.badges.bottomLeft,r.badges.bottomLeft,i);this._initBadgeComponents(t.badges.bottomRight,r.badges.bottomRight,i);this._initTextComponents(t.texts.primary,r.texts.primary,i);this._initTextComponents(t.texts.secondary,r.texts.secondary,i)};Bh.prototype._initBaseComponents=function e(t,r,i){t.haloStroke=this._nextElement(r.haloStroke,i.haloStroke);t.halo=this._nextElement(r.halo,i.halo);t.outline=this._nextElement(r.outline,i.body);t.outerStroke=this._nextElement(r.outerStroke,i.body);t.body=this._nextElement(r.body,i.body);t.pieChart=this._getNodePatternElement(r.pieChart,i);t.image=this._getNodePatternElement(r.image,i);t.icon=this._getNodePatternElement(r.icon,i)};Bh.prototype._initBadgeComponents=function e(t,r,i){t.image=this._nextElement(r.image,i.body);t.text=this._nextElement(r.text,i.body)};Bh.prototype._initTextComponents=function e(t,r,i){t.background=this._nextElement(r.background,i.textBg);t.tip=this._nextElement(r.tip,i.textBg);t.text=this._nextElement(r.text,i.text)};Bh.prototype._nextElement=function e(t,r){return t?r.next():this._nullElt};Bh.prototype._getNodePatternElement=function e(t,r){if(!t){return this._nullElt}else if(!this._nodePatternAssigned){this._nodePatternAssigned=true;return r.body.getCurrentElement()}else{return r.body.next()}};function Vh(e){if(e===void 0)e=function(){return 0};return{body:e(),text:e(),textBg:e(),halo:e(),haloStroke:e()}}function jh(){return{haloStroke:undefined,halo:undefined,outline:undefined,outerStroke:undefined,body:undefined,pieChart:undefined,image:undefined,icon:undefined,badges:{topLeft:{text:undefined,image:undefined},topRight:{text:undefined,image:undefined},bottomLeft:{text:undefined,image:undefined},bottomRight:{text:undefined,image:undefined}},texts:{primary:{text:undefined,background:undefined,tip:undefined},secondary:{text:undefined,background:undefined,tip:undefined}}}}function Uh(e,t,r,i,n,a){Gh(e,t,r,i,n,a);qh(e,t.texts.primary,r.text,i,t);qh(e,t.texts.secondary,r.text.secondary,i,t)}function Gh(e,t,r,i,n,a){var o=n.source;var s=n.target;var u=r.source.get(i);var l=r.target.get(i);var d=o.x.get(u);var h=o.y.get(u);var f=o.radius.get(u);var c=o.color.get(u);var v=+(o.scalingMethod.get(u)==="scaled");var p=s.x.get(l);var g=s.y.get(l);var _=s.radius.get(l);var m=s.color.get(l);var y=+(s.scalingMethod.get(l)==="scaled");var b=Jd(r.color.get(i),c,m);var x=r.width.get(i);var A=+(r.scalingMethod.get(i)==="scaled");var E=r.stroke.width.get(i);var S=+(r.stroke.scalingMethod.get(i)==="scaled");var w=Zs[r.shape.style.get(i)];var T=r.adjustAnchors.get(i);t.source=u;t.target=l;t.sourceX=d;t.sourceY=h;t.targetX=p;t.targetY=g;t.sourceRadiusScaled=f*v;t.sourceRadiusFixed=f*(1-v);t.targetRadiusScaled=_*y;t.targetRadiusFixed=_*(1-y);t.widthScaled=x*A;t.widthFixed=x*(1-A);t.curvature=r.curvature.get(i);t.isSelfLoop=u===l;t.color=b;t.opacity=r.opacity.get(i);t.minVisibleSize=r.minVisibleSize.get(i);t.shape.type=r.shape.type.get(i);t.shape.head=r.shape.head.get(i);t.shape.tail=r.shape.tail.get(i);t.shape.dashLength=w.dash;t.shape.gapLength=w.gap;t.shape.isBodyTriangle=t.shape.type==="triangle";t.stroke.color=Qd(r.stroke.color.get(i),b);t.stroke.widthScaled=E*S;t.stroke.widthFixed=E*(1-S);t.stroke.minVisibleSize=r.stroke.minVisibleSize.get(i);t.halo.color=r.halo.color.get(i);t.outline.enabled=r.outline.enabled.get(i);t.textHidden=r.textHidden.get(i);if(T&&(t.shape.head||t.shape.tail||t.shape.type==="triangle")){var C=t;var I=C.curvature;var M=C.sourceX;var L=C.sourceY;var k=C.targetX;var N=C.targetY;var F=1;var z=1;if(!I){F=Hh(C,a,o,u,M,L,k,N);z=Hh(C,a,s,l,k,N,M,L)}else if(!C.isSelfLoop){var R=eu(M,L,k,N,I/2);F=Hh(C,a,o,u,M,L,R.x,R.y);z=Hh(C,a,s,l,k,N,R.x,R.y)}t.sourceRadiusScaled*=F;t.sourceRadiusFixed*=F;t.targetRadiusScaled*=z;t.targetRadiusFixed*=z}}function qh(e,t,r,i,n){t.hidden=n.textHidden;t.content=e.formatText(r.content.get(i));t.backgroundColor=Qd(r.backgroundColor.get(i),n.color)}function Hh(e,t,r,i,n,a,o,s){var u=t.angle;var l=Math.atan2(s-a,o-n)-u;var d=1;var h=0;var f=null;if(l<-zs){l+=Rs}else if(l>zs){l-=Rs}if(l<-zs/2){h=Ps;f=r.badges.topLeft}else if(l<0){h=Os;f=r.badges.topRight}else if(l<zs/2){h=Bs;f=r.badges.bottomRight}else{h=Ds;f=r.badges.bottomLeft}h+=u;var c=f.text.content.get(i);var v=f.image.url.get(i);if(Kd(c)||v){var p=f.positionScale.get(i);var g=f.scale.get(i);var _=Math.cos(h);var m=Math.sin(h);var y=n+_*p;var b=a+m*p;var x=Zd(o,s,n,a,y,b,g);if(x){var A=x.x-n;var E=x.y-a;var distance=Math.sqrt(A*A+E*E);d=Math.max(d,distance)}}var S=r.shape.get(i);if(S==="square"){var w=Math.abs(Math.cos(l));var T=Math.abs(Math.sin(l));var C=1/Math.max(w,T);d=Math.max(d,C)}return d}function Wh(){return{sourceX:0,sourceY:0,targetX:0,targetY:0,sourceRadiusScaled:0,sourceRadiusFixed:0,targetRadiusScaled:0,targetRadiusFixed:0,widthScaled:0,widthFixed:0,curvature:0,isSelfLoop:false,color:"",opacity:0,minVisibleSize:0,shape:{type:"",head:null,tail:null,dashLength:0,gapLength:0},stroke:{color:"",widthScaled:0,widthFixed:0,minVisibleSize:0},halo:{widthScaled:0,widthFixed:0,color:""},outline:{enabled:false,color:"",minVisibleSize:""},textHidden:false,texts:{primary:Xh(),secondary:Xh()}}}function Xh(){return{hidden:false,content:"",backgroundColor:"",font:"",color:"",sizeScaled:0,sizeFixed:0,style:"",minVisibleSize:0,margin:0,padding:0,maxLineLength:0,widthScaled:0,widthFixed:0,heightScaled:0,heightFixed:0,positionAngle:0,adjustAngle:false}}function Yh(e,t){Zh(e.body,t,true,true);Zh(e.outline,t,t.outline.enabled,true);Zh(e.halo,t,!!t.halo.color,false);Kh(e.texts.primary,t.texts.primary);Kh(e.texts.secondary,t.texts.secondary)}function Zh(e,t,value,r){e.body=value;e.head=value&&r&&!!t.shape.head;e.tail=value&&r&&!!t.shape.tail}function Kh(e,t){e.text=!t.hidden&&!!t.content;e.background=e.text&&!!t.backgroundColor}function Qh(e,t,r,i){Jh(e,t,r,i);e.thicknessOrFontSizeScaled=t.widthScaled;e.thicknessOrFontSizeFixed=t.widthFixed;e.strokeWidthScaled=t.stroke.widthScaled;e.strokeWidthFixed=t.stroke.widthFixed;e.offsetScaled=0;e.offsetFixed=0;e.fillColor=t.color;e.strokeColor=t.stroke.color;e.globalMinVisibleSize=t.minVisibleSize;e.strokeMinVisibleSize=t.stroke.minVisibleSize;e.offsetAngle=0;e.symbolicSize=t.widthScaled;e.dashLength=t.shape.dashLength;e.gapLength=t.shape.gapLength;e.hasHead=!!t.shape.head;e.hasTail=!!t.shape.tail;e.isBodyTriangle=t.shape.isBodyTriangle}function Jh(e,t,r,i){e.pieceId=r;e.shape=i;e.x1=t.sourceX;e.y1=t.sourceY;e.x2=t.targetX;e.y2=t.targetY;e.rectWidthOrSourceRadiusScaled=t.sourceRadiusScaled;e.rectWidthOrSourceRadiusFixed=t.sourceRadiusFixed;e.rectHeightTargetRadiusScaled=t.targetRadiusScaled;e.rectHeightTargetRadiusFixed=t.targetRadiusFixed;e.thicknessOrFontSizeScaled=0;e.thicknessOrFontSizeFixed=0;e.strokeWidthScaled=0;e.strokeWidthFixed=0;e.offsetScaled=0;e.offsetFixed=0;e.pattern.type=0;e.opacity=t.opacity;e.fillColor=null;e.strokeColor=null;e.patternColor=null;e.globalMinVisibleSize=t.minVisibleSize;e.strokeMinVisibleSize=null;e.patternMinVisibleSize=0;e.offsetAngle=0;e.patternScale=0;e.symbolicSize=t.widthScaled;e.curvature=t.curvature;e.dashLength=0;e.gapLength=0;e.hasHead=false;e.hasTail=false;e.isSelfLoop=t.isSelfLoop;e.isText=false}function $h(e,t,r){var i=t.widthScaled+t.halo.widthScaled*2;var n=t.widthFixed+t.halo.widthFixed*2;Jh(e,t,r,"line");e.thicknessOrFontSizeScaled=i;e.thicknessOrFontSizeFixed=n;e.strokeWidthScaled=0;e.strokeWidthFixed=0;e.offsetScaled=0;e.offsetFixed=0;e.fillColor=t.halo.color;e.strokeColor=null;e.globalMinVisibleSize=t.minVisibleSize;e.strokeMinVisibleSize=0;e.offsetAngle=0;e.symbolicSize=t.widthScaled;e.dashLength=0;e.gapLength=0;e.hasHead=false;e.hasTail=false;e.isBodyTriangle=false}function ef(e,t,r,i){Jh(e,t,r,i);e.thicknessOrFontSizeScaled=t.widthScaled*Gs;e.thicknessOrFontSizeFixed=t.widthFixed*Gs;e.strokeWidthScaled=0;e.strokeWidthFixed=0;e.offsetScaled=t.widthScaled*qs;e.offsetFixed=t.widthFixed*qs+Hs;e.fillColor=t.outline.color;e.strokeColor=0;e.globalMinVisibleSize=Math.max(t.minVisibleSize,t.outline.minVisibleSize);e.strokeMinVisibleSize=0;e.offsetAngle=Math.PI/2;e.symbolicSize=t.widthScaled;e.dashLength=t.shape.dashLength;e.gapLength=t.shape.gapLength;e.hasHead=!!t.shape.head;e.hasTail=!!t.shape.tail;e.isBodyTriangle=t.shape.isBodyTriangle}function tf(e,t,r){nf(e,t,r);e.pattern.type=Wi;e.pattern.attributes.text=t.content;e.pattern.attributes.size="sdf";e.pattern.attributes.font=t.font;e.pattern.attributes.style=t.style;e.pattern.attributes.align=t.align;e.patternColor=t.color;e.patternScale=1;e.thicknessOrFontSizeScaled=t.sizeScaled;e.thicknessOrFontSizeFixed=t.sizeFixed;e.isText=true}function rf(e,t,r){nf(e,t,r);e.fillColor=t.backgroundColor}function nf(e,t,r){var i=(r.widthScaled+t.heightScaled)/2+r.stroke.widthScaled;var n=(r.widthFixed+t.heightFixed)/2+r.stroke.widthFixed+t.padding+t.margin;e.pieceId=Qi;e.shape="square";e.x1=r.sourceX;e.y1=r.sourceY;e.x2=r.targetX;e.y2=r.targetY;e.rectWidthOrSourceRadiusScaled=t.widthScaled;e.rectWidthOrSourceRadiusFixed=t.widthFixed+t.padding*2+1;e.rectHeightTargetRadiusScaled=t.heightScaled;e.rectHeightTargetRadiusFixed=t.heightFixed+t.padding*2;e.thicknessOrFontSizeScaled=0;e.thicknessOrFontSizeFixed=0;e.strokeWidthScaled=r.sourceRadiusScaled+r.targetRadiusScaled;e.strokeWidthFixed=r.sourceRadiusFixed+r.targetRadiusFixed;e.offsetScaled=i;e.offsetFixed=n;e.pattern.type=0;e.opacity=r.opacity;e.fillColor=null;e.strokeColor=null;e.patternColor=null;e.globalMinVisibleSize=Math.max(t.minVisibleSize,r.minVisibleSize);e.strokeMinVisibleSize=0;e.patternMinVisibleSize=0;e.offsetAngle=t.offsetAngle;e.patternScale=0;e.symbolicSize=r.widthScaled;e.curvature=r.curvature;e.dashLength=0;e.gapLength=0;e.hasHead=false;e.hasTail=false;e.isSelfLoop=r.isSelfLoop;e.isText=false;e.adjustTextAngle=t.adjustAngle}function af(e,t,r,i,n,a){of(e,t,r,i,n,a);uf(e,t,r,i.text,n.texts.primary,a.texts.primary,a);uf(e,t,r,i.text.secondary,n.texts.secondary,a.texts.secondary,a)}function of(e,t,r,i,n,a){sf(n.body,a,Qh);if(n.halo.body){var o=i.halo.width.get(r);var s=+(i.halo.scalingMethod.get(r)==="scaled");a.halo.widthScaled=o*s;a.halo.widthFixed=o*(1-s);sf(n.halo,a,$h)}if(n.outline.body){a.outline.color=i.outline.color.get(r);a.outline.minVisibleSize=i.outline.minVisibleSize.get(r);sf(n.outline,a,ef)}}function sf(e,t,r){r(e.body,t,Yi,t.shape.type);if(e.head){r(e.head,t,Zi,t.shape.head)}if(e.tail){r(e.tail,t,Ki,t.shape.tail)}}function uf(e,t,r,i,n,a,o){if(n.text){var s=i.scaling.get(r);a.font=t.fontManager.getFont(i.font.get(r));a.color=Qd(i.color.get(r),o.color);a.style=i.style.get(r);a.minVisibleSize=i.minVisibleSize.get(r);a.margin=i.margin.get(r);a.padding=i.padding.get(r);a.maxLineLength=i.maxLineLength.get(r);a.content=Oo(a.content,a.maxLineLength);a.adjustAngle=i.adjustAngle.get(r);a.align=i.align.get(r);if(s){var u=i.scale.get(r);a.sizeScaled=o.widthScaled*u;a.sizeFixed=o.widthFixed*u}else{a.sizeFixed=i.size.get(r);a.sizeScaled=0}var l=e.measureText(a.content,a.font,a.style);a.widthScaled=l.width*a.sizeScaled;a.widthFixed=l.width*a.sizeFixed;a.heightScaled=l.height*a.sizeScaled;a.heightFixed=l.height*a.sizeFixed;a.offsetAngle=a===o.texts.primary?Ws:Xs;tf(n.text,a,o);if(n.background){rf(n.background,a,o)}}}var lf=$d(vf,"start");var df=$d(vf,"end");var hf=eh(vf);var ff=function e(t){var r=t.engine;var i=t.imageManager;var n=t.fontManager;var a=t.formatText;var o=t.view;var s=t.attributes;var u=t.attributesPrev;var l=t.nodeAttributes;var d=t.nodeAttributesPrev;this._engine=r;this._view=o;this._helper={imageManager:i,fontManager:n,formatText:a};this._attributes=s;this._attributesPrev=u;this._nodeAttributes=l;this._nodeAttributesPrev=d;this._extremitiesAttributes={source:null,target:null};this._blocks=cf(function(){return r.createBlock()});this._blockIds=cf();this._fullComponents=vf();this._startComponents=vf();this._endComponents=vf();this._startFlags=vf();this._endFlags=vf();this._startInput=Wh();this._endInput=Wh();this._depthInfo=dh();this._nullElt={start:null,end:null}};ff.prototype.drawEdge=function e(t){this._computeBlockIds(t);var r=this._attributes.excluded.get(t);if(r){this._freeBlocks()}else{var i=this._engine;var n=this._helper;var a=this._extremitiesAttributes;var o="e"+t;var s=this._attributes.layer.get(t);var u=hh(s,this._depthInfo);var l=this._attributes.source.get(t);var d=this._attributes.target.get(t);var h=this._attributes.curvature.get(t);var f=this._attributesPrev.curvature.get(t);var c=this._attributes.animationDuration.get(t);var v=this._attributes.animationStart.get(t);var p=this._attributes.animationEasing.get(t);var g=c>0;var _=h!==0||g&&f!==0;this._prepareBlocks(g,u,o,_);a.source=this._nodeAttributes;a.target=this._nodeAttributes;Uh(n,this._endInput,this._attributes,t,a,this._view);Yh(this._endFlags,this._endInput);if(g){var m=this._nodeAttributes.animationDuration.get(l)>0;var y=this._nodeAttributes.animationDuration.get(d)>0;a.source=m?this._nodeAttributesPrev:this._nodeAttributes;a.target=y?this._nodeAttributesPrev:this._nodeAttributes;Uh(n,this._startInput,this._attributesPrev,t,a,this._view);Yh(this._startFlags,this._startInput);hf(this._endFlags,this._startFlags)}this._initComponents(this._fullComponents,this._endFlags,this._blocks);df(this._endComponents,this._fullComponents);af(i,n,t,this._attributes,this._endComponents,this._endInput);if(g){lf(this._startComponents,this._fullComponents);af(i,n,t,this._attributesPrev,this._startComponents,this._startInput);this._setBlocksAnimation(c,v,p)}this._setupHaloMasking(l,d);this._storeBlocks()}};ff.prototype._setupHaloMasking=function e(t,r){var i=this._nodeAttributes.halo;var n=i.color.get(t)&&i.hideNonAdjacentEdges.get(t);var a=i.color.get(r)&&i.hideNonAdjacentEdges.get(r);var o=!n&&!a;var s=o?en:Ji;this._blocks.body.setStencilUsage(s);this._blocks.text.setStencilUsage(s);this._blocks.textBg.setStencilUsage(s)};ff.prototype._computeBlockIds=function e(t){var r=t*xs;this._blockIds.body=r+gs;this._blockIds.halo=r+ys;this._blockIds.text=r+_s;this._blockIds.textBg=r+ms};ff.prototype._prepareBlocks=function e(t,r,i,n){this._blocks.body.reset(n?Bi:Oi,t,r.edgeBody,i);this._blocks.halo.reset(n?Bi:Oi,t,r.edgeHalo,i);this._blocks.text.reset(Di,t,r.edgeText,i);this._blocks.textBg.reset(Oi,t,r.edgeTextBackground,i)};ff.prototype._storeBlocks=function e(){this._engine.storeBlock(this._blockIds.body,this._blocks.body);this._engine.storeBlock(this._blockIds.halo,this._blocks.halo);this._engine.storeBlock(this._blockIds.text,this._blocks.text);this._engine.storeBlock(this._blockIds.textBg,this._blocks.textBg)};ff.prototype._freeBlocks=function e(){this._engine.freeBlock(this._blockIds.body);this._engine.freeBlock(this._blockIds.halo);this._engine.freeBlock(this._blockIds.text);this._engine.freeBlock(this._blockIds.textBg)};ff.prototype._setBlocksAnimation=function e(t,r,i){this._blocks.body.setGlobalAnimation(t,r,i);this._blocks.halo.setGlobalAnimation(t,r,i);this._blocks.text.setGlobalAnimation(t,r,i);this._blocks.textBg.setGlobalAnimation(t,r,i)};ff.prototype._initComponents=function e(t,r,i){this._initEdgeComponents(t.halo,r.halo,i.halo);this._initEdgeComponents(t.outline,r.outline,i.body);this._initEdgeComponents(t.body,r.body,i.body);this._initTextComponents(t.texts.primary,r.texts.primary,i);this._initTextComponents(t.texts.secondary,r.texts.secondary,i)};ff.prototype._initEdgeComponents=function e(t,r,i){t.head=this._nextElement(r.head,i);t.tail=this._nextElement(r.tail,i);t.body=this._nextElement(r.body,i)};ff.prototype._initTextComponents=function e(t,r,i){t.background=this._nextElement(r.background,i.textBg);t.text=this._nextElement(r.text,i.text)};ff.prototype._nextElement=function e(t,r){return t?r.next():this._nullElt};function cf(e){if(e===void 0)e=function(){return 0};return{body:e(),halo:e(),text:e(),textBg:e()}}function vf(){return{halo:{body:undefined,head:undefined,tail:undefined},outline:{body:undefined,head:undefined,tail:undefined},body:{body:undefined,head:undefined,tail:undefined},texts:{primary:{text:undefined,background:undefined},secondary:{text:undefined,background:undefined}}}}function pf(e){var t=e.graph;var r=e.elements;var i=e.engine;var n=e.imageManager;var a=e.fontManager;var o=e.view;var s=e.attributes;var u=e.boundaries;var l=e.formatText;var d=gf(s);var h=d.nodeAttributes;var f=d.nodeAttributesPrev;var c=d.edgeAttributes;var v=d.edgeAttributesPrev;var p=r.nodes;var g=r.edges;var _=u.maxSize;var m=u.maxMinVisibleSize;if(!p.size&&!g.size){return}var y=Math.max(t.getNodeMaxIndex(),t.getEdgeMaxIndex());var b=(y+1)*xs;var x=i.setGlobalBoundaries({maxBlockId:Kt(b),maxScaledSize:Kt(_*8),maxMinVisibleSize:Kt(m),maxSymbolicSize:Kt(_),maxDashLength:3,maxGapLength:1,maxPatternScale:2});var A=(x?t.getNodes("_all"):p)._indexes;var E=(x?t.getEdges("_all"):g)._indexes;if(A.length){var S=new Bh({engine:i,imageManager:n,fontManager:a,formatText:l,attributes:h,attributesPrev:f});for(var w=0;w<A.length;++w){S.drawNode(A[w])}}if(E.length){var T=new ff({engine:i,imageManager:n,fontManager:a,formatText:l,view:o,attributes:c,attributesPrev:v,nodeAttributes:h,nodeAttributesPrev:f});for(var C=0;C<E.length;++C){T.drawEdge(E[C])}}}function gf(e){var t=Z(e.nodes.current,{text:{secondary:{scaling:e.nodes.current.text.scaling,maxLineLength:e.nodes.current.text.maxLineLength}}});var r=Z(e.nodes.previous,{textHidden:t.textHidden,text:{secondary:{scaling:e.nodes.previous.text.scaling,maxLineLength:e.nodes.previous.text.maxLineLength}}});var i=Z(e.edges.current,{text:{secondary:{scaling:e.edges.current.text.scaling,maxLineLength:e.edges.current.text.maxLineLength,adjustAngle:e.edges.current.text.adjustAngle}}});var n=Z(e.edges.previous,{source:e.edges.current.source,target:e.edges.current.target,textHidden:e.edges.current.textHidden,text:{secondary:{scaling:e.edges.previous.text.scaling,maxLineLength:e.edges.previous.text.maxLineLength,adjustAngle:e.edges.previous.text.adjustAngle}}});return{nodeAttributes:t,nodeAttributesPrev:r,edgeAttributes:i,edgeAttributesPrev:n}}var _f=typeof document!=="undefined"&&!window.__OGMA_HEADLESS;var mf=_f&&document.fonts;var yf=200;var bf="/qwerty/ [HELLO] ";var xf="serif";var Af="12px FontThatDoesNotExist";var Ef=function e(){this._fontFaceSet=mf?document.fonts:null;this._checkReliable=this._fontFaceSet&&this._fontFaceSet.check&&!this._fontFaceSet.check(Af);this._canvas=Se();this._ctx=this._canvas.getContext("2d")};Ef.prototype._measureText=function e(t,r){this._ctx.font="12px "+r;return this._ctx.measureText(t).width};Ef.prototype.check=function e(t){if(this._checkReliable){return this._fontFaceSet.check("12px "+t)}else{var r=this._measureText(bf,xf);var i=this._measureText(bf,t);return i!==r}};Ef.prototype.load=function e(t){if(this._fontFaceSet&&this._fontFaceSet.load){return this._fontFaceSet.load("12px "+t)}else{this._ctx.font="12px "+t;this._ctx.fillText(bf,10,50);return Promise.resolve()}};var Sf=function e(){this._fontFaceSet=new Ef;this._fonts={};this._onFontLoaded=[];this._hideUntilFontsLoaded=true};Sf.prototype.setHideUntilFontsLoaded=function e(value){this._hideUntilFontsLoaded=value};Sf.prototype.getFont=function e(t){var r=this;var i=this._fonts[t];if(!i){i=new wf(this._fontFaceSet,t);this._fonts[t]=i;if(!i.isLoaded()){i.load().then(function(){return r._triggerFontLoaded(t)})}}return!this._hideUntilFontsLoaded&&t||i.getValue()};Sf.prototype.onFontLoaded=function e(t){this._onFontLoaded.push(t)};Sf.prototype.destroy=function e(){var t=this;this._onFontLoaded=[];Object.keys(this._fonts).forEach(function(e){return t._fonts[e].destroy()})};Sf.prototype._triggerFontLoaded=function e(t){this._onFontLoaded.forEach(function(e){return e(t)})};var wf=function e(t,r){this._fontFaceSet=t;this._fontName=r;this._loaded=false;this._value=null;this._timeout=null;if(!_f||this._fontFaceSet.check(this._fontName)){this._setLoaded()}};wf.prototype._setLoaded=function e(){this._loaded=true;this._value=this._fontName};wf.prototype.getValue=function e(){return this._value};wf.prototype.isLoaded=function e(){return this._loaded};wf.prototype.destroy=function e(){clearTimeout(this._timeout)};wf.prototype.load=function e(){var t=this;return this._tryLoad(yf).then(function(){t._setLoaded()})};wf.prototype._tryLoad=function e(t){var r=this;return this._fontFaceSet.load(this._fontName).then(function(){var e=r._fontFaceSet.check(r._fontName);if(!e){return new Promise(function(e){if(t<6e4){r._timeout=setTimeout(e,t)}}).then(function(){return r._tryLoad(t*1.5)})}})};function Tf(e,t,r){var i=r.length;var n=i-1;var a=false;for(var o=0;o<i;++o){if((r[o].y<t&&r[n].y>=t||r[n].y<t&&r[o].y>=t)&&(r[o].x<=e||r[n].x<=e)){a=a!==r[o].x+(t-r[o].y)/(r[n].y-r[o].y)*(r[n].x-r[o].x)<e}n=o}return a}function Cf(e){var t=e.x*e.x+e.y*e.y;return{x:e.x/t,y:e.y/t}}function If(e,t){var r=Infinity;var i=-Infinity;for(var n=0,a=e.length;n<a;n++){var o=e[n];var s=o.x*t.x+o.y*t.y;if(s<r){r=s}if(s>i){i=s}}return{x:r,y:i}}function Mf(e,t){var r=e[1];var i=e[0];var n=Cf({x:r.x-i.x,y:r.y-i.y});var a=n.x;n.x=-n.y;n.y=a;var o=n;r=e[2];i=e[1];n=Cf({x:r.x-i.x,y:r.y-i.y});a=n.x;n.x=-n.y;n.y=a;var s=n;r=t[1];i=t[0];n=Cf({x:r.x-i.x,y:r.y-i.y});a=n.x;n.x=-n.y;n.y=a;var u=n;r=t[2];i=t[1];n=Cf({x:r.x-i.x,y:r.y-i.y});a=n.x;n.x=-n.y;n.y=a;var l=n;return[o,s,u,l]}function Lf(e,t){var r=Mf(e,t);for(var i=0,n=r.length;i<n;i++){var a=r[i];var o=If(e,a);var s=If(t,a);var u=o.x<=s.y&&o.y>=s.x?Math.min(o.y,s.y)-Math.max(o.x,s.x):0;if(u===0){return false}}return true}function kf(e){var t=0;var r=0;var i=e.length;if(i===0){throw new Error("Compute centroid: at least one point is required")}for(var n=0;n<i;++n){var a=e[n];t+=a.x;r+=a.y}t/=i;r/=i;return{x:t,y:r}}var Nf=Gf(4);var Ff=Gf(5);var zf=Gf(10,.4);var Rf=1/3;var Pf=[{x:-1,y:-Rf},{x:0,y:-Rf},{x:0,y:-1},{x:1,y:0},{x:0,y:1},{x:0,y:Rf},{x:-1,y:Rf}];var Of=[{x:-1,y:-Rf},{x:-.55,y:-Rf},{x:-1,y:-1},{x:1,y:0},{x:-1,y:1},{x:-.55,y:Rf},{x:-1,y:Rf}];var Df=[{x:-.6,y:-.3},{x:.1,y:0},{x:-.6,y:.3}];var Bf={circle:{getDistanceFromStrokeVertically:function(e,t){return 1},getDistanceFromStrokeHorizontally:function(e,t){return 1-Math.sqrt(e*e+t*t)},points:[{x:0,y:0,r:1}],isSimple:true},square:{getDistanceFromStrokeVertically:function(e,t){return 1-Math.abs(t)},getDistanceFromStrokeHorizontally:function(e,t){return 1-Math.abs(e)},points:[{x:-1,y:-1},{x:1,y:-1},{x:1,y:1},{x:-1,y:1}],isSimple:true},line:{getDistanceFromStrokeVertically:function(e,t){return 1-Math.abs(t)},getDistanceFromStrokeHorizontally:function(e,t){return 1},points:[{x:-1,y:0},{x:1,y:0}],isSimple:true},triangle:{getDistanceFromStrokeVertically:function(e,t){return(1-e)/2-Math.abs(t)},getDistanceFromStrokeHorizontally:function(e,t){return 1-Math.abs(e)},points:[{x:-1,y:-1},{x:-1,y:1},{x:1,y:0}],isSimple:true},arrow:{getDistanceFromStrokeVertically:function(e,t){return(1-e)/2-Math.abs(t)},getDistanceFromStrokeHorizontally:function(e,t){return 1-Math.abs(e)},points:[{x:-1,y:-1},{x:-1,y:1},{x:1,y:0}],isSimple:true},"circle-hole-arrow":{getDistanceFromStrokeVertically:function(e,t){return Math.min(Math.sqrt((e+.4)*(e+.4)+t*t)-.27,(1-e)/2-Math.abs(t))},getDistanceFromStrokeHorizontally:function(e,t){return 1-Math.abs(e)},points:[{x:-1,y:-1},{x:-1,y:1},{x:1,y:0}],hole:[{x:-.4,y:0,r:.3}],isSimple:true},"triangle-hole-arrow":{getDistanceFromStrokeVertically:function(e,t){var r=Math.min((1-e)/2-Math.abs(t),1-Math.abs(e));var i=-Uf(e,t,Df);return Math.min(r,i)},getDistanceFromStrokeHorizontally:function(e,t){return 1},points:[{x:-1,y:-1},{x:-1,y:1},{x:1,y:0}],hole:Df,isSimple:true},"short-arrow":qf(Pf,false),"sharp-arrow":qf(Of,false),cross:{getDistanceFromStrokeVertically:function(e,t){return 1},getDistanceFromStrokeHorizontally:function(e,t){var r=Math.abs(e);var i=Math.abs(t);var n=.31-Math.min(r,i);var a=1-Math.max(r,i);return Math.min(n,a)},points:[{x:-1,y:.31},{x:-1,y:-.31},{x:-.31,y:-.31},{x:-.31,y:-1},{x:.31,y:-1},{x:.31,y:-.31},{x:1,y:-.31},{x:1,y:.31},{x:.31,y:.31},{x:.31,y:1},{x:-.31,y:1},{x:-.31,y:.31}],isSimple:false},diamond:qf(Nf),pentagon:qf(Ff),star:qf(zf)};function Vf(e,t){var r=["circle","square","triangle","line"];var i=["cross","diamond","pentagon","star"];var n=["arrow","triangle-hole-arrow","circle-hole-arrow","short-arrow","sharp-arrow"];for(var a=0,o=r;a<o.length;a++){var s=o[a];jf(e,s)}var u=t.nodes.current.shape.getValues();var l=t.edges.current.shape.head.getValues();var d=t.edges.current.shape.tail.getValues();for(var h=0,f=i;h<f.length;h++){var c=f[h];if(u.includes(c)){jf(e,c)}}for(var v=0,p=n;v<p.length;v++){var g=p[v];if(l.includes(g)||d.includes(g)){jf(e,g)}}}function jf(e,t){e.registerShape(t,Bf[t])}function Uf(e,t,r){var i=Infinity;var n={x:e,y:t};for(var a=0;a<r.length;++a){var o=r[a];var s=r[(a+1)%r.length];i=Math.min(i,Yu(n,o,s))}var u=Tf(e,t,r);return i*(u?1:-1)}function Gf(e,t){if(t===void 0){t=1}var r=-Math.PI/2+Fs;var i=[];var n=Math.PI*2/e;var a=r;for(var o=0;o<e;++o){var s=o%2===1?t:1;i.push({x:Math.cos(a)*s,y:Math.sin(a)*s});a+=n}return i}function qf(e,t){if(t===void 0){t=false}return{getDistanceFromStrokeVertically:function(){return 1},getDistanceFromStrokeHorizontally:function(t,r){return Uf(t,r,e)},points:e,isSimple:t}}var Hf="anonymous";var Wf="white";var Xf="default";var Yf={maxBlockId:1024,maxScaledSize:16,maxPixelSize:255,maxMinVisibleSize:64,maxDashOffset:4,maxDashLength:3,maxGapLength:1};var Zf=typeof window==="undefined"||window.__OGMA_HEADLESS?null:"webgl";var Kf=function(e){function t(t,r){var i=this;e.call(this);this._debug=r._debug;this._events=t.events;this._dom=t.dom;this._graph=t.graph;this._camera=t.camera;this._events=t.events;this._settings=t.settings;this._formatText=jo().applyArabicShaping;this._attributesManager=new Id(t,r);this._imageManager=new Ou;this._fontManager=new Sf;this._engine=new zu(zu.getCachedInitData());this._domElement=this._engine.getDomElement();this._animations=[];this._cursorStyle=[];this._initDone=false;this._fontsNewlyLoaded=[];this._rendererState={type:"",code:"",state:"",message:""};this._boundaries={maxSize:10,maxMinVisibleSize:64};this._visibility={nodes:0,edges:0,nodeTexts:0,edgeTexts:0};this._nextAnimationId=1;this._nodeAnimationList=this._graph.createNodeAttribute({storage:32,default:0});this._edgeAnimationList=this._graph.createEdgeAttribute({storage:32,default:0});this._nextGeIndex=1;this._availableGeIndexes=[];this._events.register(["reloadFonts","rendererStateChange","updateAttributes","animate"]);this._events.register(["cameraMove","cameraPan","cameraZoom","cameraRotate","viewChanged","startZoom"]);this._settings.register("renderer",Zf,function(e){i._updateRendererState({type:e,state:"requested",code:null,message:null});i._engine.setRenderType(e);i._dom.refresh()});this._settings.register("backgroundColor",Wf,function(e){if(!i._engine.parseColor(e)){vr('Invalid background color "'+e+'" specified; will default to black.');i._settings.set("backgroundColor","black")}else{i._dom.refresh()}});this._settings.register("texts.hideUntilFontsLoaded",true,function(e){i._fontManager.setHideUntilFontsLoaded(e)});this._settings.register("imgCrossOrigin",Hf,function(){return i._updateImageCrossOrigin()});this._settings.register("cursor.default",Xf,function(){return i._applyCursorStyle()});this._dom.setLayer("graphics",this._domElement);this._engine.setGlobalBoundaries(Yf);this._dom.beforeNextFrame().then(function(){i._initDone=true;i._fireRendererStateChangeEvent()});this._isBufferDisplayable=function(e){var t=th(e);var r=rh(e);var n=t?i._visibility.nodes:i._visibility.edges;var a=t?i._visibility.nodeTexts:i._visibility.edgeTexts;var o=n===0;var s=!r||a===0;return o&&s};this._imageManager.onFetch(function(){i._engine.notifyPatternUpdate();i._dom.refresh()});this._fontManager.onFontLoaded(function(e){i._fontsNewlyLoaded.push(e);i._engine.notifyPatternUpdate();i._dom.refresh()});this._dom.addMediaListener("(min-resolution: 2dppx)",function(){i._dom.refresh()});this._visibleAttributeLayer=this._attributesManager.addAttributeLayer({priority:0,name:"internal("+El+")",tag:El,nodeOutput:{attributes:"all"},edgeOutput:{attributes:"all"},nodeDependencies:null,edgeDependencies:null});this._dataAttributeLayer=this._attributesManager.addAttributeLayer({priority:0,name:"internal("+Sl+")",tag:Sl,nodeDependencies:null,edgeDependencies:null});Vf(this._engine,this._attributesManager.getFlexArrays());this._events.on({cameraMove:function(){return i._dom.refresh()},newFrame:function(){i._processAnimations();i._loadGraphInGraphicsEngine();i._render()},clear:function(){i._nextGeIndex=1;i._availableGeIndexes=[];i._engine.clear();i._attributesManager.clear();i._dom.refresh()},viewChanged:function(e){var t=e.type;if(t==="rotate"){var r=i._graph.getEdges().filter(function(e){return e.getAttribute("adjustAnchors")});i._attributesManager.redrawElements(r)}},"addNodes addEdges":function(e){i._attributesManager.updateForAllAttributeLayers(e.nodes||e.edges)},excludedStateChange:function(e){i._visibleAttributeLayer.updateElements(e.elements)},setData:function(e){i._dataAttributeLayer.updateElements(e.elements)}});zu.clearCachedInitData()}if(e)t.__proto__=e;t.prototype=Object.create(e&&e.prototype);t.prototype.constructor=t;t.prototype.onMounted=function e(t,r){var i=this;if(r.renderer!==undefined){t.setOptions({renderer:r.renderer})}if(r.imgCrossOrigin!==undefined){t.setOptions({imgCrossOrigin:r.imgCrossOrigin})}this._dom.addWindowEventListener("unload",function(){i.destroy()})};t.prototype.getTransparentBackgroundColor=function e(){var t=this._settings.get("backgroundColor");if(!t){return null}return this._engine.transparentify(t)};t.prototype._render=function e(){var t=this._dom.getDimensions();var r=this._camera.getView();var i=we();var n=tt();var a=this._settings.get("backgroundColor");var o=this._isBufferDisplayable;this._engine.setView({x:r.x,y:r.y,zoom:r.zoom,angle:r.angle,width:t.width,height:t.height,pixelRatio:i,currentTime:n,backgroundColor:a,isBufferDisplayable:o});try{this._engine.render();if(this._rendererState.state==="requested"){this._updateRendererState({state:"ok"})}}catch(e){if(this._debug){throw e}var s=e.message;var u=e.code;if(u===void 0)u="OTHER";var l=this._rendererState.type;var d=this._formatRendererName(l);var h=this._rendererState.state==="requested";var f="Error while initializing the "+d+" renderer";var c="The "+d+" renderer encountered an unexpected runtime error";var v=h?f:c;var p=null;if(l==="webgl"){v+="; fallbacking on canvas renderer";p="canvas"}vr(s);vr(v);this._updateRendererState({state:"error",code:u,message:s});this._settings.set("renderer",p)}};t.prototype._formatRendererName=function e(t){if(t==="webgl"){return"WebGL"}else if(t==="svg"){return"SVG"}else{return t}};t.prototype._fireRendererStateChangeEvent=function e(){var t={type:this._rendererState.type,state:this._rendererState.state,code:this._rendererState.code,message:this._rendererState.message};this._events.fire("rendererStateChange",t)};t.prototype._updateRendererState=function e(t){var r=t.type;var i=t.state;var n=t.code;var a=t.message;var o=false;if(r!==undefined&&this._rendererState.type!==r){this._rendererState.type=r;o=true}if(i!==undefined&&this._rendererState.state!==i){this._rendererState.state=i;o=true}if(n!==undefined&&this._rendererState.code!==n){this._rendererState.code=n;o=true}if(a!==undefined&&this._rendererState.message!==a){this._rendererState.message=a;o=true}if(o&&this._initDone){this._fireRendererStateChangeEvent()}};t.prototype.getImageData=function e(){var t=this;return this._dom.afterNextFrame().then(function(){return t._engine.getImageData()})};t.prototype.addCanvas=function e(t){this._engine.addCanvas(t)};t.prototype.removeCanvas=function e(t){this._engine.removeCanvas(t)};t.prototype.getNodeAttributes=function e(){return this._attributesManager.getFlexArrays().nodes.current};t.prototype.getEdgeAttributes=function e(){return this._attributesManager.getFlexArrays().edges.current};t.prototype.getGraphicsEngine=function e(){return this._engine};t.prototype.getImageManager=function e(){return this._imageManager};t.prototype.getFontManager=function e(){return this._fontManager};t.prototype.allocateGraphicsEngineBlockId=function e(){if(this._availableGeIndexes.length){return this._availableGeIndexes.pop()}else{return this._nextGeIndex++*xs+bs}};t.prototype.releaseGraphicsEngineBlockId=function e(t){this._engine.freeBlock(t);this._availableGeIndexes.push(t);this._dom.refresh()};t.prototype.addCursorStyle=function e(t){if(!t){return}this._cursorStyle.push(t);this._applyCursorStyle()};t.prototype.removeCursorStyle=function e(t){if(!t){return}var r=this._cursorStyle.lastIndexOf(t);if(r!==-1){this._cursorStyle.splice(r,1);this._applyCursorStyle()}};t.prototype._applyCursorStyle=function e(){var t=this._cursorStyle[this._cursorStyle.length-1]||this._settings.get("cursor.default");Ue(this._domElement,t)};t.prototype.reloadFonts=function e(){this._events.fire("reloadFonts");this._engine.notifyFontsReloaded();this._dom.refresh()};t.prototype._updateImageCrossOrigin=function e(){this._imageManager.setImgCrossOrigin(this._settings.get("imgCrossOrigin"))};t.prototype.getDomElement=function e(){return this._domElement};t.prototype.setTextHidden=function e(t,r){this._attributesManager.setTextHidden(t,r)};t.prototype.resetTextHidden=function e(){this._attributesManager.resetTextHidden();this._dom.refresh()};t.prototype.getAttributesManager=function e(){return this._attributesManager};t.prototype._checkFontsNewlyLoaded=function e(){if(this._fontsNewlyLoaded.length){this._fontsNewlyLoaded=[];return true}return false};t.prototype._loadGraphInGraphicsEngine=function e(){this._attributesManager.update();if(this._checkFontsNewlyLoaded()){this._attributesManager.redrawAll()}var t=this._attributesManager.getAndResetElementsToRedraw();var r=this._attributesManager.getAndResetElementsUpdated();var i=r.nodes.size||r.edges.size;if(r.nodeAttributes.includes("radius")||r.edgeAttributes.includes("width")){this._computeMaxSize()}if(r.nodeAttributes.includes("shape")||r.edgeAttributes.includes("shape.head")||r.edgeAttributes.includes("shape.tail")){Vf(this._engine,this._attributesManager.getFlexArrays())}pf({graph:this._graph,elements:t,engine:this._engine,imageManager:this._imageManager,fontManager:this._fontManager,view:this._camera.getView(),attributes:this._attributesManager.getFlexArrays(),boundaries:this._boundaries,formatText:this._formatText});if(i){this._events.fire("updateAttributes",r)}};t.prototype._computeMaxSize=function e(){var t=this._graph.getNodeAttribute("radius");var r=this._graph.getEdgeAttribute("width");var i=this._graph.getNodes();var n=this._graph.getEdges();var a=0;var o=0;for(var s=0,u=i._indexes;s<u.length;s+=1){var l=u[s];var d=t.get(l);if(d>a){a=d}}for(var h=0,f=n._indexes;h<f.length;h+=1){var c=f[h];var v=r.get(c);if(v>o){o=v}}this._boundaries.maxSize=Math.max(a*2,o)};t.prototype._forceCompleteGraphRefresh=function e(){this._attributesManager.redrawAll();this._loadGraphInGraphicsEngine()};t.prototype.export=function e(t,r,i,n){var a=this;var o;return Promise.all([this._graph.getNodes().addClass(kl),this._graph.getEdges().addClass(kl)]).then(function(){return a.resolveAtNextFrame()}).then(function(){return a._imageManager.whenReady()}).then(function(){if(i==="all"){o=tc(a._graph);a._forceCompleteGraphRefresh()}else{a._loadGraphInGraphicsEngine()}return a._engine.export(t,r,n)}).then(function(e){return Promise.all([a._graph.getNodes().removeClass(kl),a._graph.getEdges().removeClass(kl)]).then(function(){return e})}).then(function(e){if(i==="all"){rc(o);a._forceCompleteGraphRefresh()}return e})};t.prototype.addAttributeLayer=function e(t){return this._attributesManager.addAttributeLayer(t)};t.prototype.createFlexArrays=function e(){return this._attributesManager.createFlexArrays()};t.prototype.getAttributeValues=function e(t,r,i,n){return this._attributesManager.getAttributeValues(t,r,i,n)};t.prototype.forceAttributesComputation=function e(){this._attributesManager.update()};t.prototype.resolveAtNextFrame=function e(t){return this._dom.afterNextFrame().then(function(){return t})};t.prototype.animate=function e(t,r,i){var n=Qf(i);if(n.duration){this._engine.ensureAnimationsReady()}return this._animate(t,r,n)};t.prototype.isAnimating=function e(){return this._animations.length>0};t.prototype.getAnimationInformation=function e(t){return this._attributesManager.getAnimationInformation(t)};t.prototype._toSubGraph=function e(t){if(t instanceof _i||t instanceof gi){return{nodes:t.toList(),edges:t.getAdjacentEdges()}}if(t instanceof jr||t instanceof Vr){return{nodes:this._graph.nodeList(),edges:t.toList()}}var r={nodes:t.nodes||this._graph.nodeList(),edges:t.edges||this._graph.edgeList()};if(r.nodes.size){if(r.edges.size){r.edges=r.edges.concat(r.nodes.getAdjacentEdges()).dedupe()}else{r.edges=r.nodes.getAdjacentEdges()}}return r};t.prototype._animate=function e(t,r,i){var n=i.duration;var a=i.easing;if(!this._animations.length&&!n){r(t);return Promise.resolve(t)}var o=this._toSubGraph(t);var s=o.nodes;var u=o.edges;if(!s.size&&!u.size){return Promise.resolve(t)}if(s.size){this._events.fire("animate",{elements:s,duration:n,easing:a})}if(u.size){this._events.fire("animate",{elements:u,duration:n,easing:a})}var l={id:this._nextAnimationId++,startTime:-1,finished:false,func:function(){return r(t)},duration:n,easing:a,nodes:s,edges:u,resolve:undefined};var d=new Promise(function(e){return l.resolve=function(){return e(t)}});for(var h=0,f=s._indexes;h<f.length;h+=1){var c=f[h];this._nodeAnimationList.set(c,l.id)}for(var v=0,p=u._indexes;v<p.length;v+=1){var g=p[v];this._edgeAnimationList.set(g,l.id)}this._animations.push(l);this._dom.refresh();if(!n){this._processAnimations()}return d};t.prototype._isElementAnimated=function e(t){var r=(t.isNode?this._nodeAnimationList:this._edgeAnimationList).get(t._index)!==0;if(!t.isNode){r|=this._nodeAnimationList.get(t.getSource()._index)!==0;r|=this._nodeAnimationList.get(t.getTarget()._index)!==0}return r};t.prototype._endAnimation=function e(t){t.resolve(t.elements);t.finished=true};t.prototype._removeFinishedAnimations=function e(){this._animations=this._animations.filter(function(e){return!e.finished})};t.prototype._getAnimationElements=function e(t){var r=[];var i=[];for(var n=0,a=t.nodes._indexes;n<a.length;n+=1){var o=a[n];if(this._nodeAnimationList.get(o)===t.id){r.push(o)}}for(var s=0,u=t.edges._indexes;s<u.length;s+=1){var l=u[s];if(this._edgeAnimationList.get(l)===t.id){i.push(l)}}return{nodes:this._graph.nodeList(r),edges:this._graph.edgeList(i)}};t.prototype._resetAnimationAttributes=function e(t){var r=t.nodes;var i=t.edges;this._attributesManager.resetAnimationAttributes({nodes:r,edges:i});this._nodeAnimationList.fill(r._indexes,0);this._edgeAnimationList.fill(i._indexes,0)};t.prototype._processAnimations=function e(){if(!this._animations.length){return}var t=tt();var r=[];this._attributesManager.update();for(var i=0,n=this._animations;i<n.length;i+=1){var a=n[i];if(a.startTime===-1){a.startTime=t;r.push(a.func);if(a.duration>0){this._attributesManager.setAnimationAttributes(this._getAnimationElements(a),a)}}}for(var o=0,s=r;o<s.length;o+=1){var u=s[o];u()}for(var l=0,d=this._animations;l<d.length;l+=1){var h=d[l];if(t>=h.startTime+h.duration){this._resetAnimationAttributes(this._getAnimationElements(h));this._endAnimation(h)}}this._removeFinishedAnimations();if(this._animations.length){this._dom.refresh()}};t.prototype.hideTexts=function e(){this.setNodeTextsVisibility(false);this.setEdgeTextsVisibility(false)};t.prototype.showTexts=function e(){this.setNodeTextsVisibility(true);this.setEdgeTextsVisibility(true)};t.prototype.setNodesVisibility=function e(value){return this._updateVisibilityCounter("nodes",value)};t.prototype.setNodeTextsVisibility=function e(value){return this._updateVisibilityCounter("nodeTexts",value)};t.prototype.setEdgesVisibility=function e(value){return this._updateVisibilityCounter("edges",value)};t.prototype.setEdgeTextsVisibility=function e(value){return this._updateVisibilityCounter("edgeTexts",value)};t.prototype._updateVisibilityCounter=function e(t,value){this._visibility[t]+=value?-1:1;this._dom.refresh()};t.prototype.detectNode=function e(t){var r=t.margin;var i=t.texts;var n=t.indexes;if(n===void 0)n=this._graph.getNodes()._indexes;var a=this._engine;var o=this._graph.getObjectList(true);var s=this._attributesManager.getFlexArrays().nodes.current;var u=this._camera.getZoom();var l=t.x;var d=t.y;var h={left:{x:-1,y:0},right:{x:1,y:0},top:{x:0,y:-1},bottom:{x:0,y:1},center:{x:0,y:0}};var f=0;this._attributesManager.update();for(var c=0;c<n.length;++c){var v=n[c];if(!s.excluded.get(v)&&s.detectable.get(v)&&s.animationDuration.get(v)===0){var p=s.x.get(v);var g=s.y.get(v);var _=this._camera.graphToScreenCoordinates({x:p,y:g});var m=_.x;var y=_.y;var b=s.shape.get(v);var x=s.scalingMethod.get(v)==="scaled";var A=s.radius.get(v)*(x?u:1);var E=A+r;var S=(l-m)/E;var w=(d-y)/E;if(a.checkShapeHit(b,S,w)){f=v}else if(i){var T=this._formatText(s.text.content.get(v));var C=s.textHidden.get(v);var I=s.text.minVisibleSize.get(v);var M=x?A*2:Infinity;if(!C&&T&&M>=I){var L=Oo(T,s.text.maxLineLength.get(v));var k=s.innerStroke.width.get(v);var N=s.outerStroke.width.get(v);var F=s.text.margin.get(v);var z=s.text.padding.get(v);var R=s.text.size.get(v);var P=s.text.scale.get(v);var O=s.text.scaling.get(v);var D=s.text.font.get(v);var B=s.text.style.get(v);var V=s.text.position.get(v);var j=a.measureText(L,D,B,1);var U=O?P*A:R;var G=j.width*U/2+z+r;var q=j.height*U/2+z+r;var H=h[V];var W=k+N+F+A;var X=(W+G)*H.x;var Y=(W+q)*H.y;var Z=m+X;var K=y+Y;var Q=Z-G;var J=Z+G;var $=K-q;var ee=K+q;if(l>Q&&l<J&&d>$&&d<ee){f=v}}}}}return o.get(f)||null};t.prototype.detectEdge=function e(t){var r=t.margin;var i=t.texts;var n=t.indexes;if(n===void 0)n=this._graph.getEdges()._indexes;var a=this._graph.getObjectList(false);var o=this._attributesManager.getFlexArrays();var s=o.edges.current;var u=o.nodes.current;var l=this._camera.getZoom();var d=r/l;var h=this._camera.screenToGraphCoordinates(t);var f=h.x;var c=h.y;var v=0;this._attributesManager.update();for(var p=0;p<n.length;++p){var g=n[p];var _=s.source.get(g);var m=s.target.get(g);var y=s.excluded.get(g);var b=s.detectable.get(g);var x=s.animationDuration.get(g)!==0;var A=u.animationDuration.get(_)!==0;var E=u.animationDuration.get(m)!==0;if(!y&&b&&!x&&!A&&!E){var S=_===m;var w=s.curvature.get(g);var T=s.shape.type.get(g)==="triangle";var C=s.scalingMethod.get(g)==="scaled";var I=s.width.get(g)/(C?1:l);var M=u.x.get(_);var L=u.y.get(_);var k=u.x.get(m);var N=u.y.get(m);if(S){var F=u.scalingMethod.get(_)==="scaled";var z=u.radius.get(_)/(F?1:l);var R=tu(M,L,w,z,0);if(hl(f,c,M,L,M,L,R.x1,R.y1,R.x2,R.y2,I,d)){v=g}}else if(w!==0){var P=eu(M,L,k,N,w);if(ll(f,c,M,L,k,N,P.x,P.y,I,d,T)){v=g}}else{if(Du(f,c,M,L,k,N,I,d,T)){v=g}}}}return a.get(v)||null};t.prototype._getAttributeArray=function e(t,r){var i=this._attributesManager.getFlexArrays();var n=t?i.nodes:i.edges;return j(n.current,r)};t.prototype.destroy=function e(){this.getGraphicsEngine().destroy();this.getImageManager().destroy();this.getFontManager().destroy()};return t}(Ct);function Qf(e){if(typeof e==="number"){e={duration:e}}else if(typeof e!=="object"||e===null){e={}}return{duration:Jf(e.duration),easing:e.easing||"linear",chain:!!e.chain}}function Jf(e){if(typeof e!=="number"||!isFinite(e)||e<0){return 0}else{return e}}function $f(e,t){var r=e.getAttribute(t,"excluded");var i=(t?e.getNodes("all"):e.getEdges("all"))._indexes;var n=r.getMultiple(i);r.fill(i,0);return{excludedList:r,indexes:i,values:n}}function ec(e){var t=e.excludedList;var r=e.indexes;var i=e.values;t.setMultiple(r,i)}function tc(e){return{nodes:$f(e,true),edges:$f(e,false)}}function rc(e){var t=e.nodes;var r=e.edges;ec(t);ec(r)}var ic=1e-8;var nc=1e8;var ac;(function(e){e["ZOOM"]="zoom";e["ROTATE"]="rotate";e["PAN"]="pan"})(ac||(ac={}));var oc={duration:0,easing:"linear",startAfter:0,ignoreZoomLimits:false,callback:function(){return undefined}};function sc(e){return Math.abs(e)<1e-9}var uc=80;var lc=function(e){l(t,e);function t(t){var r=e.call(this)||this;r._modules=t;r._events=t.events;r._dom=t.dom;r._animations=t.animations;r._settings=t.settings;r._zoomAnimation=null;r._moveAnimation=null;r._reset();r._minZoom=ic;r._maxZoom=nc;r._settings.register("minZoom",ic,function(e){r._minZoom=e;if(r._zoom<e){r._zoom=e;r._events.fire(It.CAMERA_MOVE)}});r._settings.register("maxZoom",nc,function(e){r._maxZoom=e;if(r._zoom>e){r._zoom=e;r._events.fire(It.CAMERA_MOVE)}});r._timeout=null;r._events.on({setContainer:function(){r._reset();r._events.fire(It.CAMERA_MOVE)},resize:function(){r._reloadDimensions();r._events.fire(It.CAMERA_MOVE)}});return r}Object.defineProperty(t.prototype,"x",{get:function(){return this._x},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"y",{get:function(){return this._y},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"zoom",{get:function(){return this._zoom},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"angle",{get:function(){return this._angle},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"width",{get:function(){return this._dimensions.width},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"height",{get:function(){return this._dimensions.height},enumerable:true,configurable:true});t.prototype.moveEnd=function(e){var t=this;this._dom.clearTimeout(this._timeout);this._timeout=this._dom.setTimeout(function(){t._timeout=null;t._events.fire(It.VIEW_CHANGED,{type:e})},uc)};t.prototype.getSize=function(){return{width:this._dimensions.width,height:this._dimensions.height}};t.prototype.getCenter=function(){return{x:this._x,y:this._y}};t.prototype.setCenter=function(e,t){var r=this;var i=e.x,n=e.y;var a=d({},oc,t);var o=this._x;var s=this._y;var u=i-this._x;var l=n-this._y;if(sc(u)&&sc(l)){return Promise.resolve()}return new Promise(function(e){var t=function(e){r._x=o+u*e;r._y=s+l*e;r._events.fire(It.CAMERA_MOVE);r._events.fire("cameraPan")};a.callback=function(){r.moveEnd(ac.PAN);e()};if(r._moveAnimation){r._animations.end(r._moveAnimation,false)}r._moveAnimation=r._animations.play(t,a)})};t.prototype.move=function(e,t){var r=e.x,i=e.y;var n=dc({x:r,y:i},this._zoom,this._sinAngle,this._cosAngle);return this.setCenter({x:this._x+n.x,y:this._y+n.y},t)};t.prototype.getZoom=function(){return this._zoom};t.prototype.setZoom=function(e,t,r){var i=this;if(r===void 0){r={refX:undefined,refY:undefined}}t=d({},oc,t);var n=r.refX,a=r.refY;var o=this._minZoom;var s=this._maxZoom;var u=Jt(e,o,s);if(!t.ignoreZoomLimits){u=this._applyZoomLimits(u)}if(sc(this._zoom-u)){return Promise.resolve()}return new Promise(function(e){var r=i._dimensions.width/2;var o=i._dimensions.height/2;var s=i._zoom;var l=r/s-r/u;var d=function(e){i._zoom=r/(r/s-l*e);i._events.fire(It.CAMERA_MOVE);i._events.fire("cameraZoom")};t.callback=function(){i.moveEnd(ac.ZOOM);e()};if(n!==undefined&&a!==undefined){var h=(n-r)/s-(n-r)/u;var f=(a-o)/s-(a-o)/u;var c=i._cosAngle;var v=i._sinAngle;var p=c*h-v*f;var g=v*h+c*f;i.setCenter({x:i._x+p,y:i._y+g},t)}if(i._zoomAnimation){i._animations.end(i._zoomAnimation,false)}i._dom.setTimeout(function(){i._events.fire(It.START_ZOOM,{duration:t.duration,easing:t.easing,startZoom:s,endZoom:u})});i._zoomAnimation=i._animations.play(d,t)})};t.prototype._applyZoomLimits=function(e){var t=this._settings.get("interactions.zoom.minValue");var r=this._settings.get("interactions.zoom.maxValue");var i=this._modules.locate.getGraphBoundingBox();var n=this._zoom;var a=this.getSize();var o=e;if(!isNaN(i.cx)){var s={smallestNodeSize:i.minScaledSize,biggestNodeSize:i.maxScaledSize,graphWidth:i.width+i.maxScaledSize,graphHeight:i.height+i.maxScaledSize,viewWidth:a.width,viewHeight:a.height};var u=t&&t(s);var l=r&&r(s);if(hc(u)&&o<u){if(o<n){o=Math.min(n,u)}}else if(hc(l)&&o>l){if(o>n){o=Math.max(n,l)}}}return o};t.prototype.zoomIn=function(e,t,r){if(r===void 0){r={refX:undefined,refY:undefined}}if(typeof e!=="number"){r=t;t=e;e=this._settings.get("interactions.zoom.modifier")}return this.setZoom(this._zoom*e,t,r)};t.prototype.zoomOut=function(e,t,r){if(r===void 0){r={refX:undefined,refY:undefined}}if(typeof e!=="number"){r=t;t=e;e=this._settings.get("interactions.zoom.modifier")}return this.setZoom(this._zoom/e,t,r)};t.prototype.getAngle=function(){return this._angle};t.prototype.setAngle=function(e,t){var r=this;t=d({},oc,t);var i=this._angle;var n=e-i;if(sc(n)){return Promise.resolve()}return new Promise(function(e){var a=function(e){r._angle=i+n*e;while(r._angle>Math.PI){r._angle-=2*Math.PI}while(r._angle<-Math.PI){r._angle+=2*Math.PI}r._sinAngle=Math.sin(r._angle);r._cosAngle=Math.cos(r._angle);r._events.fire(It.CAMERA_MOVE);r._events.fire("cameraRotate")};t.callback=function(){r.moveEnd(ac.ROTATE);e()};if(r._rotateAnimation){r._animations.end(r._rotateAnimation,false)}r._rotateAnimation=r._animations.play(a,t)})};t.prototype.rotate=function(e,t){return this.setAngle(this._angle+e,t)};t.prototype.getScreenCenter=function(){return{x:this._dimensions.width/2,y:this._dimensions.height/2}};t.prototype.graphToScreenCoordinates=function(e,t){var r=e.x,i=e.y;if(t===void 0){t={x:0,y:0}}var n=this._dimensions.width/2;var a=this._dimensions.height/2;var o=(r-this._x)*this._zoom+n;var s=(i-this._y)*this._zoom+a;return du(o,s,n,a,-this._angle,t)};t.prototype.screenToGraphCoordinates=function(e,t){var r=e.x,i=e.y;if(t===void 0){t={x:0,y:0}}var n=this._x+(r-this._dimensions.width/2)/this._zoom;var a=this._y+(i-this._dimensions.height/2)/this._zoom;return du(n,a,this._x,this._y,this._angle,t)};t.prototype.projectBounds=function(e,t){if(t===void 0){t=e}var r=e[0],i=e[1],n=e[2],a=e[3];var o=this._x,s=this._y;var u=this._dimensions.width/2;var l=this._dimensions.height/2;var d=this._sinAngle,h=this._cosAngle,f=1/this._zoom;var c=Infinity;var v=Infinity;var p=-Infinity;var g=-Infinity;var _=[r,i,r,a,n,a,n,i];for(var m=0;m<_.length;m+=2){var y=_[m];var b=_[m+1];y=o+(y-u)*f;b=s+(b-l)*f;var x=y-o;var A=b-s;y=h*x-d*A+o;b=d*x+h*A+s;if(y<c){c=y}if(y>p){p=y}if(b<v){v=b}if(b>g){g=b}}t[0]=c;t[1]=v;t[2]=p;t[3]=g;return t};t.prototype.screenToGraphVector=function(e){var t=e.x,r=e.y;return dc({x:t,y:r},this._zoom,this._sinAngle,this._cosAngle)};t.prototype.getView=function(){return{x:this._x,y:this._y,zoom:this._zoom,angle:this._angle,width:this._dimensions.width,height:this._dimensions.height}};t.prototype.setView=function(e,t){var r=d({x:this._x,y:this._y,zoom:this._zoom,angle:this._angle},e),i=r.x,n=r.y,a=r.zoom,o=r.angle;return Promise.all([this.setCenter({x:i,y:n},t),this.setZoom(a,t),this.setAngle(o,t)]).then(function(){})};t.prototype._reloadDimensions=function(){this._dimensions=this._dom.getDimensions()};t.prototype.animationInProgress=function(){var e=this._moveAnimation;var t=this._zoomAnimation;return e&&!e.done||t&&!t.done};t.prototype.getProjectedScreenBounds=function(e){if(e===void 0){e=0}var t=this._dimensions,r=t.width,i=t.height;var n=Math.max(r,i)*e;return this.projectBounds([0-n,0-n,r+n,i+n])};t.prototype._reset=function(){this._zoom=1;this._x=0;this._y=0;this._angle=0;this._sinAngle=0;this._cosAngle=1;this._dimensions=this._dom.getDimensions()};return t}(Ct);function dc(e,t,r,i){var n=e.x,a=e.y;n/=t;a/=t;return{x:i*n-r*a,y:r*n+i*a}}function hc(value){return typeof value==="number"&&isFinite(value)}function fc(e){var t=e.filter(function(e){return isFinite(e)&&e>0});var r=t.length?rr(t):1;return r}var cc=function(e){l(t,e);function t(){var t=e!==null&&e.apply(this,arguments)||this;t._events={};t._onAnyEvents=[];return t}t.prototype.register=function(e,t){var r=this;if(t===void 0){t=[]}e.forEach(function(e){if(r._events[e]){throw new Error('event "'+e+'" already exists')}r._events[e]=new vc(false,e)});t.forEach(function(e){if(r._events[e]){throw new Error('event "'+e+'" already exists')}r._events[e]=new vc(true,e)})};t.prototype.onAnyEvent=function(e){this._onAnyEvents.push(e)};t.prototype.on=function(e,t){var r=this;if(typeof e==="string"){var i=e.split(" ").filter(function(e){return!!e});i.forEach(function(e){return _r(r._events,e,"event").on(t)})}else{P(e,function(e,t){return r.on(t,e)})}return this};t.prototype.removeListener=function(e){P(this._events,function(t){t.off(e)})};t.prototype.fire=function(e,t){if(t===void 0){t=null}var r=_r(this._events,e,"event");this._onAnyEvents.forEach(function(r){return r(e,t)});r.trigger(t);return this};t.prototype.once=function(e,t){var r=this;var i=function(){t.apply(null,arguments);r.removeListener(i)};this.on(e,i)};return t}(Ct);var vc=function(){function e(e,t){this._subscribers=[];this._handlers=[];this._reverseOrder=e;this._name=t}e.prototype.trigger=function(e){for(var t=0,r=this._handlers;t<r.length;t++){var i=r[t];i(e,this._name)}return this};e.prototype.on=function(e){if(typeof e!=="function"){throw new Error("handler is not a function")}var t=this._reverseOrder?0:this._subscribers.length;this._handlers.splice(t,0,e);this._subscribers.splice(t,0,e);return this};e.prototype.off=function(e){var t;while((t=this._subscribers.indexOf(e))!==-1){this._subscribers.splice(t,1);this._handlers.splice(t,1)}return this};return e}();var pc=function(e){l(t,e);function t(t){var r=t.events,i=t.graphics;var n=e.call(this)||this;n._events=r;n._graphics=i;n._events.on({"addNodes addEdges":function(e){var t=e.nodes,r=e.edges,i=e.objects;var a=t||r;var o=i.map(function(e){return e.attributes});n._originalAttributesLayer.setAttributeValues(a,o)}});n._originalAttributesLayer=n._graphics.addAttributeLayer({name:"original-attributes",priority:_l,nodeOutput:{attributes:"all"},edgeOutput:{attributes:"all"},nodeDependencies:null,edgeDependencies:null});n._individualAttributesLayer=n._graphics.addAttributeLayer({name:"individual-attributes",priority:bl,nodeOutput:{attributes:"all"},edgeOutput:{attributes:"all"},nodeDependencies:null,edgeDependencies:null});return n}t.prototype.getOriginalAttributes=function(){return this._originalAttributesLayer.getFlexArrays()};t.prototype.setMultipleAttributes=function(e,t,r,i){var n=this;return this._graphics.animate(e,function(){n._individualAttributesLayer.setAttributeValues(e,t,i)},r)};t.prototype.setSingleAttribute=function(e,t,r,i){var n={};V(n,t,r);return this.setMultipleAttributes(e,n,i)};t.prototype.resetMultipleAttributes=function(e,t,r){var i=this;t=t||this._individualAttributesLayer.getUsedAttributeNames(e);var n={};for(var a=0,o=t;a<o.length;a++){var s=o[a];V(n,s,undefined)}return this._graphics.animate(e,function(){i._individualAttributesLayer.setAttributeValues(e,n)},r)};t.prototype.getMultipleAttributes=function(e,t){return this._graphics.getAttributeValues(e,t,true,false)};t.prototype.getSingleAttribute=function(e,t){return this._graphics.getAttributeValues(e,t,false,false)};t.prototype.replaceOriginalAttributes=function(e,t,r){if(r===void 0){r=[]}var i={};var n=this._originalAttributesLayer.getUsedAttributeNames(e).filter(function(e){return!r.includes(e)});for(var a=0;a<n.length;++a){V(i,n[a],undefined)}this._originalAttributesLayer.setAttributeValues(e,i);this._originalAttributesLayer.setAttributeValues(e,t)};t.prototype.getSinglePreviousAttribute=function(e,t){return this._graphics.getAttributeValues(e,t,false,true)};t.prototype.getMultiplePreviousAttributes=function(e,t){return this._graphics.getAttributeValues(e,t,true,true)};return t}(Ct);var gc=function(e){l(t,e);function t(){var t=e!==null&&e.apply(this,arguments)||this;t._currentValue={};t._onChange={};t._defaultValues={};t._keys=[];return t}t.prototype.onMounted=function(e,t){if(t.renderer){this.update({renderer:t.renderer})}if(t.options){this.update(t.options)}};t.prototype.register=function(e,t,r,i){if(i===undefined){i=true}this._keys.push(e);this._currentValue[e]=t;this._defaultValues[e]=t;this._onChange[e]=r||function(){};if(r&&i){r(t)}return this};t.prototype.update=function(e){e=U(e);var t=this._keys,r={};for(var i=0;i<t.length;++i){var n=t[i];if(n in e){var value=e[n];if(value===undefined){value=this._defaultValues[n]}r[n]=this._currentValue[n];this._currentValue[n]=value}}var a=Object.keys(r);for(var i=0;i<a.length;++i){var o=a[i],s=this._currentValue[o],u=r[o];if(s!==u){this._onChange[o](s,u)}}return G(r)};t.prototype.get=function(e){if(!arguments.length){return G(this._currentValue)}return this._currentValue[e]};t.prototype.set=function(e,value){var t=this._currentValue[e];var r=this._onChange[e];this._currentValue[e]=value;if(r){r(value,t)}};return t}(Ct);var _c=function(){function e(e,t){this._classes=e;this._name=t}e.prototype.getName=function(){return this._name};e.prototype.getIndex=function(){return this._classes.getIndex(this._name)};e.prototype.setIndex=function(e){return this._classes.setIndex(this._name,e)};e.prototype.update=function(e){this._classes.update(this._name,e);return this};e.prototype.getDefinition=function(){return this._classes.getDefinition(this._name)};e.prototype.getNodes=function(){return this._classes.getElementsByClass(this._name).nodes};e.prototype.getEdges=function(){return this._classes.getElementsByClass(this._name).edges};e.prototype.clearNodes=function(){this.getNodes().removeClass(this._name)};e.prototype.clearEdges=function(){this.getEdges().removeClass(this._name)};e.prototype.add=function(e){e.addClass(this._name)};e.prototype.remove=function(e){e.removeClass(this._name)};return e}();var mc=1e3;var yc=.5/mc;var bc=function(e){l(t,e);function t(t){var r=e.call(this)||this;r._builtinClasses=[];r._userClasses=[];r._classesByName={};r._events=t.events;r._graphics=t.graphics;r._graph=t.graph;r._events.on({excludedStateChange:function(e){var t=e.elements,value=e.value;if(value){var i=r._builtinClasses.map(function(e){return e.name});r._addOrRemoveClassesToElements(i,t,false)}},clear:function(){r._builtinClasses.concat(r._userClasses).forEach(function(e){return e.elementSet.clear()})}});return r}t.prototype._getClassList=function(e){return e?this._builtinClasses:this._userClasses};t.prototype.createClass=function(e){if(e===void 0){e={}}var t=e.name,r=e.isBuiltin,i=e.after,n=e.nodeAttributes,a=e.nodeDependencies,o=e.nodeOutput,s=e.edgeAttributes,u=e.edgeDependencies,l=e.edgeOutput;if(typeof t!=="string"){throw new Error('the "name" argument should be a string')}var d=this._getClassList(r);var h=i?Ac(d,i)+1:d.length;if(h===-1){throw new Error('createClass: class specified as `after` parameter "'+i+'" does not exist')}if(r&&!t.startsWith("_")){throw new Error('invalid builtin class name "'+t+"\": builtin classes should start with '_'")}var f=new Qa(this._graph);var c=new _c(this,t);var v=this._graphics.addAttributeLayer({name:"class("+t+")",tag:t,standaloneSelectors:true,nodeAttributes:n,edgeAttributes:s,nodeSelector:function(e,t){return t.hasElement(e)},edgeSelector:function(e,t){return t.hasElement(e)},nodeContext:f,edgeContext:f,nodeOutput:o,edgeOutput:l,nodeDependencies:a,edgeDependencies:u});var p={name:t,elementSet:f,attributeLayer:v,isBuiltin:r,wrapper:c};d.splice(h,0,p);if(r){d.sort(function(e,t){return zl.indexOf(e.name)-zl.indexOf(t.name)})}this._updatePriorities(r);this._classesByName[t]=p;this._events.register([xc(t,true,true),xc(t,true,false),xc(t,false,true),xc(t,false,false)]);return c};t.prototype._updatePriorities=function(e){var t=this._getClassList(e);var r=xl+(e?.5:0);for(var i=0;i<t.length;++i){var n=t[i];var a=r+yc*i;n.attributeLayer.update({priority:a})}};t.prototype._get=function(e){var t=this._classesByName[e];if(!t){throw new Error('class "'+e+'" does not exist')}return t};t.prototype.getIndex=function(e){var t=this._get(e);var r=this._getClassList(t.isBuiltin);return r.indexOf(t)};t.prototype.setIndex=function(e,t){var r=this._get(e);var i=this._getClassList(r.isBuiltin);var n=i.indexOf(r);var a=Jt(t,0,i.length-1);i.splice(n,1);i.splice(a,0,r);this._updatePriorities(r.isBuiltin)};t.prototype.update=function(e,t){if(t===void 0){t={}}var r=this._get(e);r.attributeLayer.update({nodeAttributes:t.nodeAttributes,edgeAttributes:t.edgeAttributes,nodeDependencies:t.nodeDependencies,edgeDependencies:t.edgeDependencies,nodeOutput:t.nodeOutput,edgeOutput:t.edgeOutput,fullOverwrite:t.fullOverwrite})};t.prototype.getDefinition=function(e){var t=this._get(e);var r=t.attributeLayer.getDefinition(),i=r.nodeAttributes,n=r.nodeDependencies,a=r.nodeOutput,o=r.edgeAttributes,s=r.edgeDependencies,u=r.edgeOutput;return{nodeAttributes:i,edgeAttributes:o,nodeDependencies:n,edgeDependencies:s,nodeOutput:a,edgeOutput:u}};t.prototype._addOrRemoveClassesToElements=function(e,t,r){var i=t.isNode;for(var n=0;n<e.length;++n){var a=e[n];var o=this._get(a),s=o.elementSet,u=o.attributeLayer;var l=s.addOrRemoveElements(t,r);var d=xc(a,i,r);if(l.size){u.updateElements(l);this._events.fire(d,i?{nodes:l}:{edges:l})}}};t.prototype.addClassesToElements=function(e,t,r){var i=this;var n=t.toList();return this._graphics.animate(t,function(){i._addOrRemoveClassesToElements(e,n,true)},r)};t.prototype.removeClassesFromElements=function(e,t,r){var i=this;var n=t.toList();return this._graphics.animate(t,function(){i._addOrRemoveClassesToElements(e,n,false)},r)};t.prototype.hasSingleElementClass=function(e,t){return this._get(e).elementSet.hasElement(t)};t.prototype.getElementsClassList=function(e,t){if(t===void 0){t={}}var r=t.includeBuiltinClasses,i=r===void 0?false:r;var n=new Array(e.size);for(var a=0;a<n.length;++a){n[a]=[]}this._addClassNamesToList(n,e,this._userClasses);if(i){this._addClassNamesToList(n,e,this._builtinClasses)}return n};t.prototype._addClassNamesToList=function(e,t,r){var i=t.toList();for(var n=0;n<r.length;++n){var a=this._userClasses[n],o=a.name,s=a.elementSet;for(var u=0;u<i.size;++u){var l=i.get(u);if(s.hasElement(l)){e[u].push(o)}}}};t.prototype.getClassByName=function(e,t){if(t===void 0){t=false}var r=this._classesByName[e]||null;if(t&&!r){throw new Error('class "'+e+'" does not exist')}return r&&r.wrapper};t.prototype.getClassList=function(){return this._userClasses.map(function(e){return e.wrapper})};t.prototype.getElementsByClass=function(e){var t=this._get(e).elementSet;var r=t.getElements();return{nodes:r.nodes.filter(function(e){return e.isVisible()}),edges:r.edges.filter(function(e){return e.isVisible()})}};t.prototype._onClassEvent=function(e,t,r,i){var n=xc(e,r,i);this._events.on(n,t)};t.prototype.onNodeClassAdded=function(e,t){this._onClassEvent(e,t,true,true)};t.prototype.onNodeClassRemoved=function(e,t){this._onClassEvent(e,t,true,false)};t.prototype.onEdgeClassAdded=function(e,t){this._onClassEvent(e,t,false,true)};t.prototype.onEdgeClassRemoved=function(e,t){this._onClassEvent(e,t,false,false)};return t}(Ct);function xc(e,t,r){return(t?"node":"edge")+"Class"+(r?"Added":"Removed")+"_"+e}function Ac(e,t){for(var r=0;r<e.length;++r){if(e[r].name===t){return r}}return-1}var Ec=[0,1],Sc=[0,2];for(var wc=4;wc<65535;wc<<=2){for(var Tc=0,Cc=Ec.length;Tc<Cc;Tc++){Ec.push(Ec[Tc]|wc);Sc.push((Ec[Tc]|wc)<<1)}}function Ic(e,t){return(Sc[t&255]|Ec[e&255])+(Sc[t>>8&255]|Ec[e>>8&255])*65536+(Sc[t>>16&255]|Ec[e>>16&255])*4294967296}Ic.code=function e(t,r,i){if(t>24){throw"Morton codes are only supported up to Z=24"}var n=1<<24-t;return Ic(r*n,i*n)};Ic.range=function e(t,r,i){if(t>24){throw"Morton ranges are only supported up to Z=24"}var n=1<<24-t;var a=Ic(r*n,i*n);return[a,a+n*n-1]};var Mc,Lc;function kc(e,t){if(t===void 0)t=[];if(e>0xffffffffffff){throw"Only morton codes up to 48 bits are supported."}if(!Mc){Mc={};Lc={};for(var r=0;r<256;r++){Mc[Ic(r,0)]=r;Lc[Ic(0,r)]=r}}var i=Mc[e&21845];var n=Lc[e&43690];if(e>65535){e/=65536;i|=Mc[e&21845]<<8;n|=Lc[e&43690]<<8;if(e>65535){e/=65536;i|=Mc[e&21845]<<16;n|=Lc[e&43690]<<16}}t[0]=i;t[1]=n;return t}Ic.reverse=kc;Ic.decode=function e(t,r){var i=kc(r);var n=1<<24-t;return[i[0]/n,i[1]/n]};Ic.min=function e(t,r){var i=t&1431655765;var n=r&1431655765;var a=t&2863311530;var o=r&2863311530;return Math.min(i,n)+Math.min(a,o)};var Nc=16;var Fc=function e(t,r,i){if(t===void 0)t=Int32Array;if(r===void 0)r=Nc;if(i===void 0)i=8;this._BIG_LIST=new Uint8Array([-1])[0];this._ArrayType=t;this._capacity=r;this._MAX_LIST_SIZE=i;this._freeIndex=-1;this.clear()};var zc={averageSize:{configurable:true}};Fc.prototype.clear=function e(){this._buffer=new this._ArrayType(this._capacity*this._MAX_LIST_SIZE);this._sizes=new Uint8Array(this._capacity);this._bigLists=[];this._nextIndex=0;this._idToIndex={};this._constList=new Array(this._MAX_LIST_SIZE)};Fc.prototype.addEntry=function e(t){var r;if(this._freeIndex===-1){r=this._nextIndex++}else{r=this._freeIndex;this._freeIndex=-1}this._idToIndex[t]=r;if(r>=this._capacity){this._expand(r+1)}this._sizes[r]=0;return r};Fc.prototype.getItems=function e(t){var r=this._idToIndex[t];if(r===undefined){return}var i=this._sizes[r];var n=this._MAX_LIST_SIZE*r;if(i<=this._MAX_LIST_SIZE){this._constList.length=i;for(var a=0,o=i;a<o;++a){this._constList[a]=this._buffer[n+a]}return this._constList}else if(i===this._BIG_LIST){var s=this._buffer[n];return this._bigLists[s]}};Fc.prototype.removeEntry=function e(t){var r=this._idToIndex[t];var i=this._sizes[r];if(i===this._BIG_LIST){var n=this._MAX_LIST_SIZE*r;var a=this._buffer[n];this._bigLists[a].length=0}this._sizes[r]=0;this._freeIndex=r};Fc.prototype.size=function e(t){var r=this._idToIndex[t];var e=this._sizes[r];return e<=this._MAX_LIST_SIZE?e:this._bigLists[this._buffer[r*this._MAX_LIST_SIZE]].length};Fc.prototype.sizes=function e(t){var e=this._sizes;var r=this._bigLists;var i=this._buffer;var n=this._MAX_LIST_SIZE;var a=t.length;var o=new Array(a);for(var s=0;s<a;s++){var u=this._idToIndex[t[s]];var l=e[u];o[s]=l<=n?l:r[i[u*n]].length}return o};Fc.prototype.addTo=function e(t,value){var r=this._idToIndex[t];var i=this._sizes[r];var n=r*this._MAX_LIST_SIZE;if(i<this._MAX_LIST_SIZE){this._buffer[n+i]=value;this._sizes[r]=i+1}else if(i===this._BIG_LIST){var a=this._buffer[n];this._bigLists[a].push(value)}else{var o=new Array(this._MAX_LIST_SIZE);for(var s=0;s<this._MAX_LIST_SIZE;++s){o[s]=this._buffer[n+s]}o.push(value);this._bigLists.push(o);this._sizes[r]=this._BIG_LIST;this._buffer[n]=this._bigLists.length-1}};Fc.prototype.removeFrom=function e(t,value){this.removeFromAndGetSize(t,value)};Fc.prototype.removeFromAndGetSize=function e(t,value){var r=this._idToIndex[t];var i=this._sizes[r],n=this._MAX_LIST_SIZE*r;if(i<=this._MAX_LIST_SIZE){for(var a=n,o=n+i;a<o;++a){if(this._buffer[a]===value){i-=1;this._buffer[a]=this._buffer[o-1];this._sizes[r]=i;return i}}}else if(i===this._BIG_LIST){var s=this._buffer[n],u=this._bigLists[s],l=u.indexOf(value);if(l!==-1){u.splice(l,1);return u.length}}};Fc.prototype.reserve=function e(t){if(this._capacity<t){this._expand(t)}};Fc.prototype._expand=function e(t){this._capacity=Math.pow(2,Math.ceil(Math.log2(t)));this._buffer=Rc(this._buffer,this._capacity*this._MAX_LIST_SIZE);this._sizes=Rc(this._sizes,this._capacity)};Fc.prototype.has=function e(t){var r=this._idToIndex[t];if(r===undefined||r>=this._capacity){return false}return this._sizes[r]!==0};zc.averageSize.get=function(){var e=0;for(var t=0;t<this._capacity;t++){e+=this._sizes[t]}return e/this._capacity};Object.defineProperties(Fc.prototype,zc);function Rc(e,t){var r=new e.constructor(t);r.set(e);return r}var Pc=typeof Map==="undefined"?function(){function e(){this._values={};this._size=0}var t={size:{configurable:true}};t.size.get=function(){return this._size};e.prototype.has=function e(t){return!!this._values[t]};e.prototype.set=function e(t,value){if(!(t in this._values)){this._size++}this._values[t]=value};e.prototype.get=function e(t){return this._values[t]};e.prototype.delete=function e(t){if(t in this._values){delete this._values[t];this._size--}};e.prototype.keys=function e(){return Object.keys(this._values)};e.prototype.clear=function e(){this._values={};this._size=0};Object.defineProperties(e.prototype,t);return e}():Map;var Oc=typeof Set==="undefined"?function(){function e(){this._values={};this._size=0}var t={size:{configurable:true}};t.size.get=function(){return this._size};e.prototype.has=function e(t){return!!this._values[t]};e.prototype.add=function e(t){if(!(t in this._values)){this._size++}this._values[t]=true};e.prototype.delete=function e(t){if(t in this._values){delete this._values[t];this._size--}};e.prototype.keys=function e(){return Object.keys(this._values)};e.prototype.clear=function e(){this._values={};this._size=0};Object.defineProperties(e.prototype,t);return e}():Set;var Dc=1<<16;var Bc=16;var Vc=16;var jc=(1<<Bc)-1;var Uc=Math.log2(Bc);var Gc=(1<<Uc)-1;var qc=function(e,t,r){return r|Ic(e,t)<<4};var Hc=function(e,t){if(t===void 0)t=[];Ic.reverse(e>>4,t);t[2]=e&Gc;return t};var Wc=function e(t,r,i,n,a){if(i===void 0)i=Vc;if(n===void 0)n=Dc;if(a===void 0)a=Int32Array;this._intersects=t;this._getBounds=r;this._occupied=0;this._cells=new Fc(a);this._objectsAtLevel=new Array(Bc).fill(0);this._idToCode=new Pc;this._codeCache=[];this._offset=n;this._min=-n;this._max=n;this._resolution=jc/(this._max-this._min);this._minCellSize=i*this._resolution;this._bounds=new Array(Bc*4);for(var o=0;o<Bc;o++){this._bounds[o*4]=Infinity;this._bounds[o*4+1]=Infinity;this._bounds[o*4+2]=-Infinity;this._bounds[o*4+3]=-Infinity}};var Xc={averageCellOccupancy:{configurable:true},size:{configurable:true}};Wc.prototype.setMinCellSize=function e(t){this._minCellSize=t;return this};Wc.prototype.setOffset=function e(t){this._offset=t;this._min=-t;this._max=t;this._resolution=jc/(this._max-this._min);return this};Wc.prototype.setIntersector=function e(t){this._intersects=t;return this};Wc.prototype.setBoundsGetter=function e(t){this._getBounds=t;return this};Wc.prototype.insert=function e(t,r){if(r===void 0)r=this._getBounds(t);var i=Math.max(r[2]-r[0],r[3]-r[1]);var n=this._minCellSize,a;for(a=0;n<i&&a<Bc;a++){n*=2}var o=this._resolution,s=this._min;var u=o*((r[2]+r[0])*.5-s);var l=o*((r[3]+r[1])*.5-s);var d=u/n|0;var h=l/n|0;var f=qc(d,h,a);if(!this._cells.has(f)){this._cells.addEntry(f)}this._cells.addTo(f,t);this._objectsAtLevel[a]++;this._occupied|=1<<a;var c=a*4;var v=this._bounds;if(d<v[c]){v[c]=d}if(h<v[c+1]){v[c+1]=h}if(d>v[c+2]){v[c+2]=d}if(h>v[c+3]){v[c+3]=h}this._idToCode.set(t,f);return f};Wc.prototype.has=function e(t){return this._idToCode.has(t)};Wc.prototype.update=function e(t,r){this.remove(t);return this.insert(t,r)};Wc.prototype.remove=function e(t){var r=this._idToCode.get(t);Hc(r,this._codeCache);var i=this._codeCache[2];if(--this._objectsAtLevel[i]===0){this._occupied&=~(1<<i);this._bounds[i*4]=Infinity;this._bounds[i*4+1]=Infinity;this._bounds[i*4+2]=-Infinity;this._bounds[i*4+3]=-Infinity}this._cells.removeFrom(r,t);this._idToCode.delete(t);return this};Wc.prototype.query=function e(t){var r=t[0];var i=t[1];var n=t[2];var a=t[3];var o=this._cells;var s=this._bounds;var u=this._intersects;var l=this._min;var d=this._resolution;var h=0;var f=this._minCellSize;var c=this._occupied;var v=[];r=d*(r-l);i=d*(i-l);n=d*(n-l);a=d*(a-l);for(var p=h;p<Bc;f*=2,c>>=1,p++){if(c===0){break}if((c&1)===0){continue}var g=1/f;var _=p*4;var m=Math.max(s[_],r*g-1>>0);var y=Math.max(s[_+1],i*g-1>>0);var b=Math.min(s[_+2],n*g+1>>0);var x=Math.min(s[_+3],a*g+1>>0);for(var A=m;A<=b;A++){for(var E=y;E<=x;E++){var S=qc(A,E,p);var w=o.getItems(S);if(w===undefined){continue}for(var T=0;T<w.length;T++){var C=w[T];if(u(C,t)){v.push(C)}}}}}return v};Wc.prototype.collisions=function e(t,r){if(r===void 0)r=this._getBounds;if(typeof r!=="function"){throw new Error("getBounds function is required to get the object bounds")}var i=Array.from(this._idToCode.keys());var n=this._min;var a=this._resolution;var o=this._cells;var s=new Pc;var u=[];for(var l=0;l<i.length;l++){var d=0;var h=this._minCellSize;var f=this._occupied;var c=i[l];var v=r(c);var p=v[0];var g=v[1];var _=v[2];var m=v[3];var y=Math.max(_-p,m-g);for(d=0;h<y;d++){h*=2;f>>=1}p=a*(p-n);g=a*(g-n);_=a*(_-n);m=a*(m-n);for(var b=d;b<Bc;h*=2,f>>=1,b++){if(f===0){break}if((f&1)===0){continue}var x=1/h;var A=p*x-1>>0;var E=g*x-1>>0;var S=_*x+1>>0;var w=m*x+1>>0;for(var T=A;T<=S;T++){for(var C=E;C<=w;C++){var I=qc(T,C,b);if(s.get(I)===l){continue}s.set(I,l);var M=o.getItems(I);if(M===undefined){continue}for(var L=0;L<M.length;L++){var k=M[L];if(k!==c){if(t(c,k)){u.push(c,k)}}}}}}}return Yc(u)};Wc.prototype.clear=function e(){this._occupied=0;this._cells.clear();this._idToCode.clear();this._objectsAtLevel=new Array(Bc).fill(0);this._bounds=new Array(Bc*4);for(var t=0;t<Bc;t++){this._bounds[t*4]=Infinity;this._bounds[t*4+1]=Infinity;this._bounds[t*4+2]=-Infinity;this._bounds[t*4+3]=-Infinity}return this};Wc.prototype.keyToBBox=function e(t){var r=Hc(t);var i=r[0];var n=r[1];var a=r[2];var o=this._minCellSize*(1<<a);var s=this._min;var u=this._resolution;return[i*o/u+s,n*o/u+s,(i+1)*o/u+s,(n+1)*o/u+s]};Wc.prototype.keys=function e(){return Object.keys(this._cells._idToIndex)};Xc.averageCellOccupancy.get=function(){return this._cells.averageSize};Xc.size.get=function(){return this._idToCode.size};Object.defineProperties(Wc.prototype,Xc);function Yc(e){var t=new Oc;var r=[];for(var i=0;i<e.length;i+=2){var n=e[i],a=e[i+1];var o=n<a?n*a+(a-n-1)*(a-n-1)/4:n*a+(n-a-1)*(n-a-1)/4;if(!t.has(o)){t.add(o);r.push(n,a)}}return r}Wc.code=qc;Wc.decode=Hc;var Zc=function(){return{x:0,y:0,x1:0,y1:0,x2:0,y2:0}};var Kc=["x","y","radius"];var Qc=["width","curvature"];var Jc=function(e){l(t,e);function t(t){var r=e.call(this)||this;r._minCellSize=8;var i=t.dom,n=t.graph,a=t.camera,o=t.graphics,s=t.settings,u=t.events;r._dom=i;r._graph=n;r._camera=a;r._graphics=o;r._settings=s;r._events=u;r._index=new Wc(r._getIntersector(),r._boundsGetter(),r._minCellSize,1e6);r._elementsToUpdate=new Qa(r._graph);r._removedNodes=n.getNodeAttribute("removed");r._removedEdges=n.getEdgeAttribute("removed");r._queryResult={edges:[],nodes:[]};r._queryBounds=[0,0,0,0];u.on({"addNodes addEdges removeNodes removeEdges updateAttributes":function(e){if(e.nodes){if(!e.nodeAttributes||e.nodeAttributes.some(function(e){return Kc.includes(e)})){var t=e.nodes.fastGetAdjacentElements().edges;r._elementsToUpdate.addElements(e.nodes);r._elementsToUpdate.addElements(t)}}if(e.edges){if(!e.edgeAttributes||e.edgeAttributes.some(function(e){return Qc.includes(e)})){r._elementsToUpdate.addElements(e.edges)}}},clear:function(){r._index.clear();r._elementsToUpdate.clear()}});return r}t.prototype._getIntersector=function(){var e=this._graph;var t=e.getNodeAttributes(["x","y","radius"]),r=t[0],i=t[1],n=t[2];var a=e.getEdgeAttributes(["source","target","width","curvature"]),o=a[0],s=a[1],u=a[2],l=a[3];var d=Zc();return function(e,t){if(e<0){e=-e;var a=o.get(e);var h=s.get(e);var f=l.get(e);var c=u.get(e)/2;var v=r.get(a),p=i.get(a);var g=r.get(h),_=i.get(h);if(a===h){tu(v,p,f,n.get(a),0,d);return sl(v,p,d.x1,d.y1,d.x2,d.y2,g,_,t[0]-c,t[1]-c,t[2]+c,t[3]+c)}else if(f===0){return Xu(v,p,g,_,t[0]-c,t[1]-c,t[2]+c,t[3]+c)}else{eu(v,p,g,_,f,d);return al(v,p,d.x,d.y,g,_,t[0]-c,t[1]-c,t[2]+c,t[3]+c)}}else{var m=r.get(e),y=i.get(e),b=n.get(e);return Yd(m,y,b,t[0],t[1],t[2],t[3])}}};t.prototype._boundsGetter=function(){var e=this._graph;var t=e.getNodeAttributes(["x","y","radius"]),r=t[0],i=t[1],n=t[2];var a=e.getEdgeAttributes(["source","target","curvature"]),o=a[0],s=a[1],u=a[2];var l=Zc();var d=$a();return function(e){if(e<0){e=-e;var t=o.get(e);var a=s.get(e);var h=u.get(e);var f=r.get(t),c=i.get(t);var v=r.get(a),p=i.get(a);if(t===a){tu(f,c,h,n.get(t),0,l);cl(f,c,l.x1,l.y1,l.x2,l.y2,v,p,d)}else if(h===0){d.minX=Math.min(f,v);d.minY=Math.min(c,p);d.maxX=Math.max(f,v);d.maxY=Math.max(c,p)}else{eu(f,c,v,p,h,l);fl(f,c,l.x,l.y,v,p,d)}}else{var g=r.get(e);var _=i.get(e);var m=n.get(e);d.minX=g-m;d.minY=_-m;d.maxX=g+m;d.maxY=_+m}return[d.minX,d.minY,d.maxX,d.maxY]}};t.prototype.reindex=function(){this._graphics.forceAttributesComputation();this._index.clear();this._elementsToUpdate.clear();this._updateItems(this._graph.getNodes("all")._indexes,this._graph.getEdges("all")._indexes)};t.prototype._updateIndex=function(){if(!this._elementsToUpdate.isEmpty()){var e=this._elementsToUpdate.getElements(),t=e.nodes,r=e.edges;this._updateItems(t._indexes,r._indexes);this._elementsToUpdate.clear()}};t.prototype._updateItems=function(e,t){var r=this._index;var i=this._removedNodes;var n=this._removedEdges;var a=[];var o=[];for(var s=0;s<e.length;s++){var u=e[s];if(i.get(u)!==0){a.push(u)}else if(r.has(u)){a.push(u);o.push(u)}else{o.push(u)}}for(var s=0;s<t.length;s++){var u=-t[s];if(n.get(-u)!==0){a.push(u)}else if(r.has(u)){a.push(u);o.push(u)}else{o.push(u)}}for(var l=0,d=a;l<d.length;l++){var u=d[l];r.remove(u)}for(var h=0,f=o;h<f.length;h++){var u=f[h];r.insert(u)}};t.prototype.getNodesInScreenByDistance=function(e){var t=e.getPositionOnScreen(),r=t.x,i=t.y;return this._graph.getNodes().filter(function(t){return t.isInScreen()&&t!==e}).sort(function(e,t){var n=e.getPositionOnScreen(),a=t.getPositionOnScreen();return distance(n.x,n.y,r,i)-distance(a.x,a.y,r,i)})};t.prototype.getNearestNodesForNode=function(e,t,r){if(t===void 0){t=240}var i=e.getPosition(),n=i.x,a=i.y;return this.getNearestNodes(n,a,t,r,e)};t.prototype.getNearestNodes=function(e,t,r,i,n){this._updateIndex();if(i){var a=this._camera.screenToGraphVector({x:r,y:r});r=distance(0,0,a.x,a.y)}return this._getNearestNodes(e,t,r,n)};t.prototype._getNearestNodes=function(e,t,r,i){var n=[];var a=r*r;var o=i?i._index:0;var s=this._graph.getNodes()._indexes;var u=this._graph.getNodeAttributes(["x","y"]),l=u[0],d=u[1];for(var h=0,f=s.length;h<f;h++){var c=s[h];if(c===o){continue}var v=e-l.get(c);var p=t-d.get(c);if(v*v+p*p<=a){n.push(c)}}return this._graph.nodeList(new Uint32Array(n))};t.prototype.queryRaw=function(e,t,r,i){this._updateIndex();var n=this._queryBounds;n[0]=e;n[1]=t;n[2]=r;n[3]=i;var a=this._index.query(n);var o=this._queryResult,s=o.nodes,u=o.edges;s.length=u.length=0;for(var l=0;l<a.length;l++){var d=a[l];if(d<0){u.push(-d)}else{s.push(d)}}return this._queryResult};t.prototype.queryRawProjected=function(e,t,r,i){var n=this._queryBounds;n[0]=e;n[1]=t;n[2]=r;n[3]=i;this._camera.projectBounds(n);return this.queryRaw(n[0],n[1],n[2],n[3])};t.prototype.query=function(e,t,r,i){var n=this._graph;var a=this.queryRaw(e,t,r,i),o=a.nodes,s=a.edges;return{nodes:n.nodeList(new Uint32Array(o.slice())),edges:n.edgeList(new Uint32Array(s.slice()))}};t.prototype.queryProjected=function(e,t,r,i){var n=this._graph;var a=this.queryRawProjected(e,t,r,i),o=a.nodes,s=a.edges;return{nodes:n.nodeList(new Uint32Array(o.slice())),edges:n.edgeList(new Uint32Array(s.slice()))}};t.prototype.getNodesByBoundingBox=function(e,t,r,i,n){this._updateIndex();if(n){var a=void 0;a=this._camera.screenToGraphVector({x:e,y:t});e=a.x;t=a.y;a=this._camera.screenToGraphVector({x:r,y:i});r=a.x;i=a.y}var o=this._graph;var s=o.getNodes()._indexes;var u=[];var l=o.getNodeAttribute("excluded");var d=o.getNodeAttributes(["x","y"]),h=d[0],f=d[1];for(var c=0,v=s.length;c<v;c++){var p=s[c];if(l.get(p)){continue}var g=h.get(p),_=f.get(p);if(g>=e&&g<=r&&_>=t&&_<=i){u.push(p)}}return o.nodeList(new Uint32Array(u))};t.prototype.toggleDebug=function(e){if(e){this._canvas=Se();this._graphics.addCanvas(this._canvas);this._ctx=this._canvas.getContext("2d")}else if(this._canvas){this._graphics.removeCanvas(this._canvas);this._canvas=this._ctx=null}};t.prototype.renderDebug=function(e){if(!this._ctx){this.toggleDebug(true)}$c(this,e)};return t}(Ct);function $c(e,t){var r=t===void 0?{}:t,i=r.cells,n=i===void 0?true:i,a=r.boxes,o=a===void 0?true:a,s=r.query,u=s===void 0?true:s;var l=we();var d=e._ctx;var h=e._canvas;var f=e._camera;var c=e._index;var v=-f.getAngle();var p=f.getZoom()*l;var g=f._x;var _=f._y;var m=f._dimensions.width*l/2;var y=f._dimensions.height*l/2;var b=function(e,t){return{x:(e-g)*p,y:(t-_)*p}};var x=c.keys().map(function(e){return c.keyToBBox(e)});var A=Array.from(c._idToCode.keys()).map(function(e){return c._getBounds(e)});d.clearRect(0,0,h.width,h.height);d.save();d.translate(m,y);d.rotate(v);if(n){d.beginPath();d.lineWidth=1;d.strokeStyle="#707070";x.forEach(function(e){var t=b(e[0],e[1]);var r=b(e[2],e[3]);d.rect(t.x,t.y,r.x-t.x,r.y-t.y)});d.stroke()}if(o){d.beginPath();d.lineWidth=1;d.strokeStyle="#ff7070";A.forEach(function(e){var t=b(e[0],e[1]);var r=b(e[2],e[3]);d.rect(t.x,t.y,r.x-t.x,r.y-t.y)});d.closePath();d.stroke()}if(u&&e._queryBounds){var E=e._queryBounds;d.beginPath();d.lineWidth=2;d.strokeStyle="#3030ff";var S=b(E[0],E[1]);var w=b(E[2],E[3]);d.rect(S.x,S.y,w.x-S.x,w.y-S.y);d.closePath();d.stroke()}d.restore()}var ev=40;var tv="quadraticInOut";var rv=200;var iv=function(e){l(t,e);function t(t){var r=e.call(this)||this;r._cacheValid=true;r._cachedGraphBoundingBox=new eo;r._dom=t.dom;r._events=t.events;r._camera=t.camera;r._graph=t.graph;r._graphics=t.graphics;r._settings=t.settings;r._sync=t.sync;r._transformations=t.transformations;r._events.on({"addNodes removeNodes addEdges removeEdges excludedStateChange clear updateAttributes":function(){return r._invalidCache()}});return r}t.prototype.onMounted=function(){this.locateGraph({},true)};t.prototype.locateGraph=function(e,force){var t=this;if(force===void 0){force=false}if(force){return this._locateGraph(e)}else{return this._transformations.whenApplied().then(function(){return t._locateGraph(e)})}};t.prototype._locateGraph=function(e){return this._locateBoundingBox(this.getGraphBoundingBox(),e)};t.prototype.locateElements=function(e,t){var r=this;return this._transformations.whenApplied().then(function(){return r._locateBoundingBox(r.getBoundingBox(e),t)})};t.prototype.locateRawGraph=function(e,t){return this._locateBoundingBox(this.getRawGraphBoundingBox(e),t)};t.prototype.getGraphBoundingBox=function(){if(!this._cacheValid){this._updateCache()}return Object.assign({},this._cachedGraphBoundingBox)};t.prototype.forceInvalidCache=function(){this._invalidCache()};t.prototype._invalidCache=function(){this._cacheValid=false};t.prototype._updateCache=function(){this._cacheValid=true;this._cachedGraphBoundingBox=this.getBoundingBox(this._graph.getNodes())};t.prototype.getBoundingBox=function(e,t){if(e.isNode){return this._getNodesBoundingBox(e.toList())}return this._getEdgesBoundingBox(e.toList(),t)};t.prototype._getNodesBoundingBox=function(e){this._graphics.forceAttributesComputation();var t=this._graphics.getNodeAttributes();var r=[];var i=[];var n=[];var a=[];for(var o=0;o<e.size;++o){var s=e._indexes[o];if(t.excluded.get(s)===0){var u=t.x.get(s);var l=t.y.get(s);var d=t.radius.get(s)*2;if(t.scalingMethod.get(s)==="scaled"){n.push(d)}else{a.push(d)}r.push(u);i.push(l)}}return new eo({xValues:r,yValues:i,scaledSizeValues:n,fixedSizeValues:a})};t.prototype._getEdgesBoundingBox=function(e,t){if(t===void 0){t=false}this._graphics.forceAttributesComputation();var r=this._graphics.getEdgeAttributes();var i=this._graphics.getNodeAttributes();var n={x1:0,y1:0,x2:0,y2:0};var a={x:0,y:0};var o={minX:0,minY:0,maxX:0,maxY:0};var s=[];var u=[];var l=[];var d=[];for(var h=0;h<e.size;++h){var f=e._indexes[h];var c=r.source.get(f);var v=r.target.get(f);var p=r.curvature.get(f);var g=i.x.get(c);var _=i.y.get(c);var m=i.scalingMethod.get(c)==="scaled";var y=i.radius.get(c)*2;var b=i.x.get(v);var x=i.y.get(v);var A=i.scalingMethod.get(v)==="scaled";var E=i.radius.get(v)*2;if(m){l.push(y)}else{d.push(y)}if(A){l.push(E)}else{d.push(E)}if(t||p===0){s.push(g,b);u.push(_,x)}else if(c===v){var S=y/2;tu(g,_,p,S,0,n);cl(g,_,n.x1,n.y1,n.x2,n.y2,b,x,o);s.push(o.minX,o.maxX);u.push(o.minY,o.maxY)}else{eu(g,_,b,x,p,a);fl(g,_,a.x,a.y,b,x,o);s.push(o.minX,o.maxX);u.push(o.minY,o.maxY)}}return new eo({xValues:s,yValues:u,scaledSizeValues:l,fixedSizeValues:d})};t.prototype.getRawGraphBoundingBox=function(e){var t=e.nodes.length;var r=new Array(t);var i=new Array(t);var n=new Array(t);for(var a=0;a<t;a++){var o=e.nodes[a];var s=o.attributes||{};r[a]=s.x||0;i[a]=s.y||0;n[a]=s.radius||5}return new eo({xValues:r,yValues:i,scaledSizeValues:n})};t.prototype._computeCameraConfig=function(e,t,r){if(typeof t==="number"){t={left:t,right:t,top:t,bottom:t}}var i=pr(t.left,ev);var n=pr(t.right,ev);var a=pr(t.top,ev);var o=pr(t.bottom,ev);var s=this._dom.getDimensions();var u=i+n;var l=a+o;var d=e.width===0?e.maxFixedSize:e.width;var h=e.height===0?e.maxFixedSize:e.height;var f=(s.width-u)/(d+e.maxScaledSize);var c=(s.height-l)/(h+e.maxScaledSize);var v=(s.width-u-e.maxFixedSize)/d;var p=(s.height-l-e.maxFixedSize)/h;var g=r/e.maxScaledSize||NaN;var _=fc([f,c,v,p,g]);return{x:e.cx+(n-i)/(_*2),y:e.cy+(o-a)/(_*2),zoom:_}};t.prototype._locateBoundingBox=function(e,t){if(t===void 0){t={}}if(isNaN(e.cx)){return Promise.resolve()}var r=t.padding,i=r===void 0?{}:r,n=t.easing,a=n===void 0?tv:n,o=t.duration,s=o===void 0?0:o,u=t.maxNodeSizeOnScreen,l=u===void 0?rv:u,d=t.ignoreZoomLimits,h=d===void 0?false:d;var f=this._computeCameraConfig(e,i,l);var c=f.x;var v=f.y;var p=f.zoom;var g=p/this._camera.getZoom();return this._moveCamera(c,v,p,s,a,g,h)};t.prototype._moveCamera=function(e,t,r,i,n,a,o){if(a>1.01){this._camera.setCenter({x:e,y:t},{duration:i,easing:n,ignoreZoomLimits:o});return this._camera.setZoom(r,{duration:i,easing:n,ignoreZoomLimits:o,startAfter:.5})}else if(a<.99){this._camera.setCenter({x:e,y:t},{duration:i,easing:n,ignoreZoomLimits:o,startAfter:.5});return this._camera.setZoom(r,{duration:i,easing:n,ignoreZoomLimits:o})}else{return this._camera.setCenter({x:e,y:t},{duration:i,easing:n,ignoreZoomLimits:o})}};t.prototype.computeConfigForBounds=function(e,t){if(t===void 0){t={}}var r=t.padding,i=r===void 0?{}:r,n=t.maxNodeSizeOnScreen,a=n===void 0?rv:n;return this._computeCameraConfig(e,i,a)};t.prototype.layoutDataBoundingBox=function(e){var t=e.x,r=e.y,i=e.indexes;var n=this._graphics.getNodeAttributes();var a=[];var o=[];var s=[];var u=[];for(var l=0;l<i.length;++l){var d=i[l];var h=t[l];var f=r[l];var c=n.radius.get(d)*2;var v=n.scalingMethod.get(d)==="scaled";a.push(h);o.push(f);if(v){s.push(c)}else{u.push(c)}}return new eo({xValues:a,yValues:o,scaledSizeValues:s,fixedSizeValues:u})};t.prototype.isEdgeInPolygon=function(e,t){var r=e.getSource();var i=e.getTarget();var n=r.getPositionOnScreen();var a=i.getPositionOnScreen();if(Tf(n.x,n.y,t)||Tf(a.x,a.y,t)){return true}var o=nv(e,this._camera.getZoom());for(var s=0;s<o.length-1;++s){var u=o[s];var l=o[s+1];for(var d=0;d<t.length-1;++d){var h=t[d];var f=t[d+1];if(Wu(u.x,u.y,l.x,l.y,h.x,h.y,f.x,f.y)){return true}}}return false};t.prototype.isElementInView=function(e,t){var r=(t===void 0?{}:t).margin,i=r===void 0?0:r;var n=this._camera.getSize(),a=n.width,o=n.height;var s={minX:-i,minY:-i,maxX:a+i,maxY:o+i};return e.isNode?this.isNodeInRectangle(e,s):this.isEdgeInRectangle(e,s)};t.prototype.isNodeInRectangle=function(e,t){var r=e.getPositionOnScreen();var i=e.getAttribute("radius")*this._camera.getZoom();var n=r.x-i;var a=r.y-i;var o=r.x+i;var s=r.y+i;return o>=t.minX&&n<=t.maxX&&s>=t.minY&&a<=t.maxY};t.prototype.isNodeInPolygon=function(e,t){var r=e.getPositionOnScreen();return Tf(r.x,r.y,t)};t.prototype.isEdgeInRectangle=function(e,t){var r=nv(e,this._camera.getZoom());for(var i=0;i<r.length-1;++i){var n=r[i];var a=r[i+1];if(Xu(n.x,n.y,a.x,a.y,t.minX,t.minY,t.maxX,t.maxY)){return true}}return false};return t}(Ct);function nv(e,t){var r=e.getAttribute("curvature");var i=e.getSource();var n=e.getTarget();var a=i.getPositionOnScreen();if(i===n){var o=(r+i.getAttribute("radius"))*Pn*t;var s=a.x;var u=a.y;var l=s-o;var d=u;var h=s;var f=u+o;return[a].concat([.2,.4,.6,.8].map(function(e){return dl(e,s,u,s,u,l,d,h,f)}),[a])}var c=n.getPositionOnScreen();if(r===0){return[a,c]}var v=c.x-a.x;var p=c.y-a.y;var distance=Math.sqrt(v*v+p*p);var g=(a.x+c.x)/2;var _=(a.y+c.y)/2;var m=p/distance;var y=-v/distance;var b=r*(distance/Rn)*2;var x=g+m*b;var A=_+y*b;return[a].concat([.25,.5,.75].map(function(e){return ul(e,a.x,a.y,c.x,c.y,x,A)}),[c])}var av={doubleTapTimer:500,touchEventRate:15};var ov=function(e){function t(t){var r=this;e.call(this);this._dom=t.dom;this._events=t.events;this._settings=t.settings;this._graphics=t.graphics;this._x=0;this._y=0;this._pressed=false;this._domElt=this._graphics.getDomElement();this._settings.register("touch.enabled",true);this._events.register(["touchDown","touchUp","touchTap","touchDoubleTap","touchMove","touchStartGesture","touchProgressGesture","touchEndGesture","documentTouchMove","documentTouchUp"]);this._addEvent=function(e,t,i,n){r._dom.addElementEventListener(e,t,i,n)};this._addDocEvent=function(e,t,i,n){r._dom.addDocumentEventListener(t,i,n)};this._removeDocEvent=function(e,t,i){r._dom.removeDocumentEventListener(t,i)};this._dom.afterNextFrame().then(function(){r._initialize(r)})}if(e)t.__proto__=e;t.prototype=Object.create(e&&e.prototype);t.prototype.constructor=t;var r={x:{configurable:true},y:{configurable:true},pressed:{configurable:true}};r.x.get=function(){return this._x};r.y.get=function(){return this._y};r.pressed.get=function(){return this._pressed};t.prototype._isEnabled=function e(){return this._settings.get("touch.enabled")};t.prototype._listen=function e(t,r,i){if(st){if(r==="touchstart"){return At(this._addEvent,t,i)}if(r==="touchmove"){return St(this._addDocEvent,t,i)}if(r==="touchend"){return wt(this._addDocEvent,t,i)}if(r==="touchcancel"){return Et(this._addDocEvent,t,i)}}return this._dom.addElementEventListener(t,r,i)};t.prototype._initialize=function e(){var t=this;var r=0,i=0;var n=0,a=0;var o=false;var s="left";var u=0;var l=false;var d=false;var h=1;var f=0;var c=null;var v=null;var p=function(){t._x=r;t._y=i;t._pressed=o};var g=function(e,t,n,a){h=e;f=t;r=n;i=a;p()};var _=function(e){var n=He(t._domElt);if(!n){return null}var a=e.touches[0].clientX-n.left;var o=e.touches[0].clientY-n.top;var s=e.touches[1].clientX-n.left;var u=e.touches[1].clientY-n.top;var l=(a+s)/2;var d=(o+u)/2;var c=l-r;var v=d-i;var p=distance(a,o,s,u);var _=p/h;var m=ju(a,o,s,u);var y=m-f;var b={dx:c,dy:v,rotation:y,scale:_};g(p,m,l,d);return b};var m=function(e){if(e.touches.length===2&&d){var n=_(e);if(n){var a=n.dx;var o=n.dy;var u=n.rotation;var l=n.scale;t._events.fire("touchProgressGesture",{dx:a,dy:o,rotation:u,scale:l,x:r,y:i,domEvent:c,button:s})}}};var y=function(e){s=Ke[e.button];if(e.touches.length!==1){o=false;if(e.touches.length>1){t._events.fire("touchUp",{x:r,y:i,domEvent:c,button:s})}return false}else{var u=He(t._domElt);if(u){n=r;a=i;r=e.touches[0].clientX-u.left|0;i=e.touches[0].clientY-u.top|0;o=true;c=e;p()}return true}};var b=function(){u=0;t._dom.clearTimeout(v)};var x=function(e){e.preventDefault();if(e.touches.length!==2&&d){d=false;t._events.fire("touchEndGesture",{domEvent:c})}y(e);if(e.touches.length===0){var n={x:r,y:i,domEvent:c,button:s};if(u===1){t._events.fire("touchTap",n)}if(u>1){t._events.fire("touchDoubleTap",n);b()}t._events.fire("touchUp",n)}var a=he().documentElement;Tt(t._removeDocEvent,a,"touchmove",t._onMove);Tt(t._removeDocEvent,a,"touchend",t._onEnd)};var A=function(e){m(e);if(l){l=false;return}b();if(y(e)){t._events.fire("touchMove",{x:r,y:i,dx:r-n,dy:i-a,domEvent:c,button:s})}};this._listen(this._domElt,"touchstart",function(e){if(e.touches.length===2&&!d){if(_(e)){d=true;t._events.fire("touchStartGesture",{domEvent:c})}}if(y(e)){t._dom.focus();t._events.fire("touchDown",{x:r,y:i,domEvent:c,button:s});u+=1;v=t._dom.setTimeout(b,av.doubleTapTimer);l=true}var n=he().documentElement;t._onMove=t._listen(n,"touchmove",A);t._onEnd=t._listen(n,"touchend",x)})};Object.defineProperties(t.prototype,r);return t}(Ct);var sv=function(e){l(t,e);function t(t){var r=t.graph;var i=e.call(this)||this;i._graph=r;i._subNodesList=i._graph.createNodeAttribute({storage:"any",default:null});i._subEdgesList=i._graph.createEdgeAttribute({storage:"any",default:null});i._metaNodeList=i._graph.createNodeAttribute({storage:"any",default:null});i._metaEdgeList=i._graph.createEdgeAttribute({storage:"any",default:null});return i}t.prototype._fetchSubEltsList=function(e){return e?this._subNodesList:this._subEdgesList};t.prototype._fetchMetaEltList=function(e){return e?this._metaNodeList:this._metaEdgeList};t.prototype.setSubElements=function(e,t){var r=this._fetchSubEltsList(e.isNode);r.setMultiple(e._indexes,t)};t.prototype.setMetaElement=function(e,t){var r=this._fetchMetaEltList(e.isNode);r.setMultiple(e._indexes,t)};t.prototype.getSubElements=function(e){return this._fetchSubEltsList(e.isNode).getMultiple(e._indexes)};t.prototype.getMetaElement=function(e){return this._fetchMetaEltList(e.isNode).getMultiple(e._indexes)};return t}(Ct);var uv=function(){function e(e,t){var r=this;this._module=e;this._id=t;this._whenApplied=e.whenApplied().then(function(){return r})}e.prototype.getName=function(){return this._module.getName(this._id)};e.prototype.getId=function(){return this._id};e.prototype.whenApplied=function(){return this._whenApplied};e.prototype.isEnabled=function(){return this._module.isEnabled(this._id)};e.prototype.enable=function(e){return this._module.enable(this._id,e)};e.prototype.disable=function(e){return this._module.disable(this._id,e)};e.prototype.toggle=function(e){return this._module.toggle(this._id,e)};e.prototype.getIndex=function(){return this._module.getIndex(this._id)};e.prototype.setIndex=function(e){return this._module.setIndex(this._id,e)};e.prototype.destroy=function(e){return this._module.remove(this._id,e)};e.prototype.refresh=function(){return this._module.refresh(this._id)};e.prototype.delete=function(e){return this.destroy(e)};return e}();var lv=function(){function e(e){}e.prototype.cleanup=function(e){return Promise.resolve()};return e}();var dv=function(e){l(t,e);function t(t,r){var i=e.call(this)||this;i._list=[];i._currentPipeline=[];i._idCounter=0;i._mustRefresh=false;i._safeGuard=false;i._resolvers=[];i._afterCurrentUpdate=Promise.resolve();i._destroyed=false;i._settings=t.settings;i._dom=t.dom;i._events=t.events;i._graph=t.graph;i._captor=t.captor;i._classes=t.classes;i._selection=t.selection;i._ogma=r;i._classes.createClass({name:Nl,isBuiltin:true,nodeAttributes:{opacity:0,radius:0},edgeAttributes:{opacity:0,width:0}});i._classes.createClass({name:Fl,isBuiltin:true,nodeAttributes:{opacity:0},edgeAttributes:{opacity:0}});i._nodeTransformationIdList=i._graph.createNodeAttribute({storage:16,default:0});i._edgeTransformationIdList=i._graph.createEdgeAttribute({storage:16,default:0});i._settings.register("transformations.updateOnDataChange",true);i._events.on({"addNodes addEdges removeNodes removeEdges":function(e){var t=e.virtual;if(!t){i._invalidState()}},"updateNodeData updateEdgeData":function(){if(i._settings.get("transformations.updateOnDataChange")&&!i._safeGuard){i._invalidState()}},afterNewFrame:function(){i._computeTransformations()}});return i}t.prototype._invalidState=function(){var e=this;this._afterCurrentUpdate.then(function(){if(e._list.length||e._currentPipeline.length){e._mustRefresh=true;e._dom.refresh()}})};t.prototype._onUpdate=function(){var e=this;return this._afterCurrentUpdate.then(function(){e._dom.refresh();var t=(e._currentPipeline.find(function(e){var t=e.error;return t})||{error:null}).error;if(t){return Promise.reject(t)}return new Promise(function(t){return e._resolvers.push(t)})})};t.prototype._resetEltTransformationIds=function(){this._nodeTransformationIdList.reset();this._edgeTransformationIdList.reset()};t.prototype._assignTransformationIds=function(e){this._assignTransformationIdsToElements(true,e);this._assignTransformationIdsToElements(false,e)};t.prototype._assignTransformationIdsToElements=function(e,t){var r=e?this._graph.getNodes("all"):this._graph.getEdges("all");var i=this._graph.getAttribute(e,"virtual");var n=this._graph.getAttribute(e,"excluded");var a=e?this._nodeTransformationIdList:this._edgeTransformationIdList;for(var o=0;o<r._indexes.length;o++){var s=r._indexes[o];var u=a.get(s);if(!u){var l=n.get(s);var d=i.get(s);if(!l&&d){a.set(s,t)}}}};t.prototype._resolveTransformations=function(e,t,r){var i=this;if(!r){e.forEach(function(e){return e.duration=0});t.forEach(function(e){return e.duration=0})}this._resetEltTransformationIds();var n=this._selection.getSelectedNodes().getId();var a=this._selection.getSelectedEdges().getId();var o=Promise.resolve();var s=function(r){var i=e[r];if(i.context!==null){o=o.then(function(){return i.methods.undo(i)})}if(!t.some(function(e){return e.id===i.id})){o=o.then(function(){return i.methods.cleanup(i)}).then(function(){i.context=null})}};for(var u=e.length-1;u>=0;--u){s(u)}var l=function(e){var r=t[e];var n=null;o=o.then(function(){return r.methods.run(r)}).catch(function(e){r.error=e;return true}).then(function(e){n=e;if(r.context){return r.methods.cleanup(r)}}).then(function(){i._assignTransformationIds(r.id);r.context=n})};for(var u=0;u<t.length;++u){l(u)}o=o.then(function(){if(!i._destroyed){i._graph.getNodes(n).setSelected(true);i._graph.getEdges(a).setSelected(true)}});return o};t.prototype._computeTransformations=function(){var e=this;if(this._safeGuard){return}this._safeGuard=true;this._afterCurrentUpdate=Promise.resolve();if(this._mustRefresh){this._captor.setDetectionEnabled(false);var t=this._currentPipeline.filter(function(e){var t=e.enabled;return t});var r=this._list.filter(function(e){var t=e.enabled;return t});var i;var n;var a=false;if(t.length===r.length+1&&hv(t,r,r.length)){i=[t.pop()];n=[];a=true}else if(r.length===t.length+1&&hv(t,r,t.length)){i=[];n=[r.pop()];a=true}else{i=t;n=r;a=false}this._afterCurrentUpdate=this._afterCurrentUpdate.then(function(){return e._resolveTransformations(i,n,a)}).then(function(){e._captor.setDetectionEnabled(true);e._currentPipeline=e._list.map(function(e){return d({},e)});e._mustRefresh=false;return e._dom.afterNextFrame()})}this._afterCurrentUpdate=this._afterCurrentUpdate.then(function(){e._safeGuard=false;e._resolvers.forEach(function(e){return e()});e._resolvers=[]})};t.prototype.getList=function(){return this._list.map(function(e){var t=e.wrapper;return t})};t.prototype.clear=function(){this._list=[];this._invalidState();return this._onUpdate()};t.prototype._get=function(e,t){if(t===void 0){t=true}for(var r=0;r<this._list.length;++r){var i=this._list[r];if(i.id===e){i.index=r;return i}}if(t){throw new Error("calling a method on a destroyed transformation")}return null};t.prototype.getName=function(e){return this._get(e).methods.getName()};t.prototype.enable=function(e,t){var r=this;return this._afterCurrentUpdate.then(function(){var i=r._get(e);if(!i.enabled){i.enabled=true;i.duration=t;r._invalidState()}return r._onUpdate()})};t.prototype._setRemovalDuration=function(e,t){for(var r=0;r<this._currentPipeline.length;++r){var i=this._currentPipeline[r];if(i.id===e){i.duration=t}}};t.prototype.disable=function(e,t){var r=this;return this._afterCurrentUpdate.then(function(){var i=r._get(e);if(i.enabled){i.enabled=false;r._setRemovalDuration(e,t);r._invalidState()}return r._onUpdate()})};t.prototype.remove=function(e,t){var r=this;return this._afterCurrentUpdate.then(function(){var i=r._get(e);r._list.splice(i.index,1);r._setRemovalDuration(e,t);r._invalidState();return r._onUpdate()})};t.prototype.toggle=function(e,t){var r=this;return this._afterCurrentUpdate.then(function(){var i=r._get(e);if(i.enabled){return r.disable(e,t)}return r.enable(e,t)})};t.prototype.setIndex=function(e,t){var r=this;return this._afterCurrentUpdate.then(function(){var i=r._get(e);r._list.splice(i.index,1);r._list.splice(Jt(t,0,r._list.length),0,i);r._invalidState();return r._onUpdate()})};t.prototype.getIndex=function(e){return this._get(e).index};t.prototype.add=function(e,t){var r=t===void 0?{}:t,i=r.duration,n=i===void 0?0:i,a=r.enabled,o=a===void 0?true:a;if(!e.cleanup){e.cleanup=function(){return Promise.resolve()}}var s={ogma:this._ogma,id:++this._idCounter,methods:e,duration:n,enabled:o,context:null,wrapper:new uv(this,this._idCounter),index:-1,error:null};this._list.push(s);this._invalidState();return s.wrapper};t.prototype.whenApplied=function(){return this._onUpdate()};t.prototype.refresh=function(){this._invalidState();return this._onUpdate()};t.prototype.isEnabled=function(e){return this._get(e).enabled};t.prototype._getElementTransformationId=function(e){var t=e.isNode?this._nodeTransformationIdList:this._edgeTransformationIdList;return t.get(e._index)};t.prototype.isElementVirtual=function(e){return!!this._getElementTransformationId(e)};t.prototype.getElementTransformation=function(e){var t=this._get(this._getElementTransformationId(e),false);return t&&t.wrapper};t.prototype.destroy=function(){this._destroyed=true};return t}(Ct);function hv(e,t,r){for(var i=0;i<r;++i){if(e[i].id!==t[i].id){return false}}return true}var fv={layer:Rl,outline:true,outerStroke:{color:"red",width:5},innerStroke:{minVisibleSize:0},text:{backgroundColor:"rgb(220, 220, 220)",minVisibleSize:0}};var cv={layer:Rl,color:"red",outline:true,text:{backgroundColor:"rgb(220, 220, 220)",minVisibleSize:0},stroke:{width:2}};var vv=function(e){l(t,e);function t(t){var r=e.call(this)||this;r._events=t.events;r._settings=t.settings;r._graph=t.graph;r._keyboard=t.keyboard;r._graphics=t.graphics;r._interactions=t.interactions;r._selectionExtremityHighlightedClass=t.classes.createClass({name:Il,isBuiltin:true,nodeAttributes:fv});r._selectedClass=t.classes.createClass({name:Cl,isBuiltin:true,nodeAttributes:fv,edgeAttributes:cv});r._settings.register("interactions.selection.enabled",true);r._settings.register("interactions.selection.multiSelectionKey","ctrl");r._interactions.onClick({priority:"selection",check:function(e){var t=e.button;var i=r._settings.get("interactions.selection.enabled");return t==="left"&&i&&!r._graphics.isAnimating()},handler:function(e){var t=e.target;if(!t){r._selectedClass.clearNodes();r._selectedClass.clearEdges()}else{var i=r._settings.get("interactions.selection.multiSelectionKey");var n=i&&r._keyboard.isPressed(i);if(t.isNode){r._selectedClass.clearEdges()}else{r._selectedClass.clearNodes()}if(!n){var a=t.isNode?r._selectedClass.getNodes():r._selectedClass.getEdges();a.filter(function(e){return e!==t}).removeClass(Cl);if(!t.hasClass(Cl)){t.addClass(Cl)}}else if(t.hasClass(Cl)){t.removeClass(Cl)}else{t.addClass(Cl)}}}});r._events.on("beforeRemoveEdges",function(e){var t=e.edges;return t.setSelected(false)});return r}t.prototype.onMounted=function(e){var t=this;var r=function(){t._selectionExtremityHighlightedClass.clearNodes();t._selectedClass.getEdges().getExtremities().addClass(Il)};e.events.onEdgesClassAdded(Cl,r);e.events.onEdgesClassRemoved(Cl,r)};t.prototype.setNodeAttributes=function(e,t){this._selectedClass.update({nodeAttributes:e,fullOverwrite:t});this._selectionExtremityHighlightedClass.update({nodeAttributes:e,fullOverwrite:t});this._updateExtremityHighlightLayer()};t.prototype.setEdgeAttributes=function(e,t){this._selectedClass.update({edgeAttributes:e,fullOverwrite:t});this._updateExtremityHighlightLayer()};t.prototype._updateExtremityHighlightLayer=function(){var e=this._selectedClass.getDefinition().edgeAttributes;var t=e?e.layer:undefined;this._selectionExtremityHighlightedClass.update({nodeAttributes:{layer:t},fullOverwrite:false})};t.prototype.setActive=function(e,t){if(x(t)){var r=[];var i=[];e.toList().forEach(function(e,n){var a=t[n]?r:i;a.push(e.getId())});if(r.length!==0){this._graph.getElements(e.isNode,r).addClass(Cl)}if(i.length!==0){this._graph.getElements(e.isNode,i).removeClass(Cl)}}else{e[t?"addClass":"removeClass"](Cl)}};t.prototype.areActive=function(e){return e.hasClass(Cl)};t.prototype.getSelectedNodes=function(){return this._selectedClass.getNodes()};t.prototype.getSelectedEdges=function(){return this._selectedClass.getEdges()};t.prototype.getNonSelectedNodes=function(){return this._graph.getNodes().filter(function(e){return!e.hasClass(Cl)})};t.prototype.getNonSelectedEdges=function(){return this._graph.getEdges().filter(function(e){return!e.hasClass(Cl)})};t.prototype.clear=function(){this._selectedClass.clearNodes();this._selectedClass.clearEdges()};return t}(Ct);var pv=function(e){l(t,e);function t(t){var r=e.call(this)||this;r._dom=t.dom;r._events=t.events;r._captor=t.captor;r._delayedCalls=[];r._idIdle=function(){return!r._captor.isAnyButtonPressed()&&!r._dom.isPlayingFrame()};r._events.on({"down up beforeNewFrame newFrame":function(){r._delayedCalls.forEach(function(e){return e.reset()})}});return r}t.prototype._nextTimeIdle=function(e){var t=this;var r=new gv(this._dom,this._idIdle,e);this._delayedCalls.push(r);return r.whenDone().then(function(){t._delayedCalls.splice(t._delayedCalls.indexOf(r),1)})};t.prototype.debounceIdle=function(e,t){var r=this;if(t===void 0){t=0}var i=false;var n=[];var a=function(){var t=n;i=false;n=[];e();t.forEach(function(e){return e()})};return function(){return new Promise(function(e){n.push(e);if(!i){i=true;r._nextTimeIdle(t).then(a)}})}};return t}(Ct);var gv=function(){function e(e,t,r){var i=this;this._timeout=null;this._done=false;this._dom=e;this._promise=new Promise(function(e){return i._resolve=e});this._isIdle=t;this._delay=r;this._startTimeout()}e.prototype._startTimeout=function(){var e=this;this._timeout=this._dom.setTimeout(function(){if(e._isIdle()){e._done=true;e._resolve()}else{e._startTimeout()}},this._delay)};e.prototype.reset=function(){if(!this._done){this._dom.clearTimeout(this._timeout);this._startTimeout()}};e.prototype.whenDone=function(){return this._promise};return e}();var _v={number:1,duration:1e3,interval:800,startColor:"rgba(0,0,0,0.6)",endColor:"rgba(0,0,0,0.0)",width:50,startRatio:1,endRatio:2};var mv={number:1,duration:1e3,interval:800,startColor:"rgba(0,0,0,0.6)",endColor:"rgba(0,0,0,0.0)",width:10,startRatio:1,endRatio:2};var yv=function(e){function t(t){var r=this;e.call(this);this._graph=t.graph;this._dom=t.dom;this._graphics=t.graphics;this._events=t.events;this._events.on("updateAttributes",function(e){return r._onAttributeChange(e)});this._events.on("newFrame",function(){return r._refreshPulses()});this._events.on("beforeRemoveEdges beforeRemoveNodes",function(e){var t=e.nodes;var r=e.edges;(t||r).setAttribute("pulse.enabled",false)});this._events.on("clear",function(){return r._hasPulses.clear()});this._engine=this._graphics.getGraphicsEngine();this._block=this._engine.createBlock();var i=this._graph;this._nodePulses=i.createNodeAttribute({storage:"any"});this._edgePulses=i.createEdgeAttribute({storage:"any"});this._nodeNbPulsesRemaining=i.createNodeAttribute({storage:"int16",default:-1});this._edgeNbPulsesRemaining=i.createEdgeAttribute({storage:"int16",default:-1});this._nodeDurationList=i.getAttribute(true,"pulse.duration");this._nodeIntervalList=i.getAttribute(true,"pulse.interval");this._nodeStartColorList=i.getAttribute(true,"pulse.startColor");this._nodeEndColorList=i.getAttribute(true,"pulse.endColor");this._nodePulseWidthList=i.getAttribute(true,"pulse.width");this._nodeStartRatioList=i.getAttribute(true,"pulse.startRatio");this._nodeEndRatioList=i.getAttribute(true,"pulse.endRatio");this._nodeXList=i.getAttribute(true,"x");this._nodeYList=i.getAttribute(true,"y");this._nodeRadiusList=i.getAttribute(true,"radius");this._nodeColorList=i.getAttribute(true,"color");this._nodeLayerList=i.getAttribute(true,"layer");this._nodeScalingMethodList=i.getAttribute(true,"scalingMethod");this._edgeDurationList=i.getAttribute(false,"pulse.duration");this._edgeIntervalList=i.getAttribute(false,"pulse.interval");this._edgeStartColorList=i.getAttribute(false,"pulse.startColor");this._edgeEndColorList=i.getAttribute(false,"pulse.endColor");this._edgePulseWidthList=i.getAttribute(false,"pulse.width");this._edgeStartRatioList=i.getAttribute(false,"pulse.startRatio");this._edgeEndRatioList=i.getAttribute(false,"pulse.endRatio");this._edgeWidthList=i.getAttribute(false,"width");this._edgeColorList=i.getAttribute(false,"color");this._edgeLayerList=i.getAttribute(false,"layer");this._edgeSourceList=i.getAttribute(false,"source");this._edgeTargetList=i.getAttribute(false,"target");this._edgeCurvatureList=i.getAttribute(false,"curvature");this._edgeScalingMethodList=i.getAttribute(false,"scalingMethod");this._hasPulses=new Qa(this._graph)}if(e)t.__proto__=e;t.prototype=Object.create(e&&e.prototype);t.prototype.constructor=t;t.prototype._onAttributeChange=function e(t){var r=t.nodes;var i=t.edges;var n=t.nodeAttributes;var a=t.edgeAttributes;this._onElementsAttributeChange(r,n);this._onElementsAttributeChange(i,a)};t.prototype._onElementsAttributeChange=function e(t,r){if(r.includes("pulse.enabled")){var i=Ir(this._graph,t,function(e){return e.getAttribute("pulse.enabled")});var n=i.valid;var a=i.invalid;this._hasPulses.removeElements(a);this._hasPulses.addElements(n);this._removePulses(a)}};t.prototype._removePulses=function e(t){var r=t.isNode?this._nodePulses:this._edgePulses;for(var i=0,n=t._indexes;i<n.length;i+=1){var a=n[i];var o=r.get(a);if(o){for(var s=0,u=o;s<u.length;s+=1){var l=u[s];this._graphics.releaseGraphicsEngineBlockId(l.blockId)}r.set(a,null)}}};t.prototype._refreshPulses=function e(){var t=this._hasPulses.getElements();var r=t.nodes;var i=t.edges;if(r.size!==0||i.size!==0){var n=this._engine.getCurrentTime();this._refreshElementsPulses(r,n);this._refreshElementsPulses(i,n);this._dom.refresh()}};t.prototype._refreshElementsPulses=function e(t,r){var i=t.isNode;var n=i?this._nodePulses:this._edgePulses;var a=i?this._nodeDurationList:this._edgeDurationList;var o=i?"_createNodePulseBlock":"_createEdgePulseBlock";var s=i?this._nodeIntervalList:this._edgeIntervalList;var u=i?this._nodeNbPulsesRemaining:this._edgeNbPulsesRemaining;for(var l=0,d=t._indexes;l<d.length;l+=1){var h=d[l];var f=n.get(h);if(!f){f=[];n.set(h,f)}for(var c=0;c<f.length;c++){var v=f[c];var p=v.startTime;var g=v.duration;var _=v.blockId;if(r>=p+g){this._graphics.releaseGraphicsEngineBlockId(_);f.splice(c--,1)}}var m=f[f.length-1];if(!m||r>=m.startTime+s.get(h)){var y=a.get(h);var b=u.get(h);if(b!==0){f.push({blockId:this[o](h,r,y),startTime:r,duration:y})}if(b>0){u.set(h,b-1)}}}};t.prototype._createNodePulseBlock=function e(t,r,i){var n=this._nodeColorList.get(t);var a=this._nodeLayerList.get(t);var o=this._nodeXList.get(t);var s=this._nodeYList.get(t);var u=this._nodeRadiusList.get(t);var l=this._nodeScalingMethodList.get(t)==="scaled";var d=this._nodeStartRatioList.get(t);var h=this._nodeEndRatioList.get(t);var f=this._nodePulseWidthList.get(t);var c=u*2*d;var v=u*2*h;var p=hh(a).nodeBody;var g=this._nodeStartColorList.get(t);var _=this._nodeEndColorList.get(t);var m=this._graphics.allocateGraphicsEngineBlockId();var y=this._block.reset(Oi,true,p);var b=y.nextAndReset();var x=Qd(g,n);var A=Qd(_,n);b.end.shape="circle";b.end.pieceId=Xi;b.end.x1=o;b.end.y1=s;b.end.x2=o;b.end.y2=s;b.end.rectWidthOrSourceRadiusScaled=l?v:0;b.end.rectHeightTargetRadiusScaled=l?v:0;b.end.rectWidthOrSourceRadiusFixed=!l?v:0;b.end.rectHeightTargetRadiusFixed=!l?v:0;b.end.strokeWidthFixed=f;b.end.strokeColor=A;b.start.shape="circle";b.start.pieceId=Xi;b.start.x1=o;b.start.y1=s;b.start.x2=o;b.start.y2=s;b.start.rectWidthOrSourceRadiusScaled=l?c:0;b.start.rectHeightTargetRadiusScaled=l?c:0;b.start.rectWidthOrSourceRadiusFixed=!l?c:0;b.start.rectHeightTargetRadiusFixed=!l?c:0;b.start.strokeWidthFixed=f;b.start.strokeColor=x;b.animation.duration=i;b.animation.beginTime=r;this._engine.storeBlock(m,y);return m};t.prototype._createEdgePulseBlock=function e(t,r,i){var n=this._edgeStartRatioList.get(t);var a=this._edgeEndRatioList.get(t);var o=this._edgeStartColorList.get(t);var s=this._edgeEndColorList.get(t);var u=this._edgeLayerList.get(t);var l=hh(u).edgeBody;var d=this._edgeSourceList.get(t);var h=this._edgeTargetList.get(t);var f=this._edgeCurvatureList.get(t);var c=f!==0;var v=this._graphics.allocateGraphicsEngineBlockId();var p=this._block.reset(c?Bi:Oi,true,l);var g=p.nextAndReset();var _={isSelfLoop:d===h,curvature:f,sourceX:this._nodeXList.get(d),sourceY:this._nodeYList.get(d),targetX:this._nodeXList.get(h),targetY:this._nodeYList.get(h),sourceRadius:this._nodeRadiusList.get(d),targetRadius:this._nodeRadiusList.get(h),isSourceRadiusScaled:this._nodeScalingMethodList.get(d)==="scaled",isTargetRadiusScaled:this._nodeScalingMethodList.get(h)==="scaled",width:this._edgeWidthList.get(t),isWidthScaled:this._edgeScalingMethodList.get(t)==="scaled",strokeWidth:this._edgePulseWidthList.get(t)};bv(g.start,_);bv(g.end,_);g.start.strokeColor=o;g.end.strokeColor=s;g.start.thicknessOrFontSizeScaled*=n;g.start.thicknessOrFontSizeFixed*=n;g.end.thicknessOrFontSizeScaled*=a;g.end.thicknessOrFontSizeFixed*=a;g.animation.duration=i;g.animation.beginTime=r;this._engine.storeBlock(v,p);return v};t.prototype.pulse=function e(t,r){var i=t.isNode;var n=gr(r,i?_v:mv);var a=n.number;var o=n.interval;var s=n.duration;var u=i?this._nodeNbPulsesRemaining:this._edgeNbPulsesRemaining;var l=(a-1)*o+s;delete n.number;n.enabled=true;t.setAttributes({pulse:n});u.setMultiple(t._indexes,a);this._dom.setTimeout(function(){t.setAttribute("pulse.enabled",false);u.setMultiple(t._indexes,-1)},l)};return t}(Ct);function bv(e,t){e.pieceId=Yi;e.shape="line";e.x1=t.sourceX;e.y1=t.sourceY;e.x2=t.targetX;e.y2=t.targetY;e.rectWidthOrSourceRadiusScaled=t.isSourceRadiusScaled?t.sourceRadius:0;e.rectWidthOrSourceRadiusFixed=t.isSourceRadiusScaled?0:t.sourceRadius;e.rectHeightTargetRadiusScaled=t.isTargetRadiusScaled?t.targetRadius:0;e.rectHeightTargetRadiusFixed=t.isTargetRadiusScaled?0:t.targetRadius;e.thicknessOrFontSizeScaled=t.isWidthScaled?t.width:0;e.thicknessOrFontSizeFixed=t.isWidthScaled?0:t.width;e.strokeWidthFixed=t.strokeWidth;e.curvature=t.curvature;e.isSelfLoop=t.isSelfLoop}var xv={duration:0,easing:"linear",callback:function(){},startAfter:0};var Av=function(e){l(t,e);function t(t){var r=e.call(this)||this;r._animationList=[];r._update=function(){if(r._animationList.length===0){return}var e=tt();var t=[];for(var i=0;i<r._animationList.length;++i){var n=r._animationList[i];var a=(e-n.creationDate)/n.duration;var o=n.startAfter;var s=n.easing(a);if(a>=1){n.func(1);n.done=true;r._animationList.splice(i,1);i-=1;t.push(n.callback)}else if(s>=o){var u=1/(1-o);s=(s-o)*u;n.func(s)}}for(var l=0;l<t.length;++l){t[l](false)}r._dom.refresh()};r._dom=t.dom;r._events=t.events;r._animationList=[];r._events.on(It.BEFORE_NEW_FRAME,r._update);return r}t.prototype.play=function(e,t){var r=X(t,xv),i=r.duration,n=r.easing,a=r.callback,o=r.startAfter;var s=null;if(i<=0){e(1);a()}else{s={func:e,easing:typeof n==="function"?n:gl[n],duration:i,callback:a,startAfter:o,creationDate:tt(),done:false};this._animationList.push(s);this._dom.refresh()}return s};t.prototype.end=function(e,t){if(t===void 0){t=true}var r=this._animationList.indexOf(e);if(r!==-1){e.func(1);this._animationList.splice(r,1);e.done=true;if(t){e.callback(true)}}};return t}(Ct);function Ev(e){e.TileLayer.prototype.getUrl=function(){return this._url};e.ImageOverlay.prototype.getUrl=function(){return this._url};var t="leaflet-zoom-animated";if(e.OgmaOverlay){return}e.OgmaOverlay=e.Layer.extend({options:{pane:"overlayPane",padding:0,onUpdate:function(){}},initialize:function(t){var r=t.container;e.Util.setOptions(this,t);this._container=r},setLocked:function(value){this._locked=value;return this},onAdd:function(r){this._map=r;this.getPane().appendChild(this._container);this._wgsOrigin=e.latLng([0,0]);this._wgsInitialShift=r.project(this._wgsOrigin,this._initialZoom);e.DomUtil.addClass(this._container,"leaflet-layer");if(this._zoomAnimated){e.DomUtil.addClass(this._container,t);this._container.style.position="absolute";this._container.style.zIndex=9999}this._initialZoom=(this._map.getMaxZoom()+this._map.getMinZoom())/2;this._mapInitialZoom=this._map.getZoom();this._updateBounds();this._update({})},_updateBounds:function(){var t=this.options.padding;var r=this._map.getSize();var i=this._map.containerPointToLayerPoint(r.multiplyBy(-t));this._bounds=new e.Bounds(i,i.add(r.multiplyBy(1+t*2)));this._center=this._map.getCenter();this._zoom=this._map.getZoom()},_update:function(t){var r=this;this._updateBounds();this._redraw(this._bounds.min,t);this._positionTimer=e.Util.requestAnimFrame(function(){return e.DomUtil.setPosition(r._container,r._bounds.min)})},_redraw:function(e,t){this.options.onUpdate()},_updateTransform:function(t,r){if(this._locked){return}var i=this._map.getZoomScale(r,this._zoom);var n=this._map.getSize().multiplyBy(.5+this.options.padding);var a=this._map.project(this._center,r);var o=n.multiplyBy(-i).add(a).subtract(this._map._getNewPixelOrigin(t,r));if(e.Browser.any3d){e.DomUtil.setTransform(this._container,o,i)}else{e.DomUtil.setPosition(this._container,o)}},_onZoom:function(e){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_onMoveEnd:function(e){this._update(e)},_onAnimZoom:function(e){var t=e.center,r=e.zoom;this._updateTransform(t,r)},bringToFront:function(){e.DomUtil.toFront(this._container)},getEvents:function(){return{zoom:this._onZoom,moveend:this._onMoveEnd,zoomanim:this._onAnimZoom,layeradd:this.bringToFront,zoomend:this.options.onUpdate}},onRemove:function(){e.DomUtil.removeClass(this._container,t);var r=this._container;["transform","webkitTransform","OTransform","MozTransform","msTransform","zIndex","position"].forEach(function(e){return r.style[e]=null});e.Util.cancelAnimFrame(this._positionTimer);this._container=null}})}function Sv(e){return e+(e.indexOf("?")===-1?"?":"&")+"noCache="+Date.now()}var wv={tileLayers:Mv,imageOverlays:Nv,vectorLayers:Lv,markers:kv,vectorMap:Iv};function Tv(e,t){if(e instanceof t.TileLayer){return"tileLayers"}if(e instanceof t.ImageOverlay){return"imageOverlays"}if(e instanceof t.Path){return"vectorLayers"}if(e instanceof t.Marker){return"markers"}if("MapboxGL"in t&&e instanceof t.MapboxGL){return"vectorMap"}}function Cv(e,t,r,i,n,a){var o={vectorMap:[],tileLayers:[],vectorLayers:[],imageOverlays:[],markers:[]};t.eachLayer(function(s){if(s!==e){var u=Tv(s,i);if(u in o){var l=wv[u];o[u].push(function(){return l(s,r,t,i,n,a)})}}});return o}function Iv(e,t,r,i,n){var a=r._getMapPanePos();var o=e.getMapboxMap();var s=e.getCanvas();var u=e.getSize().round();var l=i.DomUtil.getPosition(e.getContainer());var d=l.x+a.x-n.x;var h=l.y+a.y-n.y;return new Promise(function(e){function r(){t.drawImage(s,d,h,u.x,u.y);e()}if(o.loaded()){return r()}o.once("idle",r)})}function Mv(e,t,r,i,n){var a=r._getMapPanePos();var o=i.DomUtil.getPosition(e.getContainer());r.removeLayer(e);e.options.crossOrigin="anonymous";var s=[];var u=[];e.on("tileload",function(e){var t=e.tile;var r=i.DomUtil.getPosition(t),l=r.x,d=r.y;s.push(t);u.push({x:l-o.x+a.x-n.x,y:d-o.y+a.y-n.y})});r.addLayer(e);return new Promise(function(r){e.once("load",function(){var i=e.getTileSize();s.forEach(function(e,r){var n=u[r],a=n.x,o=n.y;t.drawImage(e,a,o,i.x,i.y)});r()})})}function Lv(e,t,r,i,n,a){return new Promise(function(o){var s=e.options.renderer;r.removeLayer(e);e.options.renderer=a;r.addLayer(e);a._updatePaths();var u=r._getMapPanePos();var l=a._container;var d=i.DomUtil.getPosition(l);var h=we();t.drawImage(a._container,d.x+u.x-n.x,d.y+u.y-n.y,l.width/h,l.height/h);r.removeLayer(e);e.options.renderer=s;r.addLayer(e);o()})}function kv(e,t,r,i,n){return new Promise(function(i){var a=r.getPixelBounds();var o=a.min;var s=r.project(e.getLatLng(),r.getZoom());var u=/^data\:/.test(e._icon.src);var l=u?e._icon.src:Sv(e._icon.src);var d=new Image;var h=e.options.icon.options;var f=h.iconSize;var c=s.subtract(o);var v=h.iconAnchor;if(!Array.isArray(f)){f=[f.x,f.y]}if(!Array.isArray(v)){v=[v.x,v.y]}var p=Math.round(c.x-f[0]+v[0])-n.x;var g=Math.round(c.y-v[1])-n.y;d.crossOrigin="";var _=function(){t.drawImage(d,p,g,f[0],f[1]);i()};d.onload=_;d.src=l;if(u){_()}})}function Nv(e,t,r,i,n){return new Promise(function(i){r.removeLayer(e);e.setUrl(Sv(e.getUrl()));e.options.crossOrigin="anonymous";e.once("load",function(){var a=e.getBounds();var o=r.latLngToContainerPoint(a.getNorthWest());var s=r.latLngToContainerPoint(a.getSouthEast());var u=s.x-o.x;var l=s.y-o.y;t.drawImage(e._image,o.x-n.x,o.y-n.y,u,l);i()});r.addLayer(e)})}function Fv(e,t,r,i){var n=e.filter(function(e){return e.isVisible()});var a=n.size===0;var o=n.reduce(function(e,t){var r=t.getGeoCoordinates(),n=r.latitude,a=r.longitude;var o=i(n,a),s=o.x,u=o.y;e.mapX.push(s);e.mapY.push(u);return e},{mapX:[],mapY:[]}),s=o.mapX,u=o.mapY;var l=n.getAttribute("x");var h=n.getAttribute("y");var f=n.getAttribute("radius");var c=new eo({xValues:l,yValues:h,scaledSizeValues:f});var v=new eo({xValues:s,yValues:u});if(a){c.cx=c.cy=0;c.width=c.height=0}if(!isFinite(v.width)||!isFinite(v.height)){v.cx=v.cy=0;v.width=v.height=0}var p=v.cx-c.cx;var g=v.cy-c.cy;var _=a?1:Math.max(v.width,v.height)/Math.max(c.width,c.height);var m=f.reduce(function(e,t){e[0]=Math.min(e[0],t*_);e[1]=Math.max(e[1],t*_);return e},[Infinity,0]),y=m[0],b=m[1];v.pad(b);v.minScaledSize=y;v.maxScaledSize=b;var x=r.computeConfigForBounds(v);var A=t.zoom/ri(x.zoom);p+=(c.cx-t.x)*A;g+=(c.cy-t.y)*A;var E=c.cx+p;var S=c.cy+g;return{offsetChanges:{name:"graph-to-geo",nodeAttributes:{radius:function(e){return e.getAttribute("radius")*A},x:function(e){return(e.getAttribute("x")+p-E)*A+E},y:function(e){return(e.getAttribute("y")+g-S)*A+S}},edgeAttributes:{width:function(e){return e.getAttribute("width")*A}}},camera:d({zoom:t.zoom/A,x:(t.x+p-E)*A+E,y:(t.y+g-S)*A+S,angle:0},t.getSize())}}function zv(e,t,r,i){var n=e.getAttributes(["x","y","radius"]);var a=e.getBoundingBox();var o=e.size===0;var s=e.reduce(function(e,t,r){var i=t._index;e[i]=r;return e},{});i();var u=e.getAttribute("x");var l=e.getAttribute("y");var h=e.getAttribute("radius");var f=new eo({xValues:u,yValues:l,scaledSizeValues:h.map(function(e){return e*2})});if(o){a.reset();f.reset()}var c=f.cx-a.cx;var v=f.cy-a.cy;var p=0,g=0;var _=r.computeConfigForBounds(f);var m=t.zoom/_.zoom;var y,b;if(isNaN(a.cx)||isNaN(a.cy)){a.cx=t.x;a.cy=t.y;y=_.x;b=_.y}else{c+=(a.cx-t.x)*m;v+=(a.cy-t.y)*m;p=a.cx+c;g=a.cy+v;y=(t.x+c-p)*m+p;b=(t.y+v-g)*m+g}return{offsetChanges:{name:"geo-to-graph",nodeAttributes:{x:function(e){return(n[s[e._index]].x+c-p)*m+p},y:function(e){return(n[s[e._index]].y+v-g)*m+g}}},camera:d({zoom:_.zoom,x:y,y:b,angle:0},t.getSize())}}var Rv={"top-left":"left","bottom-left":"left","top-right":"right","bottom-right":"right"};var Pv={"top-left":"top","bottom-left":"bottom","top-right":"top","bottom-right":"bottom"};var Ov={position:"bottom-right",horizontalMargin:0,verticalMargin:0,className:null};var Dv=function(e){l(t,e);function t(t){var r=e.call(this)||this;r._dom=t.dom;r._brand=null;return r}t.prototype.set=function(e,t){var r=d({},Ov,t),i=r.position,n=r.horizontalMargin,a=r.verticalMargin,o=r.className;if(!Rv[i]){i=Ov.position}this.remove();var s=document.createElement("div");s.innerHTML=e;s.style.position="absolute";Bv(s,i,n,a);s.style.padding="0px 0px 0px 0px";s.style.zIndex="10";if(o){s.setAttribute("class",o)}this._brand=s;this._dom.setLayer("brand",this._brand);return s};t.prototype.remove=function(){this._dom.setLayer("brand",null);this._brand=null};return t}(Ct);function Bv(e,t,r,i){var n=r===undefined?"":r+"px";var a=i===undefined?"":i+"px";e.style[Rv[t]]=n;e.style[Pv[t]]=a}var Vv=function(e){l(t,e);function t(t){var r;var i=t.camera,n=t.graph,a=t.settings,o=t.filters,s=t.events,u=t.dom,l=t.graphics,h=t.locate;var f=e.call(this)||this;f._enabled=false;f._zoom=0;f._nodeDraggingSetting=false;f._transition=false;f._map=null;f._attribution=null;f._updating=false;f._updateRate=50;f._x=0;f._y=0;f._graph=n;f._camera=i;f._settingsModule=a;f._filters=o;f._events=s;f._dom=u;f._graphics=l;f._locate=h;f._events.register(["geoEnabled","geoDisabled","geoLoaded","geoReady"]);f.L=null;if(Zr()){f.L=m("L")||m("leaflet");if(f.L){Ev(f.L)}}f._graph.createNodeAttribute({name:"geo.prevLat",storage:"float"});f._graph.createNodeAttribute({name:"geo.prevLng",storage:"float"});f._graph.createNodeAttribute({name:Ur,storage:"float"});f._graph.createNodeAttribute({name:Gr,storage:"float"});f._settings=d({},Xr);f._events.on((r={addNodes:function(e){return f._refreshOrAddNodes(e.nodes)},updateNodeData:function(e){if(f._enabled){f._onDataChange(e.changes)}},progressMoveNodesByDragging:function(e){return f._onNodesDragged(e)},startMoveNodesByDragging:function(){return f._onNodesDragStart()},endMoveNodesByDragging:function(){return f._setMapDragging(true)}},r[It.CAMERA_MOVE]=function(){return f._onCameraUpdate()},r[It.VIEW_CHANGED]=function(){return f._onCameraUpdate()},r));return f}t.prototype._onCameraUpdate=function(){var e=this;if(this._enabled&&this._map&&this._map._loaded){var t=this._x-this._camera.x;var r=this._y-this._camera.y;if(t||r){if(!this._updating){this._updating=true;this._layer.setLocked(true);this._map._moveStart(true,false)}var i=this._fromPointToLatLng(this._camera.x,this._camera.y);var n=Kr(this._camera.zoom);var a=this.L.latLng(i.latitude,i.longitude);this._map._move(a,n,{pinch:true,round:false});clearTimeout(this._updateRequest);this._updateRequest=setTimeout(function(){e._updating=false;e._layer.setLocked(false);if(e._map){e._map._move(a,n,{pinch:true})._moveEnd(true)}},this._updateRate)}}};t.prototype._onNodesDragStart=function(){if(this._enabled){this._setMapDragging(false);this._nodeDragOffsetX=this._nodeDragOffsetY=0}};t.prototype._onNodesDragged=function(e){var t=this;var r=e.nodes,i=e.dx,n=e.dy;if(this._enabled){var a=r.map(function(e){var r=e.getAttributes(["x","y"]),a=r.x,o=r.y;return t._fromPointToLatLng(a+i-t._nodeDragOffsetX,o+n-t._nodeDragOffsetY)});this._nodeDragOffsetX=i;this._nodeDragOffsetY=n;return r.setGeoCoordinates(a)}};t.prototype._onDataChange=function(e){var t=this;var r=e.filter(function(e){var r=e.property;return r===t.latitudePath||r===t.longitudePath});if(r.length){var i=vi(r);this._refreshOrAddNodes(i)}};t.prototype._refreshOrAddNodes=function(e){this._updateNodesCoordinates(e);if(this._enabled){this._filter.refresh();this._updatePrevNodesCoordinates(e)}};t.prototype._updatePrevNodesCoordinates=function(e){fi(this._graph,e,Ur,"geo.prevLat");fi(this._graph,e,Gr,"geo.prevLng")};t.prototype._restorePrevNodesCoordinates=function(e){fi(this._graph,e,"geo.prevLat",Ur);fi(this._graph,e,"geo.prevLng",Gr)};t.prototype._updateNodesCoordinates=function(e){di(this._graph,e,this._settings)};t.prototype._createMapTileLayer=function(e,t){if(!Y(e)){return e}var r=e;var i=r.wms?this.L.tileLayer.wms:this.L.tileLayer;var n=ii(r,t);return i(r.url,d({attribution:n},e))};t.prototype._onSettingsChanged=function(e,t){var r=e.wrapCoordinates!==t.wrapCoordinates;var i=e.latitudePath!==t.latitudePath||e.longitudePath!==t.longitudePath;if(r||i){this._updateNodesCoordinates(this._graph.getNodes("all"))}if(!this._enabled){return}if(oi(e,t)&&this._map){this._map.removeLayer(this._tileLayer);this._tileLayer=this._createMapTileLayer(t.tiles,t.attribution).addTo(this._map)}if(e.sizeRatio!==t.sizeRatio){this._updateSizes()}if(e.maxZoomLevel!==t.maxZoomLevel){this._settingsModule.update({minZoom:1,maxZoom:Math.pow(2,t.maxZoomLevel)})}if(e.disableNodeDragging!==t.disableNodeDragging){this._setDragging(!t.disableNodeDragging)}if(e.attributionOptions!==t.attributionOptions){this._setAttributionOptions(t.attributionOptions,t.attribution)}};t.prototype._setMapDragging=function(e){if(this._map){var t=e?"enable":"disable";this._map.dragging[t]()}};t.prototype._fromLatLngToPoint=function(e,t){return this._map.options.crs.latLngToPoint(this.L.latLng(e,t),Hr)};t.prototype._fromPointToLatLng=function(e,t){var r=this._map.options.crs.pointToLatLng(this.L.point({x:e,y:t}),Hr),i=r.lat,n=r.lng;return{latitude:i,longitude:n}};t.prototype._updateSizes=function(){if(this._enabled&&this._projection){this._projection.updateAll()}};t.prototype.enable=function(e){return this.setEnabled(true,e)};t.prototype.getMap=function(){if(!this._enabled){return}return this._map};t.prototype.getOptions=function(){if(!this._enabled){return}return d({},this._settings,{tiles:d({},this._settings.tiles)})};t.prototype.setOptions=function(e){if(!this._enabled){return}ni(e,this.L);var t=this._settings;this._settings=d({},Xr,e,{tiles:ai(Xr,e)});this._onSettingsChanged(t,this._settings)};t.prototype.disable=function(e){return this.setEnabled(false,e)};t.prototype.isEnabled=function(){return this._enabled};t.prototype.toggle=function(e){return this.setEnabled(!this._enabled,e)};t.prototype.getContainerCoords=function(e){var t=this;return e.getGeoCoordinates().map(function(e){var r=e.latitude,i=e.longitude;return t._map.latLngToContainerPoint([r,i])})};t.prototype.setEnabled=function(value,e){var t=this;if(!Zr()){throw new Error("Ogma Geo cannot be used outside a browser")}if(!this.L){throw new Error("You are trying to use Geo mode but Leaflet has not been found. Please follow our migration guide: https://bit.ly/2SYkF8A")}if(this._transition||value===this._enabled){return Promise.resolve()}this._enabled=value;this._transition=true;this.setOptions(e);var r=this._settingsModule;var i=this._settings;if(value){this._nodeDraggingSetting=r.get("interactions.drag.enabled");this._setDragging(!i.disableNodeDragging);return this._show().then(function(){t._setDragging(!i.disableNodeDragging);t._setMapDragging(i.disableNodeDragging);t._transition=false;t._updating=false;t._events.fire("geoEnabled");t._events.fire("geoReady")})}return this._hide().then(function(){t._transition=false;t._events.fire("geoDisabled");t._setDragging(t._nodeDraggingSetting,true)})};t.prototype._setDragging=function(e,t){if(t===void 0){t=false}this._settingsModule.update({interactions:{drag:{enabled:e,applyResult:t}}})};t.prototype._setAttributionOptions=function(e,t){if(this._attribution){this._attribution.remove();this._attribution=null}this._attribution=this.L.control.attribution({prefix:false}).addTo(this._map);if(Y(e)){this._attribution.setPrefix("");e.position=e.position||"bottom-right";var r=e.position.replace("-","");this._attribution.setPosition(r);var i=this._attribution.getContainer();if(e.className){this.L.DomUtil.addClass(i,e.className)}Bv(i,e.position||"bottom-right",e.horizontalMargin,e.verticalMargin)}if(t!==undefined){this._attribution.addAttribution(t)}};t.prototype._nodeIsVisible=function(e){return hi(e,this._settings,this._hasCustomProjection())};t.prototype._updateSettingsForMap=function(){var e=this._graphics.getGraphicsEngine().parseColor(this._settings.backgroundColor);e[3]=0;this._prevSettings=this._settingsModule.update({backgroundColor:Fi(e),minZoom:1e-6,interactions:{rotation:{enabled:false},drag:{enabled:false},pan:{enabled:false},zoom:{enabled:false,onDoubleClick:false}},mouse:{wheelEnabled:false}})};t.prototype.getGraphPosition=function(e){var t=this.L.latLngBounds(li(e));return{center:e.size>0?t.getCenter():this.L.latLng([0,0]),zoom:this._map.getBoundsZoom(t)}};t.prototype._initMap=function(){this._updateSettingsForMap();this._mapContainer=ui(this._dom.getContainer());var e=d({},Yr,{minZoom:this._settings.minZoomLevel,maxZoom:this._settings.maxZoomLevel});if(this._hasCustomProjection()){e.crs=this._settings.crs;e.worldCopyJump=false;e.maxBoundsViscosity=0}this._map=new this.L.Map(this._mapContainer,e);if(!this._hasCustomProjection()){this._map.setMaxBounds(this.L.latLngBounds([[qr,-180],[-qr,180]]))}this._setAttributionOptions(this._settings.attributionOptions,this._settings.attribution);this._setupLayers()};t.prototype._show=function(){var e=this;this._filter=this._filters.addNodeFilter(function(t){return e._nodeIsVisible(t)});return this._filter.whenApplied().then(function(){e._initMap();var t=e._graph.getNodes();var r=e._graph.getEdges();var i=e.getGraphPosition(t),n=i.center,a=i.zoom;e._zoom=a;var o=e._transformToGeo(),s=o.offset,u=o.newCameraView;return e._camera.setView(u,{ignoreZoomLimits:true}).then(function(){e._updatePrevNodesCoordinates(t);e._map.setView(n,a);e._zoom=a;return e._graphics.animate({nodes:t,edges:r},function(){e._projection=e._createFinalPositionLayer()},e._settings.duration)}).then(function(){return s.destroy()})})};t.prototype._hasCustomProjection=function(){return this._settings.crs!=null};t.prototype._setupLayers=function(){var e=this;if(this._settings.tiles){this._tileLayer=this._createMapTileLayer(this._settings.tiles,this._settings.attribution).addTo(this._map)}this._layer=new this.L.OgmaOverlay({container:this._graphics.getDomElement(),mapContainer:this._mapContainer,onUpdate:function(){return e._onMapUpdate()}});this._layer.addTo(this._map)};t.prototype._onMapUpdate=function(){var e=this._map.getCenter(),t=e.lat,r=e.lng;var i=this._fromLatLngToPoint(t,r);this._x=i.x;this._y=i.y;return this._camera.setView({zoom:Qr(this._map.getZoom()),x:i.x,y:i.y},{ignoreZoomLimits:true})};t.prototype._hide=function(){var e=this;if(!this._map){return Promise.resolve()}this._settingsModule.update(this._prevSettings);this._map.removeLayer(this._layer);var t=this._dom.getContainer();var r=this._graphics.getDomElement();if(t){t.appendChild(r)}this._map.getContainer().style.zIndex=0;var i=this._graph.getNodes("all");var n=this._graph.getEdge("all");var a=this._transformToGraph(),o=a.offset,s=a.newCameraView;return this._camera.setView(s).then(function(){return Promise.all([Je(e._map.getContainer(),1,0,e._settings.duration/2).then(function(){e._map.remove();e._mapContainer.parentNode.removeChild(e._mapContainer)}),e._graphics.animate({nodes:i,edges:n},function(){return o.destroy()},e._settings.duration)])}).then(function(){e._map=null;return e._filter.delete()})};t.prototype._transformToGeo=function(){var e=this;var t=this._graph.getNodes();var r=Fv(t,this._camera,this._locate,function(t,r){return e._fromLatLngToPoint(t,r)}),i=r.offsetChanges,n=r.camera;return{offset:this._addGraphAttributesLayer(i),newCameraView:n}};t.prototype._addGraphAttributesLayer=function(e){return this._graphics.addAttributeLayer(d({priority:Al,nodeSelector:function(e){return e.isVisible()},edgeSelector:function(e){return e.isVisible()}},e))};t.prototype._transformToGraph=function(){var e=this;var t=this._graph.getNodes("all");var r=zv(t,this._camera,this._locate,function(){if(e._projection){e._projection.destroy();e._projection=null}}),i=r.offsetChanges,n=r.camera;return{offset:this._addGraphAttributesLayer(i),newCameraView:n}};t.prototype.getPointFromLatLng=function(e){var t=e.getGeoCoordinates(),r=t.latitude,i=t.longitude;if(r==null){return e.getAttributes(["x","y"])}return this._fromLatLngToPoint(r,i)};t.prototype._createFinalPositionLayer=function(){var e=this;return this._addGraphAttributesLayer({name:"graph-2-geo-animation",nodeAttributes:{scalingMethod:"fixed",radius:function(t){return t.getAttribute("radius")*e._settings.sizeRatio},x:function(t){return e.getPointFromLatLng(t).x},y:function(t){return e.getPointFromLatLng(t).y}},edgeAttributes:{scalingMethod:"fixed",width:function(t){return t.getAttribute("width")*e._settings.sizeRatio}}})};t.prototype.destroy=function(){return Promise.resolve()};t.prototype.setCenter=function(e,t){if(!this._enabled){return Promise.resolve()}return this.setView(e,t,Kr(this._camera.getZoom()))};t.prototype.setZoom=function(e){if(!this._enabled){return Promise.resolve()}this._zoom=e;this._map.setZoom(e);return this._onMapUpdate()};t.prototype.setView=function(e,t,r){if(!this._enabled){return}this._map.setView(this.L.latLng([e,t]),r,{animate:false});this._zoom=r;return this._onMapUpdate()};t.prototype.getView=function(){if(!this._enabled){return}var e=this._map.getCenter();return{zoom:this._zoom,latitude:e.lat,longitude:e.lng}};t.prototype.getCenter=function(){if(!this._enabled){return}var e=this._map.getCenter();return{latitude:e.lat,longitude:e.lng}};t.prototype.getZoom=function(){if(!this._enabled){return}return this._zoom};t.prototype.resetCoordinates=function(){if(!this._enabled){return}var e=this._graph.getNodes();this._restorePrevNodesCoordinates(this._graph.getNodes());var t=this._graph.getNodeAttribute(Ur).getMultiple(e._indexes);var r=this._graph.getNodeAttribute(Gr).getMultiple(e._indexes);e.setData(this._settings.latitudePath,t);e.setData(this._settings.longitudePath,r);this._projection.update()};t.prototype.updateCoordinates=function(){vr("The ogma.geo.updateCoordinates() API has been deprecated. The coordinates are updated by default now.")};t.prototype.getUnprojectedCoordinates=function(e){vr("The ogma.geo.getUnprojectedCoordinates() API has been deprecated. Original graph coordinates are only available when in graph mode.");this._projection.destroy();var t=e.getPosition();this._projection=this._createFinalPositionLayer();return t};Object.defineProperty(t.prototype,"latitudePath",{get:function(){return this._settings.latitudePath},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"longitudePath",{get:function(){return this._settings.longitudePath},enumerable:true,configurable:true});t.prototype.exportBackground=function(e){var t=this;var r=Se();r.width=e.width;r.height=e.height;var i=r.getContext("2d");var n=this._map.getSize();var a=this.getView();var o=d({zoom:Kr(e.zoom)},this._fromPointToLatLng(e.x,e.y));var s={x:(n.x-e.width)/2,y:(n.y-e.height)/2};var u=new this.L.Canvas;this._map.addLayer(u);var l=Cv(this._layer,this._map,i,this.L,s,u),h=l.vectorMap,f=l.tileLayers,c=l.vectorLayers,v=l.imageOverlays,p=l.markers;var g=this._map.options.zoomSnap;return this.setView(o.latitude,o.longitude,o.zoom).then(function(){return t._map._onResize()}).then(function(){return F(h.concat(f,v,c,p))}).then(function(){t._map._onResize();t.setView(a.latitude,a.longitude,a.zoom);t._map.options.zoomSnap=g}).then(function(){return new Promise(function(e){return t.L.Util.requestAnimFrame(e)})}).then(function(){return t._map.removeLayer(u)}).then(function(){return r})};return t}(Ct);function jv(e,t,r,i,n){var a=new Array(e.length);for(var o=0;o<t.length;o++){var s=i[t[o]];var u=i[r[o]];a[s]=a[s]||[];a[s].push(u);if(n){a[u]=a[u]||[];a[u].push(s)}}return a}function Uv(e,t){if(e[t]===-1){return t}return Uv(e,e[t])}function Gv(e,t,r){var i=Uv(e,t);var n=Uv(e,r);e[i]=n}function qv(e,t,r,i){if(i===void 0){i=false}var n=new Int32Array(e.length);var a={};for(var o=0;o<e.length;o++){n[o]=-1;a[e[o]]=o}for(var o=0;o<t.length;o++){var s=a[t[o]];var u=a[r[o]];if(i&&s===u){return true}var l=Uv(n,s);var d=Uv(n,u);if(l===d){return true}Gv(n,l,d)}return false}function Hv(e,t,r,i,n,a,o,s){i[e]=n;if(r[e]){return true}if(t[e]){return false}t[e]=1;r[e]=1;var u=a[e];if(u){for(var l=0,d=u;l<d.length;l++){var h=d[l];if(Hv(h,t,r,i,e,a,o,s)){o.push(s[h]);return true}}}r[e]=0;return false}function Wv(e,t,r){var i=e.length;var n=new Uint8Array(i);var a=new Uint8Array(i);var o=new Int32Array(i);var s={};for(var u=0;u<i;u++){s[e[u]]=u}var l=jv(e,t,r,s,false);for(var u=0;u<i;u++){var d=u;var h=[];if(Hv(d,n,a,o,-1,l,h,e)){if(h.length>1){var f=h[0];for(var c=1;c<h.length;c++){if(h[c]===f){h.length=c;break}}h.push(f);return h.reverse()}}}return false}function Xv(e,t,r,i,n,a,o){t[e]=1;i[e]=r;var s=n[e];if(s){for(var u=0,l=s;u<l.length;u++){var d=l[u];if(!t[d]){if(Xv(d,t,e,i,n,a,o)){a.push(o[d]);return true}}else if(d!==r){i[d]=e;a.push(o[d]);return true}}}return false}function Yv(e,t,r){var i=e.length;var n=new Uint8Array(i);var a=new Int32Array(i);var o={};for(var s=0;s<i;s++){o[e[s]]=s;a[s]=-1}var u=jv(e,t,r,o,true);for(var s=0;s<t.length;s++){var l=o[t[s]];var d=o[r[s]];u[l]=u[l]||[];u[l].push(d)}for(var s=0;s<i;s++){var h=s;var f=[];if(!n[h]&&Xv(h,n,-1,a,u,f,e)){return true}}return false}var Zv=function(){function e(e,t,r){this.cycles=[];this.visitedLength=0;this.visitedStack=[];this.stack=[];this.idToIndex={};this.removed={};this.nodes=e;this.visited=new Uint8Array(this.nodes.length);for(var i=0;i<e.length;i++){this.idToIndex[e[i]]=i}this.adjacency=jv(e,t,r,this.idToIndex)}e.prototype.getCycles=function(){this.visited=new Uint8Array(this.nodes.length);this.visitedStack=[];for(var e=0;e<this.nodes.length;e++){this.backtrack(e,e);while(this.visitedLength!==0){var t=this.visitedStack.pop();if(this.visited[t]){this.visited[t]=0;this.visitedLength--}}}return this.cycles};e.prototype.backtrack=function(e,t){var r=false;this.stack.push(t);if(!this.visited[t]){this.visited[t]=1;this.visitedLength++}this.visitedStack.push(t);var i=this.adjacency[t]||[];for(var n=0,a=i;n<a.length;n++){var o=a[n];this.removed[t]=this.removed[t]||{};if(this.removed[t][o]){continue}if(o<e){this.removed[t][o]=true}else if(o===e){r=true;var s=[];for(var u=0,l=false;u<this.stack.length;u++){var d=this.stack[u];if(e===d){l=true}if(l){s.push(this.nodes[d])}}this.cycles.push(s)}else if(!this.visited[o]){var h=this.backtrack(e,o);r=r||h}}if(r){var f=void 0;do{f=this.visitedStack.pop();if(this.visited[f]){this.visited[f]=null;this.visitedLength--}}while(f!==t)}this.stack.pop();return r};return e}();var Kv=function(e){l(t,e);function t(t){var r=t.graph;var i=e.call(this)||this;i._graph=r;i._nodeList=r.getNodeAttribute("object");i._edgeList=r.getEdgeAttribute("object");i._sourceList=r.getEdgeAttribute("source");i._targetList=r.getEdgeAttribute("target");i._excludedList=r.getEdgeAttribute("excluded");i._virtualList=r.getEdgeAttribute("virtual");return i}t.prototype.shortestPath=function(e){if(e===void 0){e={source:undefined,target:undefined}}var t=e.source,r=e.target,i=e.directed,n=i===void 0?false:i,a=e.filter,o=a===void 0?"visible":a,s=e.edgeCostFunction,u=s===void 0?function(){return 1}:s,l=e.heuristicFunction,d=l===void 0?function(){return 0}:l;var h=this._graph.getNode(t);var f=this._graph.getNode(r);if(!h){throw new Error("the source is not a node")}if(!f){throw new Error("the target is not a node")}var c=h._index;var v=f._index;var p=null;if(c===v){p={nodes:h.toList(),edges:this._graph.edgeList()}}else{var g=this._graph.getNodeMaxIndex()+1;var _=new Int32Array(g);var m=new Float32Array(g);var y=new Float32Array(g);var b=new Ei;var x=new Ka(y);m.fill(Infinity);y.fill(Infinity);_.fill(-1);x.add(c);m[c]=0;y[c]=d(h,f);while(!x.isEmpty()){var A=x.removeMin();if(A===v){p=this._constructPath(_,c,v);break}b.add(A);var E=this._graph.getAdjacentDirections(A);if(!E){continue}for(var S=0;S<E.length;++S){var w=E[S];var T=this._graph.getEdgeIndexesInDirection(w);var C=-1;var I=0;var M=-1;for(var L=0;L<T.length;++L){var k=T[L];var N=this._sourceList.get(k);var F=this._targetList.get(k);if(N===F){continue}if(n&&A!==N){continue}if(o==="visible"&&this._excludedList.get(k)){continue}if(o==="raw"&&this._virtualList.get(k)){continue}var z=this._edgeList.get(k);var R=u(z);if(C===-1||R<I){C=k;I=R;M=N===A?F:N}}if(M!==-1||b.has(M)){var P=m[A]+I;if(!x.has(M)||P<m[M]){var O=this._nodeList.get(A);_[M]=C;m[M]=P;y[M]=P+d(O,f);x.add(M)}}}}}return Promise.resolve(p)};t.prototype._constructPath=function(e,t,r){var i=[r];var n=[];var a=r;while(a!==t){var o=e[a];var s=this._sourceList.get(o);var u=this._targetList.get(o);a=a===s?u:s;i.push(a);n.push(o)}i.reverse();n.reverse();return{nodes:this._graph.nodeList(new Uint32Array(i)),edges:this._graph.edgeList(new Uint32Array(n))}};t.prototype.detectCycle=function(e,t){var r=t.getSource();var i=t.getTarget();var n=Wv(e._indexes,r._indexes,i._indexes);return n?this._graph.nodeList(new Uint32Array(n)).dedupe():null};t.prototype.getAllSimpleCycles=function(e,t){var r=this;var i=t.getSource();var n=t.getTarget();var a=new Zv(e._indexes,i._indexes,n._indexes);return a.getCycles().map(function(e){return r._graph.nodeList(new Uint32Array(e))})};return t}(Ct);var Qv;(function(e){e["LEFT"]="left";e["RIGHT"]="right"})(Qv||(Qv={}));var Jv=typeof window!=="undefined"&&("msLaunchUri"in navigator&&!("documentMode"in document));function $v(e){return Jv?e.wheelDeltaY/2:e.deltaY&&e.deltaMode===0?-e.deltaY/we():e.deltaY&&e.deltaMode===1?-e.deltaY*20:e.deltaY&&e.deltaMode===2?-e.deltaY*60:e.deltaX||e.deltaZ?0:e.wheelDelta?(e.wheelDeltaY||e.wheelDelta)/2:e.detail&&Math.abs(e.detail)<32765?-e.detail*20:e.detail?e.detail/-32765*60:0}if(typeof window!=="undefined"&&!window.__OGMA_HEADLESS){var ep=[];document.documentElement.addEventListener("mousemove",function(e){for(var t=0;t<ep.length;t++){ep[t](e)}})}var tp=6;var rp=function(e){l(t,e);function t(t){var r=e.call(this)||this;r._x=0;r._y=0;r._px=0;r._py=0;r._pressX=0;r._pressY=0;r._left=false;r._middle=false;r._right=false;r._evt=null;r._bounds=null;r._clickCounter={left:0,middle:0,right:0};r._buttons={left:false,middle:false,right:false};r._button=null;r._lastMouseDownTarget=null;r._skipNextMove=false;r._onMouseWheel=function(e){if(r._isEnabled()&&r._isWheelEnabled()&&(!r._disableWheelUntilMouseDown()||r._dom.hasFocus())){e.preventDefault();e.stopPropagation();r._applyMouseWheelZoom(e)}};r._onMouseMove=function(e){if(!r._isEnabled()||!r._setXY(e)){return}var t=r._x,i=r._y;var n=t-r._px;var a=i-r._py;if(n===0&&a===0){return}if(r._skipNextMove){r._skipNextMove=false}else if(distance(t,i,r._pressX,r._pressY)>=tp){r._resetClickCounter();r._events.fire("mouseMove",{x:t,y:i,dx:n,dy:a,domEvent:r._evt})}};r._onDocumentMouseMove=function(e){if(!r._isEnabled()||!r._setXY(e)){return}var t=r._x,i=r._y,n=r._bounds;var a=t-r._px;var o=i-r._py;if(t<0||t>n.width||i<0||i>n.height){r._events.fire("documentMouseMove",{x:t,y:i,dx:a,dy:o,domEvent:r._evt})}};r._onMouseUp=function(e){if(!r._isEnabled()||!r._setXY(e)){return}var t=r._x,i=r._y,n=r._button,a=r._evt;r._buttons[n]=false;if(r._clickCounter[r._button]===1){r._events.fire("mouseClick",{button:n,x:t,y:i,domEvent:a})}else if(r._clickCounter[n]>1){r._events.fire("mouseDoubleClick",{button:n,x:t,y:i,domEvent:a});r._resetClickCounter(n)}r._events.fire("mouseUp",{button:n,x:t,y:i,domEvent:a})};r._onDocumentMouseup=function(e){if(!r._isEnabled()||!r._setXY(e)){return}var t=r._x,i=r._y,n=r._button;r._buttons[n]=false;r._events.fire("documentMouseUp",{button:n,x:t,y:i,domEvent:r._evt});r._dom.removeDocumentEventListener("mousemove",r._onDocumentMouseMove);r._dom.removeDocumentEventListener("mouseup",r._onDocumentMouseup)};r._onMouseDown=function(e){if(!r._isEnabled()||!r._setXY(e)){return}var t=r._x,i=r._y,n=r._button;r._skipNextMove=true;r._pressX=t;r._pressY=i;r._lastMouseDownTarget=e.target;r._dom.focus();r._buttons[n]=true;r._clickCounter[n]+=1;var a=n;r._dbclickTimer=r._dom.setTimeout(function(){r._resetClickCounter(a,0)},r._getDoubleClickTimer());r._events.fire("mouseDown",{button:n,x:t,y:i,domEvent:r._evt});r._dom.addDocumentEventListener("mousemove",r._onDocumentMouseMove);r._dom.addDocumentEventListener("mouseup",r._onDocumentMouseup)};r._dom=t.dom;r._settings=t.settings;r._events=t.events;r._graphics=t.graphics;r._domElt=r._graphics.getDomElement();r._settings.register("mouse.enabled",true);r._settings.register("mouse.wheelEnabled",true);r._settings.register("mouse.disableWheelUntilMouseDown",false);r._settings.register("mouse.doubleClickTimer",500);r._events.register(["mouseDown","mouseUp","mouseMove","mouseWheel","mouseClick","mouseDoubleClick",It.MOUSE_LEAVE,"documentMouseMove","documentMouseUp"]);r._dom.afterNextFrame().then(function(){return r._initializeListeners()});return r}Object.defineProperty(t.prototype,"x",{get:function(){return this._x},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"y",{get:function(){return this._y},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"left",{get:function(){return this._left},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"right",{get:function(){return this._right},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"middle",{get:function(){return this._middle},enumerable:true,configurable:true});t.prototype._isEnabled=function(){return this._settings.get("mouse.enabled")};t.prototype._isWheelEnabled=function(){return this._settings.get("mouse.wheelEnabled")};t.prototype._disableWheelUntilMouseDown=function(){return this._settings.get("mouse.disableWheelUntilMouseDown")};t.prototype._getDoubleClickTimer=function(){return this._settings.get("mouse.doubleClickTimer")};t.prototype._resetClickCounter=function(e,value){if(value===void 0){value=0}if(e){this._clickCounter[e]=value}else{this._clickCounter.left=value;this._clickCounter.middle=value;this._clickCounter.right=value}this._dom.clearTimeout(this._dbclickTimer);this._lastMouseDownTarget=null};t.prototype._setXY=function(e){var t=He(this._domElt);this._bounds=t;if(!t){return false}this._evt=e;this._button=Ke[e.button];this._px=this._x;this._py=this._y;this._x=e.clientX-t.left;this._y=e.clientY-t.top;this._left=this._buttons.left;this._right=this._buttons.right;this._middle=this._buttons.middle;return true};t.prototype._applyMouseWheelZoom=function(e){if(this._setXY(e)){this._events.fire("mouseWheel",{delta:$v(e),x:this._x,y:this._y,domEvent:this._evt})}};t.prototype._initializeListeners=function(){var e=this;var t=this._domElt;this.onMouseWheel=function(t){return e._onMouseWheel(t)};this.onMouseMove=function(t){return e._onMouseMove(t)};this.onDocumentMouseMove=function(t){return e._onDocumentMouseMove(t)};this.onMouseUp=function(t){return e._onMouseUp(t)};this.onDocumentMouseUp=function(t){return e._onDocumentMouseup(t)};this.onMouseDown=function(t){return e._onMouseDown(t)};if(typeof document!=="undefined"&&!window.__OGMA_HEADLESS){this._dom.addElementEventListener(document,"contextmenu",function(t){if(e._lastMouseDownTarget&&t.target!==e._lastMouseDownTarget){t.preventDefault()}})}this._dom.addElementEventListener(this._domElt,"contextmenu",function(t){e._setXY(t);if(e._dom.hasFocus()&&e._settings.get("mouse.enabled")){t.preventDefault()}},false);var r="onwheel"in this._domElt?"wheel":this._domElt.onmousewheel!==undefined?"mousewheel":"DOMMouseScroll";this._dom.addElementEventListener(t,r,this._onMouseWheel);this._dom.addElementEventListener(t,"mousemove",this._onMouseMove);this._dom.addElementEventListener(t,"mouseleave",function(){if(!e._isEnabled()){return}e._dom.blur();e._events.fire(It.MOUSE_LEAVE,{domEvent:e._evt})});this._dom.addElementEventListener(t,"mousedown",this._onMouseDown);this._dom.addElementEventListener(t,"mouseup",this._onMouseUp)};return t}(Ct);var ip=function(e){l(t,e);function t(t){var r=e.call(this)||this;r._context={edgesAlwaysCurvy:false,directedEdges:false};r._settings=t.settings;r._graphics=t.graphics;r._attributeLayer=r._addAttributeLayer();r._settings.register("edgesAlwaysCurvy",false,function(value){r._context.edgesAlwaysCurvy=value;r._attributeLayer.updateAll()});r._settings.register("directedEdges",false,function(value){r._context.directedEdges=value;r._attributeLayer.updateAll()});return r}t.prototype._addAttributeLayer=function(){return this._graphics.addAttributeLayer({name:"curvature",priority:ml,edgeDependencies:{parallelEdges:true},edgeContext:this._context,edgeAttributes:{curvature:function(e,t){var r=t.edgesAlwaysCurvy,i=t.directedEdges;var n=e.getSource()===e.getTarget();var a=e.getParallelEdges();var o=a.indexOf(e);if(o===-1){return 0}var s;if(n){s=o+1}else{var u=e.getSource();var l=a.size;if(l===1&&!r){return 0}if(i){var d=0;for(var h=0;h<o;++h){if(a.get(h).getSource()===u){d+=1}}s=d+1}else{var f=u!==a.get(0).getSource();if(l%2===1&&!r){if(o===0){s=0}else{s=((o+1)/2|0)*(o%2===0?1:-1)*(f?-1:1)}}else{s=((o/2|0)+1)*(o%2===0?1:-1)*(f?-1:1)}}}return s}}})};return t}(Ct);var np=function(){return{}};var ap=function(){return undefined};var op=function(){return false};var sp=function(){};var up=function(){};var lp=function(){};var dp=function(e){l(t,e);function t(t,r,i){var n=e.call(this)||this;n._complete=false;n._data=null;n._dependencies=r;n._dom=i;n.configure(t);return n}t.prototype.configure=function(e){this._onStart=e.onStart||up;this._onEnd=e.onEnd||lp;this._update=e.update||ap;this._onUpdate=e.onUpdate||sp;this._createContext=e.context||np;this._isRunning=e.isRunning||op};t.prototype.setData=function(e){this._data=e};t.prototype.getData=function(){return this._data};t.prototype.onStart=function(){this.fire("start",{target:this});this._onStart.call(this);return this};t.prototype.stop=function(){};return t}(to);var hp=function(e){l(t,e);function t(t,r,i){var n=e.call(this,t,r,i)||this;var a=[fp(t.imports),"","","var __CONTEXT = ("+n._createContext.toString()+")();","var __UPDATE_FUNC = "+n._update.toString()+";","var __IS_RUNNING_FUNC = "+n._isRunning.toString()+";","",'self.addEventListener("message", function (evt) {',"  var result    = __UPDATE_FUNC(evt.data, __CONTEXT);","  var isRunning = __IS_RUNNING_FUNC(__CONTEXT, evt.data);","  self.postMessage({ result: result, isRunning: isRunning });","});"].join("\n");n._worker=Pa(a);n._worker.addEventListener("message",function(e){if(!n._dom.isDestroyed()){n.sync(e)}});return n}t.prototype.sync=function(e){var t=e.data.isRunning;var r=e.data.result;var i=this._onUpdate.call(this,r,this._dependencies,t);this.fire("update",{target:this,isRunning:t});if(t){return this.send(i)}return this.stop(r)};t.prototype.stop=function(e){if(!this._complete){this._onEnd.call(this,e,this._dependencies);this._worker.terminate();this.fire("stop",{target:this})}this._complete=true;return this};t.prototype.send=function(e){this._worker.postMessage(za(e));return this};return t}(dp);function fp(e){if(e===void 0){e={}}var t=Object.keys(e);var r=[];for(var i=0,n=t.length;i<n;i++){var a=t[i];var o=e[a];if(typeof o!=="function"){throw new Error('Asynchronous task: dependency "'+a+'" is not found')}else{var s=cp(o);if(s){r.push(o.toString());if(s!==a){r.push("var "+a+" = "+s+";")}}else{r.push("var "+a+" = "+o.toString()+";")}}}return r.join("\n")}function cp(e){if(e.name){return e.name}var t=e.toString();var r=t.startsWith("function ");if(!r){return null}return t.substring("function ".length,t.indexOf("(")).trim()}var vp=function(e){l(t,e);function t(t,r,i){var n=e.call(this,t,r,i)||this;n._context=n._createContext();return n}t.prototype.sync=function(e){var t=this._update(e,this._context);var r=this._isRunning(this._context,e);var i=this._onUpdate.call(this,t,this._dependencies,r);this.fire("update",{target:this,isRunning:r});if(r){this.send(i)}else{this.stop(t)}};t.prototype.send=function(e){var t=this;if(!this._complete){this._dom.setTimeout(function(){return t.sync(e)},0)}return this};t.prototype.stop=function(e){if(!this._complete){this._onEnd(e,this._dependencies);this._complete=true}return this};return t}(dp);var pp=function(e){l(t,e);function t(t){var r=t.dom;var i=e.call(this)||this;i._dom=r;return i}t.prototype.run=function(e,t,r,i){var n=r;var a=e.configure||function(e){return e};var o=gp(a,t,i);var s=n?hp:vp;var u=new s(e,i,this._dom);return u.onStart().send(o)};return t}(Ct);function gp(e,t,r){var i=e(t,r);if(i===undefined){i=t}return i}var _p=40;var mp="layoutStart";var yp="layoutEnd";var bp="layoutComputed";var xp="complete";var Ap={duration:500,skipTextDrawing:true,useWebWorker:true,locate:false};var Ep=function(e){l(t,e);function t(t){var r=e.call(this)||this;r._currentLayout=null;r._onTaskUpdate=function(e,t,i,n,a,o){var s=o.duration,u=o.onSync,l=o.onUpdate,d=o.dryRun,h=o.locate;if(u){r._dom.setTimeout(function(){return u(i,r._modules,n)},s)}if(a){var f=a(i,r._modules,n);r._events.fire(bp,{type:bp,name:t,positions:f});if(l){l(i,f,n)}var c=r._assignNodePositions(f,s,d);if(!n){if(h){r._animateCamera(f,h,o.duration)}c.then(function(){return e.fire(xp,f)})}}else if(!n){e.fire(xp,i)}};r._onTaskComplete=function(e,t,i,n,a,o){r._currentLayout=null;if(i.onEnd&&e){i.onEnd(e,r._modules)}if(n.skipTextDrawing){r._dom.setTimeout(function(){return r._graphics.showTexts()},50)}var s=r._graph.nodeList(new Uint32Array(o.indexes));var u=n.dryRun&&e?t:wp(s);var l=s.getId();var d={before:Sp(o),current:Sp(u)};r._events.fire(yp,{type:yp,name:i.name,positions:d,ids:l});r._dom.setTimeout(function(){if(n.onEnd){n.onEnd(e)}a({name:i.name,positions:d,ids:l})})};r._onTaskStart=function(e,t,i){if(t.skipTextDrawing){r._graphics.hideTexts()}var n=r._graph.getNodes(t.nodes);var a=wp(n);var o=a.ids;i.setData(a);r._events.fire(mp,{type:mp,name:e.name,ids:o,task:i})};r._modules=t;r._dom=t.dom;r._events=t.events;r._graph=t.graph;r._graphics=t.graphics;r._tasks=t.tasks;r._locate=t.locate;r._camera=t.camera;r._layouts={};r._events.register([mp,yp,bp]);r._currentLayout=null;r._events.on(It.CLEAR_GRAPH,function(){return r.stop()});return r}t.prototype.register=function(e,t){if(e in this._layouts){throw new Error("Layout "+e+" already exists")}var r=d({},t,{name:e});this._layouts[e]=r};t.prototype.getAvailableLayouts=function(){return Object.keys(this._layouts)};t.prototype.start=function(e,t){var r=this;if(t===void 0){t={}}var i=this._layouts[e];return new Promise(function(n){if(!i){throw new Error("layout "+e+" does not exist")}if(r._currentLayout){r.stop()}t.duration=typeof t.duration==="number"?t.duration:Ap.duration;var a=i.onSync;var o=-Infinity;t.skipTextDrawing=t.skipTextDrawing===undefined?Ap.skipTextDrawing:t.skipTextDrawing;var s=t.locate||Ap.locate;if(s&&typeof s==="boolean"){s={}}t.locate=s;var u=r._onTaskStart;var l=r._onTaskUpdate;var d=r._onTaskComplete;var h={name:e,update:i.update,isRunning:i.isRunning,configure:i.configure,context:i.context,imports:i.imports,onStart:function(){u(i,t,this)},onUpdate:function(r,i,n){var s=tt();if(n&&s-o<_p){return}o=s;l(this,e,r,n,a,t)},onEnd:function(e){var r=this;this.once(xp,function(a){d(e,a,i,t,n,r.getData())})}};r._graphics.forceAttributesComputation();var f=t.useWebWorker===undefined?Ap.useWebWorker:t.useWebWorker;r._currentLayout=r._tasks.run(h,t,f,r._modules)})};t.prototype._animateCamera=function(e,t,r){if(e.indexes.length===0){return Promise.resolve()}var i=this._locate.layoutDataBoundingBox(e);var n=this._locate.computeConfigForBounds(i,t);return this._camera.setView(n,{duration:r,easing:t.easing})};t.prototype.stop=function(){if(this._currentLayout!==null){this._currentLayout.stop();this._currentLayout.fire(xp,null);this._currentLayout=null}return Promise.resolve()};t.prototype.isRunning=function(){return this._currentLayout!==null};t.prototype._assignNodePositions=function(e,t,r){if(!e||r){var i=e?new Uint32Array(e.indexes):undefined;var n=this._graph.nodeList(i);return Promise.resolve(n)}var a=e.indexes,o=e.x,s=e.y;var u=this._graph.nodeList(new Uint32Array(a));var l=Sp(e);for(var d=0;d<l.length;d++){l[d]={x:o[d],y:s[d]}}return u.setAttributes(l,t)};return t}(Ct);function Sp(e){var t=e.x,r=e.y,i=e.indexes;var n=i.length;var a=new Array(n);for(var o=0;o<n;o++){a[o]={x:t[o],y:r[o]}}return a}function wp(e){var t=e.getAttribute("x");var r=e.getAttribute("y");return{ids:e.getId(),indexes:e._indexes,x:t,y:r}}var Tp=function(e){l(t,e);function t(t){var r=e.call(this)||this;r._generators={};return r}t.prototype.register=function(e,t){this._generators[e]=t};t.prototype.load=function(e,t){var r=this._generators[e];var i=r.configure(t);return Promise.resolve(r.generate(i))};return t}(Ct);var Cp=function(){function e(e,t,r){var i=r.path,n=r.filter,a=r.unwindArrays;var o=this;this._module=e;this._isNode=t;this._path=i||[];this._filter=n;this._unwindArrays=a;this._onUpdateHandlers=[];this._triggerUpdate=function(e){for(var t=0;t<o._onUpdateHandlers.length;++t){o._onUpdateHandlers[t](e)}};this._info=e._watchPropertyInformation(this._isNode,this._path,this._triggerUpdate,this._filter,this._unwindArrays)}e.prototype.onUpdate=function(e){this._onUpdateHandlers.push(e)};e.prototype.getPropertyInfo=function(){return this._info};e.prototype.getPath=function(){return this._path.slice()};e.prototype.destroy=function(){this._module._unwatchPropertyInformation(this._isNode,this._path,this._triggerUpdate,this._filter,this._unwindArrays)};e.prototype.kill=function(){return this.destroy()};return e}();var Ip=function(){function e(e,t,r){var i=r.path,n=r.filter,a=r.unwindArrays;this._module=e;this._isNode=t;this._path=i;this._filter=n;this._unwindArrays=a;this._propertyList=[];this._properties={};this._onAddHandlers=[];this._onRemoveHandlers=[];this._onUpdateHandlers=[]}e.prototype.onPropertyAdded=function(e){this._onAddHandlers.push(e);return this};e.prototype.onPropertyRemoved=function(e){this._onRemoveHandlers.push(e);return this};e.prototype.onPropertyUpdated=function(e){this._onUpdateHandlers.push(e);return this};e.prototype.getPath=function(){return this._path.slice()};e.prototype.getProperties=function(){return this._propertyList.slice()};e.prototype.getPropertyInfo=function(e){var t=this._properties[e];return t?t.info:null};e.prototype.destroy=function(){var e=this;P(this._properties,function(t,r){var i=t.handler;var n=e._path.concat([r]);e._module._unwatchPropertyInformation(e._isNode,n,i,e._filter,e._unwindArrays)});this._propertyList=undefined;this._properties=undefined;this._onAddHandlers=undefined;this._onRemoveHandlers=undefined;this._onUpdateHandlers=undefined;var t=this._module._objectPropertyWatchers.indexOf(this);this._module._objectPropertyWatchers.splice(t,1)};e.prototype.kill=function(){return this.destroy()};e.prototype._updateSubPropertiesToWatch=function(e,t){if(e!==this._isNode){return}var r=t.getData(this._path);for(var i=0;i<r.length;i++){var n=r[i];if(z(n)){var a=Object.keys(n);for(var o=0;o<a.length;o++){this._addSubPropertyToWatch(a[o])}}}};e.prototype._addSubPropertyToWatch=function(e){var t=this;if(!this._properties[e]){var r=this._path.concat([e]);var i=function(){return t._triggerPropertyUpdate(e)};var n=this._unwindArrays;var a=this._isNode;var o=this._filter;var s=this._module._watchPropertyInformation(a,r,i,o,n);this._properties[e]={handler:i,info:s};this._triggerPropertyUpdate(e)}};e.prototype._triggerPropertyUpdate=function(e){var t=this._properties[e].info,r=this._propertyList.indexOf(e),i=r!==-1,n=t.getType()!=="undefined";if(!i&&n){this._propertyList.push(e);this._triggerHandlers("_onAddHandlers",e,t);this._triggerHandlers("_onUpdateHandlers",e,t)}else if(i&&!n){this._propertyList.splice(r,1);this._triggerHandlers("_onUpdateHandlers",e,t);this._triggerHandlers("_onRemoveHandlers",e,t)}else if(i&&n){this._triggerHandlers("_onUpdateHandlers",e,t)}};e.prototype._triggerHandlers=function(e,t,r){var i=this[e];for(var n=0,a=i.length;n<a;n++){i[n](t,r)}};return e}();var Mp=function(){function e(e){this._watcher=e}e.prototype.isNode=function(){return this._watcher.isNode};e.prototype.getPath=function(){return this._watcher.property.slice()};e.prototype.getBoundaries=function(){var e=this._watcher.boundaries;return e?{min:e.min,max:e.max}:null};e.prototype.getValues=function(){return this._watcher.values.keys()};e.prototype.getValueCount=function(value){return this._watcher.values.get(value)||0};e.prototype.getCount=function(){return this._watcher.nbTotal};e.prototype.getType=function(){if(this._watcher.nbAny>0){return"any"}else if(this._watcher.nbNumbers>0){return"number"}else{return"undefined"}};return e}();function Lp(e){if(typeof e!=="object"||e===null||Array.isArray(e)){return{path:Np(e),filter:"visible",unwindArrays:false}}else{return{path:Np(e.path),filter:Fp(e.filter),unwindArrays:!!e.unwindArrays}}}var kp=function(e){function t(t){var r=this;e.call(this);this._dom=t.dom;this._graph=t.graph;this._events=t.events;this._propertyWatchers=[];this._objectPropertyWatchers=[];this._events.on({excludedStateChange:function(e){var t=e.elements;var value=e.value;var i=!value;for(var n=0,a=r._propertyWatchers.length;n<a;n++){var o=r._propertyWatchers[n];if(o.isNode===t.isNode&&o.filter==="visible"){if(i){Op(o,t.getData(o.property))}else{Dp(o,t.getData(o.property))}zp(o)}}},"updateNodeData updateEdgeData":function(e){var t=e.isNode;var i=e.changes;for(var n=0;n<r._propertyWatchers.length;++n){var a=r._propertyWatchers[n],o=a.property,s=a.filter==="all";if(a.isNode!==t){continue}for(var u=0;u<i.length;++u){var l=i[u],d=l.property||[],h=Pp(d,o);if(h){var f=l.nodes||l.edges,c=[],v=[];for(var p=0;p<f.size;++p){var g=f.get(p);if(s||g.isVisible()){c.push(j(l.newValues[p],h));v.push(j(l.previousValues[p],h))}}if(c.length){Op(a,c);Dp(a,v);zp(a)}}}}for(var _=0,m=r._objectPropertyWatchers.length;_<m;_++){var y=r._objectPropertyWatchers[_];var b=y._path;var x=function(e){var t=i[e];var r=t.property;var n=t.nodes;var a=t.edges;var o=n||a,s=o.isNode;if(!r||r.length<=b.length+1&&b.every(function(e,t){return e===r[t]})){y._updateSubPropertiesToWatch(s,o)}};for(var A=0;A<i.length;++A)x(A)}},"addNodes addEdges":function(e){var t=e.nodes;var i=e.edges;var n=t||i;for(var a=0;a<r._propertyWatchers.length;++a){var o=r._propertyWatchers[a];if(o.isNode===n.isNode){var s=n.getData(o.property);if(s.length){Op(o,s);zp(o)}}}for(var u=0;u<r._objectPropertyWatchers.length;u++){r._objectPropertyWatchers[u]._updateSubPropertiesToWatch(n.isNode,n)}},"removeNodes removeEdges":function(e){var t=e.nodes;var i=e.edges;var n=t||i;for(var a=0;a<r._propertyWatchers.length;++a){var o=r._propertyWatchers[a];var s=o.filter==="all";if(o.isNode===n.isNode&&s){var u=n.getData(o.property);if(u.length){Dp(o,u);zp(o)}}}},clear:function(){r._propertyWatchers.forEach(function(e){e.nbNumbers=0;e.nbAny=0;e.nbTotal=0;e.boundaries=null;e.values.clear()})}})}if(e)t.__proto__=e;t.prototype=Object.create(e&&e.prototype);t.prototype.constructor=t;t.prototype.watchNodeObjectProperty=function e(t){return this._watchObjectProperty(true,Lp(t))};t.prototype.watchEdgeObjectProperty=function e(t){return this._watchObjectProperty(false,Lp(t))};t.prototype.watchNodeNonObjectProperty=function e(t){return this._watchNonObjectProperty(true,Lp(t))};t.prototype.watchEdgeNonObjectProperty=function e(t){return this._watchNonObjectProperty(false,Lp(t))};t.prototype._watchPropertyInformation=function e(t,r,i,n,a){var o=this._findWatcher(t,r,n,a);if(!o){o=this._createWatcher(t,r,n,a)}if(i){o.onChange.push(i)}return o.info};t.prototype._unwatchPropertyInformation=function e(t,r,i,n,a){var o=this._findWatcher(t,r,n,a);if(!o){return}var s=o.onChange,u=s.indexOf(i);if(u!==-1){s.splice(u,1);if(s.length===0){var l=this._propertyWatchers.indexOf(o);this._propertyWatchers.splice(l,1)}}};t.prototype._watchObjectProperty=function e(t,r){var i=new Ip(this,t,r);this._objectPropertyWatchers.push(i);i._updateSubPropertiesToWatch(t,this._graph[t?"getNodes":"getEdges"](r.filter));return i};t.prototype._watchNonObjectProperty=function e(t,r){return new Cp(this,t,r)};t.prototype._findWatcher=function e(t,r,i,n){for(var a=0;a<this._propertyWatchers.length;++a){var o=this._propertyWatchers[a];if(o.isNode===t&&o.filter===i&&o.unwindArrays===n&&Rp(o.property,r)){return o}}return null};t.prototype._createWatcher=function e(t,r,i,n){var a={isNode:t,property:r,nbNumbers:0,nbAny:0,nbTotal:0,values:new ya,boundaries:null,onChange:[],filter:i,unwindArrays:n,info:undefined};a.info=new Mp(a);Op(a,this._graph[t?"getNodes":"getEdges"](i).getData(r));this._propertyWatchers.push(a);return a};return t}(Ct);function Np(value){if(value===null||value===undefined){return[]}else{return C(value)}}function Fp(value){return value==="all"?"all":"visible"}function zp(e){for(var t=0;t<e.onChange.length;++t){e.onChange[t](e.info)}}function Rp(e,t){if(e.length!==t.length){return false}for(var r=0;r<e.length;++r){if(e[r]!==t[r]){return false}}return true}function Pp(e,t){if(e.length>t.length){return null}for(var r=0;r<e.length;++r){if(e[r]!==t[r]){return null}}return t.slice(r)}function Op(e,t,r){var i=e.values,n=!r&&e.unwindArrays;for(var a=0;a<t.length;++a){var value=t[a];if(!r&&value!==undefined){e.nbTotal+=1}if(n&&Array.isArray(value)){Op(e,value,true)}else{var o=i.get(value);if(o){i.set(value,o+1)}else{i.set(value,1);if(Vp(value)){if(!e.boundaries){e.boundaries={min:value,max:value}}else if(value<e.boundaries.min){e.boundaries.min=value}else if(value>e.boundaries.max){e.boundaries.max=value}e.nbNumbers+=1}else if(value!==undefined){e.nbAny+=1}}}}}function Dp(e,t,r){var i=e.values,n=!r&&e.unwindArrays,a=e.boundaries,o=false;for(var s=0;s<t.length;++s){var value=t[s];if(!r&&value!==undefined){e.nbTotal-=1}if(n&&Array.isArray(value)){o|=Dp(e,value,true)}else{var u=i.get(value);if(u>1){i.set(value,u-1)}else{i.delete(value);if(Vp(value)){e.nbNumbers-=1;if(a&&(a.min===value||a.max===value)){o=true}}else if(value!==undefined){e.nbAny-=1}}}}if(!r&&o){e.boundaries=Bp(i.keys())}return o}function Bp(e){var t=undefined,r=undefined;for(var i=0;i<e.length;++i){var value=e[i];if(Vp(value)){if(t===undefined||value<t){t=value}if(r===undefined||value>r){r=value}}}return t===undefined?null:{min:t,max:r}}function Vp(value){return typeof value==="number"&&isFinite(value)}function minHeap(e,t,r,i){if(e===void 0){e=function(e,t){return e-t}}if(t===void 0){t=[]}if(r===void 0){r={}}if(i===void 0){i=function(e){return e}}var n=t.length;function a(a){while(true){var o=2*a+1;var s=o+1;var u=a;if(o<n&&e(t[o],t[u])<0){u=o}if(s<n&&e(t[s],t[u])<0){u=s}if(u===a){return a}var l=t[u];t[u]=t[a];t[a]=l;r[i(t[u])]=u;r[i(l)]=a;a=u}}var o={get keys(){return r},get size(){return n},heapify:a,pop:function(){if(n<=0){return undefined}if(n===1){n--;return t[0]}var e=t[0];t[0]=t[n-1];n--;a(0);return e},decreaseKey:function(n,value){if(value!==undefined){t[n]=value;r[i(value)]=n}while(n>0){var a=n-1>>1;if(e(t[a],t[n])>0){var o=t[n];t[n]=t[a];t[a]=o;r[i(t[n])]=n;r[i(o)]=a;n=a}else{break}}return n},min:function(){return t[0]},remove:function(e){this.decreaseKey(e,Number.NEGATIVE_INFINITY);return this.pop()},push:function(a){n++;var o=n-1;t[o]=a;while(o>0){var s=o-1>>1;if(e(t[s],t[o])>0){var u=t[o];t[o]=t[s];t[s]=u;r[i(t[o])]=o;r[i(u)]=s;o=s}else{break}}return o},empty:function(){return n<=0},toArray:function(){return t.slice(0,n)}};return o}function dijkstra(e,t,r,i,n,a,o){var s=i?i.length:e.length;var u=new Float32Array(s);var l=new Int32Array(s);var d=new Uint32Array(s);var h=Number.POSITIVE_INFINITY;var f={};var c,v;if(s===0){return{distances:u,path:null,pathLength:null}}if(!i){for(c=0,i=new Uint32Array(s);c<s;c++){i[c]=c+1}}if(!n){for(c=0,n={};c<s;c++){n[i[c]]=c}}for(c=0;c<s;c++){u[c]=h;l[c]=-1;d[c]=f[c]=c}var p=minHeap(function(e,t){return u[e]-u[t]},d,f);u[n[t]]=0;p.decreaseKey(f[n[t]]);while(p.size!==0){var g=p.pop();var _=u[g];var m=e[g];if(_===h){break}for(c=0,v=m.nodes.length;c<v;c++){var y=m.nodes[c];var b=a?1:o?o(i[g],y):m.weights[c];var x=n[y];if(x===undefined){continue}var A=_+b;if(A<u[x]){u[x]=A;l[x]=g;p.decreaseKey(f[x])}}}var E=null;var S=null;if(r!==undefined){var w=n[r];if(u[w]!==h){for(c=w,E=[];c!==-1;c=l[c]){E.push(i[c])}E=E.reverse();S=u[r]}}return{distances:u,path:E,pathLength:S}}function jp(e,t){var r=e.getPosition(),i=t.getPosition();return distance(r.x,r.y,i.x,i.y)}function Up(){return 1}function Gp(){return 0}var qp={pathLengthFunction:jp,heuristicLengthFunction:jp};var Hp={pathLengthFunction:Up,heuristicLengthFunction:Gp};var Wp=function(e){l(t,e);function t(t){var r=t.graph;var i=e.call(this)||this;i._graph=r;i._cachedObjectList=r.getNodeAttribute("object");return i}t.prototype.astar=function(e,t,r){return Xp(this._graph,e,t,this._cachedObjectList,d({},qp,r))};t.prototype.dijkstra=function(e,t,r){return Xp(this._graph,e,t,this._cachedObjectList,d({},Hp,r))};t.prototype.dijkstraBig=function(e,t,r){var i=this._graph.getNodes();var n=dijkstra(this._graph.getAdjacencyList({directed:r.directed,weight:1,nodes:i}),this._graph.getNode(e)._index,this._graph.getNode(t)._index,i._indexes,undefined,false);return n.path&&this._graph.nodeList(n.path)};return t}(Ct);function Xp(e,t,r,i,n){var a=n===void 0?{}:n,o=a.pathLengthFunction,s=a.heuristicLengthFunction,u=a.filter,l=a.directed;var d=e.getNode(t)._index;var h=e.getNode(r)._index;var f=o;var c=s;var v=l?dr.OUT:dr.BOTH;var p=i.get(d);var g=i.get(h);var _=null;if(d===h){return e.nodeList([d])}var m=e.getNodeMaxIndex()+1,y=new xa(Uint32Array),b=new xa(Uint32Array),x=new Int32Array(m),A=new Float32Array(m),E=new Float32Array(m);for(var S=0;S<m;++S){x[S]=-1;A[S]=Infinity;E[S]=Infinity}b.add(d);A[d]=0;E[d]=c(p,g);while(b.length!==0){var w=b.length;var T=b.get(0);var C=0;var I=E[T];for(var S=1;S<w;++S){var M=b.get(S);var L=E[M];if(L<I){I=L;T=M;C=S}}if(T===h){_=Yp(x,d,h);break}var k=i.get(T);b.removeByPosition(C);y.add(T);var N=e.node(T).getAdjacentNodes({direction:v,filter:u})._indexes;for(var S=0;S<N.length;++S){var F=N[S];var z=i.get(F);if(y.has(F)){continue}var R=A[T]+f(k,z);if(!b.add(F)&&R>=A[F]){continue}x[F]=T;A[F]=R;E[F]=R+c(z,g)}}return _&&e.nodeList(_)}function Yp(e,t,r){var i=[r],n=r;while(n!==t){n=e[n];i.push(n)}i.reverse();return i}var Zp=function(e){function t(t){e.call(this);this._modules=t;this._dom=t.dom;this._events=t.events;this._events.register(["virtualDown","virtualUp","virtualMove","virtualClick","virtualDoubleClick","virtualWheel"])}if(e)t.__proto__=e;t.prototype=Object.create(e&&e.prototype);t.prototype.constructor=t;var r={x:{configurable:true},y:{configurable:true}};r.x.get=function(){return this._modules.captor._x||0};r.y.get=function(){return this._modules.captor._y||0};t.prototype._later=function e(){return this._dom.afterNextFrame()};t.prototype.move=function e(t){var r=this;var i=t.x;var n=t.y;if(i!==undefined&&n!==undefined){return this._dom.afterNextFrame().then(function(){var e=i-r.x;var t=n-r.y;r._events.fire("virtualMove",{x:i,y:n,dx:e,dy:t});return r._later()})}else{return Promise.resolve()}};t.prototype.down=function e(t){var r=this;if(t===void 0)t={};var i=t.x;var n=t.y;var a=t.button;if(a===void 0)a="left";return this.move({x:i,y:n}).then(function(){r._events.fire("virtualDown",{x:r.x,y:r.y,button:a});r._events.fire("virtualMove",{x:r.x,y:r.y,dx:0,dy:0});return r._later()})};t.prototype.up=function e(t){var r=this;if(t===void 0)t={};var i=t.x;var n=t.y;var a=t.button;if(a===void 0)a="left";return this.move({x:i,y:n}).then(function(){r._events.fire("virtualUp",{x:r.x,y:r.y,button:a});return r._later()})};t.prototype.click=function e(t){var r=this;if(t===void 0)t={};var i=t.x;var n=t.y;var a=t.button;if(a===void 0)a="left";return this.move({x:i,y:n}).then(function(){r._events.fire("virtualClick",{x:r.x,y:r.y,button:a});return r._later()})};t.prototype.rightClick=function e(t){var r=this;if(t===void 0)t={};var i=t.x;var n=t.y;var a=t.button;if(a===void 0)a="right";return this.move({x:i,y:n}).then(function(){r._events.fire("virtualClick",{x:r.x,y:r.y,button:a});return r._later()})};t.prototype.doubleClick=function e(t){var r=this;if(t===void 0)t={};var i=t.x;var n=t.y;var a=t.button;if(a===void 0)a="left";return this.move({x:i,y:n}).then(function(){r._events.fire("virtualDoubleClick",{x:r.x,y:r.y,button:a});return r._later()})};t.prototype.drag=function e(t,r){var i=this;return this.down(t).then(function(){return i.move(r)}).then(function(){return i.up()})};t.prototype.wheel=function e(t){var r=this;var i=t.x;var n=t.y;var a=t.delta;return this.move({x:i,y:n}).then(function(){r._events.fire("virtualWheel",{x:r.x,y:r.y,delta:a});return r._later()})};Object.defineProperties(t.prototype,r);return t}(Ct);var Kp={tolerance:5,centerSnapDistance:240,sideSnapDistanceFactor:3,guidelineWidth:1,guidelineColor:"#ff0000",preferredDistance:{enabled:true,ratio:1.13,tolerance:10,lineColor:"#00C3FF",lineWidth:1},neighbours:{enabled:true,offset:5,tolerance:3,lineColor:"#00C3FF",lineWidth:1}};var Qp={NONE:0,CENTER:1,LEFT:2,RIGHT:3,TOP:4,BOTTOM:5};var Jp=function(e){function t(t){e.call(this);this._graph=t.graph;this._graphics=t.graphics;this._spatial=t.spatial;this._settings=t.settings;this._events=t.events;this._camera=t.camera;this._options=O(Kp);this._enabled=false;this._canvas=Se();this._ctx=this._canvas.getContext("2d");this._ysnap=Qp.NONE;this._xsnap=Qp.NONE;this._node=null;this._r=0;this._viewport=null;this._horizontalGuideLine=null;this._verticalGuideLine=null;this._vguideline={start:{x:0,y:0},end:{x:0,y:0}};this._hguideline={start:{x:0,y:0},end:{x:0,y:0}};this._distanceGuidelines=[-1,-1];this._neighbourGuidelines=[]}if(e)t.__proto__=e;t.prototype=Object.create(e&&e.prototype);t.prototype.constructor=t;t.prototype.enable=function e(t){var r=this;if(this._enabled){return}var i=this._events;this._options=gr(t,Kp);this._enabled=true;this._graphics.addCanvas(this._canvas);this._dragStartListener=i.on("startMoveNodesByDragging",function(e){return r._onNodeDragStart(e)});this._dragEndListener=i.on("endMoveNodesByDragging",function(e){return r._onNodeDragEnd(e)});this._settings.update({"interactions.drag.onBeforeDrag":function(e,t,i,n){return r._onBeforeDrag(t,i,n)}})};t.prototype.disable=function e(){if(!this._enabled){return}var t=this._events;t.removeListener(this._dragStartListener);t.removeListener(this._dragEndListener);this._graphics.removeCanvas(this._canvas);this._settings.update({"interactions.drag.onBeforeDrag":null});this._enabled=false};t.prototype.enabled=function e(){return this._enabled};t.prototype._onNodeDragStart=function e(t){var r=t.nodes;if(r.size===1){this._node=r.get(0);this._cacheViewport();this._r=this._node.getAttribute("radius")}};t.prototype._onBeforeDrag=function e(t,r,i){if(this._node){var n=i[0];this._scan(n);this._node.setAttributes(n)}};t.prototype._onNodeDragEnd=function e(){this._node=null;this._clearCanvas()};t.prototype._cacheViewport=function e(){var t=this._camera;var r=t.screenToGraphCoordinates({x:0,y:0});var i=t.screenToGraphCoordinates({x:t.width,y:t.height});this._viewport={xmin:r.x,ymin:r.y,xmax:i.x,ymax:i.y};this._nodes=this._spatial.getNodesByBoundingBox(r.x,r.y,i.x,i.y);var n=this._node._index;var a=Array.from(this._nodes._indexes);a.splice(a.indexOf(n),1);var o=this._graphics._getAttributeArray(true,"radius");var s=this._graph.getNodeAttribute("x");var u=this._graph.getNodeAttribute("y");var l=s._buffer;var d=u._buffer;var h=y(a.slice(),s);var f=y(a.slice(),u);var c={},v={};var p={},g={};var _=this._gridResolution=this._node.getAttribute("radius");for(var m=0,b=a.length;m<b;m++){var x=h[m],A=f[m];var E=l[x]/_|0,S=d[A]/_|0;if(!c[E]){c[E]=[]}if(!v[S]){v[S]=[]}c[E].push(x);v[S].push(A);p[x]=g[A]=m}this._nodesByX=h;this._nodesByY=f;this._nodesByXIndex=p;this._nodesByYIndex=g;this._xGrid=c;this._yGrid=v;this._xList=s;this._yList=u;this._X=l;this._Y=d;this._R=o};t.prototype._clearCanvas=function e(){this._ctx.clearRect(0,0,this._canvas.width,this._canvas.height)};t.prototype._drawLine=function e(t,r,i,n){var a=this._ctx,o=we(),s=this._camera.graphToScreenCoordinates(t),u=this._camera.graphToScreenCoordinates(r);a.beginPath();a.moveTo(s.x*o,s.y*o);a.lineTo(u.x*o,u.y*o);a.strokeStyle=n;a.lineWidth=i;a.stroke()};t.prototype._scan=function e(t){this._clearCanvas();var r=this._node._index;var i=t.x,n=t.y,a=this._r;var o=this._options;var s=this._xList;var u=this._yList;var l=this._R;var d=this._X;var h=this._Y;var f=this._camera.zoom;var c=Math.min(a,this._options.tolerance/f);var v=a*2*o.sideSnapDistanceFactor;var p=o.guidelineWidth;var g=o.guidelineColor;var _,m;var b=r;var x=r;var A,E,S,w,T,C,I;var M=false,L=false;b=$p(this._nodesByX,d,i);x=$p(this._nodesByY,h,n);if(Math.abs(d[b]-i)>o.centerSnapDistance){b=r}if(Math.abs(h[x]-n)>o.centerSnapDistance){x=r}this._xsnap=Qp.NONE;if(b!==r){_=this._vguideline.start;m=this._vguideline.end;I=b;A=d[I];E=h[I];S=l.get(I);C=Math.abs(i-A);var k=Math.abs(i-a-(A-S));var N=Math.abs(i+a-(A+S));if(C<Math.max(a,S)){if(E<n){_.y=E-S;m.y=n+a}else{_.y=E+S;m.y=n-a}var F=Math.min(k,C,N);if(F===C){_.x=m.x=A;m.y=n;_.y=E;this._xsnap=Qp.CENTER}else if(Math.abs(n-E)<S+a+v){if(F===k){_.x=m.x=A-S;this._xsnap=Qp.LEFT}else{_.x=m.x=A+S;this._xsnap=Qp.RIGHT}}if(F<c){M=true}}if(this._xsnap!==Qp.NONE){this._drawLine(_,m,p,g)}}this._ysnap=Qp.NONE;if(x!==r){_=this._hguideline.start;m=this._hguideline.end;I=x;A=d[I];E=h[I];S=l.get(I);C=Math.abs(n-E);var z=Math.abs(n-a-(E-S));var R=Math.abs(n+a-(E+S));if(C<Math.max(a,S)){if(A<i){_.x=A-S;m.x=i+a}else{_.x=A+S;m.x=i-a}var P=Math.min(z,C,R);if(P===C){_.y=m.y=E;m.x=i;_.x=A;this._ysnap=Qp.CENTER}else if(Math.abs(i-A)<S+a+v){if(P===z){_.y=m.y=E-S;this._ysnap=Qp.TOP}else{_.y=m.y=E+S;this._ysnap=Qp.BOTTOM}}if(P<c){L=true}}if(this._ysnap!==Qp.NONE){this._drawLine(_,m,p,g)}}if(o.preferredDistance.enabled){var O=o.preferredDistance.ratio;var D=Math.min(o.preferredDistance.tolerance/f,a);var B=Math.max(a,S);if(b!==r&&(this._xsnap===Qp.NONE||!M)){I=b;A=d[I];E=h[I];S=l.get(I);w=Math.abs(i-A)-(a+S)*(1+O);if(w<=D&&w>=-D){var V=i<A?-1:1;_=this._vguideline.start;m=this._vguideline.end;_.x=m.x=A+V*(1+O)*(a+S);_.y=E-B;m.y=E+B;_.x=m.x=A;this._drawLine(_,m,p,g);_.y=n-B;m.y=n+B;_.x=m.x=A+V*(1+O)*(a+S);this._drawLine(_,m,p,g);this._xsnap=Qp.CENTER;M=true}}else if(x!==r&&(this._ysnap===Qp.NONE||!L)){I=x;A=d[I];E=h[I];S=l.get(I);T=Math.abs(n-E)-(a+S)*(1+O);if(T<=D&&T>=-D){var j=n<E?-1:1;_=this._hguideline.start;m=this._hguideline.end;_.x=A-B;m.x=A+B;_.y=m.y=E;this._drawLine(_,m,p,g);_.x=i-B;m.x=i+B;_.y=m.y=E+j*(1+O)*(a+S);this._drawLine(_,m,p,g);this._ysnap=Qp.CENTER;L=true}}}if(o.neighbours.enabled){var U=this._gridResolution;var G=i/U|0,q=n/U|0;var H=this._xGrid,W=this._yGrid,X=[];var Y=[].concat(W[q-1]||X,W[q]||X,W[q+1]||X);var Z=[].concat(H[G-1]||X,H[G]||X,H[G+1]||X);var K;if(Y.length>1){y(Y,s);K=this.findNeighboursToAlign(Y,d,r,i,a,l,c);if(K){this.drawNeighbourGuidelines(K,t);M=false}}if(Z.length>1&&!K){y(Z,u);K=this.findNeighboursToAlign(Z,h,r,n,a,l,c);if(K){this.drawNeighbourGuidelines(K,t,true);L=false}}}if(M||L){this._snap(t,!M,!L)}};t.prototype.findNeighboursToAlign=function e(t,r,i,n,a,o,s){var u,l,d,h=false,f,c,v;var p=Math.abs;for(var g=0,_=t.length;!h&&g<_;g++){for(var m=0;!h&&m<_;m++){if(g===m){continue}var y=t[g],b=t[m];if(m<g){f=b;b=y;y=f}var x=r[y],A=r[b];var E=o.get(y),S=o.get(b);if(x+E<n-a&&A-S>n+a&&p(p(x+E-(n-a))-p(A-S-(n+a)))<=s){u=y;l=i,d=b;v=x+E+Math.abs(A-S-(x+E))/2;c=[x+E,v-a,v+a,A-S];h=true}else if(x+E<n-a&&A+S<n-a&&p(p(x+E-(A-S))-p(Math.max(x+E,A+S)-(n-a)))<=s){u=y;l=b;d=i;v=A+E+p(p(x+E-(A-S)))+a;c=[x+E,A-S,A+S,v-a];h=true}else if(x-E>n+a&&A-S>n+a&&p(p(x+E-(A-S))-p(Math.min(x-E,A-S)-(n+a)))<=s){u=i;l=y;d=b;v=x-E-p(p(x+E-(A-S)))-a;c=[v+a,x-E,x+E,A-S];h=true}}}return h?{a:u,b:l,c:d,current:i,target:v,points:c}:null};t.prototype.drawNeighbourGuidelines=function e(t,r,i){var n=t.a;var a=t.b;var o=t.c;var s=t.points;var u=t.target;var l={x:0,y:0};var d={x:0,y:0};var h=this._R,f=this._X,c=this._Y;var v=h.getMultiple([n,a,o]);var p=v[0];var g=v[1];var _=v[2];var m=this._options.neighbours;var y=m.offset;var b=m.lineWidth;var x=m.lineColor;var A,E;if(i){r.y=u;p=-p;g=-g;_=-_;A=d.x=l.x=Math.min(f[n]+p,f[a]+g,f[o]+_)-y;E=f}else{r.x=u;A=d.y=l.y=Math.max(c[n]+p,c[a]+g,c[o]+_)+y;E=c}var S=i?"y":"x";var w=i?"x":"y";l[S]=s[0];d[S]=s[1];this._drawLine(l,d,b,x);l[S]=s[2];d[S]=s[3];this._drawLine(l,d,b,x);l[S]=s[0];l[w]=A-y/2;d[S]=s[0];l[w]=E[n]+p;this._drawLine(l,d,b,x);l[S]=s[1];l[w]=A-y/2;d[S]=s[1];l[w]=E[a]+g;this._drawLine(l,d,b,x);l[S]=s[2];l[w]=A-y/2;d[S]=s[2];l[w]=E[a]+g;this._drawLine(l,d,b,x);l[S]=s[3];l[w]=A-y/2;d[S]=s[3];l[w]=E[o]+_;this._drawLine(l,d,b,x)};t.prototype._snap=function e(t,r,i){var n=this._xsnap;var a=this._ysnap;var o;if(!r&&n!==Qp.NONE){o=this._vguideline.end;if(n===Qp.LEFT){t.x=o.x+this._r}else if(n===Qp.RIGHT){t.x=o.x-this._r}else{t.x=o.x}}if(!i&&a!==Qp.NONE){o=this._hguideline.end;if(a===Qp.TOP){t.y=o.y+this._r}else if(a===Qp.BOTTOM){t.y=o.y-this._r}else{t.y=o.y}}};return t}(Ct);function $p(e,t,r,i){var n=0,a=e.length-1;var o,s,u;var l=Math.abs;while(n<a){o=(n+a)/2|0;s=l(t[e[o]]-r);u=l(t[e[o+1]]-r);if(u<=s){n=o+1}else{a=o}}return i?a:e[a]}var eg=function(){function e(e,t,r){var i=this;this._module=e;this._id=t;this._whenApplied=r.then(function(){return i})}e.prototype.getId=function(){return this._id};e.prototype.whenApplied=function(){return this._whenApplied};e.prototype.refresh=function(){return this._module.refreshRule(this._id)};e.prototype.getIndex=function(){return this._module.getRuleIndex(this._id)};e.prototype.setIndex=function(e){return this._module.setRuleIndex(this._id,e)};e.prototype.update=function(e){return this._module.updateRule(this._id,e)};e.prototype.getDefinition=function(){return this._module.getRuleDefinition(this._id)};e.prototype.destroy=function(){return this._module.destroyRule(this._id)};e.prototype.delete=function(){return this.destroy()};return e}();var tg=1e3;var rg=1/tg;var ig=function(e){l(t,e);function t(t){var r=e.call(this)||this;r._idCounter=1;r._rules=[];r._graphics=t.graphics;r._dom=t.dom;r._rules=[];return r}t.prototype._get=function(e){for(var t=0;t<this._rules.length;++t){var r=this._rules[t];if(r.id===e){r.index=t;return r}}throw new Error("calling a method on a destroyed style rule")};t.prototype._updatePriorities=function(){for(var e=0;e<this._rules.length;++e){var t=this._rules[e];var r=yl+e*rg;t.attributeLayer.update({priority:r})}};t.prototype.addRule=function(e){if(e===void 0){e={}}var t=this._idCounter++;var r=this._graphics.addAttributeLayer(Object.assign({name:"rule("+t+")"},ng(e)));var i=this._dom.afterNextFrame();var n=new eg(this,t,i);var a={id:t,attributeLayer:r,wrapper:n};this._rules.push(a);this._updatePriorities();return n};t.prototype.getRuleIndex=function(e){return this._get(e).index};t.prototype.setRuleIndex=function(e,t){var r=this._get(e);var i=Jt(t,0,this._rules.length-1);this._rules.splice(r.index,1);this._rules.splice(i,0,r);this._updatePriorities();return this._dom.afterNextFrame()};t.prototype.updateRule=function(e,t){var r=this._get(e);var i=Object.assign({fullOverwrite:t.fullOverwrite},ng(t));r.attributeLayer.update(i);return this._dom.afterNextFrame()};t.prototype.getRuleDefinition=function(e){var t=this._get(e);var r=t.attributeLayer.getDefinition();return ng(r)};t.prototype.destroyRule=function(e){var t=this._get(e);t.attributeLayer.destroy();this._rules.splice(t.index,1);return this._dom.afterNextFrame()};t.prototype.refreshRule=function(e){var t=this._get(e);t.attributeLayer.updateAll();return this._dom.afterNextFrame()};t.prototype.refreshAllRules=function(){for(var e=0;e<this._rules.length;e++){this._rules[e].attributeLayer.updateAll()}return this._dom.afterNextFrame()};t.prototype.getRuleList=function(){return this._rules.map(function(e){return e.wrapper})};return t}(Ct);function ng(e){return{nodeAttributes:e.nodeAttributes,edgeAttributes:e.edgeAttributes,nodeSelector:e.nodeSelector,edgeSelector:e.edgeSelector,nodeDependencies:e.nodeDependencies,edgeDependencies:e.edgeDependencies,nodeOutput:e.nodeOutput,edgeOutput:e.edgeOutput}}var ag={strokeColor:"#00C3FF",fillColor:"rgba(0,195,255,0.1)",strokeWidth:1,cursorStyle:"cell",callback:function(e){var t=e.nodes;return t.setSelected(true)},bothExtremities:false};var og=function(e){l(t,e);function t(t){var r=t.locate,i=t.graphics,n=t.captor,a=t.graph,o=t.spatial,s=t.interactions;var u=e.call(this)||this;u._enabled=false;u._points=[];u._bbox=new eo;u._locate=r;u._graph=a;u._graphics=i;u._captor=n;u._interactions=s;u._spatial=o;u._options=O(ag);u._canvas=Se();u._ctx=u._canvas.getContext("2d");u._interaction=u._interactions.onDrag({priority:"lasso",check:function(){return u._enabled},onStart:function(e){var t=e.x,r=e.y;u._bbox.reset();u.savePoint(t,r,false)},onProgress:function(e){var t=e.x,r=e.y;return u.savePoint(t,r,true)},onStop:function(){var e=u._bbox,t=e.minX,r=e.minY,i=e.maxX,n=e.maxY;var a=u._spatial.queryProjected(t,r,i,n),o=a.nodes,s=a.edges;var l={};var d=o.filter(function(e){var t=e.isVisible();var r=e.getAttribute("detectable");var i=t&&r&&u._locate.isNodeInPolygon(e,u._points);l[e._index]=i;return i});var h=s.filter(function(e){var t=e.isVisible();var r=e.getAttribute("detectable");return t&&r&&u._locate.isEdgeInPolygon(e,u._points)});if(u._options.bothExtremities){h=u.filterByExtremities(h,l)}u._ctx.clearRect(0,0,u._canvas.width,u._canvas.height);u._points=[];u.disable();u._options.callback({nodes:d,edges:h})}});return u}t.prototype.enable=function(e){if(this._enabled){return}this._enabled=true;this._captor.setDetectionEnabled(false);this._options=gr(e,ag);this._graphics.addCanvas(this._canvas);Ue(this._canvas,this._options.cursorStyle);if(this._captor.isLeftPressed()){this._interaction.start(this._captor.getCursorPosition())}return this};t.prototype.disable=function(){if(!this._enabled){return}this._enabled=false;this._captor.setDetectionEnabled(true);this._graphics.removeCanvas(this._canvas);return this};t.prototype.enabled=function(){return this._enabled};t.prototype.savePoint=function(e,t,r){var i=we();var n=this._ctx;var a=this._options;var o=this._points;this._bbox.addPoint(e,t);n.clearRect(0,0,this._canvas.width,this._canvas.height);o.push({x:e,y:t});if(r){var s=o[0];n.lineWidth=a.strokeWidth;n.lineJoin="bevel";n.strokeStyle=a.strokeColor;n.fillStyle=a.fillColor;n.beginPath();n.moveTo(s.x*i,s.y*i);for(var u=1;u<o.length;++u){var l=o[u];n.lineTo(l.x*i,l.y*i)}n.stroke();if(a.fillColor){n.fill()}}};t.prototype.filterByExtremities=function(e,t){var r=this._graph.getEdgeAttribute("source");var i=this._graph.getEdgeAttribute("target");return e.filter(function(e){var n=e._index;var a=r.get(n);var o=i.get(n);return t[a]&&t[o]})};return t}(Ct);var sg={strokeColor:"#00C3FF",fillColor:"rgba(0,195,255,0.1)",strokeWidth:1,cursorStyle:"cell",callback:function(e){var t=e.nodes,r=e.edges;if(t.size){t.setSelected(true)}else{r.setSelected(true)}},bothExtremities:false};var ug=function(e){l(t,e);function t(t){var r=e.call(this,t)||this;r._options=O(sg);r._canvas=Se();r._ctx=r._canvas.getContext("2d");r._enabled=false;r._start=null;r._rectangle=new eo;r._interaction=r._interactions.onDrag({priority:"lasso",disableDetection:true,check:function(){return r._enabled},onStart:function(e){var t=e.x,i=e.y;r._rectangle.reset();r._start={x:t,y:i};r._ctx.fillStyle=r._options.fillColor;r._ctx.strokeStyle=r._options.strokeColor;r._ctx.lineWidth=r._options.strokeWidth},onProgress:function(e){var t=e.x,i=e.y;return r._refreshRectangle({x:t,y:i})},onStop:function(){var e=r._captor.getCursorPosition();var t=r._formatRectangle(e);var i=r._spatial.queryProjected(t.minX,t.minY,t.maxX,t.maxY),n=i.nodes,a=i.edges;var o={};var s=n.filter(function(e){var i=e.isVisible();var n=e.getAttribute("detectable");var a=i&&n&&r._locate.isNodeInRectangle(e,t);o[e._index]=a;return a});var u=a.filter(function(e){var i=e.isVisible();var n=e.getAttribute("detectable");return i&&n&&r._locate.isEdgeInRectangle(e,t)});if(r._options.bothExtremities){u=r.filterByExtremities(u,o)}r._clearCanvas();r.disable();r._options.callback({nodes:s,edges:u})}});return r}t.prototype.enable=function(e){if(this._enabled){return}this._enabled=true;this._options=gr(e,sg);this._graphics.addCanvas(this._canvas);Ue(this._canvas,this._options.cursorStyle);if(this._captor.isLeftPressed()){this._interaction.start(this._captor.getCursorPosition())}};t.prototype.disable=function(){if(!this._enabled){return}this._enabled=false;this._graphics.removeCanvas(this._canvas);return this};t.prototype.enabled=function(){return this._enabled};t.prototype._clearCanvas=function(){this._ctx.clearRect(0,0,this._canvas.width,this._canvas.height)};t.prototype._formatRectangle=function(e){var t=this._start.x;var r=this._start.y;var i=e.x;var n=e.y;var a=Math.abs(t-i);var o=Math.abs(r-n);var s=t<i?t:i;var u=r<n?r:n;return this._rectangle.reset().addPoint(s,u).addPoint(s+a,u+o)};t.prototype._refreshRectangle=function(e){var t=this._formatRectangle(e),r=t.minX,i=t.minY,n=t.width,a=t.height;var o=we();this._clearCanvas();this._ctx.strokeRect(r*o,i*o,n*o,a*o);if(this._options.fillColor){this._ctx.fillRect(r*o,i*o,n*o,a*o)}};return t}(og);function lg(e,t,r,i,n,a,o,s){if(n===void 0){n=0}if(a===void 0){a=Math.sin(n)}if(o===void 0){o=Math.cos(n)}if(s===void 0){s=[0,0,0,0]}var u=r/2;var l=i/2;var d=e+u;var h=t+l;if(n===0){s[0]=e;s[1]=t;s[2]=e+r;s[3]=t+i;return s}var f,c,v,p;var g,_,m,y;v=-u;p=-l;f=d+v*o-p*a,c=h+v*a+p*o;g=m=f;_=y=c;v=-u;p=l;f=d+v*o-p*a;c=h+v*a+p*o;if(f<g){g=f}else if(f>m){m=f}if(c<_){_=c}else if(c>y){y=c}v=u;p=l;f=d+v*o-p*a;c=h+v*a+p*o;if(f<g){g=f}else if(f>m){m=f}if(c<_){_=c}else if(c>y){y=c}v=u;p=-l;f=d+v*o-p*a;c=h+v*a+p*o;if(f<g){g=f}else if(f>m){m=f}if(c<_){_=c}else if(c>y){y=c}s[0]=g;s[1]=_;s[2]=m;s[3]=y;return s}function dg(e,t,r,i,n){if(n===void 0){n=0}var a=r/2;var o=i/2;var s=e+a;var u=t+o;if(n===0){return[{x:e,y:t},{x:e+r,y:t},{x:e+r,y:t+i},{x:e,y:t+i}]}var l=Math.sin(n);var d=Math.cos(n);var h,f,c,v;c=-a;v=-o;h=s+c*d-v*l,f=u+c*l+v*d;var p={x:h,y:f};c=-a;v=o;h=s+c*d-v*l;f=u+c*l+v*d;var g={x:h,y:f};c=a;v=o;h=s+c*d-v*l;f=u+c*l+v*d;var _={x:h,y:f};c=a;v=-o;h=s+c*d-v*l;f=u+c*l+v*d;var m={x:h,y:f};return[p,g,_,m]}function hg(e,t,r,i){if(t===void 0){t=0}if(r===void 0){r=1}if(i===void 0){i=lu.slice()}var n=r*Math.sin(t);var a=r*Math.cos(t);i[0]=e[0]+n;i[1]=e[1]+a;i[2]=e[2]+n;i[3]=e[3]+a;return i}function fg(e,t){e.minX-=t;e.minY-=t;e.maxX+=t;e.maxY+=t;e.width+=2*t;e.height+=2*t;return e}function cg(e,t){return pg(e[0],e[1],e[2],e[3],t[0],t[1],t[2],t[3])}function vg(e,t,r,i,n,a,o,s){return e>n&&e<o&&(t>a&&t<s)||r>n&&r<o&&(i>a&&i<s)}function pg(e,t,r,i,n,a,o,s){return i>=a&&t<=s&&(r>=n&&e<=o)}function gg(e,t,r,i,n,a){return{minX:e,minY:t,maxX:r,maxY:i,leaf:true,level:a,parent:n,objects:[],final:false,children:null}}function _g(e){var t=e.minX,r=e.minY,i=e.maxX,n=e.maxY;return[t,r,i,n]}function mg(e,t,r,i,n,a,o,s){var u=(e+r)/2;var l=(t+i)/2;return u>=n&&u<=o&&(l>=a&&l<=s)}var yg=0;var bg=1;var xg=2;var Ag=3;function Eg(e,t,r,i,n,a,o,s){var u=(n+o)/2;var l=(a+s)/2;var d=(e+r)/2;var h=(t+i)/2;if(d<=u){return h<=l?yg:bg}else{return h<=l?Ag:xg}}var Sg=function(e){return e};var wg=function(){function e(e,t,r,i){if(e===void 0){e=Sg}if(t===void 0){t=10}if(i===void 0){i=0}this._nodeCapacity=10;this._root=null;this._objects={};this._size=0;this._rootLevel=0;this._maxLevel=30;this._idToCell={};this._nodeCapacity=t;this._root=null;this._getBBox=e;this._rootLevel=i;this._maxLevel=i+30;this._idToCell={};if(r){this._root=gg(r[0],r[1],r[2],r[3],null,i)}}Object.defineProperty(e.prototype,"size",{get:function(){return this._size},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"root",{get:function(){return this._root},enumerable:true,configurable:true});e.prototype.clear=function(){this._root=null;this._objects={};this._size=0;this._idToCell={};this._rootLevel=0;this._maxLevel=this._rootLevel+30;return this};e.prototype.insert=function(e,t,r){if(r===void 0){r=this._root}t=t||this._getBBox(e);if(this._objects[e]){return}this._objects[e]=true;this._size++;if(!this._root){var i=Math.max(Math.abs(t[2]-t[0]),Math.abs(t[3]-t[1]));this._root=gg(t[0],t[1],t[0]+i,t[1]+i,null,this._rootLevel);this._root.objects.push(e);return e}var n=[r];var a;var o=false;var s=this._nodeCapacity;var u=this._idToCell;var l=this._maxLevel;while(a=n.pop()){var d=a.minX,h=a.minY,f=a.maxX,c=a.maxY;if(pg(t[0],t[1],t[2],t[3],d,h,f,c)){if(a.leaf){if(a.objects.length<s||a.final){a.objects.push(e);if(u[e]){u[e].push(a)}else{u[e]=[a]}o=true;if(a.level>=l||Math.abs(f-d)<=Math.abs(t[2]-t[0])||Math.abs(c-h)<=Math.abs(t[3]-t[1])){a.final=true}}else{this.splitNode(a);n.push(a)}}else{n.push.apply(n,a.children)}}}if(o){return e}r=this._root;if(!mg(t[0],t[1],t[2],t[3],r.minX,r.minY,r.maxX,r.maxY)){var v=this._rootLevel;var p=(t[0]+t[2])/2;var g=(t[1]+t[3])/2;while(!mg(t[0],t[1],t[2],t[3],this._root.minX,this._root.minY,this._root.maxX,this._root.maxY)){r=this._root;var d=r.minX,h=r.minY,f=r.maxX,c=r.maxY;var _=d,m=h,y=f,b=c;var x=Math.abs(f-d);var A=Math.abs(c-h);if(A===0&&x===0){break}var E=Math.max(x,A);if(p<=d){_-=E}if(g<=h){m-=E}if(p>d){y+=E}if(g>h){b+=E}var S=gg(_,m,y,b,null,--v);this.splitNode(S);S.children[Eg(d,h,f,c,_,m,y,b)]=r;this._root=r.parent=S}n=[this._root];this._root.level=this._rootLevel;while(a=n.shift()){if(!a.leaf){for(var w=0;w<4;w++){var T=a.children[w];T.level=a.level+1;n.push(T)}}}}r=this._root;a=r.children[Eg(t[0],t[1],t[2],t[3],r.minX,r.minY,r.maxX,r.maxY)];if(a.leaf){a.objects.push(e);if(u[e]){u[e].push(a)}else{u[e]=[a]}}return e};e.prototype.removeById=function(e){if(!this._objects[e]){return e}this._size--;var t=this._idToCell[e];for(var r=0;r<t.length;r++){var i=t[r].objects;for(var n=0,a=i.length;n<a;n++){if(i[n]===e){i.splice(n,1);break}}}delete this._objects[e];delete this._idToCell[e];return e};e.prototype.remove=function(e){var t=this._getBBox(e),r=t[0],i=t[1],n=t[2],a=t[3];var o=[this._root];var s,u,l;while(s=o.pop()){if(pg(r,i,n,a,s.minX,s.minY,s.maxX,s.maxY)){if(s.leaf){var d=s.objects;for(var h=0,f=d.length;h<f;h++){if(d[h]===e){d.splice(h,1);if(f===1){l=l||[];l.push(s)}break}}}else{o.push.apply(o,s.children)}}}delete this._idToCell[e];delete this._objects[e];this._size--;if(l){while(u=l.pop()){var c=u.parent;var v=true;while(c&&v){if(!c.leaf){for(var h=0;h<4;h++){s=c.children[h];if(!s.leaf||s.objects.length!==0){v=false;break}}if(v){c.leaf=true;c.children=null;c.objects=[]}}c=c.parent}}}return e};e.prototype.splitNode=function(e){var t=e.minX,r=e.minY,i=e.maxX,n=e.maxY;var a=(t+i)/2;var o=(r+n)/2;var s=e.level+1;var u=this._idToCell;var l=this._maxLevel;var d=[gg(t,r,a,o,e,s),gg(t,o,a,n,e,s),gg(a,o,i,n,e,s),gg(a,r,i,o,e,s)];if(e.objects!==null){var h=e.objects;var f=this._getBBox;for(var c=0,v=h.length;c<v;c++){var p=h[c];var g=f(p);var _=u[p];for(var m=0;m<4;m++){var y=d[m];var b=y.minX,x=y.minY,A=y.maxX,E=y.maxY;if(pg(g[0],g[1],g[2],g[3],b,x,A,E)){y.objects.push(p);if(y.level>=l||Math.abs(A-b)<=Math.abs(g[2]-g[0])||Math.abs(E-x)<=Math.abs(g[3]-g[1])){y.final=true}if(_){_.push(y)}else{_=[y]}}}_.splice(_.indexOf(e),1)}}e.children=d;e.objects=null;e.leaf=false};e.prototype.point=function(e,t,r){var i=[];var n=[this._root];var a,o,s;var u=this._getBBox;while(a=n.pop()){if(e>=a.minX&&e<=a.maxX&&t>=a.minY&&t<=a.maxY){if(a.leaf){if(r){i=a.objects}var l=a.objects;for(var d=0,h=l.length;d<h;d++){s=l[d];o=u(s);if(e>=o[0]&&e<=o[2]&&t>=o[1]&&t<=o[3]){i.push(s)}}break}else{n.push.apply(n,a.children)}}}return i};e.prototype.neigbours=function(e,t){var r=[],i;var n=[this._root];while(i=n.pop()){if(e>=i.minX&&e<=i.maxX&&t>=i.minY&&t<=i.maxY){if(i.leaf){r=i.objects;break}else{n.push.apply(n,i.children)}}}return r};e.prototype.query=function(e,t,r,i){var n=[];var a=[this._root];var o,s,u;var l=this._getBBox;var d={};while(o=a.pop()){if(pg(e,t,r,i,o.minX,o.minY,o.maxX,o.maxY)){if(o.leaf){var h=o.objects;for(var f=0,c=h.length;f<c;f++){u=h[f];if(!d[u]){s=l(u);if(pg(e,t,r,i,s[0],s[1],s[2],s[3])){n.push(u)}d[u]=true}}}else{a.push.apply(a,o.children)}}}return n};e.prototype.getOverlaps=function(){var e=[this._root];var t,r,i;var n=[];var a=this._getBBox;var o={};while(t=e.pop()){if(t.leaf){var s=t.objects,u=s.length;for(var l=0;l<u;l++){for(var d=0;d<u;d++){r=s[l];i=s[d];if(l!==d&&!o[r+":"+i]&&!o[i+":"+r]){o[r+":"+i]=true;var h=a(r);var f=a(i);if(pg(h[0],h[1],h[2],h[3],f[0],f[1],f[2],f[3])){n.push(r,i)}}}}}else{e.push.apply(e,t.children)}}return n};e.prototype.getAll=function(){return Object.keys(this._objects).map(function(e){return Number(e)})};e.prototype.forEach=function(e,t){var r=[this._root];var i;while(i=r.pop()){if(i.leaf){for(var n=0,a=i.objects.length;n<a;n++){e.call(t,i.objects[n])}}else{r.push.apply(r,i.children)}}return this};e.prototype.getLeafs=function(){var e=[this._root],t=[];var r;while(r=e.pop()){if(r.leaf){t.push(r)}else{e.push.apply(e,r.children)}}return t};e.prototype.traverse=function(e,t){var r=[this._root];var i;while(i=r.pop()){if(!e.call(t,i,i.objects)&&!i.leaf){r.push.apply(r,i.children)}}return this};e.prototype.update=function(e){this.remove(e);this.insert(e,this._getBBox(e));return this};e.prototype.getNodeBounds=function(e){return _g(e)};e.flatAccessor=function(e,t){return function(r){var i=t*r;return e.slice(i,i+t)}};e.inside=mg;e.intersects=vg;e.overlaps=pg;e.getNodeBBox=_g;return e}();var Tg=6;var Cg=5;var Ig=1;var Mg={left:-1,right:1,top:0,bottom:0,center:0};var Lg={left:0,right:0,top:-1,bottom:1,center:0};var kg={left:-1,right:0,top:-1/2,bottom:-1/2,center:-1/2};var Ng={left:-1/2,right:-1/2,top:-1,bottom:0,center:-1/2};function Fg(e,t,r,i,n,a,o){var s=o.remove.nodes;var u=o.remove.edges;var l=o.redraw.nodes;var d=r.angle;var h=r.zoom;var f=r.sin;var c=r.cos;var v=i.x;var p=i.y;var g=i.radius;var _=i.layer;var m=i.innerStroke.width;var y=i.outerStroke.width;var x=i.scalingMethod;var A=i.text.content;var E=i.text.position;var S=i.text.size;var w=i.text.font;var T=i.text.style;var C=i.text.maxLineLength;var I=i.text.scaling;var M=i.text.scale;var L=i.text.minVisibleSize;var k=i.text.padding;var N=i.text.margin;var F=i.animationDuration;var z=i.textHidden;var R=i.excluded;b(e,_);var P,O;var D=[0,0,0,0];var B=[0,0,0,0,0];var V=o.bboxes,j=o.rects,U=o.intersects;for(var G=0,q=e.length;G<q;G++){P=e[G];var H=F.get(P);var W=A.get(P);if(W===null||W===""||H!==0){continue}var X=g.get(P);var Y=L.get(P);if(R.get(P)===1){s.push(P);continue}if(X*2*h<Y){if(z.get(P)===0){s.push(P)}continue}if(x.get(P)==="fixed"){X/=h}var Z=v.get(P);var K=p.get(P);if(typeof W==="number"){W=W.toString()}var Q=!I.get(P);var J=E.get(P);var $=k.get(P);var ee=M.get(P);var te=(Q?S.get(P):ee*X)*Ig;var re=T.get(P);var ie=w.get(P);var ne=C.get(P);var ae=Vo(W,ne).lines;var oe=$+m.get(P)+y.get(P)+N.get(P);var se=Mg[J];var ue=Lg[J];var le=n(W,ie,re,te).width/ae;var de=ae*te*Ig;var he=le/2/h;var fe=de/2/h;var ce=oe/h;var ve=kg[J]*le;var pe=Ng[J]*de;if(Q){ve/=h;pe/=h}ve=ve+se*ce+he+se*X;pe=pe+ue*ce+fe+ue*X;lg(Z-he,K-fe,le/h,de/h,-d,f,-c,D);B[0]=Z-he;B[1]=K-fe;B[2]=le/h;B[3]=de/h;B[4]=d;var ge=c*ve-f*pe;var _e=f*ve+c*pe;D[0]+=ge;D[1]+=_e;D[2]+=ge;D[3]+=_e;B[0]+=ge;B[1]+=_e;var me=t.query(D[0],D[1],D[2],D[3]);if(me.length!==0){var ye=false;var be=dg(B[0],B[1],B[2],B[3],B[4]);for(var xe=0;xe<me.length;xe++){var Ae=me[xe];var Ee=Ae*Cg;var Se=dg(j[Ee],j[Ee+1],j[Ee+2],j[Ee+3],j[Ee+4]);if(Lf(be,Se)){U.push(be,Se);ye=true;if(a){t.remove(Ae);if(V[Ae*Tg+4]===1){s.push(V[Ae*Tg+5])}else{u.push(V[Ae*Tg+5])}}else{break}}}if(ye&&!a){s.push(P);continue}}l.push(P);O=V.length/Tg;V.push(D[0],D[1],D[2],D[3],1,P);t.insert(O,D);j.push(B[0],B[1],B[2],B[3],B[4])}return o}var zg={x1:0,y1:0,x2:0,y2:0};var Rg={x:0,y:0};var Pg={x:0,y:0};var Og=Math.PI/2;var Dg=4;function Bg(e,t,r,i,n,a,o,s){var u=s.remove.nodes;var l=s.remove.edges;var d=s.redraw.edges;var h=r.angle;var f=r.zoom;var c=n.x;var v=n.y;var p=n.radius;var g=Math.PI;var _=i.source,m=i.target,y=i.scalingMethod;var x=i.width;var A=i.curvature;var E=i.layer;var S=i.text.content;var w=i.text.scaling;var T=i.text.size;var C=i.text.font;var I=i.text.style;var M=i.text.scale;var L=i.text.maxLineLength;var k=i.text.margin;var N=i.text.minVisibleSize;var F=i.animationDuration;b(e,E);var z,R;var P=[0,0,0,0];var O=[0,0,0,0,0];var D=s.bboxes,B=s.rects,V=s.intersects;for(var j=0,U=e.length;j<U;j++){z=e[j];var G=F.get(z);var q=S.get(z);if(q===null||q===""||G){continue}var H=_.get(z);var W=m.get(z);var X=x.get(z);var Y=A.get(z);var Z=N.get(z);if(X*f<Z){continue}if(y.get(z)==="fixed"){X/=f}var K=(c.get(H)+c.get(W))/2;var Q=(v.get(H)+v.get(W))/2;q=q.toString();var J=!w.get(z);var $=M.get(z);var ee=C.get(z);var te=(J?T.get(z):$*X)*Ig;var re=I.get(z);var ie=L.get(z);var ne=k.get(z);var ae=c.get(H);var oe=v.get(H);var se=c.get(W);var ue=v.get(W);var le=void 0;var de=H===W;if(de){le=g/4-h;tu(ae,oe,Y,p.get(H),0,zg);dl(.5,ae,oe,se,ue,zg.x1,zg.y1,zg.x2,zg.y2,Pg);K=Pg.x;Q=Pg.y;ne/=-f}else{if(ae===se&&oe===ue){continue}le=ju(ae,oe,se,ue)-h;if(Y!==0){le=ju(ae,oe,se,ue)-h;eu(ae,oe,se,ue,Y,Rg);ul(.5,ae,oe,se,ue,Rg.x,Rg.y,Pg);K=Pg.x;Q=Pg.y}}var he=ne+Dg;var fe=Vo(q,ie).lines;var ce=a(q,ee,re,te).width*Ig/fe;var ve=fe*te;var pe=ce/f/2;var ge=ve/f/2;var _e=Math.abs(le)<Og?1:-1;var me=de?ve/f+X/2:_e*(he/f+X/2+ge);O[0]=K-pe;O[1]=Q-ge;O[2]=K+pe;O[3]=Q+ge,O[4]=le+h;hg(O,-(le+h),-me,O);O[2]=O[2]-O[0];O[3]=O[3]-O[1];le=g-le-h;lg(K-pe,Q-ge,pe*2,ge*2,le,undefined,undefined,P);hg(P,le,me,P);var ye=t.query(P[0],P[1],P[2],P[3]);if(ye.length){var be=false;var xe=dg(O[0],O[1],O[2],O[3],O[4]);for(var Ae=0;Ae<ye.length;Ae++){var Ee=ye[Ae];var Se=Ee*Cg;var we=dg(B[Se],B[Se+1],B[Se+2],B[Se+3],B[Se+4]);if(Lf(xe,we)){be=true;V.push(xe,we);if(o){t.remove(Ee);if(D[Ee*Tg+4]===1){u.push(D[Ee*Tg+5])}else{l.push(D[Ee*Tg+5])}}else{break}}}if(be&&!o){l.push(z);continue}}d.push(z);R=D.length/Tg;D.push(P[0],P[1],P[2],P[3],0,z);t.insert(R,P);B.push(O[0],O[1],O[2],O[3],O[4])}return s}function Vg(e,t,r,i){if(i===void 0){i="#22ff00"}return jg([[e[0],e[1]],[e[2],e[1]],[e[2],e[3]],[e[0],e[3]]].map(function(e){return{x:e[0],y:e[1]}}),t,r,i)}function jg(e,t,r,i){if(i===void 0){i="#ff0000"}t.strokeStyle=i;t.lineWidth=1;t.beginPath();var n=we();for(var a=0,o=e.length;a<o;a++){var s=r.graphToScreenCoordinates(e[a]);if(a===0){t.moveTo(s.x*n,s.y*n)}else{t.lineTo(s.x*n,s.y*n)}}t.closePath();t.stroke()}function Ug(e,t,r,i,n,a){e.clearRect(0,0,t.width,t.height);for(var o=0,s=i.length;o<s;o+=Tg){Vg(i.slice(o,o+4),e,r,"#aaaaaa")}for(var o=0;o<n.length;o+=Cg){var u=dg(n[o],n[o+1],n[o+2],n[o+3],n[o+4]);jg(u,e,r,"green")}a.forEach(function(t){return jg(t,e,r,"red")})}var Gg=5;var qg="topDown";var Hg="bottomUp";var Wg=.25;var Xg=200;var Yg=80;var Zg=["x","y","radius","width","text.content","text.minVisibleSize","text.size","text.scale","text.scaling","text.padding","text.margin","text.position","text.style"];var Kg=function(e){l(t,e);function t(t,r){var i;var n=t.graph,a=t.graphics,o=t.camera,s=t.events,u=t.settings,l=t.sync,d=t.spatial;var h=e.call(this)||this;h._textBBoxes=[];h._rects=[];h._enabled=false;h._intersects=[];h._onZoomStart=I(function(e){var t=e.startZoom,r=e.endZoom;if(h._enabled&&r<t){h._updateLabels(r)}},Yg);h._onAttributesChanged=function(e){if(e.edgeAttributes.concat(e.nodeAttributes).some(function(e){return Zg.includes(e)})){h._update()}};h._onItemsAdded=function(e){var t=e.nodes||e.edges;if((h._enabled||h._forceEnabled)&&h._settings.get("texts.preventOverlap")){h._graphics.setTextHidden(t,true)}};h._measureText=function(e,t,r,i){return h._engine.measureText(e,t,r,i)};h._graph=n;h._graphics=a;h._camera=o;h._events=s;h._settings=u;h._sync=l;h._spatial=d;h._engine=a.getGraphicsEngine();h._textQuad=new wg(function(e){var t=Tg;var r=t*e;return h._textBBoxes.slice(r,r+t)},Gg);if(!!r.forceEnableTextOverlapRemoval){h.forceEnable()}h._events.register(["labelCollisionsRemoved"]);h.setRate(Xg);u.register("texts.preventOverlap",true,function(e){return h._onToggle(e)});u.register("texts.debug",false,function(e){return h._toggleDebug(e)});u.register("texts.removalStrategy",qg);h._events.on((i={"addNodes addEdges":h._onItemsAdded},i[It.VIEW_CHANGED]=function(e){return h._update()},i.updateAttributes=h._onAttributesChanged,i.setContainer=function(e){var t=e.element;if(t){return h._enable()}h._disable()},i[It.START_ZOOM]=h._onZoomStart,i));return h}t.prototype.getTextsBoundingBox=function(){this._updateLabels();var e=this._rects;var t=this._textBBoxes;var r=new eo;var i=this._graphics.getNodeAttributes();var n=this._graphics.getEdgeAttributes();var a=i.excluded;var o=n.excluded;for(var s=0;s<e.length;s++){var u=s*Cg;var l=t[s*Tg+4]===1;var d=t[s*Tg+4];var h=l?a.get(d):o.get(d);if(h){continue}var f=e[u];var c=e[u+1];var v=e[u+2];var p=e[u+3];var g=e[u+4];var _=lg(f,c,v,p,g),m=_[0],y=_[1],b=_[2],x=_[3];r.addPoint(m,y).addPoint(b,x)}return r};t.prototype.setRate=function(e){var t=this;this._updateDebounced=this._sync.debounceIdle(function(e){return t._updateLabels(e)},e)};t.prototype.forceEnable=function(){this._forceEnabled=true};t.prototype.update=function(){this._update()};t.prototype.forceUpdate=function(){this._updateLabels()};t.prototype._onToggle=function(e){if(e){this._update()}else{this._reset()}return this};t.prototype._update=function(){if(this._enabled||this._forceEnabled){this._updateDebounced()}};t.prototype._enable=function(){this._enabled=true;this._update()};t.prototype._disable=function(){this._textBBoxes=[];this._rects=[];this._intersects=[];this._enabled=false};t.prototype._toggleDebug=function(e){if(e){this._canvas=Se();this._graphics.addCanvas(this._canvas);this._ctx=this._canvas.getContext("2d");this._update()}else if(this._canvas){this._graphics.removeCanvas(this._canvas);this._canvas=this._ctx=null}};t.prototype._onCameraMove=function(){this._update()};t.prototype._updateLabels=function(e){if(e===void 0){e=this._camera.getZoom()}if(!this._settings.get("texts.preventOverlap")){return}var t=this._graphics.getNodeAttributes();var r=this._graphics.getEdgeAttributes();this._intersects=[];this._textBBoxes=[];this._rects=[];var i=this._textQuad.clear();var n=this._camera.getAngle();var a=this._camera.getProjectedScreenBounds(Wg);var o=this._settings.get("texts.removalStrategy")===Hg;var s={angle:n,zoom:e,screen:a,sin:Math.sin(n),cos:Math.cos(n)};var u={remove:{nodes:[],edges:[]},redraw:{nodes:[],edges:[]},rects:this._rects,bboxes:this._textBBoxes,intersects:this._intersects};var l=this._spatial.queryRaw(a[0],a[1],a[2],a[3]),d=l.nodes,h=l.edges;if(d.length+h.length===0){return}Fg(d,i,s,t,this._measureText,o,u);Bg(h,i,s,r,t,this._measureText,o,u);this._clearOverlaps(u);if(this._settings.get("texts.debug")){this.drawAll()}};t.prototype._clearOverlaps=function(e){var t=this._graph.nodeList;var r=this._graph.edgeList;var i=t(new Uint32Array(e.remove.nodes));var n=r(new Uint32Array(e.remove.edges));var a=t(new Uint32Array(e.redraw.nodes));var o=r(new Uint32Array(e.redraw.edges));this._graphics.setTextHidden(i,true);this._graphics.setTextHidden(n,true);this._graphics.setTextHidden(a,false);this._graphics.setTextHidden(o,false);this._events.fire("labelCollisionsRemoved",e)};t.prototype._reset=function(){this._graphics.resetTextHidden()};t.prototype.drawAll=function(){Ug(this._ctx,this._canvas,this._camera,this._textBBoxes,this._rects,this._intersects)};return t}(Ct);var Qg=function(){};var Jg=function(){return false};var $g=function(){function e(e){var t=e.captor,r=e.events;var i=this;this._current=null;this._onStartInteractionEvent=function(e,t){if(i._current){return}var r=i._interactionsByStartEvent[t];var n=null;for(var a=0,o=r;a<o.length;a++){var s=o[a];var u=s.check(e);if(u&&(!n||s.priority>=n.priority)){n=s}}if(n){i._startInteraction(n,e)}};this._onProgressInteractionEvent=function(e,t){if(i._current&&i._current.progressEventName===t){i._current.onProgress(e)}};this._onStopInteractionEvent=function(e,t){if(i._current&&i._current.stopEventName===t){i._stopCurrentInteraction(null)}};this._captor=t;this._events=r;this._interactionsByStartEvent={};this._boundProgressEvents={};this._boundStopEvents={}}e.prototype._startInteraction=function(e,t){e.onStart(t);if(e.onStop){this._current=e;if(e.disableDetection){this._captor.setDetectionEnabled(false)}}};e.prototype._stopCurrentInteraction=function(e){if(this._current.disableDetection){this._captor.setDetectionEnabled(true)}this._current.onStop(e);this._current=null};e.prototype._forceStartInteraction=function(e,t){if(this._current){this._stopCurrentInteraction(t)}this._startInteraction(e,t)};e.prototype._createWrapper=function(e){var t=this;return{start:function(r){return t._forceStartInteraction(e,r)}}};e.prototype._addInteraction=function(e,t){var r=this._interactionsByStartEvent[e];if(r){r.push(t)}else{this._interactionsByStartEvent[e]=[t];this._events.on(e,this._onStartInteractionEvent)}return this._createWrapper(t)};e.prototype._createProgressiveInteraction=function(e,t,r,i){var n={priority:e_(i.priority),check:i.check||Jg,onStart:i.onStart||Qg,onProgress:i.onProgress||Qg,onStop:i.onStop||Qg,disableDetection:!!i.disableDetection,progressEventName:t,stopEventName:r};if(!this._boundProgressEvents[t]){this._boundProgressEvents[t]=true;this._events.on(t,this._onProgressInteractionEvent)}if(!this._boundStopEvents[r]){this._boundStopEvents[r]=true;this._events.on(r,this._onStopInteractionEvent)}return this._addInteraction(e,n)};e.prototype._createNonProgressiveInteraction=function(e,t){return this._addInteraction(e,{priority:e_(t.priority),check:t.check||Jg,onStart:t.handler||Qg,onProgress:null,onStop:null,disableDetection:false,progressEventName:null,stopEventName:null})};e.prototype.onDrag=function(e){return this._createProgressiveInteraction(It.DRAG_START,It.DRAG_PROGRESS,It.DRAG_END,e)};e.prototype.onGesture=function(e){return this._createProgressiveInteraction(It.GESTURE_START,It.GESTURE_PROGRESS,It.GESTURE_END,e)};e.prototype.onClick=function(e){return this._createNonProgressiveInteraction(It.CLICK,e)};e.prototype.onDoubleClick=function(e){return this._createNonProgressiveInteraction(It.DOUBLE_CLICK,e)};e.prototype.onHover=function(e){return this._createNonProgressiveInteraction(It.HOVER,e)};e.prototype.onUnhover=function(e){return this._createNonProgressiveInteraction(It.UNHOVER,e)};e.prototype.onMouseWheel=function(e){return this._createNonProgressiveInteraction(It.WHEEL,e)};e.prototype.onMouseDown=function(e){return this._createNonProgressiveInteraction(It.DOWN,e)};e.prototype.onMouseUp=function(e){return this._createNonProgressiveInteraction(It.UP,e)};e.prototype.onMouseMove=function(e){return this._createNonProgressiveInteraction(It.MOVE,e)};return e}();function e_(e){if(typeof e==="string"){return Bl.indexOf(e)}if(typeof e==="number"&&!isNaN(e)){return e}return 0}var t_;(function(e){e["MOUSE"]="mouse";e["TOUCH"]="touch"})(t_||(t_={}));var r_;(function(e){e["LEFT"]="left";e["MIDDLE"]="middle";e["RIGHT"]="right"})(r_||(r_={}));var i_=function(e){l(t,e);function t(t){var r=e.call(this)||this;r._elt=null;r._hoveredElt=null;r._draggedElt=null;r._hover=false;r._disabledCounter=0;r._x=0;r._y=0;r._accDx=0;r._accDy=0;r._timeout=null;r._buttons={left:{isPressed:false,isDragging:false},middle:{isPressed:false,isDragging:false},right:{isPressed:false,isDragging:false}};r._dom=t.dom;r._graphics=t.graphics;r._events=t.events;r._settings=t.settings;r._spatial=t.spatial;r._events.register([It.MOVE,It.DOWN,It.UP,It.CLICK,It.DOUBLE_CLICK,It.HOVER,It.UNHOVER,It.WHEEL,It.DRAG_START,It.DRAG_PROGRESS,It.DRAG_END,It.GESTURE_START,It.GESTURE_PROGRESS,It.GESTURE_END]);r._settings.register("detect.nodes",true).register("detect.edges",true).register("detect.nodeTexts",true).register("detect.edgeTexts",true).register("detect.nodeErrorMargin",5).register("detect.edgeErrorMargin",7).register("detect.enableSpatialIndex",true).register("detect.spatialIndexMarginRatio",3);r._events.on({"removeNodes removeEdges clear":function(){return r._onGraphChanged()},"mouseMove touchMove virtualMove":function(e,t){var i=e.domEvent,n=e.x,a=e.y;r._onMove({domEvent:i,x:n,y:a,source:n_(t)})},"mouseDown touchDown virtualDown":function(e,t){var i=e.domEvent,n=e.x,a=e.y,o=e.button,s=o===void 0?r_.LEFT:o;r._onDown({domEvent:i,x:n,y:a,button:s,source:n_(t)})},"mouseUp touchUp virtualUp":function(e,t){var i=e.domEvent,n=e.x,a=e.y,o=e.button,s=o===void 0?r_.LEFT:o;r._onUp({domEvent:i,x:n,y:a,button:s,source:n_(t)})},"mouseClick touchTap virtualClick":function(e,t){var i=e.domEvent,n=e.x,a=e.y,o=e.button,s=o===void 0?r_.LEFT:o;r._onClick({domEvent:i,x:n,y:a,button:s,source:n_(t)})},"mouseDoubleClick touchDoubleTap virtualDoubleClick":function(e,t){var i=e.domEvent,n=e.x,a=e.y,o=e.button,s=o===void 0?r_.LEFT:o;r._onDoubleClick({domEvent:i,x:n,y:a,button:s,source:n_(t)})},"mouseWheel virtualWheel":function(e){var t=e.domEvent,i=e.x,n=e.y,a=e.delta;r._onWheel({domEvent:t,x:i,y:n,delta:a,source:t_.MOUSE})},touchStartGesture:function(e){return r._events.fire(It.GESTURE_START,e)},touchProgressGesture:function(e){return r._events.fire(It.GESTURE_PROGRESS,e)},touchEndGesture:function(e){return r._events.fire(It.GESTURE_END,e)},documentMouseMove:function(e,t){var i=e.domEvent,n=e.x,a=e.y;r._onDocumentMove({domEvent:i,x:n,y:a,source:n_(t)})},documentMouseUp:function(e,t){var i=e.domEvent,n=e.x,a=e.y,o=e.button,s=o===void 0?r_.LEFT:o;r._onDocumentUp({domEvent:i,x:n,y:a,source:n_(t),button:s})}});return r}t.prototype.triggerUnhover=function(){this._hover=false;this._hoveredElt=null};t.prototype.triggerDetection=function(){this._detectElement(this._x,this._y);if(this._elt){this._hoveredElt=this._elt;this._hover=true}};t.prototype.getElementAt=function(e,t){var r=e.x,i=e.y;return this._detectElementAt(r,i,t)};t.prototype.getPointedElement=function(){return this._hoveredElt};t.prototype.getDraggedElement=function(){return this._draggedElt};t.prototype.isAnyButtonPressed=function(){return this._buttons[r_.LEFT].isPressed||this._buttons[r_.RIGHT].isPressed||this._buttons[r_.MIDDLE].isPressed};t.prototype.isAnyButtonDragging=function(){return this._buttons[r_.LEFT].isDragging||this._buttons[r_.RIGHT].isDragging||this._buttons[r_.MIDDLE].isDragging};t.prototype.isButtonPressed=function(e){return this._buttons[e].isPressed};t.prototype.isLeftPressed=function(){return this.isButtonPressed(r_.LEFT)};t.prototype.getCursorPosition=function(){return{x:this._x,y:this._y}};t.prototype.getCursorInformation=function(){return{x:this._x,y:this._y,target:this._hoveredElt}};t.prototype.setDetectionEnabled=function(value){this._disabledCounter=Math.max(0,this._disabledCounter+(value?-1:1))};t.prototype._resetCurrent=function(e,t){var r=null;for(var i in this._buttons){var n=this._buttons[i];if(n.isDragging){this._events.fire(It.DRAG_END,{domEvent:r,x:e,y:t,button:i,target:this._draggedElt})}n.isPressed=false;n.isDragging=false}if(this._hover&&this._hoveredElt){this._events.fire(It.UNHOVER,{domEvent:r,x:e,y:t,target:this._hoveredElt})}this._hover=false;this._hoveredElt=null;this._draggedElt=null};t.prototype._onMove=function(e){var t=e.domEvent,r=e.x,i=e.y,n=e.source;var a=this._setPointerPosition(r,i),o=a.dx,s=a.dy;this._events.fire(It.MOVE,{domEvent:t,x:r,y:i,dx:o,dy:s,source:n});for(var u in this._buttons){var l=this._buttons[u];if(l.isPressed){if(!l.isDragging){l.isDragging=true;if(this._hoveredElt){if(this._hover){this._events.fire(It.UNHOVER,{domEvent:t,x:r,y:i,source:n,target:this._hoveredElt});this._hover=false}}if(!this._draggedElt){this._draggedElt=this._hoveredElt}this._storeDXY(o,s);this._events.fire(It.DRAG_START,{domEvent:t,x:r,y:i,button:u,source:n,target:this._draggedElt})}else{var d=this._getStoredDXY();o+=d.dx;s+=d.dy;this._events.fire(It.DRAG_PROGRESS,{domEvent:t,x:r,y:i,dx:o,dy:s,button:u,source:n,target:this._draggedElt})}}}if(!t||this._graphics.getDomElement().contains(t.target)){this._detectElement(r,i)}if(this._elt!==this._hoveredElt){if(this._hoveredElt&&this._hover){this._hover=true;this._events.fire(It.UNHOVER,{domEvent:t,x:r,y:i,source:n,target:this._hoveredElt})}this._hoveredElt=this._elt;if(this._elt){this._hover=true;this._events.fire(It.HOVER,{domEvent:t,x:r,y:i,source:n,target:this._hoveredElt})}}};t.prototype._onDocumentMove=function(e){var t=e.domEvent,r=e.x,i=e.y,n=e.source;for(var a in this._buttons){var o=this._buttons[a].isDragging;if(o){var s=this._setPointerPosition(r,i),u=s.dx,l=s.dy;this._events.fire(It.DRAG_PROGRESS,{domEvent:t,x:r,y:i,dx:u,dy:l,button:a,source:n,target:this._draggedElt})}}};t.prototype._onDocumentUp=function(e){var t=e.domEvent,r=e.x,i=e.y,n=e.source,a=e.button;if(this._buttons[a].isDragging){this._events.fire(It.DRAG_END,{domEvent:t,x:r,y:i,button:a,source:n,target:this._draggedElt});var o=this._buttons[a];o.isDragging=false;o.isPressed=false;if(!this.isAnyButtonDragging()){this._draggedElt=null}}};t.prototype._onDown=function(e){var t=e.domEvent,r=e.x,i=e.y,n=e.button,a=e.source;this._detectElement(r,i);if(this._elt!==this._hoveredElt){this._resetCurrent(r,i)}var o=this._buttons[n];this._hoveredElt=this._elt;o.isPressed=true;this._events.fire(It.DOWN,{domEvent:t,x:r,y:i,button:n,source:a,target:this._hoveredElt})};t.prototype._onDoubleClick=function(e){var t=e.domEvent,r=e.x,i=e.y,n=e.button,a=e.source;if(s_(t,"doubleclick")){return}this._events.fire(It.DOUBLE_CLICK,{domEvent:t,x:r,y:i,button:n,source:a,target:this._hoveredElt})};t.prototype._onUp=function(e){var t=e.domEvent,r=e.x,i=e.y,n=e.button,a=e.source;var o=this._buttons[n];if(!o.isPressed){return}if(o.isDragging){this._events.fire(It.DRAG_END,{domEvent:t,x:r,y:i,button:n,source:a,target:this._draggedElt});o.isDragging=false;if(!this.isAnyButtonDragging()){this._draggedElt=null}}o.isPressed=false;this._detectElement(r,i);this._events.fire(It.UP,{domEvent:t,x:r,y:i,button:n,source:a,target:this._elt});if(!this.isAnyButtonPressed()&&!this._hover&&a!==t_.TOUCH){this._hoveredElt=this._elt;if(this._hoveredElt){this._events.fire(It.HOVER,{domEvent:t,x:r,y:i,source:a,target:this._hoveredElt});this._hover=true}}};t.prototype._onClick=function(e){var t=e.domEvent,r=e.x,i=e.y,n=e.button,a=e.source;if(s_(t,"click")){return}this._events.fire(It.CLICK,{domEvent:t,x:r,y:i,button:n,source:a,target:this._hoveredElt})};t.prototype._onWheel=function(e){var t=e.domEvent,r=e.x,i=e.y,n=e.delta,a=e.source;this._x=r;this._y=i;this._events.fire(It.WHEEL,{domEvent:t,x:r,y:i,delta:n,source:a,target:this._hoveredElt})};t.prototype._onGraphChanged=function(){var e=this;this._resetCurrent(this._x,this._y);if(!this._timeout){this._timeout=this._dom.setTimeout(function(){e._onMove({x:e._x,y:e._y,source:null});e._timeout=null},0)}};t.prototype._storeDXY=function(e,t){this._accDx=e;this._accDy=t};t.prototype._getStoredDXY=function(){var e=this._accDx;var t=this._accDy;this._accDx=0;this._accDy=0;return{dx:e,dy:t}};t.prototype._setPointerPosition=function(e,t){var r=e-this._x;var i=t-this._y;this._x=e;this._y=t;this._accDx=0;this._accDy=0;return{dx:r,dy:i}};t.prototype._detectElement=function(e,t,r){this._elt=this._detectElementAt(e,t,r)};t.prototype._detectElementAt=function(e,t,r){if(this._disabledCounter!==0){return null}var i=this._settings;var n=i.get("detect.enableSpatialIndex");var a=i.get("detect.nodeErrorMargin");var o=i.get("detect.edgeErrorMargin");var s=i.get("detect.nodes");var u=i.get("detect.edges");var l=null;var d,h;if(!r&&n){if(s||u){var f=i.get("detect.spatialIndexMarginRatio");var c=Math.max(a*f,o*f);var v=this._spatial.queryRawProjected(e-c,t-c,e+c,t+c);d=v.nodes;h=v.edges}}if(s){l=this._graphics.detectNode({x:e,y:t,indexes:d,margin:a,texts:i.get("detect.nodeTexts")})}if(!l&&u){l=this._graphics.detectEdge({x:e,y:t,indexes:h,margin:o,texts:i.get("detect.edgeTexts")})}return l};return t}(Ct);function n_(e){return e.indexOf(t_.TOUCH)===0?t_.TOUCH:t_.MOUSE}var a_=false;var o_={down:{trigger:"pointerdown",duplicate:"mousedown"},click:{trigger:"pointerdown",duplicate:"mouseup"},doubleclick:{trigger:"pointerdown",duplicate:"mouseup"}};function s_(e,t){if(!e){return}if(e.type===o_[t].trigger){a_=true}if(e.type===o_[t].duplicate&&a_){a_=false;return true}}var u_=function(e){l(t,e);function t(t){var r=t.graph,i=t.graphics,n=t.camera,a=t.selection,o=t.events,s=t.captor,u=t.individualAttributes,l=t.interactions,d=t.classes,h=t.settings;var f=e.call(this)||this;f._dragged=null;f._start=null;f._end=null;f._startDrag=null;f._shouldDrag=function(e){var t=e.target,r=e.button;var i=r===Qv.LEFT;var n=f._settings.get("interactions.drag.enabled");var a=t!==null&&t.isNode&&t.getAttribute("draggable")===true;return i&&n&&a};f._onDragStart=function(e){var t=e.x,r=e.y,i=e.target;if(i.isSelected()){f._dragged=f._selection.getSelectedNodes().filter(function(e){return e.getAttribute("draggable")})}else{f._dragged=i.toList()}f._start=f._dragged.getPosition();f._end=O(f._start);f._onBeforeDrag=f._settings.get("interactions.drag.onBeforeDrag");f._startDrag=f._camera.screenToGraphCoordinates({x:t,y:r});f._dragged.addClass(Ml);f._events.fire(It.NODES_DRAG_START,{nodes:f._dragged});f._graphics.addCursorStyle(f._settings.get("interactions.drag.cursor"))};f._onDrag=function(){var e=f._captor.getCursorInformation(),t=e.x,r=e.y;var i=f._dragged._indexes;var n=f._camera.screenToGraphCoordinates({x:t,y:r});var a=n.x-f._startDrag.x;var o=n.y-f._startDrag.y;for(var s=0;s<i.length;++s){var u=f._start[s];var l=f._end[s];l.x=u.x+a;l.y=u.y+o}if(f._onBeforeDrag){f._onBeforeDrag(f._dragged,t,r,f._end)}if(f._settings.get("interactions.drag.applyResult")){f._attributes.setMultipleAttributes(f._dragged,f._end,null,["x","y"])}f._events.fire(It.NODES_DRAG_PROGRESS,{nodes:f._dragged,dx:a,dy:o})};f._onDragEnd=function(){f._dragged.removeClass(Ml);f._graphics.removeCursorStyle(f._settings.get("interactions.drag.cursor"));f._events.fire(It.NODES_DRAG_END,{nodes:f._dragged,start:f._start,end:f._end});f._dragged=null;f._start=null;f._end=null};f._camera=n;f._graphics=i;f._selection=a;f._events=o;f._settings=h;f._captor=s;f._attributes=u;f._interactions=l;d.createClass({name:Ml,isBuiltin:true,nodeAttributes:{layer:Ol}});o.register([It.NODES_DRAG_START,It.NODES_DRAG_PROGRESS,It.NODES_DRAG_END]);h.register("interactions.drag.enabled",true);h.register("interactions.drag.cursor","move");h.register("interactions.drag.onBeforeDrag",null);h.register("interactions.drag.applyResult",true);f._interactions.onDrag({priority:"drag",disableDetection:true,check:f._shouldDrag,onStart:f._onDragStart,onProgress:f._onDrag,onStop:f._onDragEnd});return f}return t}(Ct);var l_=function(e){var t=e.graphWidth,r=e.graphHeight,i=e.viewWidth,n=e.viewHeight;return Math.min(i/t,n/r)*.2};var d_=function(e){var t=e.smallestNodeSize,r=e.viewWidth,i=e.viewHeight;if(t===Infinity){return Infinity}return Math.min(r,i)/t*.5};var h_;(function(e){e["ROTATION"]="rotation";e["PAN"]="pan";e["ZOOM"]="zoom";e["GESTURE"]="gesture"})(h_||(h_={}));var f_=function(e){l(t,e);function t(t,r){var i=t.locate,n=t.dom,a=t.camera,o=t.graphics,s=t.settings,u=t.interactions;var l=e.call(this)||this;l._zoomWheelEnabled=true;l._locate=i;l._dom=n;l._camera=a;l._settings=s;l._interactions=u;l._graphics=o;l._settings.register("interactions.zoom.enabled",true);l._settings.register("interactions.zoom.onDoubleClick",false);l._settings.register("interactions.zoom.duration",150);l._settings.register("interactions.zoom.modifier",1.8);l._settings.register("interactions.zoom.easing","quadraticOut");l._settings.register("interactions.zoom.minValue",r?null:l_);l._settings.register("interactions.zoom.maxValue",r?null:d_);l._settings.register("interactions.zoom.hideNodes",false);l._settings.register("interactions.zoom.hideEdges",false);l._settings.register("interactions.zoom.hideNodeTexts",false);l._settings.register("interactions.zoom.hideEdgeTexts",false);l._settings.register("interactions.pan.enabled",true);l._settings.register("interactions.pan.hideNodes",false);l._settings.register("interactions.pan.hideEdges",false);l._settings.register("interactions.pan.hideNodeTexts",false);l._settings.register("interactions.pan.hideEdgeTexts",false);l._settings.register("interactions.rotation.enabled",true);l._settings.register("interactions.rotation.hideNodes",false);l._settings.register("interactions.rotation.hideEdges",false);l._settings.register("interactions.rotation.hideNodeTexts",false);l._settings.register("interactions.rotation.hideEdgeTexts",false);l._settings.register("interactions.gesture.enabled",true);l._settings.register("interactions.gesture.hideNodes",false);l._settings.register("interactions.gesture.hideEdges",false);l._settings.register("interactions.gesture.hideNodeTexts",false);l._settings.register("interactions.gesture.hideEdgeTexts",false);l._setupInteractions();return l}t.prototype._setupInteractions=function(){var e=this;this._interactions.onMouseWheel({priority:"zoom",check:function(){return e._settings.get("interactions.zoom.enabled")},handler:I(function(t){var r=t.x,i=t.y,n=t.delta;return e._smoothZoom(n,r,i)},50)});this._interactions.onDoubleClick({priority:"zoom",check:function(){var t=e._settings.get("interactions.zoom.enabled");var r=e._settings.get("interactions.zoom.onDoubleClick");return t&&r},handler:function(t){var r=t.x,i=t.y;return e._smoothZoom(1,r,i)}});this._interactions.onDrag({priority:"panning",disableDetection:true,check:function(t){var r=t.button;var i=e._settings.get("interactions.pan.enabled");return r==="left"&&i},onStart:function(){return e._updateVisibility(h_.PAN,true)},onProgress:function(t){var r=t.dx,i=t.dy;e._camera.move({x:-r,y:-i})},onStop:function(){return e._updateVisibility(h_.PAN,false)}});this._interactions.onDrag({priority:"rotation",disableDetection:true,check:function(t){var r=t.button,i=t.domEvent;return(r==="right"||i&&i.buttons===2)&&e._settings.get("interactions.rotation.enabled")},onStart:function(t){var r=t.x,i=t.y;e._rotationStart={x:r,y:i};e._updateVisibility(h_.ROTATION,true)},onProgress:function(t){var r=t.x,i=t.y;e._rotate({x:r,y:i})},onStop:function(){return e._updateVisibility(h_.ROTATION,false)}});this._interactions.onGesture({priority:"gesture",disableDetection:true,check:function(){return e._settings.get("interactions.gesture.enabled")},onStart:function(){return e._updateVisibility(h_.GESTURE,true)},onProgress:function(t){var r=t.dx,i=t.dy,n=t.rotation,a=t.scale,o=t.x,s=t.y;if(e._settings.get("interactions.rotation.enabled")){e._camera.rotate(-n)}e._camera.zoomIn(a,undefined,{refX:o,refY:s});e._camera.move({x:-r,y:-i})},onStop:function(){return e._updateVisibility(h_.GESTURE,true)}})};t.prototype._rotate=function(e){var t=e.x,r=e.y;var i=this._camera.getSize(),n=i.width,a=i.height;var o=n/2;var s=a/2;var u=this._rotationStart.x-o;var l=this._rotationStart.y-s;var d=t-o;var h=r-s;var f=Math.atan2(l,u)-Math.atan2(h,d);this._rotationStart={x:t,y:r};this._camera.rotate(f)};t.prototype._updateVisibility=function(e,t){var value=!t;var r=this._settings;var i=r.get("interactions."+e+".hideNodes");var n=r.get("interactions."+e+".hideEdges");var a=r.get("interactions."+e+".hideNodeTexts");var o=r.get("interactions."+e+".hideEdgeTexts");if(i){this._graphics.setNodesVisibility(value)}if(a){this._graphics.setNodeTextsVisibility(value)}if(n){this._graphics.setEdgesVisibility(value)}if(o){this._graphics.setEdgeTextsVisibility(value)}};t.prototype._smoothZoom=function(e,t,r){var i=this;var n=this._settings;var a=n.get("interactions.zoom.modifier");var o=n.get("interactions.zoom.duration");var s=n.get("interactions.zoom.easing");var u=this._camera.getZoom();var l=u*(e>0?a:1/a);var d={duration:o,easing:s};this._updateVisibility(h_.ZOOM,true);this._camera.setZoom(l,d,{refX:t,refY:r}).then(function(){return i._updateVisibility(h_.ZOOM,false)})};return t}(Ct);var c_={color:"#00C3FF",radius:7,cursorOnHover:"grab",cursorOnDrag:"grabbing"};var v_=function(e){l(t,e);function t(t){var r=t.classes,i=t.graphics,n=t.camera,a=t.captor,o=t.selection,s=t.events,u=t.settings,l=t.interactions;var d=e.call(this)||this;d._canvas=Se();d._ctx=d._canvas.getContext("2d");d._nodesToHighlight=null;d._movedEdges=null;d._startNode=null;d._hoverHandle=false;d._grabHandle=false;d._prevSettings=null;d._x=0;d._y=0;d._enabled=false;d._onDragStart=function(){d._nodesToHighlight=d._nodesToHighlight.filter(function(e){return e!==d._startNode});d._movedEdges.setExcluded(true);var e=d._options.cursorOnDrag;d._prevSettings=d._settings.update({edgeHover:false,cursor:{default:e,node:e,edge:e}})};d._onDragEnd=function(){d._restoreSettings();var e=d._getPointedNode();if(e){d._movedEdges.forEach(function(t){if(t.getTarget()===d._startNode){t.setTarget(e)}else{t.setSource(e)}})}d._movedEdges.setExcluded(false);d._movedEdges.setSelected(true);d._movedEdges=null;d._refreshHandles()};d._refreshHandles=function(){if(!d._enabled||d._movedEdges){return}var e=d._selection.getSelectedEdges();d._nodesToHighlight=e.getExtremities().dedupe();d._rewirableClass.clearEdges();d._rewirableClass.add(e);d._refreshCanvas()};d._shouldInteractionStart=function(e){var t=e.target;if(!d._enabled||!t||!t.isNode||!d._hoverHandle){return false}var r=t.getAdjacentEdges().filter(function(e){return e.isSelected()});if(r.size){d._movedEdges=r;d._edgeColors=d._movedEdges.getAttribute("color");d._startNode=t;return true}else{return false}};d._refreshCanvas=function(){if(!d._enabled||!d._nodesToHighlight){return}var e=d._captor.getCursorPosition();var t=d._getPointedNode();var r=d._camera.zoom;var i=d._canvas.getContext("2d");var n=we();var a=d._options.color;var o=d._options.radius;var s=o*2*n;i.clearRect(0,0,d._canvas.width,d._canvas.height);d._displayMovedEdges();i.fillStyle=a;i.strokeStyle=a;var u=false;d._nodesToHighlight.forEach(function(t){var a=t.getPositionOnScreen(),l=a.x,d=a.y;var h=t.getAttribute("radius")*(t.getAttribute("scalingMethod")==="fixed"?1:r);if(h>o){i.fillRect((l-o)*n,(d-o)*n,s,s);if(distance(l,d,e.x,e.y)<o){u=true}}});if(d._movedEdges){var l=t?t.getPositionOnScreen():e;i.fillRect((l.x-o)*n,(l.y-o)*n,s,s)}if(u){d._enableCursorOnHover()}else{d._disableCursorOnHover()}};d._captor=a;d._camera=n;d._graphics=i;d._selection=o;d._events=s;d._settings=u;d._interactions=l;d._classes=r;d._rewirableClass=d._classes.createClass({name:Ll,isBuiltin:true,edgeAttributes:{layer:Dl}});d._events.on({cameraMove:d._refreshCanvas,move:d._refreshCanvas,progressMoveNodesByDragging:d._refreshCanvas,down:function(){if(d._hoverHandle){d._grabHandle=true}},up:function(){d._grabHandle=false}});d._interaction=d._interactions.onDrag({priority:"rewiring",check:d._shouldInteractionStart,onStart:d._onDragStart,onProgress:function(e){var t=e.x,r=e.y;d._x=t;d._y=r},onStop:d._onDragEnd});return d}t.prototype.onMounted=function(e){e.events.onEdgesSelected(this._refreshHandles);e.events.onEdgesUnselected(this._refreshHandles)};t.prototype.enable=function(e){if(this._enabled){return}this._options=d({},c_,e);this._enabled=true;this._graphics.addCanvas(this._canvas);this._refreshHandles()};t.prototype.disable=function(){if(!this._enabled){return}this._interaction.stop();this._graphics.removeCursorStyle(this._options.cursorOnDrag);this._disableCursorOnHover();this._restoreSettings();this._graphics.removeCanvas(this._canvas);this._rewirableClass.clearEdges();this._enabled=false};t.prototype.enabled=function(){return this._enabled};t.prototype._restoreSettings=function(){if(this._prevSettings){this._settings.update(this._prevSettings);this._prevSettings=null}};t.prototype._disableCursorOnHover=function(){if(this._hoverHandle&&!this._grabHandle){this._hoverHandle=false;this._graphics.removeCursorStyle(this._options.cursorOnHover)}};t.prototype._enableCursorOnHover=function(){if(!this._hoverHandle){this._hoverHandle=true;this._graphics.addCursorStyle(this._options.cursorOnHover)}};t.prototype._displayMovedEdges=function(){var e=this;if(!this._movedEdges){return}var t=this._x;var r=this._y;var i=this._ctx;var n=we();var a={x:t,y:r};var o=this._camera.getZoom();var s=this._movedEdges;s.forEach(function(t,r){var s=e._edgeColors[r];var u=t.getSource();var l=t.getTarget();var d=e._getPointedNode();var h=l===e._startNode?u:l;var f=t.getAttribute("width")*o;var c=h.getPositionOnScreen();var v=d?d.getPositionOnScreen():a;h.addClass(Il);i.beginPath();i.moveTo(c.x*n,c.y*n);i.lineTo(v.x*n,v.y*n);i.strokeStyle=s;i.lineWidth=f*n;i.stroke()})};t.prototype._getPointedNode=function(){var e=this._captor.getPointedElement();return e&&e.isNode?e:null};return t}(Ct);var p_={cursor:"nesw-resize",color:"#00C3FF",lineWidth:1,handleSize:6,detectionMargin:5,snappingRatio:1.25,nbNodesToSnapTo:5,previewColor:"rgba(0, 0, 0, 0.2)",sizeIndicatorColor:"black",sizeIndicatorOffset:5,sizeIndicatorWidth:3,sizeIndicatorThickness:1};var g_=function(e){l(t,e);function t(t){var r=t.dom,i=t.interactions,n=t.camera,a=t.events,o=t.graphics,s=t.spatial,u=t.selection;var l=e.call(this)||this;l._enabled=false;l._nodesToHighlight=null;l._options=null;l._nodeBeingResized=null;l._pointedNode=null;l._cursorEnabled=false;l._x=0;l._y=0;l._additionalRadiuses=[];l._onSelectionChange=function(){if(!l._enabled){return}l._nodesToHighlight=l._selection.getSelectedNodes();l._displayHandles()};l._displayHandlesHandler=function(){return l._displayHandles()};l._moveHandler=function(e){var t=e.x,r=e.y;l._dom.setTimeout(function(){return l._detectBoundingBoxes(t,r)})};l._dom=r;l._interactions=i;l._events=a;l._camera=n;l._dom=r;l._spatial=s;l._graphics=o;l._selection=u;l._engine=l._graphics.getGraphicsEngine();l._canvas=Se();l._ctx=l._canvas.getContext("2d");l._interactions.onDrag({priority:"resizing",disableDetection:true,check:function(){return!!(l._enabled&&l._pointedNode)},onStart:function(e){var t=e.x,r=e.y;l._x=t;l._y=r;l._nodeBeingResized=l._pointedNode},onProgress:function(e){var t=e.x,r=e.y;l._x=t;l._y=r;l._displayHandles()},onStop:function(){l._nodesToHighlight.forEach(function(e,t){var r=l._additionalRadiuses[t]/l._camera.zoom;e.setAttributes({radius:e.getAttribute("radius")+r,x:e.getPosition().x+r,y:e.getPosition().y-r})});l._pointedNode=null;l._nodeBeingResized=null;l._displayHandles()}});return l}t.prototype.onMounted=function(e){e.events.onNodesSelected(this._onSelectionChange);e.events.onNodesUnselected(this._onSelectionChange)};t.prototype._enableCursor=function(){if(!this._cursorEnabled){this._graphics.addCursorStyle(this._options.cursor);this._cursorEnabled=true}};t.prototype._disableCursor=function(){if(this._cursorEnabled){this._graphics.removeCursorStyle(this._options.cursor);this._cursorEnabled=false}};t.prototype._detectBoundingBoxes=function(e,t){var r=this;if(!this._enabled||this._nodeBeingResized||!this._nodesToHighlight){return}var i=this._options.handleSize/2;var n=this._options.detectionMargin;this._pointedNode=null;this._forEachNodeToHighlight(function(a,o,s){var u=o.x+s-i-n;var l=o.x+s+i+n;var d=o.y-s-i-n;var h=o.y-s+i+n;if(e>=u&&e<=l&&t>=d&&t<=h){r._pointedNode=a}});if(this._pointedNode){return this._enableCursor()}return this._disableCursor()};t.prototype._forEachNodeToHighlight=function(e){var t=this;this._nodesToHighlight.forEach(function(r){var i=r.getPositionOnScreen();var n=t._getTotalOnScreenRadius(r);e(r,i,n)})};t.prototype._displayHandles=function(){var e=this;if(!this._enabled||!this._nodesToHighlight){return}var t=this._canvas;var r=this._ctx;var i=t.width;var n=t.height;var a=we();var o=this._options,s=o.color,u=o.lineWidth,l=o.handleSize;var d=0;r.clearRect(0,0,i,n);if(this._nodeBeingResized){var h=this._getTotalOnScreenRadius(this._nodeBeingResized),f=this._nodeBeingResized.getPositionOnScreen();d=Math.max(this._x-(f.x+h),-(this._y-(f.y-h)))/2}this._additionalRadiuses=[];this._forEachNodeToHighlight(function(t,i,n){var o=0;if(e._nodeBeingResized){o=d;var h=-n+t.getAttribute("innerStroke.width")+t.getAttribute("outerStroke.width")+u/2+1;if(o<h){o=h}else{o=e._snap(t,o)}e._additionalRadiuses.push(o);var f=t.getAttribute("shape"),c=e._engine.getShapePoints(f),v=i.x+o,p=i.y-o,g=n+o;e._displayNodePreview(r,a,v,p,g,c)}r.strokeStyle=s;r.fillStyle=s;r.lineWidth=u;r.strokeRect((i.x-n)*a,(i.y-n-o*2)*a,(o+n)*2*a,(o+n)*2*a);r.fillRect((i.x+n+o*2-l/2)*a,(i.y-n-o*2-l/2)*a,l*a,l*a)})};t.prototype._displayNodePreview=function(e,t,r,i,n,a){r*=t;i*=t;n*=t;e.beginPath();if(a.length===1){e.arc(r,i,n,0,Math.PI*2)}else{for(var o=0;o<a.length;++o){var s=a[o],u=r+s.x*n,l=i+s.y*n;if(o===0){e.moveTo(u,l)}else{e.lineTo(u,l)}}}e.fillStyle=this._options.previewColor;e.fill()};t.prototype._getTotalOnScreenRadius=function(e){return e.getAttribute("radius")*this._camera.zoom+e.getAttribute("innerStroke.width")+e.getAttribute("outerStroke.width")+this._options.lineWidth/2};t.prototype._snap=function(e,t){var r=this;var i=this._spatial.getNodesInScreenByDistance(e).filter(function(e){return!e.isSelected()}).slice(0,this._options.nbNodesToSnapTo);var n=this._ctx;var a=this._getTotalOnScreenRadius(e);var o=a+t;var s=this._options.snappingRatio;var u=o/a;var l=Math.round(ir(u,s));var d=a*Math.pow(s,l);var h=null;i.forEach(function(e){var t=r._getTotalOnScreenRadius(e);if(Math.abs(t-o)<=Math.abs(d-o)){d=t;h=e}});if(h){n.save();n.strokeStyle=this._options.sizeIndicatorColor;n.lineWidth=this._options.sizeIndicatorThickness;var f=h.getAttribute("radius");this._displaySizeIndicator(e,d);i.filter(function(e){return e.getAttribute("radius")===f}).forEach(function(e){return r._displaySizeIndicator(e)});n.restore()}return d-a};t.prototype._displaySizeIndicator=function(e,t){var r=this._ctx;var i=we();var n=e.getPositionOnScreen();var a=this._getTotalOnScreenRadius(e);var o=t||a;var s=t?t-a:0;var u=s-this._options.sizeIndicatorOffset-(t?e.getAttribute("innerStroke.width")+e.getAttribute("outerStroke.width"):0);var l=n.x-o+u|0;var d=n.y-o-s|0;var h=n.y+o-s|0;var f=this._options.sizeIndicatorWidth;r.beginPath();r.moveTo((l-f)*i,d*i);r.lineTo((l+f)*i,d*i);r.moveTo(l*i,d*i);r.lineTo(l*i,h*i);r.moveTo((l-f)*i,h*i);r.lineTo((l+f)*i,h*i);r.stroke()};t.prototype.enable=function(e){if(this._enabled){return}this._options=d({},p_,e);this._graphics.addCanvas(this._canvas);this._ctx=this._canvas.getContext("2d");this._events.on({"cameraMove progressMoveNodesByDragging":this._displayHandlesHandler,"move down":this._moveHandler});this._enabled=true};t.prototype.disable=function(){if(!this._enabled){return}this._events.removeListener(this._displayHandlesHandler);this._events.removeListener(this._moveHandler);this._graphics.removeCanvas(this._canvas);this._disableCursor();this._reset()};t.prototype._reset=function(){this._enabled=false;this._nodesToHighlight=null;this._options=null;this._nodeBeingResized=null;this._pointedNode=null;this._cursorEnabled=false;this._x=0;this._y=0;this._additionalRadiuses=[]};t.prototype.enabled=function(){return this._enabled};return t}(Ct);var __={strokeColor:"black",strokeWidth:5,dashed:true,cursorStyle:"cell",createNodes:true,condition:function(){return true},onNodeCreated:function(){},onEdgeCreated:function(){},onComplete:function(){}};var m_=function(e){l(t,e);function t(t){var r=t.dom,i=t.camera,n=t.captor,a=t.graph,o=t.graphics,s=t.interactions,u=t.events,l=t.settings;var d=e.call(this)||this;d._enabled=false;d._options=null;d._blockId=null;d._startNode=null;d._startPos=null;d._endPos=null;d._cursorEnabled=false;d._dom=r;d._camera=i;d._captor=n;d._graph=a;d._graphics=o;d._interactions=s;d._events=u;d._settings=l;d._engine=d._graphics.getGraphicsEngine();d._block=d._engine.createBlock();d._depth=hh(0).edgeBody;d._events.register(["connectNodes"]);d._interaction=d._interactions.onDrag({priority:"connectNodes",check:function(e){var t=e.target,r=e.button,i=r===void 0?"left":r;return d._enabled&&i==="left"&&t&&t.isNode},onStart:function(e){var t=e.target;return d._onStart(t)},onProgress:function(e){var t=e.x,r=e.y;return d._onMove(t,r)},onStop:function(){return d._onStop()}});d._events.on({clear:function(){return d.disable()}});return d}t.prototype._onStart=function(e){if(e){this._cursorEnabled=true;this._startNode=e;this._startPos=e.getPosition();this._graphics.addCursorStyle(this._options.cursorStyle);this._blockId=this._graphics.allocateGraphicsEngineBlockId()}};t.prototype._onMove=function(e,t){if(this._startNode===null){return}this._endPos=this._camera.screenToGraphCoordinates({x:e,y:t});this._drawLine()};t.prototype._onStop=function(){if(this._startNode===null){return}var e=this._options,t=e.condition,r=e.onNodeCreated,i=e.onEdgeCreated,n=e.onComplete,a=e.createNodes;var o=this._captor.getPointedElement();var s=null;var u=null;this._graphics.releaseGraphicsEngineBlockId(this._blockId);if(!o&&a){o=this._graph.addNode({attributes:{x:this._endPos.x,y:this._endPos.y}});u=o;if(r){r(u)}}if(o&&(u||!t||t(o))){s=this._graph.addEdge({source:this._startNode.getId(),target:o.getId()});if(i){i(s)}}if(n){n(this._startNode,o,s)}this.disable()};t.prototype._drawLine=function(){this._block.reset(Oi,false,this._depth);var e=this._block.nextAndReset();var t=e.end;t.pieceId=Yi;t.shape="line";t.x1=this._startPos.x;t.y1=this._startPos.y;t.x2=this._endPos.x;t.y2=this._endPos.y;t.fillColor=this._options.strokeColor;t.thicknessOrFontSizeFixed=this._options.strokeWidth;if(this._options.dashed){t.dashLength=3;t.gapLength=1}this._engine.storeBlock(this._blockId,this._block);this._dom.refresh()};t.prototype.enable=function(e){if(e===void 0){e={}}if(this._enabled){return}this._options=d({},__,e);this._enabled=true;this._cursorEnabled=false;this._startNode=null;this._prevSettings=this._settings.update({"cursor.node":this._options.cursorStyle,"detect.edges":false});if(this._captor.isLeftPressed()){this._interaction.start(this._captor.getCursorInformation())}return this};t.prototype.disable=function(){if(!this._enabled){return}this._enabled=false;this._settings.update(this._prevSettings);if(this._cursorEnabled){this._graphics.removeCursorStyle(this._options.cursorStyle)}};t.prototype.enabled=function(){return this._enabled};return t}(Ct);var y_,b_;var x_=["top","bottom","left","right","cssDefined"];var A_={top:{x:0,y:-1},bottom:{x:0,y:1},left:{x:-1,y:0},right:{x:1,y:0}};var E_={position:"top",autoAdjust:true,delay:100,className:null};var S_={hover:{node:function(e){var t=e.target;return t&&t.isNode},edge:function(e){var t=e.target;return t&&!t.isNode}},click:(y_={},y_[Qv.LEFT]={node:function(e){var t=e.target,r=e.button;return r===Qv.LEFT&&t&&t.isNode},edge:function(e){var t=e.target,r=e.button;return r===Qv.LEFT&&t&&!t.isNode},background:function(e){var t=e.target,r=e.button;return r===Qv.LEFT&&!t}},y_[Qv.RIGHT]={node:function(e){var t=e.target,r=e.button;return r===Qv.RIGHT&&t&&t.isNode},edge:function(e){var t=e.target,r=e.button;return r===Qv.RIGHT&&t&&!t.isNode},background:function(e){var t=e.target,r=e.button;return r===Qv.RIGHT&&!t}},y_),doubleClick:(b_={},b_[Qv.LEFT]={node:function(e){var t=e.target,r=e.button;return r===Qv.LEFT&&t&&t.isNode},edge:function(e){var t=e.target,r=e.button;return r===Qv.LEFT&&t&&!t.isNode},background:function(e){var t=e.target,r=e.button;return r===Qv.LEFT&&!t}},b_[Qv.RIGHT]={node:function(e){var t=e.target,r=e.button;return r===Qv.RIGHT&&t&&t.isNode},edge:function(e){var t=e.target,r=e.button;return r===Qv.RIGHT&&t&&!t.isNode},background:function(e){var t=e.target,r=e.button;return r===Qv.RIGHT&&!t}},b_)};var w_=function(e){l(t,e);function t(t){var r=t.dom,i=t.connectNodes,n=t.interactions,a=t.camera,o=t.events;var s=e.call(this)||this;s._x=0;s._y=0;s._dom=r;s._connectNodes=i;s._interactions=n;s._camera=a;s._events=o;s._handlers={};s._currentHandlerName=null;s._tooltip=null;s._isHover=false;s._events.register(["showTooltip","hideTooltip"]);s._events.on({"up dragStart":function(){if(!s._isHover){s._hideTooltip(false)}},unhover:function(){if(s._isHover){s._hideTooltip(false)}},clear:function(){return s._hideTooltip(false)}});s._interactions.onHover(s._createInteraction("hover",true));s._interactions.onClick(s._createInteraction("click"));s._interactions.onDoubleClick(s._createInteraction("doubleClick"));return s}t.prototype.hide=function(){this._hideTooltip(true)};t.prototype.isShown=function(){return!!this._tooltip};t.prototype.refresh=function(){this._refreshTooltip()};t.prototype.show=function(e,t){var r=t===void 0?{}:t,i=r.position,n=i===void 0?"top":i,a=r.autoAdjust,o=a===void 0?true:a,s=r.className,u=s===void 0?null:s,l=r.x,d=l===void 0?0:l,h=r.y,f=h===void 0?0:h;this._showTooltip(e,{position:n,autoAdjust:o,className:u},{x:d,y:f})};t.prototype.setHandler=function(e,t,r){var i=d({},E_,r);if(x_.indexOf(i.position)===-1){i.position="top"}this._handlers[e]={handler:t,condition:j(S_,e),settings:i}};t.prototype._hideTooltip=function(e){if(this._timeout){this._dom.clearTimeout(this._timeout);this._timeout=null}if(e){this._currentHandlerName=null}if(this._tooltip){var t=this._tooltip;if(this._tooltip.parentNode){this._tooltip.parentNode.removeChild(this._tooltip)}this._tooltip=null;this._events.fire("hideTooltip",{tooltip:t})}};t.prototype._createInteraction=function(e,t){var r=this;if(t===void 0){t=false}return{priority:"tooltip",check:function(i){var n=T_(e,i);var a=r._handlers[n];if(t&&r._connectNodes.enabled()){return false}if(a&&a.condition(i)){return true}if(!t&&r._currentHandlerName&&!r._isHover){return r._tooltip!==null}return false},handler:function(i){var n=i.target,a=i.x,o=i.y;r._hideTooltip(false);r._isHover=t;r._elt=n;r._x=a;r._y=o;r._currentHandlerName=T_(e,i);r._refreshTooltip()}}};t.prototype._refreshTooltip=function(){var e=this;if(!this._currentHandlerName){this._hideTooltip(false);return}var t=this._handlers[this._currentHandlerName];if(!t){return}var r=t.settings,i=t.handler;var n=this._elt;if(n){var a=n.isNode?"node":"edge";if(this._currentHandlerName.indexOf(a)===-1){return}}var o=i(n);var s=o instanceof Promise?o:Promise.resolve(o);s.then(function(t){e._schedule(function(){return e._showTooltip(t,r)},r.delay)})};t.prototype._schedule=function(e,t){var r=this;if(this._timeout){this._dom.clearTimeout(this._timeout)}this._timeout=this._dom.setTimeout(function(){r._timeout=null;e()},t)};t.prototype._showTooltip=function(e,t,r){this._hideTooltip(false);var i=t.position,n=t.className,a=t.autoAdjust;var o=this._x;var s=this._y;var u=this._elt;var l=this._dom.getDimensions();var d=0;var h=0;if(r){o=r.x;s=r.y;u=null}if(typeof e==="string"){this._tooltip=C_("div");this._tooltip.innerHTML=e}else if(je(e)){this._tooltip=e}else{throw new Error("invalid tooltip "+e+", expected HTML string or HTML element")}var f=this._tooltip;if(n){this._tooltip.classList.add(n)}if(i!=="cssDefined"){f.style.position="absolute"}this._dom.appendElement(f);if(u&&u.isNode){var c=u;var v=c.getPositionOnScreen();var p=c.getAttribute("radius");if(c.getAttribute("scalingMethod")==="fixed"){p=p+c.getAttribute("innerStroke.width")+c.getAttribute("outerStroke.width")}else{p=p*this._camera.getZoom()+c.getAttribute("innerStroke.width")+c.getAttribute("outerStroke.width")}o=v.x;s=v.y;d=p;h=p}var g=f.offsetWidth;var _=f.offsetHeight;var m=g/2;var y=_/2;d+=m;h+=y;if(i!=="cssDefined"){var b=A_[i];var x=b.x;var A=b.y;if(a){var E=o+d*b.x;var S=s+h*b.y;if(E-m<0||E+m>=l.width){if(i==="left"||i==="right"){x*=-1}else{if(E-m<0){x=(m-E+1)/d}else{x=(l.width-(E+m)-1)/d}}}if(S-y<0||S+y>=l.height){if(i==="top"||i==="bottom"){A*=-1}else{if(S-y<0){A=(y-S+1)/h}else{A=(l.height-(S+y)-1)/h}}}}f.style.left=o+d*x-m+"px";f.style.top=s+h*A-y+"px"}this._events.fire("showTooltip",{tooltip:f})};return t}(Ct);function T_(e,t){var r=t.button,i=t.target;var n=i!==null?i.isNode?"node":"edge":"background";var a=r?"."+r:"";return""+e+a+"."+n}function C_(e){if(typeof document!=="undefined"){return document.createElement(e)}return xe()}var I_={65:"a",66:"b",67:"c",68:"d",69:"e",70:"f",71:"g",72:"h",73:"i",74:"j",75:"k",76:"l",77:"m",78:"n",79:"o",80:"p",81:"q",82:"r",83:"s",84:"t",85:"u",86:"v",87:"w",88:"x",89:"y",90:"z",48:"0",49:"1",50:"2",51:"3",52:"4",53:"5",54:"6",55:"7",56:"8",57:"9",13:"enter",16:"shift",17:"ctrl",18:"alt",27:"esc",46:"del",8:"backspace",32:"space",224:"cmd",91:"cmd",92:"cmd",93:"cmd",187:"+",189:"-"};var M_=Object.keys(I_).reduce(function(e,t){var r=I_[t];if(!e[r]){e[r]=[]}e[r].push(t);return e},{});var L_=function(e){l(t,e);function t(t){var r=t.dom,i=t.events;var n=e.call(this)||this;n._onBlur=function(){return n.resetKeys()};n._onKeyUp=function(e){var t=e.keyCode||e.which;n._pressed[t]=false;n._events.fire("keyUp",{domEvent:e,key:I_[t],code:t})};n._onKeyDown=function(e){var t=e.keyCode||e.which;var r=n._binds[t];if(n._pressed[t]){return}n._pressed[t]=true;if(r){for(var i=0,a=r;i<a.length;i++){var o=a[i];var s=o.keys.every(function(e){return e.some(function(e){return n._pressed[e]})});if(s){o.handler({domEvent:e})}}}n._events.fire("keyDown",{domEvent:e,key:I_[t],code:t})};n._dom=r;n._events=i;n._events.register(["keyUp","keyDown"]);n._binds=[];n._pressed=[];n._dom.addWindowEventListener("keydown",n._onKeyDown);n._dom.addWindowEventListener("keyup",n._onKeyUp);n._dom.addWindowEventListener("visibilitychange",n._onBlur);n._dom.addWindowEventListener("blur",n._onBlur,false);n._idleTimeout=4e3;n._prevEventTimeStamp=tt();n._events.onAnyEvent(function(){var e=tt();if(e-n._prevEventTimeStamp>n._idleTimeout){n.resetKeys()}n._prevEventTimeStamp=e});return n}t.prototype.setIdleTimeout=function(e){if(!isFinite(e)||e<=1){throw new TypeError("Idle timeout must be a positive number > 1")}this._idleTimeout=e};t.prototype.resetKeys=function(){for(var e=0;e<this._pressed.length;e++){if(this._pressed[e]){this._pressed[e]=false;this._events.fire("keyUp",{key:I_[e],code:e})}}};t.prototype.onKeyPress=function(e,t){var r=this;var i;if(typeof e==="number"){i=[e]}if(typeof e==="string"){i=e.split(" ")}if(Array.isArray(e)){i=e}if(!i){throw new TypeError(e+" is not a number, string or array")}if(i.length===0){throw new Error("the array should contain at least one element")}var n=i.map(function(e){if(typeof e==="number"){return[e]}if(typeof e==="string"){var t=M_[e];if(!t){throw new Error(e+" is not a valid key identifier")}return t}throw new TypeError(e+" is not a valid key identifier")});var a=n.pop();var o={keys:n,handler:t};a.forEach(function(e){if(!r._binds[e]){r._binds[e]=[]}r._binds[e].push(o)})};t.prototype.isPressed=function(e){var t=this;if(typeof e==="number"){return this._pressed[e]}if(typeof e==="string"){var r=M_[e];if(r){return r.some(function(e){return t._pressed[e]})}}return false};return t}(Ct);var k_=[{name:"color",isNode:true},{name:"shape",isNode:true},{name:"radius",isNode:true},{name:"icon.content",isNode:true},{name:"image.url",isNode:true},{name:"image",isNode:true},{name:"color",isNode:false},{name:"shape",isNode:false},{name:"width",isNode:false}];var N_=Math.PI;var F_=2*Math.PI;var z_=Math.cos(N_/2-F_/5);var R_=Math.cos(N_/2-F_/5*2);var P_=Math.cos(N_/2-F_/5*3);var O_=Math.cos(N_/2-F_/5*4);var D_=Math.sin(-N_/2+F_/5);var B_=Math.sin(-N_/2+F_/5*2);var V_=Math.sin(-N_/2+F_/5*3);var j_=Math.sin(-N_/2+F_/5*4);var U_=1.6;var G_=3;var q_=.9;var H_=.31;var W_=1/3;var X_=[8,3];var Y_=[3,3];var Z_={position:"bottom",widgetWidth:130,fontFamily:"Arial",fontSize:10,fontColor:"black",titleFontSize:12,titleFontColor:"black",titleMaxLength:20,titleTextAlign:"left",shapeColor:"grey",backgroundColor:"white",borderColor:"black",borderRadius:0,borderWidth:1,innerMargin:10,outerMargin:5,circleStrokeWidth:3,titleFunction:function(e){return e[e.length-1]}};var K_=["widgetWidth","fontSize","titleFontSize","borderRadius","borderWidth","innerMargin","outerMargin","circleStrokeWidth"];function Q_(e){if(Array.isArray(e)){return e.reduce(function(e,t){return e&&Q_(t)},true)}else{return e==="undefined"||!isNaN(Number(e))}}function J_(e){if(Array.isArray(e)){return e.reduce(function(e,t){return Math.min(e,J_(t))},Infinity)}else{return isNaN(e)?Infinity:+e}}function $_(e){if(Array.isArray(e)){return e.reduce(function(e,t){return Math.max(e,$_(t))},-Infinity)}else{return isNaN(e)?-Infinity:+e}}function em(e){var t=["K","M","B","T","P","E","Z","Y"];if(e>9999){var r=0;while(r<t.length&&e>999){e/=1e3;r++}return(tm(e,3)+t[r-1]).toString()}return tm(e,4).toString()}function tm(e,t){if(t===void 0){t=3}var r=t===4?10:1;if(e<10){return Math.round(e*100*r)/100*r}if(e<100){return Math.round(e*10*r)/10*r}if(e<1e3){return Math.round(e*r)/r}return Math.round(e)}function rm(e){return e.innerMargin+(e.titleFontSize+e.fontSize)*U_}function im(e,t,r){var i=t.getContext("2d");var n=r.x,a=r.y,o=r.height,s=r.isNode,u=r.styleProperty,l=r.title,d=r.mapping,h=r.iconFont,f=r.iconFontStyle;sm(i,e,n,a,o);um(i,e,l,n,a);var c=e.fontSize*U_;var v=e.fontSize/2*U_*q_;var p=e.fontSize*G_;var g=e.fontSize;var _=om(e,s);var m=a+rm(e);var y=n+e.innerMargin+_/2;var b=n+e.innerMargin*2+_;var x=R(d);var A=Q_(x);var E=e.fontColor;var S=e.shapeColor;var w=Object.keys(d);if(A){w.sort(function(e,t){return rr(d[t])-rr(d[e])});if(u==="radius"||u==="width"){var T=J_(x);var C=$_(x);var I=Math.round((T+C)/2);var M=s?Sm:wm;return M(e,i,n,m,T,I,C,S)}}w.forEach(function(t){var r=d[t];if(u==="color"){if(s){dm(i,y,m,v,t)}else{hm(i,y,m,p,g,t)}}if(u==="shape"){if(s){mm(i,y,m,v,t,S)}else{Am(i,y,m,p,g,t,S)}}if(u==="icon.content"){fm(i,y,m,t,h,v,E,f)}if(u==="image"||u==="image.url"){cm(i,y,m,v,t)}lm(i,e,b,m,r,A);m+=c})}function nm(e,t,r,i,n,a){e.beginPath();e.arc(t,r,i,0,F_);e.strokeStyle=n;e.lineWidth=a;e.stroke()}function am(e,t,r,i,n,a){if(n===void 0){n="left"}if(a===void 0){a="normal"}var o="middle";e.textAlign=n;e.textBaseline=o;e.fillStyle=i;e.font=a+" "+r+'px "'+t+'"'}function om(e,t){var r=t?1:G_;return e.fontSize*r}function sm(e,t,r,i,n){return Em(e,r,i,t.widgetWidth,n,t.borderRadius,t.backgroundColor,t.borderColor,t.borderWidth)}function um(e,t,r,i,n){am(e,t.fontFamily,t.titleFontSize,t.titleFontColor,t.titleTextAlign);var a=t.titleTextAlign==="center",o=t.widgetWidth-t.innerMargin*2,s=e.measureText(r).width,u=i+(a?t.widgetWidth/2:t.innerMargin),l=n+t.titleFontSize/2+t.innerMargin;if(s>o){var d=o/s;var h=(r.length*d|0)-2;r=r.substr(0,h)+"…"}e.fillText(r,u,l)}function lm(e,t,r,i,n,a){var o=n.join();if(a){if(n.length===1){o=em(n[0])}else{var s=rr(n);var u=tr(n);o=em(s)+" - "+em(u)}}am(e,t.fontFamily,t.fontSize,t.fontColor);e.fillText(o,r,i)}function dm(e,t,r,i,n){e.beginPath();e.arc(t,r,i,0,2*N_);e.fillStyle=n;e.fill()}function hm(e,t,r,i,n,a){e.fillStyle=a;e.fillRect(t-i/2,r-n/2,i,n)}function fm(e,t,r,i,n,a,o,s){am(e,n,a*2,o,"center",s);e.fillText(i,t,r)}function cm(e,t,r,i,n){if(typeof Image==="undefined"){return}if(!e._imgStore){e._imgStore={}}var a=e._imgStore[n];if(a){return e.drawImage(a,t-i,r-i,i*2,i*2)}a=new Image;a.src=n;a.onload=function(){e.drawImage(a,t-i,r-i,i*2,i*2)};e._imgStore[n]=a}function vm(e,t,r,i){e.fillRect(t-i,r-i*H_,i*2,i*2*H_);e.fillRect(t-i*H_,r-i,i*2*H_,i*2)}function pm(e,t,r,i){e.beginPath();e.moveTo(t-i,r);e.lineTo(t,r-i);e.lineTo(t+i,r);e.lineTo(t,r+i);return e.fill()}function gm(e,t,r,i){e.beginPath();e.moveTo(t,r-i);e.lineTo(t+z_*i,r+D_*i);e.lineTo(t+R_*i,r+B_*i);e.lineTo(t+P_*i,r+V_*i);e.lineTo(t+O_*i,r+j_*i);e.fill()}function _m(e,t,r,i){e.beginPath();e.moveTo(t,r-i);e.lineTo(t+R_*i,r+B_*i);e.lineTo(t+O_*i,r+j_*i);e.lineTo(t+z_*i,r+D_*i);e.lineTo(t+P_*i,r+V_*i);e.fill()}function mm(e,t,r,i,n,a){e.fillStyle=a;switch(n){case"square":return e.fillRect(t-i,r-i,i*2,i*2);case"circle":return dm(e,t,r,i,a);case"cross":return vm(e,t,r,i);case"diamond":return pm(e,t,r,i);case"equilateral":return gm(e,t,r,i);case"star":return _m(e,t,r,i)}}function ym(e,t,r,i,n){e.fillRect(t-i/2,r-n/4,i*(1-W_),n/2);e.beginPath();e.moveTo(t+i*(1-W_-.5),r-n/2);e.lineTo(t+i*(1-W_-.5),r+n/2);e.lineTo(t+i/2,r);e.fill()}function bm(e,t,r,i,n,a,o){e.beginPath();e.moveTo(t-i/2,r);e.lineTo(t+i/2,r);e.strokeStyle=a;e.lineWidth=n/2;e.setLineDash(o==="dashed"?X_:Y_);e.stroke()}function xm(e,t,r,i,n){e.beginPath();e.moveTo(t-i/2,r-n/2);e.lineTo(t-i/2,r+n/2);e.lineTo(t+i/2,r);e.fill()}function Am(e,t,r,i,n,a,o){e.fillStyle=o;if(a==="line"){e.fillRect(t-i/2,r-n/4,i,n/2)}if(a==="arrow"){return ym(e,t,r,i,n)}if(a==="dashed"||a==="dotted"){return bm(e,t,r,i,n,o,a)}if(a==="tapered"){return xm(e,t,r,i,n)}}function Em(e,t,r,i,n,a,o,s,u){e.setLineDash([]);e.beginPath();e.moveTo(t+a,r);e.lineTo(t+i-a,r);e.quadraticCurveTo(t+i,r,t+i,r+a);e.lineTo(t+i,r+n-a);e.quadraticCurveTo(t+i,r+n,t+i-a,r+n);e.lineTo(t+a,r+n);e.quadraticCurveTo(t,r+n,t,r+n-a);e.lineTo(t,r+a);e.quadraticCurveTo(t,r,t+a,r);e.closePath();e.fillStyle=o;e.fill();e.strokeStyle=s;e.lineWidth=u;e.stroke()}function Sm(e,t,r,i,n,a,o,s){var u=e.fontSize*.7;var l=u*3;var d=(u+l)/2;var h=r+e.innerMargin+l;var f=h+l+e.innerMargin;var c=i+l*2-e.innerMargin*.5;var v=e.circleStrokeWidth;for(var p=0,g=[u,d,l];p<g.length;p++){var _=g[p];nm(t,h,c-_,_,s,v)}am(t,e.fontFamily,e.fontSize,e.fontColor,"left");t.fillText(em(n),f,c+u-u*2);t.fillText(em(a),f,c+u-d*2);t.fillText(em(o),f,c+u-l*2)}function wm(e,t,r,i,n,a,o,s){var u=(e.widgetWidth-2*e.innerMargin)/3,l=e.fontSize,d=i-e.innerMargin/2,h=d+l*2,f=r+e.innerMargin;t.fillStyle=s;t.fillRect(f,d-l/2,u+1,l);t.fillRect(f+u,d-l/3,u+1,l/1.5);t.fillRect(f+u*2,d-l/6,u,l/3);am(t,e.fontFamily,e.fontSize,e.fontColor,"center");t.fillText(em(o),f+u*.5,h);t.fillText(em(a),f+u*1.5,h);t.fillText(em(n),f+u*2.5,h)}function Tm(e,t,r,i){var n=i.outerMargin+rm(i);var a=i.fontSize*U_;var o=n-i.innerMargin*.8;if(t==="radius"||t==="width"){return o+a*(r?3:2)}return o+Object.keys(e).length*a}function Cm(e,t,r){var i={width:t.width,height:t.height};var n=false;if(!i.width||!i.height||!r){return false}if(e.position==="top"||e.position==="bottom"){n=km(i,e,r,e.position==="bottom")}else{n=Im(i,e,r,e.position==="left")}if(n){r.forEach(function(r){return im(e,t,r)})}return n}function Im(e,t,r,i){var n=t.widgetWidth+t.outerMargin,a=Math.floor((e.width-t.outerMargin)/n),o=e.height,s=t.outerMargin,u=i?t.outerMargin:e.width-n,l=1;r=r.slice().sort(Nm);for(var d=0;d<r.length;++d){var h=r[d];if(s+h.height>o){if(s===t.outerMargin){return false}else{s=t.outerMargin;l+=1;if(i){u+=n}else{u-=n}}}h.x=u;h.y=s;s+=h.height}return l<=a}function Mm(e,t,r){var i=null;for(var n=0;n<t.length;++n){var a=t[n];if((a.isNode===e.isNode||t.length===1)&&(i===null||a.height<t[i].height)){i=n}}a=t[i];a.content.push(e);a.height+=e.height+r.outerMargin}function Lm(e){var t=0;for(var r=1;r<e.length;++r){if(e[r].height>e[t].height){t=r}}return t}function km(e,t,r,i){r=r.slice();var n=t.widgetWidth+t.outerMargin,a=Math.floor((e.width-t.outerMargin)/n),o=e.height-t.outerMargin,s=new Array(Math.min(a,r.length)),u=r.length,l=0,d=0,h=0,f=0;for(var c=0;c<u;++c){var v=r[c];if(v.isNode){l+=1;d+=v.height}else{h+=1;f+=v.height}}var p=d+f;var g=d/p;var _=f/p;var m=Math.round(g*a);var y=Math.round(_*a);if(m>l){m=l}else if(y>h){m=a-h}if(a===0){return false}for(var c=0;c<s.length;c++){s[c]={content:[],height:0,isNode:c<m}}for(var c=0;c<u;++c){var b=Lm(r);Mm(r[b],s,t);r.splice(b,1)}if(s.every(function(e){var t=e.content;return t.length===1})){s.sort(Rm)}else{s.sort(zm)}var x=t.outerMargin;for(var c=0;c<s.length;++c){var A=s[c];if(A.height>o){return false}A.content.sort(Fm);var E=0;for(var S=0;S<A.content.length;++S){var w=A.content[S];w.x=x;w.y=i?e.height-E-w.height-t.outerMargin:E+t.outerMargin;E+=w.height+t.outerMargin}x+=n}return true}function Nm(e,t){if(e.isNode!==t.isNode){return e.isNode?-1:1}else{return e.title<=t.title?-1:1}}function Fm(e,t){return e.height-t.height}function zm(e,t){if(e.isNode!==t.isNode){return e.isNode?-1:1}else{return t.height-e.height}}function Rm(e,t){if(e.isNode!==t.isNode){return e.isNode?-1:1}else{return e.content[0].title<=t.content[0].title?-1:1}}var Pm=function(e){l(t,e);function t(t){var r=t.graphics,i=t.dom,n=t.events,a=t.styleRules;var o=e.call(this)||this;o._enabled=false;o._mustRefresh=false;o._settings=null;o._promises=[];o._graphics=r;o._dom=i;o._events=n;o._styleRules=a;o._canvas=Se();o._ctx=o._canvas.getContext("2d");o._events.on({newFrame:function(){if(o._enabled&&o._mustRefresh){o._ctx.clearRect(0,0,o._canvas.width,o._canvas.height);o._drawOnCanvas(o._settings,o._canvas,we());var e=o._promises;o._promises=[];e.forEach(function(e){return e()});o._mustRefresh=false}},"resize reloadFonts":function(){o._mustRefresh=true}});return o}t.prototype.enable=function(e){var t=this._settings;this._settings=d({},Z_,e);this._mustRefresh=!this._enabled||!this._sameOptions(t,this._settings);if(!this._enabled){this._enabled=true;this._graphics.addCanvas(this._canvas);return this.refresh()}return Promise.resolve()};t.prototype._afterNextUpdate=function(){var e=this;return new Promise(function(t){return e._promises.push(t)})};t.prototype._formatSettings=function(e,t){var r=d({},Z_,e);K_.forEach(function(e){return r[e]*=t});return r};t.prototype.disable=function(){if(this._enabled){this._enabled=false;this._graphics.removeCanvas(this._canvas)}};t.prototype.enabled=function(){return this._enabled};t.prototype.refresh=function(){this._mustRefresh=true;this._dom.refresh();return this._afterNextUpdate()};t.prototype.destroy=function(){this._enabled=false;this._mustRefresh=false;this._settings=null;this._promises=[]};t.prototype.getOptions=function(){if(this.enabled){return d({},this._settings)}};t.prototype.getCurrentOptions=function(){return this._settings};t.prototype._sameOptions=function(e,t){return e===t||Object.keys(e).reduce(function(r,i){return r&&e[i]===t[i]},true)};t.prototype._drawOnCanvas=function(e,t,r){var i=this._formatSettings(e,r);var n=this._computeWidgetList(i);Cm(i,t,n)};t.prototype.exportOnCanvas=function(e,t){return this._drawOnCanvas(t,e,1)};t.prototype._computeWidgetList=function(e){var t=this;var r=[];k_.forEach(function(i){var n=i.name,a=i.isNode;var o=t._computeWidget(e,n,a);if(o){r.push(o)}});return r};t.prototype._computeWidget=function(e,t,r){var i=this._computePropertyMapping(e,t,r);if(i){if(t!=="icon.content"){return i}var n=this._getRulesForAttribute(r,"icon.font");var a=this._getRulesForAttribute(r,"icon.style");var o=null;var s=null;if(!n.length){o="Arial";s="normal"}if(typeof n[0]==="string"){o=n[0];s=a[0]}if(o){i.iconFont=o;i.iconFontStyle=s;return i}}return null};t.prototype._computePropertyMapping=function(e,t,r){var i=this._getRulesForAttribute(r,t)[0];var n=i&&i.mapping;var a=n&&n.getValues(r);if(n&&a){var o=n.getField();var s={};P(a,function(e,t){if(e===undefined||t==="undefined"){return}s[e]=s[e]||[];s[e].push(t)});if(Object.keys(s).length===0){return null}return{isNode:r,title:e.titleFunction(o),styleProperty:t,dataProperty:o,mapping:s,height:Tm(s,t,r,e)}}return null};t.prototype._getRulesForAttribute=function(e,t){return this._styleRules.getRuleList().map(function(r){var i=r.getDefinition();var n=e?i.nodeAttributes:i.edgeAttributes;return j(n,t)}).filter(function(e){return e}).sort(function(e,t){if(e.mapping&&t.mapping){return 0}if(!e.mapping){return 1}return-1})};return t}(Ct);var Om={layer:Pl,outline:true,outerStroke:{color:"red",width:5},innerStroke:{minVisibleSize:0},text:{backgroundColor:"rgb(220, 220, 220)",minVisibleSize:0}};var Dm={layer:Pl,outline:true,color:"red",text:{backgroundColor:"rgb(220, 220, 220)",minVisibleSize:0}};var Bm=100;var Vm=function(e){l(t,e);function t(t){var r;var i=t.dom,n=t.classes,a=t.captor,o=t.graph,s=t.graphics,u=t.settings,l=t.events;var d=e.call(this)||this;d._delay=Bm;d._manualTriggerDetection=false;d._hovered=null;d._timeout=null;d._onAnimate=function(e){var t=e.duration;if(t){d._manualTriggerDetection=true;d._resetHover()}};d._onBeforeNewFrame=function(){if(d._manualTriggerDetection&&!d._graphics.isAnimating()){d._manualTriggerDetection=false;d._captor.triggerDetection();var e=d._captor.getPointedElement();if(e){d._hoverElement(e)}}};d._onClear=function(){d._hovered=null;if(d._timeout){d._dom.clearTimeout(d._timeout)}};d._resetHover=function(){if(d._hovered){d._unhoverElement(d._hovered);d._captor.triggerUnhover()}if(d._timeout){d._dom.clearTimeout(d._timeout);d._timeout=null}};d._dom=i;d._graph=o;d._graphics=s;d._settings=u;d._captor=a;d._events=l;d._classes=n;d._registerSettings();d._hoverExtremityHighlightedClass=d._classes.createClass({name:Tl,isBuiltin:true,nodeAttributes:Om});d._hoverClass=d._classes.createClass({name:wl,isBuiltin:true,nodeAttributes:Om,edgeAttributes:Dm});d._events.on((r={},r[It.HOVER]=function(e){var t=e.target;return d._hoverElement(t)},r[It.UNHOVER]=function(e){var t=e.target;return d._unhoverElement(t)},r[It.ANIMATE]=d._onAnimate,r[It.BEFORE_NEW_FRAME]=d._onBeforeNewFrame,r[It.MOUSE_LEAVE]=d._resetHover,r[It.CLEAR_GRAPH]=d._onClear,r));return d}t.prototype.setRate=function(e){this._delay=e};t.prototype.updateNodeAttributes=function(e,t){this._hoverClass.update({nodeAttributes:e,fullOverwrite:t});this._hoverExtremityHighlightedClass.update({nodeAttributes:e,fullOverwrite:t});this._updateExtremityHighlightLayer()};t.prototype.updateEdgeAttributes=function(e,t){this._hoverClass.update({edgeAttributes:e,fullOverwrite:t});this._updateExtremityHighlightLayer()};t.prototype.onMounted=function(e){var t=this;var r=function(){t._hoverExtremityHighlightedClass.clearNodes();t._hoverClass.getEdges().getExtremities().addClass(Tl)};this._classes.onEdgeClassAdded(wl,r);this._classes.onEdgeClassRemoved(wl,r)};t.prototype._registerSettings=function(){var e=this;this._settings.register("cursor.node","pointer",function(value,t){if(e._hovered&&e._hovered.isNode){e._graphics.removeCursorStyle(t);e._graphics.addCursorStyle(value)}});this._settings.register("cursor.edge","pointer",function(value,t){if(e._hovered&&!e._hovered.isNode){e._graphics.removeCursorStyle(t);e._graphics.addCursorStyle(value)}});this._settings.register("nodeHover",true,function(value){if(!value&&e._hovered&&e._hovered.isNode){e._unhoverElement(e._hovered)}});this._settings.register("edgeHover",true,function(value){if(!value&&e._hovered&&!e._hovered.isNode){e._unhoverElement(e._hovered)}})};t.prototype._updateExtremityHighlightLayer=function(){var e=this._hoverClass.getDefinition().edgeAttributes;var t=e?e.layer:undefined;this._hoverExtremityHighlightedClass.update({nodeAttributes:{layer:t},fullOverwrite:false})};t.prototype._removeTimeout=function(){if(this._timeout){this._dom.clearTimeout(this._timeout);this._timeout=null}};t.prototype._isAnimating=function(){return this._graphics.isAnimating()};t.prototype._hoverElement=function(e){var t=this;var r=e.isNode?"nodeHover":"edgeHover";var i=this._settings.get(r);if(!i||this._isAnimating()){return}this._removeTimeout();this._timeout=this._dom.setTimeout(function(){if(!t._isAnimating()){t._setElementHighlight(true,e);t._hovered=e}t._timeout=null},this._delay)};t.prototype._unhoverElement=function(e){this._removeTimeout();if(this._hovered===e){this._setElementHighlight(false,e);this._hovered=null}};t.prototype._setElementHighlight=function(e,t){var r=this._settings.get(t.isNode?"cursor.node":"cursor.edge");if(e){this._graphics.addCursorStyle(r);t.addClass(wl)}else{this._graphics.removeCursorStyle(r);t.removeClass(wl)}if(t.isNode&&e){this._graph.getAttribute(t.isNode,"textHidden").set(t._index,false)}};return t}(Ct);var jm=function(){function e(e,t){this._nodeMapping={valid:false,values:null};this._edgeMapping={valid:false,values:null};this._computeMapping=t;this._field=e}e.prototype.getValue=function(e,t){var r=e.isNode;var i=r?this._nodeMapping:this._edgeMapping;if(!i.valid){i.values=this._computeMapping(r);i.valid=true}var n=e.getData(this._field);if(Array.isArray(n)){if(t==="color"){return n.map(function(e){return i.values[e]})}return i.values[n[0]]}return i.values[n]};e.prototype.markAsInvalid=function(){this._nodeMapping.valid=false;this._edgeMapping.valid=false};e.prototype.getValues=function(e){return e?this._nodeMapping.values:this._edgeMapping.values};e.prototype.getField=function(){return this._field};return e}();function Um(value){return typeof value==="number"&&isFinite(value)}function Gm(e,t,r){var i=t?e.getNodes():e.getEdges();var n=i.getData(r);var a={};n.forEach(function(value){if(!Array.isArray(value)){return a[value]=1}value.forEach(function(e){return a[e]=1})});if("undefined"in a){delete a["undefined"]}return Object.keys(a).sort()}function qm(e,t,r,i){var n=r.values,a=r.fallback;var o=Gm(e,i,t);var s={};var u=0;for(var l=0;l<o.length;++l){var value=o[l];if(value in n){s[value]=n[value]}else{s[value]=a[u];u=(u+1)%a.length}}return s}function Hm(e,t){var r=t.nbSlices,i=t.minValue,n=t.maxValue;if(Array.isArray(e)){return e.slice()}var a=e.min,o=a===void 0?i:a,s=e.max,u=s===void 0?n:s;var l=(u-o)/r;var d=[];for(var h=1;h<r;++h){d.push(o+l*h)}return d}function Wm(e,t){if(Array.isArray(e)){return e}var r=e.min,i=e.max;var n=t.length+1;var a=(i-r)/t.length;var o=[];for(var s=0;s<n;s++){o.push(r+s*a)}return o}function Xm(e,t,r,i){var n=r.fallback,a=r.stops,o=r.values,s=r.reverse;var u=Gm(e,i,t);var l=Infinity;var d=-Infinity;for(var h=0;h<u.length;h++){var value=+u[h];if(Um(value)){l=Math.min(l,value);d=Math.max(d,value);u[h]=value}}var f={};if(!isFinite(l)){for(var h=0;h<u.length;h++){f[u[h]]=n}return f}var c=Array.isArray(o)?o.length:o.nbSlices;var v=Hm(a,{nbSlices:c,minValue:l,maxValue:d});var p=Wm(o,v);if(s){p.reverse()}for(var h=0;h<u.length;++h){var value=u[h];if(!isFinite(value)){f[value]=n}else{var g=0;while(g<v.length&&v[g]<=value){g+=1}f[value]=p[g]}}return f}var Ym=function(e){l(t,e);function t(t){var r=t.graph,i=t.events,n=t.styleRules,a=t.legend;var o=e.call(this)||this;o._mappingList=[];o._graph=r;o._styleRules=n;o._events=i;o._legend=a;o._events.on({"addNodes addEdges updateNodeData updateEdgeData removeNodes removeEdges excludedStateChange clear":function(){if(o._mappingList.length){for(var e=0;e<o._mappingList.length;++e){o._mappingList[e].markAsInvalid()}o._styleRules.refreshAllRules();o._legend.refresh()}}});return o}t.prototype.createMapping=function(e){var t=e===void 0?{field:""}:e,r=t.field,i=t.values,n=i===void 0?{}:i,a=t.fallback,o=a===void 0?undefined:a;r=C(r);if(Array.isArray(o)){if(o.length===0){o=[undefined]}}else{o=[o]}if(!z(n)){throw new Error('"mapping" should be an object')}return this._createMappingFunction(qm,r,{values:n,fallback:o})};t.prototype.createSlices=function(e){var t=e===void 0?{field:"",values:[]}:e,r=t.field,i=t.fallback,n=i===void 0?undefined:i,a=t.stops,o=a===void 0?{}:a,s=t.values,u=t.reverse,l=u===void 0?false:u;r=C(r);if(!Array.isArray(s)&&!s.nbSlices){s.nbSlices=7}if(Array.isArray(o)&&Array.isArray(s)&&o.length!==s.length-1){throw new Error("there should be exactly one more value that stops")}return this._createMappingFunction(Xm,r,{fallback:n,stops:o,values:s,reverse:l})};t.prototype._createMappingFunction=function(e,t,r){var i=this;var n=new jm(t,function(n){return e(i._graph,t,r,n)});this._mappingList.push(n);var a=function(e,t,r){return n.getValue(e,r)};a.mapping=n;return a};t.prototype.createTemplate=function(e){if(typeof e!=="string"){throw new TypeError('"template" should be a string')}var t=[];var r=0;var i=false;while(!i){var n=-1;var a=e.indexOf("{{",r);if(a!==-1){n=e.indexOf("}}",a+2)}if(n!==-1){t.push(e.substring(r,a));t.push(e.substring(a+2,n));r=n+2}else{t.push(e.slice(r));i=true}}return function(e){var r=t[0];for(var i=1;i<t.length;i+=2){r+=e.getData(t[i]);r+=t[i+1]}return r}};return t}(Ct);var Zm=function(){function e(e){var t=e.getNodesToFilter,r=e.getEdgesToFilter;this._getNodesToFilter=t;this._getEdgesToFilter=r}e.prototype.run=function(e){var t=e.ogma,r=e.duration;var i=this._getNodesToFilter(t);var n=this._getEdgesToFilter(t,i);return Promise.all([i.addClass(Fl,r),n.addClass(Fl,r)]).then(function(){i.setExcluded(true);n.setExcluded(true);return{nodes:i,edges:n}})};e.prototype.undo=function(e){var t=e.duration,r=e.context;var i=r.nodes,n=r.edges;i.setExcluded(false);n.setExcluded(false);i.addClass(Fl);n.addClass(Fl);return Promise.all([i.removeClass(Fl,t),n.removeClass(Fl,t)])};return e}();var Km;(function(e){e["NodeFilter"]="node-filter";e["EdgeFilter"]="edge-filter";e["NodeCollapsing"]="node-collapsing"})(Km||(Km={}));var Qm=function(e){l(t,e);function t(t){return e.call(this,{getNodesToFilter:function(e){return e.getNodes().filter(function(e){return!t(e)})},getEdgesToFilter:function(e,t){return t.getAdjacentEdges()}})||this}t.prototype.getName=function(){return Km.NodeFilter};return t}(Zm);var Jm=function(e){l(t,e);function t(t){return e.call(this,{getNodesToFilter:function(e){return e.createNodeList()},getEdgesToFilter:function(e){return e.getEdges().filter(function(e){return!t(e)})}})||this}t.prototype.getName=function(){return Km.EdgeFilter};return t}(Zm);function $m(e){if(typeof e!=="object"){return{criteria:e,enabled:true,duration:0}}return e}var ey=function(e){l(t,e);function t(t){var r=t.transformations;var i=e.call(this)||this;i._transformations=r;return i}t.prototype.addNodeFilter=function(e){var t=$m(e),r=t.criteria,i=h(t,["criteria"]);return this._transformations.add(new Qm(r),i)};t.prototype.addEdgeFilter=function(e){var t=$m(e),r=t.criteria,i=h(t,["criteria"]);return this._transformations.add(new Jm(r),i)};return t}(Ct);var ty=function(){function e(e,t){var r=this;this._ogma=e;if(Zf==="webgl"){zu.cacheInitData(zu.createInitData())}this.settings=new gc;this.events=new cc;this.dom=new Nt(this,t.dimensions);this.animations=new Av(this);this.camera=new lc(this);this.graph=new Ii(this,e);this.data=new Rt(this);this.graphics=new Kf(this,e);this.individualAttributes=new pc(this);this.algorithms=new Kv(this);this.touch=new ov(this);this.mouse=new rp(this);this.virtualMouse=new Zp(this);this.spatial=new Jc(this);this.captor=new i_(this);this.interactions=new $g(this);this.classes=new bc(this);this.cameraInteractions=new f_(this,!!t.debug);this.hover=new Vm(this);this.keyboard=new L_(this);this.selection=new vv(this);this.styleRules=new ig(this);this.legend=new Pm(this);this.sync=new pv(this);this.rules=new Ym(this);this.transformations=new dv(this,e);this.filters=new ey(this);this.locate=new iv(this);this.grouping=new sv(this);this.pulses=new yv(this);this.drag=new u_(this);this.curvatureManager=new ip(this);this.tasks=new pp(this);this.layouts=new Ep(this);this.generators=new Tp(this);this.watcher=new kp(this);this.pathfinding=new Wp(this);this.rectangleSelect=new ug(this);this.labels=new Kg(this,t);this.brand=new Dv(this);this.lasso=new og(this);this.rewiring=new v_(this);this.resizing=new g_(this);this.snapping=new Jp(this);this.connectNodes=new m_(this);this.tooltip=new w_(this);this.geo=new Vv(this);e.onReady(function(){Object.keys(r).forEach(function(e){var i=r[e];if(i instanceof Ct){i.onMounted(r._ogma,t)}})})}e.prototype.destroy=function(){var e=this;Object.keys(this).forEach(function(t){var r=e[t];if(r instanceof Ct){r.destroy(e._ogma)}})};return e}();var ry=function(e){return{shortestPath:function(t){return e.modules.algorithms.shortestPath(t)},hasCycle:function(t){var r=t===void 0?{}:t,i=r.nodes,n=r.edges;return e.algorithms.detectCycle({nodes:i,edges:n})!==null},getAllSimpleCycles:function(t){var r=t===void 0?{}:t,i=r.nodes,n=r.edges;if(!i){i=e.getNodes()}if(!n){n=i.getAdjacentEdges({bothExtremities:true})}return e.modules.algorithms.getAllSimpleCycles(i,n)},detectCycle:function(t){var r=t===void 0?{}:t,i=r.nodes,n=r.edges;if(!i){i=e.getNodes()}if(!n){n=i.getAdjacentEdges({bothExtremities:true})}return e.modules.algorithms.detectCycle(i,n)}}};var iy=function(){function e(){}e.initNamespace=function(e){e.algorithms=ry(e)};return e}();var ny=function(){function e(){}e.prototype.createClass=function(e,t){return this.modules.classes.createClass(Object.assign({},t,{name:e}))};e.prototype.updateClass=function(e,t){return this.modules.classes.getClassByName(e,true).update(t)};e.prototype.getNodesByClassName=function(e){return this.modules.classes.getClassByName(e,true).getNodes()};e.prototype.getEdgesByClassName=function(e){return this.modules.classes.getClassByName(e,true).getEdges()};return e}();var ay=function(){function e(){}e.prototype.getHoveredElement=function(){return this.modules.captor.getPointedElement()};e.prototype.getPointerInformation=function(){return this.modules.captor.getCursorInformation()};return e}();var oy=function(e){return{wait:function(e){return new Promise(function(t){return setTimeout(t,e)})},initRandomGraph:function(t){return e.generate.random(t).then(e.setGraph).then(function(){return e.view.locateGraph()}).then(function(){return e.view.afterNextFrame()})},initGrid:function(t){var r=Math.ceil(Math.sqrt(t));return e.generate.grid({rows:r,columns:r}).then(function(t){return e.setGraph(t)}).then(function(){return e.view.locateGraph()})},initLine:function(t){e.setGraph({nodes:[{id:0,attributes:{x:0,y:0}},{id:1,attributes:t?{x:0,y:50}:{x:50,y:0}}],edges:[{id:0,source:1,target:0}]});return e.view.locateGraph()},initSingleNode:function(){e.setGraph({nodes:[{id:0,attributes:{x:0,y:0}}],edges:[]});return e.view.locateGraph()},initContinuousRenderLoop:function(t){var r=t===void 0?{}:t,i=r.triggerKey,n=i===void 0?"r":i,a=r.start,o=a===void 0?true:a;var s=o;var u=function(){if(s){e.modules.dom.beforeNextFrame().then(u)}};document.addEventListener("keydown",function(e){var t=e.key;if(t===n){s=!s;u()}});u()},appendToBody:function(){var t=document.createElement("div");t.style.position="absolute";t.style.top="0";t.style.left="0";t.style.bottom="0";t.style.right="0";document.body.appendChild(t);e.setContainer(t)},loadFile:function(t){var r=t.endsWith(".gexf")?e.parse.gexfFromUrl(t):e.parse.jsonFromUrl(t);return r.then(function(t){return e.setGraph(t)}).then(function(){return e.view.locateGraph()}).then(function(){return e.view.afterNextFrame()})},enableLasso:function(t){e.events.onDragStart(function(){if(e.keyboard.isKeyPressed("ctrl")){e.tools.lasso.enable(t)}})},randomizeGraph:function(t){var r=t===void 0?{}:t,i=r.minX,n=i===void 0?0:i,a=r.minY,o=a===void 0?0:a,s=r.maxX,u=s===void 0?500:s,l=r.maxY,d=l===void 0?500:l;return e.getNodes().setAttributes(e.getNodes().map(function(){return{x:n+Math.random()*(u-n),y:o+Math.random()*(d-o)}}))}}};var sy=function(){function e(){}e.initNamespace=function(e){e.debug=oy(e)};return e}();var uy=function(){function e(){}e.prototype.setContainer=function(e){this.modules.dom.setContainer(e)};e.prototype.getContainer=function(){return this.modules.dom.getContainer()};return e}();var ly=function(e){return{removeListener:function(t){e.modules.events.removeListener(t)},onNodesAdded:function(t){e.modules.events.on("addNodes",t);return e},onBeforeNodesRemoved:function(t){e.modules.events.on("beforeRemoveNodes",t);return e},onNodesRemoved:function(t){e.modules.events.on("removeNodes",t);return e},onEdgesAdded:function(t){e.modules.events.on("addEdges",t);return e},onBeforeEdgesRemoved:function(t){e.modules.events.on("beforeRemoveEdges",t);return e},onEdgesRemoved:function(t){e.modules.events.on("removeEdges",t);return e},onNodesClassAdded:function(t,r){e.modules.classes.onNodeClassAdded(t,r);return e},onNodesClassRemoved:function(t,r){e.modules.classes.onNodeClassRemoved(t,r);return e},onEdgesClassAdded:function(t,r){e.modules.classes.onEdgeClassAdded(t,r);return e},onEdgesClassRemoved:function(t,r){e.modules.classes.onEdgeClassRemoved(t,r);return e},onNodeDragStart:function(t){e.modules.events.on("startMoveNodesByDragging",t);return e},onNodeDragProgress:function(t){e.modules.events.on("progressMoveNodesByDragging",t);return e},onNodeDragEnd:function(t){e.modules.events.on("endMoveNodesByDragging",t);return e},onKeyPress:function(t,r){e.modules.keyboard.onKeyPress(t,r);return e},onNodesSelected:function(t){return e.events.onNodesClassAdded(Cl,t)},onNodesUnselected:function(t){return e.events.onNodesClassRemoved(Cl,t)},onEdgesSelected:function(t){return e.events.onEdgesClassAdded(Cl,t)},onEdgesUnselected:function(t){return e.events.onEdgesClassRemoved(Cl,t)},onNodeDataChange:function(t){e.modules.events.on("updateNodeData",t);return e},onEdgeDataChange:function(t){e.modules.events.on("updateEdgeData",t);return e},onMouseMove:function(t){e.modules.events.on(It.MOVE,t);return e},onMouseButtonDown:function(t){e.modules.events.on(It.DOWN,t);return e},onMouseButtonUp:function(t){e.modules.events.on(It.UP,t);return e},onClick:function(t){e.modules.events.on(It.CLICK,t);return e},onDoubleClick:function(t){e.modules.events.on(It.DOUBLE_CLICK,t);return e},onMouseWheel:function(t){e.modules.events.on(It.WHEEL,t);return e},onHover:function(t){e.modules.events.on(It.HOVER,t);return e},onUnhover:function(t){e.modules.events.on(It.UNHOVER,t);return e},onDragStart:function(t){e.modules.events.on(It.DRAG_START,t);return e},onDragProgress:function(t){e.modules.events.on(It.DRAG_PROGRESS,t);return e},onDragEnd:function(t){e.modules.events.on(It.DRAG_END,t);return e},onGestureStart:function(t){e.modules.events.on(It.GESTURE_START,t);return e},onGestureProgress:function(t){e.modules.events.on(It.GESTURE_PROGRESS,t);return e},onGestureEnd:function(t){e.modules.events.on(It.GESTURE_END,t);return e},onRendererStateChange:function(t){e.modules.events.on("rendererStateChange",t);return e},onZoomProgress:function(t){e.modules.events.on("cameraZoom",t);return e},onViewChanged:function(t){e.modules.events.on(It.VIEW_CHANGED,t);return e},onNodesConnected:function(t){e.modules.events.on("connectedNodes",t);return e},onGeoModeEnabled:function(t){e.modules.events.on("geoEnabled",t);return e},onGeoModeDisabled:function(t){e.modules.events.on("geoDisabled",t);return e},onGeoModeLoaded:function(t){e.modules.events.on("geoLoaded",t);return e},onLayoutStart:function(t){e.modules.events.on(mp,t);return e},onLayoutComplete:function(t){e.modules.events.on(yp,t);return e},onLayoutComputed:function(t){e.modules.events.on(bp,t);return e},onTooltipShown:function(t){e.modules.events.on("showTooltip",t);return e},onTooltipHidden:function(t){e.modules.events.on("hideTooltip",t);return e}}};var dy=function(){function e(){}e.initNamespace=function(e){e.events=ly(e)};return e}();function hy(e){return e instanceof gi?e.getId():e}function fy(e){return e instanceof Vr?e.getId():e}function cy(e){if(e instanceof _i){return e.getId()}if(e instanceof gi){return[e.getId()]}if(x(e)){return e.map(hy)}return[hy(e)]}function vy(e){if(e instanceof jr){return e.getId()}if(e instanceof Vr){return[e.getId()]}if(x(e)){return e.map(fy)}return[fy(e)]}function py(e,t,r){if(e==null){return}if(Array.isArray(e)){return e[0]}if(e==="source"){return py(r.color.get(t.getSource()._index))}if(e==="target"){return py(r.color.get(t.getTarget()._index))}return e}function gy(e){if(e==null){return null}if(typeof e==="string"||typeof e==="number"){return""+e}return e&&gy(e.content)}function _y(e){if(e==null){return}if(typeof e==="string"){return e}return e.type}var my=["color","radius","shape","text.content","x","y"];var yy=["color","width","shape.type","text.content"];function by(e){if(e!=="all"){return{nodes:["x","y"],edges:[]}}return{nodes:my,edges:yy}}function xy(e,t){var r=t.nodes,i=t.edges;var n=e.getOriginalAttributes();return{nodes:r.reduce(function(e,t){e[t.getId()]={x:n.nodes.x.get(t._index),y:n.nodes.y.get(t._index),color:py(n.nodes.color.get(t._index)),radius:n.nodes.radius.get(t._index),shape:n.nodes.shape.get(t._index),text:{content:n.nodes.text.content.get(t._index)}};return e},{}),edges:i.reduce(function(e,t){e[t.getId()]={color:py(n.edges.color.get(t._index)),width:n.edges.width.get(t._index),shape:{type:n.edges.shape.type.get(t._index)},text:{content:n.edges.text.content.get(t._index)}};return e},{})}}function Ay(e){return{nodes:e.nodes.map(function(e){var t=e.id,r=e.attributes,i=r===void 0?{}:r,n=e.data;var a=i.color,o=i.radius,s=i.shape,u=i.text,l=i.x,d=i.y;return{id:t,x:l,y:d,color:py(a),size:o,shape:s,text:gy(u),data:n}}),edges:e.edges.map(function(e){var t=e.id,r=e.source,i=e.target,n=e.attributes,a=n===void 0?{}:n,o=e.data;var s=a.color,u=a.width,l=a.text,d=a.shape;return{id:t,source:r,target:i,color:py(s),size:u,shape:_y(d),text:gy(l),data:o}})}}function Ey(e,t){if(e){return cy(e)}if(typeof t==="object"){return cy(t.nodes)}return t}function Sy(e,t){if(e){return vy(e)}if(typeof t==="object"){return vy(t.edges)}return t}function wy(e,t,r,i){var n=Ey(t,i);var a=Sy(r,i);return{nodes:e.getNodes(n),edges:e.getEdges(a)}}function Ty(e,t){var r=t.nodeAttributes,i=t.edgeAttributes,n=t.nodes,a=t.edges,o=t.filter,s=t.nodeData,u=t.edgeData;var l=wy(e,n,a,o);return{nodes:l.nodes.toJSON({attributes:r,data:s}),edges:l.edges.toJSON({attributes:i,data:u})}}function Cy(e,t,r){var i=r.styles,n=r.nodes,a=r.edges,o=r.filter,s=r.nodeData,u=r.edgeData;var l=by(i),d=l.nodes,h=l.edges;var f=Ty(e,{nodeAttributes:d,edgeAttributes:h,nodes:n,edges:a,filter:o,nodeData:s,edgeData:u});if(i==="original"){var c=xy(t,wy(e,n,a,o));for(var v=0,p=f.nodes;v<p.length;v++){var g=p[v];g.attributes=c[g.id]}for(var _=0,m=f.edges;_<m.length;_++){var y=m[_];y.attributes=c[y.id]}}if(i==="all"){f.edges.forEach(function(t){var r=t.source,i=t.target,n=t.attributes;if(n.color==="source"){n.color=e.getNode(r).getAttribute("color")}if(n.color==="target"){n.color=e.getNode(i).getAttribute("color")}})}return Ay(f)}function Iy(e,t){for(var r=0;r<t.length;++r){if(e===undefined||e===null){return undefined}e=e[t[r]]}return e}function My(e,t,value){for(var r=0;r<t.length-1;++r){var i=t[r],n=e[i];if(n===undefined){n={};e[i]=n}e=n}e[t[t.length-1]]=value}function Ly(e){var t=d({},e[0]);for(var r=0,i=e;r<i.length;r++){var n=i[r];for(var a=0,o=Object.keys(n);a<o.length;a++){var s=o[a];if(!(s in t)){t[s]=undefined}}}return Object.keys(t)}function ky(value,e){if(value==null||Array.isArray(value)&&!value.length){return e}return value}function Ny(e){return typeof e==="string"}function Fy(e,t,r,i){var n=t==="edges";var a={};var o=function(e){var o=A(ky(r(e),t));if(!o.every(Ny)){throw Error("The tab "+t+" function returned an invalid value.")}var s=A(i(e.data,o));o.forEach(function(t,r){var i=ky(s[r],{});var o=d({},i,{id:e.id},n?{source:e.source,target:e.target}:{});var u=Ca(o).reduce(function(e,t){var r=t.path,value=t.value;e[r]=value;return e},{});a[t]=a[t]||[];a[t].push(u)})};for(var s=0,u=e;s<u.length;s++){var l=u[s];o(l)}return a}function zy(e){if(!e.length){return[]}var t=Ly(e);var r=t.indexOf("source")>-1?["id","source","target"]:["id"];var i=r.concat(t.filter(function(e){return r.indexOf(e)===-1}));var n=[i];var a=function(e){n.push(i.map(function(t){return e[t]}))};for(var o=0,s=e;o<s.length;o++){var u=s[o];a(u)}return n}function Ry(e,t,r){var i=new Ia,n=t?1:3,a=[];var o=function(o){var s=e[o],u=new Array(n),l=s.data;if(r){var d={};r.forEach(function(e){var t=C(e),value=Iy(l,t);My(d,t,value)});l=d}var h=Ca(l);u[0]=s.id;if(!t){u[1]=s.source;u[2]=s.target}for(var f=0;f<h.length;++f){var c=h[f],v=c.path,value=c.value;if(v.length){if(i.has(v)){u[i.get(v)]=value}else{i.set(v,n);u[n]=value;n++}}}a.push(u)};for(var s=0;s<e.length;++s){o(s)}var u=[];u.push("id");if(!t){u.push("source");u.push("target")}i.keys().forEach(function(e){return u.push(e[e.length-1])});a.unshift(u);a.forEach(function(e){return e.length=n});return a}var Py={what:undefined,dataProperties:undefined,separator:",",textSeparator:'"',download:true,filename:"graph.csv",filter:"visible",nodes:undefined,edges:undefined,nodeData:function(e){return e},edgeData:function(e){return e},styles:"none"};var Oy=function(e){return{csv:function(t){var r=gr(t,Py),i=r.what,n=r.dataProperties,a=r.nodes,o=r.edges,s=r.separator,u=r.textSeparator,l=r.download,d=r.nodeData,h=r.edgeData,f=r.filename,c=r.filter;var v=Cy(e.modules.graph,e.modules.individualAttributes,{styles:"none",nodes:a,edges:o,filter:c,nodeData:d,edgeData:h});try{var p=Dy(v,{what:i,separator:s,textSeparator:u,dataProperties:n});if(l){Le(p,f,"text")}return Promise.resolve(p)}catch(e){return Promise.reject(e)}}}};function Dy(e,t){var r=t.what,i=t.separator,n=t.textSeparator,a=t.dataProperties;var o=new RegExp(""+n,"g");function s(e){e=By(e);e=n+e.replace(o,"\\$&")+n;return e}if(n&&n!=='"'&&n!=="'"){throw new TypeError('Invalid argument :"textSeparator" is not single-quote or double-quote, was '+n)}if(r!=="nodes"&&r!=="edges"){throw new TypeError('missing argument: "what": should have value "nodes" or "edges"')}var u=r==="nodes";var l=u?e.nodes:e.edges;var d=Ry(l,u,a).map(function(e){return e.map(function(value){return s(value)})});return d.map(function(e){return e.join(i)}).join("\n")}function By(e){if(e instanceof Date){return e.toISOString()}return""+e}var Vy={creator:undefined,description:undefined,styles:"all",download:true,filename:"graph.gexf",nodes:undefined,edges:undefined,nodeData:function(e){return e},edgeData:function(e){return e},filter:"visible"};var jy=function(e){return{gexf:function(t){if(t===void 0){t={}}var r=gr(t,Vy),i=r.styles,n=r.nodes,a=r.edges,o=r.download,s=r.filename,u=r.creator,l=r.description,d=r.filter,h=r.nodeData,f=r.edgeData;var c=Cy(e.modules.graph,e.modules.individualAttributes,{styles:i,nodes:n,edges:a,filter:d,nodeData:h,edgeData:f});var v=Uy(c,{creator:u,description:l});if(o){Le(v,s,"text")}return Promise.resolve(v)}}};function Uy(e,t){var r=new Pi;var i=Za();var n={};var a={};var o=0;var s=0;var u;var l=i.createElement("gexf");l.setAttribute("xmlns","http://www.gexf.net/1.2draft");l.setAttribute("xmlns:viz","http://www.gexf.net/1.2draft/viz");l.setAttribute("xmlns:xsi","http://www.w3.org/2001/XMLSchema-instance");l.setAttribute("xsi:schemaLocation","http://www.gexf.net/1.2draft http://www.gexf.net/1.2draft/gexf.xsd");l.setAttribute("version","1.2");var d=i.createElement("meta");d.setAttribute("lastmodifieddate",rt());if(t.creator){var h=i.createElement("creator");u=i.createTextNode(""+t.creator);h.appendChild(u);d.appendChild(h)}if(t.description){var f=i.createElement("description");u=i.createTextNode(""+t.description);f.appendChild(u);d.appendChild(f)}var c=i.createElement("graph");c.setAttribute("mode","static");var v=i.createElement("nodes");e.nodes.forEach(function(e){var t=i.createElement("node");t.setAttribute("id",e.id);if(e.text){t.setAttribute("label",Ze(e.text))}if(Hy(e.data)){var a=Wy(e.data);var s=i.createElement("attvalues");Object.keys(a).forEach(function(e){if(!(e in n)){n[e]={id:o,type:"integer"};o++}var t=a[e];n[e].type=qy(t,n[e].type);var r=i.createElement("attvalue");r.setAttribute("for",n[e].id);r.setAttribute("value",Ze(t));s.appendChild(r)});t.appendChild(s)}if(e.color){var u=r.parseColor(e.color);var l=i.createElement("viz:color");l.setAttribute("r",Gy(u[0]));l.setAttribute("g",Gy(u[1]));l.setAttribute("b",Gy(u[2]));l.setAttribute("a",u[3]);t.appendChild(l)}var d=i.createElement("viz:position");d.setAttribute("x",e.x);d.setAttribute("y",-e.y);t.appendChild(d);if(e.size){var h=i.createElement("viz:size");h.setAttribute("value",e.size);t.appendChild(h)}v.appendChild(t)});var p=i.createElement("attributes");p.setAttribute("class","node");Object.keys(n).forEach(function(e){var t=i.createElement("attribute");t.setAttribute("id",n[e].id);t.setAttribute("title",e);t.setAttribute("type",n[e].type);p.appendChild(t)});var g=i.createElement("edges");e.edges.forEach(function(e){var t=i.createElement("edge");t.setAttribute("id",e.id);t.setAttribute("source",e.source);t.setAttribute("target",e.target);if(e.size){t.setAttribute("weight",e.size)}if(e.text){t.setAttribute("label",Ze(e.text))}if(Hy(e.data)){var n=Wy(e.data);var o=i.createElement("attvalues");Object.keys(n).forEach(function(e){if(!(e in a)){a[e]={id:s,type:"integer"};s++}var t=n[e];a[e].type=qy(t,a[e].type);var r=i.createElement("attvalue");r.setAttribute("for",a[e].id);r.setAttribute("value",Ze(t));o.appendChild(r)});t.appendChild(o)}if(e.color){var u=r.parseColor(e.color);var l=i.createElement("viz:color");l.setAttribute("r",Gy(u[0]));l.setAttribute("g",Gy(u[1]));l.setAttribute("b",Gy(u[2]));l.setAttribute("a",u[3]);t.appendChild(l)}if(e.size){var d=i.createElement("viz:size");d.setAttribute("value",e.size);t.appendChild(d)}g.appendChild(t)});var _=i.createElement("attributes");_.setAttribute("class","edge");Object.keys(a).forEach(function(e){var t=i.createElement("attribute");t.setAttribute("id",a[e].id);t.setAttribute("title",e);t.setAttribute("type",a[e].type);_.appendChild(t)});c.appendChild(p);c.appendChild(_);c.appendChild(v);c.appendChild(g);l.appendChild(d);l.appendChild(c);i.appendChild(l);return'<?xml version="1.0" encoding="UTF-8"?>'+i.serialize()}function Gy(value){return Math.round(value*255)}function qy(e,t){if(t==="integer"&&typeof e==="number"){if(e%1!==0){return"float"}}else if(typeof e!=="number"){if(typeof e==="boolean"){return"boolean"}return"string"}return t}function Hy(value){return typeof value==="object"&&value!==null&&value.constructor===Object}function Wy(e,t){if(t===void 0){t={}}P(e,function(value,e){if(Hy(value)){Wy(value,t)}else{t[e]=value}});return t}var Xy={graphId:"G",directedEdges:true,styles:"all",download:true,filename:"graph.graphml",nodes:undefined,edges:undefined,nodeData:function(e){return e},edgeData:function(e){return e},filter:"visible"};var Yy=function(e){return{graphml:function(t){if(t===void 0){t={}}var r=gr(t,Xy),i=r.styles,n=r.nodes,a=r.edges,o=r.download,s=r.filename,u=r.graphId,l=r.directedEdges,d=r.filter,h=r.nodeData,f=r.edgeData;var c=Cy(e.modules.graph,e.modules.individualAttributes,{styles:i,nodes:n,edges:a,filter:d,nodeData:h,edgeData:f});var v=Zy(c,{graphId:u,directedEdges:l,noStyles:i==="none"});if(o){Le(v,s,"text")}return Promise.resolve(v)}}};function Zy(e,t){var r=new Pi;var i=Ae();function n(e){return r.parseColor(e)}function a(e){return r.toHexa(e)}function o(e,t){var r=n(t);e.r=r[0];e.g=r[1];e.b=r[2]}function s(e,t,r,n,force){r=r||{};var a=i.createElement(t);for(var o in r){if(!r.hasOwnProperty(o)){continue}var value=r[o];if(value!==undefined){a.setAttribute(o,value)}}if(n!==undefined||force){if(Object.prototype.toString.call(n)==="[object Object]"){n=JSON.stringify(n)}a.appendChild(i.createTextNode(n))}e.appendChild(a);return a}var u=["id","source","target"];var l=["size","x","y","shape","text","color"];var d={size:{for:"all",type:"double"},x:{for:"node",type:"double"},y:{for:"node",type:"double"},shape:{for:"all",type:"string"},color:{for:"all",type:"string"},r:{for:"all",type:"int"},g:{for:"all",type:"int"},b:{for:"all",type:"int"},a:{for:"all",type:"double"},text:{for:"all",type:"string"}};if(t.noStyles){delete d["color"];delete d["r"];delete d["g"];delete d["b"];delete d["a"];delete d["shape"];l.pop()}var h=[];var f=[];function c(e,t){var r={id:e.id};l.forEach(function(i){var value=e[i];if(i==="y"&&value){value=-parseFloat(value)}if(value!==undefined){r[(t==="edge"?"edge_":"")+i]=value;if(i==="color"){o(r,value)}}});var i=e.data||{};P(i,function(value,e){if(l.indexOf(e)!==-1||u.indexOf(e)!==-1){return}if(!d[e]){d[e]={for:t,type:"string"}}else if(d[e].for!==t){d[e].for="all"}r[e]=value});if(t==="edge"){r.source=e.source;r.target=e.target;f.push(r)}else{h.push(r)}}e.nodes.forEach(function(e){return c(e,"node")});e.edges.forEach(function(e){return c(e,"edge")});var v=s(i,"graphml",{xmlns:"http://graphml.graphdrawing.org/xmlns","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xsi:schemaLocation":"http://graphml.graphdrawing.org/xmlns "+"http://www.yworks.com/xml/schema/graphml/1.1/ygraphml.xsd","xmlns:y":"http://www.yworks.com/xml/graphml","xmlns:java":"http://www.yworks.com/xml/yfiles-common/1.0/java","xmlns:sys":"http://www.yworks.com/xml/yfiles-common/markup/primitives/2.0","xmlns:x":"http://ww.yworks.com/xml/yfiles-common/markup/2.0"});P(d,function(value,e){if(value.for==="node"||value.for==="all"){s(v,"key",{"attr.name":e,"attr.type":value.type,for:"node",id:e})}if(value.for==="edge"||value.for==="all"){s(v,"key",{"attr.name":e,"attr.type":value.type,for:"edge",id:"edge_"+e})}});s(v,"key",{id:"nodegraphics",for:"node","yfiles.type":"nodegraphics","attr.type":"string"});s(v,"key",{id:"edgegraphics",for:"edge","yfiles.type":"edgegraphics","attr.type":"string"});var p=s(v,"graph",{edgedefault:t.directedEdges||t.directedEdges===undefined?"directed":"undirected",id:t.graphId?t.graphId:"G","parse.nodes":e.nodes.length,"parse.edges":e.edges.length,"parse.order":"nodesfirst"});function g(e,r){var i=s(e,"data",{key:"nodegraphics"});var n=s(i,"y:ShapeNode");s(n,"y:Geometry",{x:r.x,y:r.y,width:r.size,height:r.size});if(!t.noStyles){s(n,"y:Fill",{color:a(r.color),transparent:false})}s(n,"y:NodeLabel",null,r.text||"");s(n,"y:Shape",{type:r.shape})}function _(e,r){var i=s(e,"data",{key:"edgegraphics"});var n=s(i,"y:PolyLineEdge");s(n,"y:LineStyle",{type:r.edge_type,color:t.noStyles?undefined:a(r.edge_color),width:r.edge_size});s(n,"y:EdgeLabel",null,r.edge_label)}h.forEach(function(e){var t=s(p,"node",{id:e.id});g(t,e);P(e,function(value,e){if(u.indexOf(e)!==-1){return}s(t,"data",{key:e},value,true)})});f.forEach(function(e){var t=s(p,"edge",{id:e.id,source:e.source,target:e.target});_(t,e);P(e,function(value,e){if(u.indexOf(e)!==-1){return}s(t,"data",{key:e},value,true)})});var m=Ee(i);return'<?xml version="1.0" encoding="UTF-8"?>\n'+m}var Ky={nodeAttributes:["x","y","color","radius","shape","text"],edgeAttributes:["color","width","text"],nodeData:function(e){return e},edgeData:function(e){return e},filter:"visible",pretty:false,download:true,filename:"graph.json"};var Qy=function(e){return{json:function(t){if(t===void 0){t={}}var r=X(t,Ky),i=r.nodeAttributes,n=r.edgeAttributes,a=r.nodeData,o=r.edgeData,s=r.filter,u=r.pretty,l=r.download,d=r.filename;var h=Ty(e.modules.graph,{nodeAttributes:i,edgeAttributes:n,filter:s,nodeData:a,edgeData:o});var f=u?JSON.stringify(h,null," "):JSON.stringify(h);if(l){Le(f,d,"text")}return Promise.resolve(f)}}};function Jy(e,t){var r=e.view.get();var i=typeof t.margin==="number"?t.margin:0;var n={pixelRatio:1,angle:0,backgroundColor:null,zoom:0,x:0,y:0,width:0,height:0,hideImages:false};if(t.width&&t.height){n.width=t.width;n.height=t.height}else{n.width=r.width;n.height=r.height}if(t.clip){n.zoom=r.zoom;n.x=r.x;n.y=r.y}else{var a=e.getNodes(t.filter);var o=a.getBoundingBox().computeForZoom(r.zoom).extend(eo.fromValues(a.getAttribute("x"),a.getAttribute("y"),a.map(function(e){return e.getAttribute("radius")+e.getAttribute("innerStroke.width")+e.getAttribute("outerStroke.width")})));if(t.texts){var s=e.modules.labels.getTextsBoundingBox();if(s.isValid()){o.extend(s)}}if(!isFinite(t.width)||!isFinite(t.height)){var u=e.view.graphToScreenCoordinates(o.bottomLeft());var l=e.view.graphToScreenCoordinates(o.topRight());var d=l.x-u.x,h=l.y-u.y;var f=Math.min(n.width/d,n.height/h);n.width=d*f;n.height=h*f}n.x=o.cx;n.y=o.cy;n.width=Math.max(n.width,i*2+1);n.height=Math.max(n.height,i*2+1);n.zoom=Math.min((n.width-i*2)/o.width,(n.height-i*2)/o.height)}if(e.modules.geo.isEnabled()){n.backgroundColor=null}else if(t.background!==undefined){n.backgroundColor=t.background}return n}function $y(e,t,r,i,n){if(n===void 0){n=false}r.hideImages=n;r.isBufferDisplayable=function(e){return t.texts||!rh(e)};var a={};if(t.badges===false){var o={text:null,image:null};a.badges={topLeft:o,topRight:o,bottomRight:o,bottomLeft:o}}e.styles.getClass(kl).update({nodeAttributes:a});return e.modules.graphics.export(i,r,t.filter,t)}var eb=function(e){return{png:function(t){if(t===void 0){t={}}return lb(e,t,"png")},jpg:function(t){if(t===void 0){t={}}return lb(e,t,"jpg")},tiff:function(t){if(t===void 0){t={}}return lb(e,t,"tiff")},gif:function(t){if(t===void 0){t={}}return lb(e,t,"gif")}}};function tb(e){return{download:true,filter:"visible",filename:"graph."+e,clip:false,margin:10,width:undefined,height:undefined,background:null,badges:true,legend:undefined,texts:true,images:true,textWatermark:{content:null,fontFamily:"Arial",fontSize:48,fontStyle:null,fontColor:"red",repeat:false,angle:0,alpha:.65,space:50,x:undefined,y:undefined},imageWatermark:{url:null,width:undefined,height:undefined,repeat:false,angle:0,alpha:.65,space:50,x:undefined,y:undefined},imageCrossOrigin:undefined}}var rb={png:tb("png"),jpg:tb("jpg"),tiff:tb("tiff"),gif:tb("gif")};function ib(e){var t=e.canvas,r=e.parameters;if(r.textWatermark.content){vb(t,r.textWatermark,db,hb)}if(r.imageWatermark.url){return De(r.imageWatermark.url).then(function(i){if(i){r.imageWatermark.content=i;vb(t,r.imageWatermark,cb,fb)}return e})}else{return e}}function nb(e){var t=e.ogma,r=e.canvas,i=e.parameters;var n=t.modules.legend;var a=null;if(i.legend===undefined){a=n.enabled()?n.getCurrentOptions():false}if(i.legend===true){a={}}if(a){n.exportOnCanvas(r,a)}return e}function ab(e){var t=e.ogma,r=e.view;if(!t.modules.geo.isEnabled()){return e}return t.modules.geo.exportBackground(r).then(function(t){var i=ub(e.view);var n=i.getContext("2d");n.drawImage(t,(r.width-t.width)/2,(r.height-t.height)/2);n.drawImage(e.canvas,0,0);e.canvas=i;return e})}function ob(e){var t=e.ogma,r=e.parameters,i=e.canvas,n=e.view;var a=i.getContext("2d");return $y(t,r,n,"canvas",!r.images).then(function(i){try{i.getContext("2d").getImageData(0,0,1,1);a.drawImage(i,0,0);return e}catch(i){vr(i);return $y(t,r,n,"canvas",true).then(function(t){a.drawImage(t,0,0);return e})}})}function sb(e){var t=e.canvas,r=e.parameters,i=e.type;var n=t.toDataURL("image/"+i);if(r.download){Le(n,r.filename,"dataURL")}return n}function ub(e){var t=e.width,r=e.height;var i=Se();i.width=t;i.height=r;return i}function lb(e,t,r){t=gr(t,rb[r]);if(t.background===null){t.background=e.modules.graphics.getTransparentBackgroundColor()}var i=Jy(e,t);var n=ub(i);var a={ogma:e,parameters:t,canvas:n,view:i,type:r};return Promise.resolve(a).then(ab).then(ob).then(ib).then(nb).then(sb)}function db(e,t,r,i){e.textAlign="center";e.textBaseline="middle";e.fillText(t,r,i)}function hb(e,t,r){return{width:e.measureText(t).width,height:r}}function fb(e,t,r,i,n){return{width:i===undefined?t.width:i,height:n===undefined?t.height:n}}function cb(e,t,r,i,n,a){e.drawImage(t,r-n/2,i-a/2,n,a)}function vb(e,t,r,i){if(!t){return}if(typeof t!=="object"){t={content:t}}else if(!t.content){return}var n=t.fontFamily,a=t.fontSize,o=t.fontStyle,s=t.fontColor,u=t.repeat,l=t.angle,d=t.alpha,h=t.space,f=t.content;var c=e.getContext("2d");var v=e.width;var p=e.height;var g=t.x===undefined?v/2:t.x;var _=t.y===undefined?p/2:t.y;var m=t.height;var y=t.width;l=l/180*Math.PI;Ye(c,n,a,o);c.fillStyle=s;c.globalAlpha=d;var b=i(c,f,a,y,m);if(!u){c.save();c.translate(g,_);c.rotate(l);r(c,f,0,0,b.width,b.height);c.restore()}else{var x=b.width+h;var A=b.height+h;var E=Math.sqrt(v*v+p*p);c.save();c.translate(0,0);c.rotate(l);for(var S=0;S<E;S+=x){for(var w=0;w<E;w+=A){r(c,f,S,w,b.width,b.height);if(w!==0){r(c,f,S,-w,b.width,b.height)}}}c.restore()}}var pb=function(e){return{svg:function(t){if(t===void 0){t={}}return _b(e,t)}}};var gb={download:true,filename:"graph.svg",width:undefined,height:undefined,background:null,texts:true,images:true,badges:true,embedFonts:false,clip:false,margin:10,prefix:"ogma"};function _b(e,t){t=X(t,gb);var r=t.background,i=t.filename,n=t.download;var a=e.modules.graphics;if(r===null){t.background=a.getTransparentBackgroundColor()}var o=Jy(e,t);return $y(e,t,o,"svg",!t.images).then(function(e){e.removeAttribute("pointer-events");e.setAttribute("version","1.1");e.setAttributeNS(ze,"xmlns",Fe);e.setAttributeNS(ze,"xmlns:xlink",Re);return e}).then(function(r){return mb(e,r,t)}).then(function(e){return bb(e,t)}).then(function(e){var t=Ee(e);var r='<?xml version="1.0" encoding="utf-8"?>'+t;if(n){Le(r,i)}return r})}function mb(e,t,r){var i=t.childNodes[2];var n=i.childNodes;var a={};var o=r.prefix;for(var s=0;s<n.length;s++){var u=n[s];var l=u.getAttribute(yu);a[l]=a[l]||[];a[l].push(u)}var d=Object.keys(a);var h=e.modules.graph;var f=h.getNodeAttribute("id");var c=h.getEdgeAttribute("id");var v=Pe("g",{class:o+"-edges"});var p=Pe("g",{class:o+"-nodes"});for(var s=0;s<d.length;s++){var g=d[s];var _=g.charAt(0)==="n";var m=parseInt(g.substring(1));var y=a[g];var b=Ze((_?f:c).get(m).toString());var x=Pe("g");x.setAttribute("data-"+(_?"node":"edge")+"-id",b);x.setAttribute("class",o+"-"+(_?"node":"edge"));for(var A=0;A<y.length;A++){var u=y[A];x.appendChild(u);u.removeAttribute(yu)}(_?p:v).appendChild(x)}i.appendChild(v);i.appendChild(p);return t}function yb(e){var t=[].concat(Array.prototype.slice.call(e.getElementsByTagName("text")||[]),Array.prototype.slice.call(e.getElementsByTagName("tspan")||[]));var r=[];var i={};for(var n=0;n<t.length;n++){var a=t[n];var o=a.getAttribute("font-family");if(typeof o==="string"){var s=o.split(",");for(var u=0;u<s.length;u++){var l=s[u].replace(/['"]/g,"");if(l!==""&&!i[l]){i[l]=true;r.push(l)}}}}return{list:r,map:i}}function bb(e,t){var r=yb(e).map;return aa().then(function(e){return e.filter(function(e){return r[e.name]})}).then(function(e){return oa(e,!!t.embedFonts)}).then(function(t){if(t.length!==0){var r=Pe("style");for(var i=0;i<t.length;i++){r.appendChild(Oe(t[i]))}e.childNodes[0].appendChild(r)}return e})}var xb={what:undefined,dataProperties:undefined,filter:"visible",nodes:undefined,edges:undefined,download:true,filename:"graph.xlsx",tab:undefined,nodeData:undefined,edgeData:undefined};var Ab=function(e){return{xlsx:function(t){if(typeof t==="string"){t={what:t}}var r=gr(t,xb),i=r.what,n=r.nodes,a=r.edges,o=r.download,s=r.filename,u=r.tab,l=u===void 0?{}:u,d=r.dataProperties,h=r.filter,f=r.nodeData,c=r.edgeData;if(!l.nodes){l.nodes=function(){return"nodes"}}if(!l.edges){l.edges=function(){return"edges"}}var v=Cy(e.modules.graph,e.modules.individualAttributes,{styles:"none",nodes:n,edges:a,filter:h,nodeData:function(e){return e},edgeData:function(e){return e}});var p=Eb(v,{what:i,tabFunctions:l,tabContentFunctions:{nodes:f||function(e){return K(U(e||{}),d)},edges:c||function(e){return K(U(e||{}),d)}}});if(o){Le(p,s,"blob")}return Promise.resolve(p)}}};function Eb(e,t){var r=t.what,i=t.tabFunctions,n=t.tabContentFunctions;var a=m("XLSX")||m("xlsx",{throwOnError:true});var o=new Tb;if(r){if(r!=="nodes"&&r!=="edges"){throw new TypeError('Invalid argument: "what" is not "nodes" or "edges", was '+r)}if(r==="nodes"){e.edges=[]}if(r==="edges"){e.nodes=[]}}var s={};for(var u=0,l=["nodes","edges"];u<l.length;u++){var d=l[u];var h=Fy(e[d],d,i[d],n[d]);for(var f=0,c=Object.keys(h);f<c.length;f++){var v=c[f];s[v]=(s[v]||[]).concat(h[v])}}for(var p=0,g=Object.keys(s);p<g.length;p++){var v=g[p];o.SheetNames.push(v);o.Sheets[v]=wb(a,zy(s[v]))}var _=a.write(o,{bookType:"xlsx",bookSST:false,type:"binary"});var y=Ie([Cb(_)]);return y}function Sb(e){if(e===undefined){return""}else if(e instanceof Date){return e.toISOString()}else{return""+e}}function wb(e,t){var r={};var i={s:{c:1e7,r:1e7},e:{c:0,r:0}};for(var n=0;n!==t.length;++n){var a=t[n];for(var o=0;o!==a.length;++o){var value=a[o];if(i.s.r>n){i.s.r=n}if(i.s.c>o){i.s.c=o}if(i.e.r<n){i.e.r=n}if(i.e.c<o){i.e.c=o}var s={v:Sb(value)};var u=e.utils.encode_cell({c:o,r:n});r[u]=s}}if(i.s.c<1e7){r["!ref"]=e.utils.encode_range(i)}return r}var Tb=function(){function e(){this.SheetNames=[];this.Sheets={}}return e}();function Cb(e){var t=new ArrayBuffer(e.length);var r=new Uint8Array(t);for(var i=0;i!==e.length;++i){r[i]=e.charCodeAt(i)&255}return t}var Ib=function(e){e.styles.createClass({name:kl,isBuiltin:true});return d({},Oy(e),jy(e),Yy(e),Qy(e),eb(e),pb(e),Ab(e))};var Mb=function(){function e(){}e.initNamespace=function(e){e.export=Ib(e)};return e}();function Lb(e){if(e===void 0)e={};var t=e.children;if(t===void 0)t=2;var r=e.height;if(r===void 0)r=3;if(!Yl(t)){throw new TypeError('Invalid argument: "children" is not a positive number, was '+t)}if(!Xl(r)){throw new TypeError('Invalid argument: "height" is not a positive number, was '+r)}return{children:t,height:r}}function kb(e){var t=e.children;var r=e.height;r+=1;var i=Math.pow(t,r),n=[],a=[],o=1,s=0,u=0;for(var l=0;l<r;++l){var d=i/(o+1)/1.5;for(var h=0;h<o;++h){var f=s++;n.push({id:f,attributes:{x:(h+1)*d*10,y:l*20}});if(l!==r-1){for(var c=0;c<t;++c){a.push({id:u,source:f,target:f*t+c+1});u+=1}}}o*=t}return{nodes:n,edges:a}}var Nb={configure:Lb,generate:kb};function Fb(e){if(e===void 0)e={};var t=e.nodes;if(t===void 0)t=40;var r=e.m0;if(r===void 0)r=5;var i=e.m;if(i===void 0)i=1;var n=e.scale;if(n===void 0)n=100;if(!Wl(t)||t<3){throw new TypeError("Invalid argument: options.nodes is not a number >= 3, was "+t)}if(!Wl(r)||r>=t){throw new TypeError("Invalid argument: options.m0 is not a number < "+t+", was "+r)}if(!Wl(r)||i>=r){throw new TypeError("Invalid argument: options.m is not a number <= "+r+", was "+i)}if(!Wl(n)||n<0){throw new TypeError("Invalid argument: options.scale is not a number or is less than 0")}return{nodes:t,m0:r,m:i,scale:n}}function zb(e){var t={nodes:[],edges:[]},r={},i=[],n,a,o,s,u,l,d,h,f=e.scale,c=0,v=e.nodes,p=e.m0,g=e.m;var _=f/10;for(n=0;n<p;n++){t.nodes.push({id:n,attributes:{x:Math.random()*_,y:Math.random()*_}});i[n]=0}for(n=0;n<p;n++){for(a=n+1;a<p;a++){o={id:c++,source:n,target:a};r[o.source+"-"+o.target]=o;t.edges.push(o);i[n]++;i[a]++}}for(n=p;n<v;n++){t.nodes.push({id:n,attributes:{x:Math.random()*f,y:Math.random()*f}});i[n]=0;s=0;for(a=0;a<n;a++){s+=i[a]}u=0;for(l=0;l<g;l++){d=Math.random();h=0;for(a=0;a<n;a++){if(r[n+"-"+a]||r[a+"-"+n]){continue}if(n==1){h=1}else{h+=i[a]/s+u/(n-l)}if(d<=h){u+=i[a]/s;o={id:c++,source:n,target:a};r[o.source+"-"+o.target]=o;t.edges.push(o);i[n]++;i[a]++;break}}}}return t}var Rb={configure:Fb,generate:zb};function Pb(e){if(e===void 0)e={};var t=e.nodes;if(t===void 0)t=20;var r=e.edges;var i=e.p;if(!Wl(t)||t<3){throw new TypeError("Invalid argument: options.nodes is not a number >= 3, was "+t)}if(r!==undefined&&i!==undefined){throw new TypeError("Invalid argument: choose between options.edges and options.p")}if(r===undefined&&i===undefined){i=.1}return{nodes:t,edges:r,p:i}}function Ob(e){var t={nodes:[],edges:[]},r,i,n,a=0,o=e.nodes,s=e.p;if(e.p>=0){for(i=0;i<o;i++){t.nodes.push({id:i,attributes:{x:Math.random()*100,y:Math.random()*100}});for(n=0;n<i;n++){if(Math.random()<s){t.edges.push({id:a++,source:i,target:n})}}}}else{var u=[],l=e.edges;for(i=0;i<o;i++){t.nodes.push({id:i,x:Math.random()*100,y:Math.random()*100,size:1});for(n=i+1;n<o;n++){u.push({source:i,target:n})}}a=u.length-1;for(i=0;i<l;i++){r=u.splice(Math.floor(Math.random()*a),1)[0];r.id=i;t.edges.push(r);a--}}return t}var Db={configure:Pb,generate:Ob};var Bb=5;var Vb=10;var jb=10;var Ub=2.7;var Gb=1/5;function qb(e){var t=e.depth;if(t===void 0)t=3;var r=e.breadth;if(r===void 0)r=3;var i=e.nbNodes;if(i!==undefined){r=5;t=Math.ceil(Math.log(i)/Math.log(5))}return{depth:t,breadth:r,nbNodes:i}}function Hb(e){var t=e.depth;var r=e.breadth;var i=e.nbNodes;var n={id:0,attributes:{x:0,y:0,radius:Xb(t+1)}};var a={nodes:[n],edges:[]};Yb(a,r,t,n,1);if(i!==undefined){a.nodes=a.nodes.slice(0,i);a.edges=a.edges.slice(0,Math.max(i-1,0))}return a}function Wb(e){return Math.pow(Ub,e)*Vb}function Xb(e){return Bb+Wb(e)/jb}function Yb(e,t,r,i,n){if(r===0){return n}var distance=Wb(r);var a=Xb(r);var o=a*Gb;var s=-Math.PI;var u=Math.PI*2/t;var l=i.attributes.x;var d=i.attributes.y;for(var h=0;h<t;++h){var f=Math.cos(s);var c=Math.sin(s);var v={id:n,attributes:{x:l+distance*f,y:d+distance*c,radius:a}};var p={id:n,source:i.id,target:n,attributes:{width:o}};e.nodes.push(v);e.edges.push(p);n=Yb(e,t,r-1,v,n+1);s+=u}return n}var Zb={configure:qb,generate:Hb};function Kb(e){if(e===void 0)e={};var t=e.rows;if(t===void 0)t=4;var r=e.columns;if(r===void 0)r=4;var i=e.columnDistance;if(i===void 0)i=20;var n=e.rowDistance;if(n===void 0)n=20;var a=e.xmin;if(a===void 0)a=0;var o=e.ymin;if(o===void 0)o=0;return{rows:t,columns:r,columnDistance:i,rowDistance:n,xmin:a,ymin:o}}function Qb(e){var t=e.rows;var r=e.columns;var i=e.columnDistance;var n=e.rowDistance;var a=e.xmin;var o=e.ymin;var s={nodes:[],edges:[]};var u=0;for(var l=0;l<t;++l){for(var d=0;d<r;++d){var h=l*r+d;s.nodes.push({id:h,attributes:{x:a+d*i,y:o+l*n}});if(d!==r-1){s.edges.push({id:u,source:h,target:l*r+d+1});u+=1}if(l!==t-1){s.edges.push({id:u,source:h,target:(l+1)*r+d});u+=1}}}return s}var Jb={configure:Kb,generate:Qb};function $b(e){var t=e===void 0?{}:e,r=t.nodes,i=r===void 0?10:r,n=t.edges,a=n===void 0?10:n,o=t.texts,s=o===void 0?false:o;return{nodes:i,edges:a,texts:s}}function ex(e){var t=e.nodes,r=e.edges,i=e.texts;var n=Math.max(t,200);var a=[];var o=[];for(var s=0;s<t;s++){a.push({id:s,attributes:{x:Math.random()*n,y:Math.random()*n,text:i?"Node "+s:undefined}})}for(var s=0;s<r;s++){o.push({id:s,source:Math.random()*t|0,target:Math.random()*t|0,attributes:{text:i?"Edge "+s:undefined}})}return{nodes:a,edges:o}}var tx={configure:$b,generate:ex};function rx(e){if(e===void 0)e={};var t=e.nodes;if(t===void 0)t=50;var r=e.width;if(r===void 0)r=100;var i=e.height;if(i===void 0)i=100;var n=e.x;if(n===void 0)n=0;var a=e.y;if(a===void 0)a=0;if(!isFinite(t)||t<1){throw new RangeError("Tree generator: number of nodes must be a positive integer")}return{nodes:t,width:r,height:i,x:n,y:a}}function ix(e){var t=e.nodes;var r=e.x;var i=e.y;var n=e.width;var a=e.height;var o=r-n/2;var s=i-a/2;return{nodes:new Array(t).fill(0).map(function(e,t){return{id:t,attributes:{x:o+Math.random()*n,y:s+Math.random()*a}}}),edges:new Array(t-1).fill(0).map(function(e,t){return{id:t,source:Math.floor(Math.sqrt(t)),target:t+1}})}}var nx={configure:rx,generate:ix};function ax(e){if(e===void 0)e={};var t=e.length;if(t===void 0)t=5;return{length:t}}function ox(e){var t=e.length;var r={nodes:[],edges:[]};if(t<=0){return r}r.nodes.push({id:0,attributes:{x:Math.random()*100,y:Math.random()*100}});for(var i=1;i<t;++i){r.nodes.push({id:i,attributes:{x:Math.random()*100,y:Math.random()*100}});r.edges.push({id:i-1,source:i-1,target:i})}return r}var sx={configure:ax,generate:ox};var ux=function(e){return{balancedTree:function(t){return e.modules.generators.load("balancedTree",t)},barabasiAlbert:function(t){return e.modules.generators.load("barabasiAlbert",t)},erdosRenyi:function(t){return e.modules.generators.load("erdosRenyi",t)},flower:function(t){return e.modules.generators.load("flower",t)},grid:function(t){return e.modules.generators.load("grid",t)},path:function(t){return e.modules.generators.load("path",t)},random:function(t){return e.modules.generators.load("random",t)},randomTree:function(t){return e.modules.generators.load("randomTree",t)}}};var lx=function(){function e(){}e.initNamespace=function(e){e.modules.generators.register("balancedTree",Nb);e.modules.generators.register("barabasiAlbert",Rb);e.modules.generators.register("erdosRenyi",Db);e.modules.generators.register("flower",Zb);e.modules.generators.register("grid",Jb);e.modules.generators.register("random",tx);e.modules.generators.register("randomTree",nx);e.modules.generators.register("path",sx);e.generate=ux(e)};return e}();var dx=function(e){return{enable:function(t){return e.modules.geo.enable(t)},disable:function(t){return e.modules.geo.disable(t)},setOptions:function(t){return e.modules.geo.setOptions(t)},getOptions:function(){return e.modules.geo.getOptions()},getMap:function(){return e.modules.geo.getMap()},enabled:function(){return e.modules.geo.isEnabled()},getCenter:function(){return e.modules.geo.getCenter()},getView:function(){return e.modules.geo.getView()},getZoom:function(){return e.modules.geo.getZoom()},setZoom:function(t){return e.modules.geo.setZoom(t)},setView:function(t,r,i){return e.modules.geo.setView(t,r,i)},setCenter:function(t,r){return e.modules.geo.setCenter(t,r)},toggle:function(t){return e.modules.geo.toggle(t)},resetCoordinates:function(){return e.modules.geo.resetCoordinates()},updateCoordinates:function(){return e.modules.geo.updateCoordinates()},getUnprojectedCoordinates:function(t){return e.modules.geo.getUnprojectedCoordinates(e.getNodes(t))}}};var hx=function(){function e(){}e.initNamespace=function(e){e.geo=dx(e)};return e}();function fx(e,t,r){return gx(e,true,[t],r)}function cx(e,t,r){return gx(e,false,[t],r)}function vx(e,t,r){return gx(e,true,t,r)}function px(e,t,r){return gx(e,false,t,r)}function gx(e,t,r,i,n){if(i===void 0){i={}}if(n===void 0){n=false}var a;if(!Array.isArray(r)&&!(r instanceof(t?_i:jr))){r=[r]}var o=e.getElements(t,r);if(!n){o=o.dedupe()}if(!o.size){return Promise.resolve()}if(t){var s=o.getAdjacentEdges({filter:"all"});gx(e,false,s,i,true)}var u=i.virtual,l=u===void 0?false:u;var d=o._indexes;var h=e.storage.fetch(t);var f=e.getCacheLists(t);var c=h.getFlexArray("removed");var v=h.getFlexArray("virtual");var p=Qt(v.getMultiple(d));if(p!==(l?d.length:0)){throw new Error("Attempting to remove virtual elements; you should not do that")}var g=(a={virtual:l},a[t?"nodes":"edges"]=o,a);e.fireEvent(t?It.BEFORE_REMOVE_NODES:It.BEFORE_REMOVE_EDGES,g);f.visible.invalidList();f.all.invalidList();if(!l){f.raw.invalidList()}e.setExcluded(o,true);c.setMultiple(d,1);if(!t){for(var _=0;_<d.length;++_){e.topology.removeFromAdjacencyList(d[_])}}h.removeElements(d);e.setIndexFreeStep(1);e.fireEvent(t?It.REMOVE_NODES:It.REMOVE_EDGES,g);return Promise.resolve()}var _x=function(){function e(){}e.prototype.addNodes=function(e,t){return Ti(this.modules.graph,true,e,t)};e.prototype.addEdges=function(e,t){return Ti(this.modules.graph,false,e,t)};e.prototype.addNode=function(e,t){return Si(this.modules.graph,true,e,t)};e.prototype.addEdge=function(e,t){return Si(this.modules.graph,false,e,t)};e.prototype.removeNodes=function(e,t){return vx(this.modules.graph,e,t)};e.prototype.removeEdges=function(e,t){return px(this.modules.graph,e,t)};e.prototype.removeNode=function(e,t){return fx(this.modules.graph,e,t)};e.prototype.removeEdge=function(e,t){return cx(this.modules.graph,e,t)};e.prototype.getNodes=function(e){return this.modules.graph.getNodes(e)};e.prototype.getEdges=function(e){return this.modules.graph.getEdges(e)};e.prototype.getNode=function(e){return this.modules.graph.getNode(e)};e.prototype.getEdge=function(e){return this.modules.graph.getEdge(e)};e.prototype.clearGraph=function(){this.modules.graph.clear()};e.prototype.setGraph=function(e,t){this.modules.graph.clear();return this.addGraph(e,t)};e.prototype.addGraph=function(e,t){return wi(this.modules.graph,e,t)};e.prototype.createNodeList=function(){return this.getNodes([])};e.prototype.createEdgeList=function(){return this.getEdges([])};e.prototype.getConnectedComponents=function(e){if(e===void 0){e={}}return this.modules.graph.getConnectedComponents(this.getNodes(e.filter),e)};e.prototype.getConnectedComponentByNode=function(e,t){var r=this.modules.graph.getNode(e);if(r===undefined){throw new Error("getComponentByNode: cannot find node "+e)}return this.modules.graph.getConnectedComponentByNode(r,t)[0]};return e}();var mx=function(){function e(){}e.prototype.reloadFonts=function(){this.modules.graphics.reloadFonts()};return e}();var yx=Gx(" ");var bx=Gx("<");var xx=Gx(">");var Ax=Gx('"');var Ex=Gx("\n");var Sx=Gx("\r");var wx=Gx("/");var Tx=Gx("\\");var Cx=Gx("a");var Ix=Gx("z");var Mx=Gx("A");var Lx=Gx("Z");var kx=Gx("0");var Nx=Gx("9");var Fx=Gx(":");var zx=-1;var Rx=-2;var Px=-3;var Ox=-4;function Dx(e){var t=new Int32Array(e.length);for(var r=0,i=e.length;r<i;++r){t[r]=e.charCodeAt(r)}return t}function Bx(e,t,r,i){var n=i.length;if(r-t!==n){return false}for(var a=0;a<n;++a){if(e[t+a]!==i[a]){return false}}return true}function Vx(e,t,r,i){return Ux(e.tags,t,r,i)}function jx(e,t,r,i){return Ux(e.attributes,t,r,i)}function Ux(e,t,r,i){var n=e.length;for(var a=0;a<n;++a){if(Bx(t,r,i,e[a])){return a}}e.push(t.slice(r,i));return n}function Gx(e){return e.charCodeAt(0)}function qx(e,t,r){var i,n,a;r=Xx(t,r);i=t[r];if(i===xx||i===wx){return r}n=r;r=Zx(t,r);a=jx(e,t,n,r);while(t[r]!==Ax){++r}++r;n=r;while((i=t[r])!==Ax){if(i===Tx){++r}++r}e.tokens.push(Px,a,n,r);return r+1}function Hx(e,t){var r,i,n,a,o=e.length;var s={tags:[],attributes:[],tokens:[]};var u=s.tokens;t=Xx(e,t);while(t<o){a=e[t];if(a===bx){t=Xx(e,++t);if(e[t]===wx){u.push(Rx);while(e[++t]!==xx){}}else{r=t;t=Zx(e,r);n=Vx(s,e,r,t);u.push(zx,n);a=e[t];while(a!==xx&&a!==wx){t=qx(s,e,t);a=e[t]}if(a===wx){u.push(Rx);while(e[++t]!==xx){}}}t+=1}else{r=t;while(e[++t]!==bx){}i=t-1;while(Wx(e[i])){--i}u.push(Ox,r,i+1)}t=Xx(e,t)}return s}function Wx(e){return e===yx||e===Ex||e===Sx}function Xx(e,t){while(Wx(e[t])){++t}return t}function Yx(e){return e>=Cx&&e<=Ix||e>=Mx&&e<=Lx||e===Fx||e>=kx&&e<=Nx}function Zx(e,t){while(Yx(e[t])){++t}return t}function Kx(e,t){var r=["this.id = undefined;","this.attributes = {","  text: undefined,","  color: undefined,","  "+(e?"radius":"width")+": undefined",e?"  ,x: undefined":"",e?"  ,y: undefined":"","};"];if(!e){r.push("this.source = undefined;","this.target = undefined;")}var i=Object.keys(t);if(i.length){r.push("  this.data = {")}for(var n=0;n<i.length;++n){var a=i[n],o=t[a],s=o.title;r.push('  "'+s+'": '+(o.default!==undefined?JSON.stringify(o.default):undefined)+(n===i.length-1?"":","))}if(i.length){r.push("};")}return new Function(r.join("\n"))}function Qx(e){if(e.indexOf("\\")===-1){return e}e=e.replace(/\\"/g,'"');return e}function Jx(e){if(e.indexOf("<gexf")===-1){throw new Error("not a GEXF file")}var t=Dx(e),r=Hx(t,e.indexOf("<gexf ")),i={},n={};r.tags.forEach(function(e,t){var r=String.fromCharCode.apply(null,e);i[r]=t});r.attributes.forEach(function(e,t){var r=String.fromCharCode.apply(null,e);n[r]=t});var a=i.attributes;var o=i.attribute;var s=i.node;var u=i.edge;var l=i.default;var d=i["viz:position"];var h=i["viz:size"];var f=i["viz:color"];var c=i.attvalue;var v=n.class;var p=n.id;var g=n.type;var _=n.title;var m=n.label;var y=n.source;var b=n.target;var x=n.x;var A=n.y;var E=n.r;var S=n.g;var w=n.b;var T=n.a;var C=n.value;var I=n.for;var M=n.weight;var L=4;var k=5;var N=6;var F=1;var z=2;var R=3;var P=4;var O=5;var D={float:F,double:F,integer:z,boolean:R,string:P,"list-string":O};var B=0,V=r.tokens,j=V.length;var U=new Array(16);var G=0;var q=0;var H=0;var W=true;var X={};var Y={};var Z=null;var K=null;var Q=null;var J=undefined;var $=null;var ee=0,te=0,re=0,ie=1;var ne=null;var ae=undefined;var oe=false;var se=true;var ue=null;var le=null;var de=[];var he=[];var fe=0;var ce=null;var value;while(B<j){var ve=V[B];if(ve===zx){q=G;G=V[B+1];U[H]=G;H+=1;if(G===s){if(!ue){ue=Kx(true,X)}$=new ue;se=true;ce=X}else if(G===u){if(!le){le=Kx(false,Y)}$=new le;se=false;ce=Y}B+=2}else if(ve===Rx){if(Z&&G===o){ce=W?X:Y;var pe=D[K];value=J;if(value){if(pe===F){value=+value}else if(pe===z){value=+value|0}else if(pe===R){value=value==="true"}else if(pe===O){value=value.split(" ").filter(function(e){return e})}}ce[Z]={title:Q||Z,type:pe,default:value};Z=null;Q=null;K=null;J=undefined}else if(G===s&&H===L){if(oe){$.attributes.color="rgba("+ee+", "+te+", "+re+", "+ie+")";ee=0;te=0;re=0;ie=1;oe=false}if(!$.id){$.id=++fe}de.push($)}else if(G===u&&H===L){if(!$.id){$.id=++fe}he.push($)}else if(G===c&&H===N&&ne){var ge=(se?X:Y)[ne];if(ge){if(ae===undefined){ae=ge.default}else{var _e=ge.type;if(_e){if(_e===F){ae=+ae}else if(_e===z){ae=+ae|0}else if(_e===R){ae=ae==="true"}else if(_e===O){ae=ae.split(" ").filter(function(e){return e}).map(function(e){return Qx(e)})}else if(typeof t==="string"){ae=Qx(ae)}}}$.data[ce[ne].title]=ae}ne=null;ae=null}H-=1;G=q;q=U[H-2];B+=1}else if(ve===Px){var me=V[B+1];value=e.substring(V[B+2],V[B+3]);if(G===a){if(me===v){W=value!=="edge"&&value!=="edges"}}else if(G===o){if(me===p){Z=value}else if(me===g){K=value}else if(me===_){Q=value}}else if((G===s||G===u)&&H===L){if(me===p){$.id=value}else if(me===m){$.attributes.text=value}else if(me===y){$.source=value}else if(me===b){$.target=value}else if(me===M){$.attributes.width=+value}}else if(G===d&&H===k){if(me===x){$.attributes.x=+value}else if(me===A){$.attributes.y=-value}}else if(G===f&&H===k){oe=true;if(me===E){ee=value}else if(me===S){te=value}else if(me===w){re=value}else if(me===T){ie=value}}else if(G===h&&H===k){if(me===C){if(se){$.attributes.radius=+value}else{$.attributes.width=+value}}}else if(G===c&&H===N){if(me===I||me===p){ne=value}else if(me===C){ae=value}}B+=4}else if(ve===Ox){value=e.substring(V[B+1],V[B+2]);if(G===l){J=value}B+=3}else{throw new Error("at index "+B+": token "+ve)}}return{nodes:de,edges:he}}function $x(e){var t=[],r=[];var i=function(e){if(!e||typeof e!=="object"){return}if(e.type==="vertex"){var n={};if(e.properties){Object.keys(e.properties).forEach(function(t){n[t]=e.properties[t][0].value})}t.push({id:e.id+"",data:{id:e.id+"",categories:[e.label],properties:n}})}else if(e.type==="edge"){r.push({id:e.id+"",source:e.inV+"",target:e.outV+"",data:{id:e.id+"",type:e.label,properties:e.properties||{}}})}else if(Array.isArray(e)){e.forEach(function(e){return i(e)})}else{Object.keys(e).forEach(function(t){return i(e[t])})}};i(e);return{nodes:t,edges:r}}function eA(e,t,r){r=r||t;if(t in e){if(!e.attributes){e.attributes={}}e.attributes[r]=e[t]}}function tA(e){var t=JSON.parse(e);var r=t.nodes||[];var i=t.edges||[];for(var n=0;n<r.length;n++){var a=r[n];if(typeof a.size==="string"){a.size=+a.size}if(typeof a.x==="string"){a.x=+a.x}if(typeof a.y==="string"){a.y=+a.y}eA(a,"x");eA(a,"y");eA(a,"size","radius");eA(a,"color");eA(a,"text")}for(var n=0;n<i.length;n++){var o=i[n];if(typeof o.size==="string"){o.size=+o.size}eA(o,"size","width");eA(o,"color");eA(o,"text")}return t}var rA=function e(){this._decimalPowerOfTwo=new Uint8Array(20);this._binaryNumber=new Uint8Array(64);this._decimalNumber=new Uint8Array(20)};rA.prototype._addDecimalNumbers=function e(t,r){var i=0;for(var n=0;n<20;++n){var a=i+t[n]+r[n];i=+(a>=10);t[n]=a%10}};rA.prototype._loadNumberInBits=function e(t,r,i){for(var n=0;n<32;++n){i[n]=+!!(t&1<<n)}for(var a=0;a<32;++a){i[a+32]=+!!(r&1<<a)}return i};rA.prototype._negateBinaryNumber=function e(t){for(var r=0;r<64;++r){t[r]^=1}for(var i=0;i<64&&!(t[i]^=1);++i){}};rA.prototype.int64ToString=function e(t){var r=t.low;var i=t.high;if(r===0&&i===0){return"0"}this._loadNumberInBits(r,i,this._binaryNumber);this._decimalNumber.fill(0);this._decimalPowerOfTwo.fill(0);this._decimalPowerOfTwo[0]=1;var n=this._binaryNumber[63]===1;if(n){this._negateBinaryNumber(this._binaryNumber)}for(var a=0;a<64;++a){if(this._binaryNumber[a]){this._addDecimalNumbers(this._decimalNumber,this._decimalPowerOfTwo)}this._addDecimalNumbers(this._decimalPowerOfTwo,this._decimalPowerOfTwo)}var o=[];var s=this._decimalNumber.length-1;if(n){o.push("-")}while(!this._decimalNumber[s]){s-=1}for(var u=s;u>=0;--u){o.push(this._decimalNumber[u])}return o.join("")};var iA=new rA;function nA(e){return iA.int64ToString(e)}function aA(e){return typeof e==="object"&&"high"in e&&"low"in e}function oA(e){if(typeof e!=="object"||e===null){throw new Error("Ogma can only retrieve nodes and relationships from Neo4j. "+"Please make sure that your Cypher query returns nodes and edges, not values.")}var t=Object.keys(e.properties);for(var r=0,i=t;r<i.length;r+=1){var n=i[r];var a=e.properties[n];if(aA(a)){e.properties[n]=nA(a)}}if(e.identity!==undefined){if(aA(e.identity)){e.identity=nA(e.identity)}if("start"in e&&"end"in e){var o=e.start.identity||e.start;var s=e.end.identity||e.end;if(aA(o)){e.start=nA(o)}if(aA(s)){e.end=nA(s)}}}}var sA=function(e){return"start"in e&&"end"in e&&"type"in e};var uA=function(e){return"segments"in e};function lA(e,t,r,i){t.segments.forEach(function(t){dA(e,t.start,r,i);dA(e,t.end,r,i);dA(e,t.relationship,r,i)})}function dA(e,t,r,i){if(t){if(Array.isArray(t)){t.forEach(function(t){return dA(e,t,r,i)})}else if(uA(t)){lA(e,t,r,i)}else{oA(t);if(sA(t)){if(!i.has(t.identity)){i.add(t.identity);e.edges.push({id:t.identity,source:t.start,target:t.end,data:{neo4jType:t.type,neo4jProperties:t.properties}})}}else{if(!r.has(t.identity)){r.add(t.identity);e.nodes.push({id:t.identity,attributes:{x:Math.random()*100,y:Math.random()*100},data:{neo4jLabels:t.labels,neo4jProperties:t.properties}})}}}}}function hA(e){var t={nodes:[],edges:[]};var r=new Set;var i=new Set;e.records.forEach(function(e){e._fields.forEach(function(e){dA(t,e,r,i)})});return t}var fA=function(e){return{gexf:function(e){return Promise.resolve(Jx(e))},gexfFromUrl:function(e){return Ve(e).then(function(e){return Jx(e)})},janus:function(e){return Promise.resolve($x(e))},json:function(e){return Promise.resolve(tA(e))},jsonFromUrl:function(e){return Ve(e).then(function(e){return tA(e)})},neo4j:function(e){return Promise.resolve(hA(e))}}};var cA=function(){function e(){}e.initNamespace=function(e){e.parse=fA()};e.prototype.fetch=function(e){return Ve(e)};return e}();var vA=function(e){return{isKeyPressed:function(t){return e.modules.keyboard.isPressed(t)},resetKeys:function(){e.modules.keyboard.resetKeys()}}};var pA=function(){function e(){}e.initNamespace=function(e){e.keyboard=vA(e)};return e}();var gA={configure:function(e,t){var r=t.graph,i=t.data;function n(e,t,r){if(r===void 0){r=e.getNodes()}if(!t){return r}if(!(t instanceof _i)){return e.getNodes(t)}return t}function a(e,t){if(!(t instanceof gi)){return e.getNode(t)}return t}function o(e,t,r,i){if(t){if(t==="random"){return"random"}if(t==="radius"){return i.slice()}if(t==="degree"){return r.getDegree()}return e.getProperty(r,t)}}if(e.centralNode===undefined){throw new Error('concentric layout: missing parameter "centralNode"')}var s=d({},e,{centralNode:a(r,e.centralNode),nodes:n(r,e.nodes)});var u=s.centralNode,l=s.nodes;var h=r.getNode(u)._index;var f=s.centralNode.getPosition(),c=f.x,v=f.y;var p=l.getAttribute("layoutable");var g=r.getNodes(l)._indexes;var _=Array.from(g.filter(function(e,t){return p[t]}));if(_.indexOf(h)===-1){_.push(h)}var m=r.getNodeAttribute("radius").getMultiple(g);var y=o(i,s.sortBy,l,m);var b=_.reduce(function(e,t,r){e[t]=r;return e},{});var x=_.map(function(e,t){return t});var A=_.map(function(e){var t=r.topology.getAdjacentElements(true,[e]);return t.map(function(e){return b[e]})});return{sourceNodeIndex:_.indexOf(h),centerX:typeof s.centerX==="number"?s.centerX:c,centerY:typeof s.centerY==="number"?s.centerY:v,list:_,indexes:x,size:_.length,totalSize:_.length,attributes:{adjacentNodes:A,size:m},sortAttr:y,clockwise:s.clockwise===undefined||s.clockwise,circleHopRatio:s.circleHopRatio||5,allowOverlap:!!s.allowOverlap}},context:function(){return{dijkstra:function(e,t,r,i,n){var a=Math.pow(2,31)-1;var o=new Int32Array(i);var s=new Int32Array(i);var u=new Int8Array(i);o.fill(a);s.fill(-1);for(var l=0;l<i;++l){var d=t[l];if(d!==undefined){o[d]=a;s[d]=-1}}o[n]=0;var h;var f=function(){var i=a;h=-1;for(var n=0;n<r;++n){var l=t[n];var d=o[l];if(!u[l]&&d<i){i=d;h=l;u[l]=1}}if(h>-1){var f=e[h];var c=i+1;f.forEach(function(e){var t=o[e];if(c<t){o[e]=c;s[e]=h}})}};while(h!==-1){f()}return o},determinePropertyType:function(e,t,r){if(t.some(function(t){return e[t]!=="number"})){return"string"}return"number"}}},update:function(e,t){function r(e,t,r){if(e==="random"){return function(){return Math.random()-.5}}if(e){var i=r.determinePropertyType(e,t,t.length);if(i==="number"){return function(t,r){return e[t]-e[r]}}return function(t,r){return e[t]<e[r]?-1:1}}}var i=e.attributes,n=e.indexes,a=e.size;var o=e.sourceNodeIndex,s=e.centerX,u=e.centerY,l=e.sortAttr;var d=i.adjacentNodes;var h=i.size;var f=new Array(e.totalSize);var c=new Array(e.totalSize);var v=t.dijkstra(d,n,e.size,e.totalSize,o);var p=0;var g={};for(var _=0;_<a;_++){var m=h[n[_]];if(m>p){p=m}}var y=p*e.circleHopRatio;var b=0;var x=0;var A=Math.PI/9;for(var _=0;_<a;_++){var E=n[_];var distance=v[E];var S=g[distance];if(!S){S=[];g[distance]=S}S.push(E)}var w=r(l,n,t);var T=l==="random"||l;var C=Object.keys(g).sort(function(e,t){return parseInt(e)-parseInt(t)});C.forEach(function(t,r){var i=g[t];var n=i.length;var a=0;var o=x;var l=Math.PI*2/n;if(r!==0&&!e.allowOverlap){var d=Math.PI*2*b;var v=0;a+=i.reduce(function(e,t){return e+h[t]},0);v=a*2*Math.SQRT2;if(v>d){b+=v/(2*Math.PI)-b}}if(T){i.sort(w);if(!e.clockwise){i.reverse()}}for(var p=0;p<n;p++){var _=i[p];f[_]=Math.cos(o)*b+s;c[_]=Math.sin(o)*b+u;m=h[_];var E=e.allowOverlap?1:m/a*n;o+=l*E}b+=y;x+=A});return{x:f,y:c,indexes:e.list}},isRunning:function(){return false},onSync:function(e){var t=e.indexes,r=e.x,i=e.y;return{indexes:t,x:r,y:i}}};var _A=function(e){e.modules.layouts.register("concentric",gA);return{concentric:function(t){return e.modules.layouts.start("concentric",t)}}};function bellmanFord(e){var t=e.sources,r=e.targets,i=e.weights,n=e.source,a=e.target,o=e.undirected,s=o===void 0?false:o,u=e.indexes,l=e.N;l=u?u.length:l;if(!isFinite(l)||l===0){throw new Error("Invalid number of nodes "+l)}var d=new Float32Array(l);var h=new Int32Array(l);var f={};var c=Number.POSITIVE_INFINITY;if(!i){i=[];for(var v=0;v<l;v++){i[v]=1}}if(!u){u=new Uint32Array(l);for(var v=0;v<l;v++){u[v]=v+1}}for(var v=0;v<l;v++){d[v]=c;h[v]=-1;f[u[v]]=v}d[f[n]]=0;var p;for(var v=1;v<=l;v++){p=false;for(var g=0;g<i.length;g++){var _=t[g];var m=r[g];var y=f[_];var b=f[m];if(y!==undefined&&b!==undefined){var x=i[g];var A=d[y]+x;if(d[y]!==c&&A<d[b]){d[b]=A;h[b]=_;p=true}if(s){A=d[b]+x;if(d[b]!==c&&A<d[y]){d[y]=A;h[y]=m;p=true}}}}if(!p){break}}if(p){for(var v=0;v<i.length;v++){var _=t[v];var m=r[v];var y=f[_];var b=f[m];if(y!==undefined&&b!==undefined){var x=i[v];if(d[y]+x<d[b]){return null}}}}var E=null;var S=null;if(a!==undefined){var w=f[a];if(w!==undefined&&d[w]!==c){E=[];for(var v=a;v!==-1;v=h[f[v]]){E.push(v)}E=E.reverse();S=d[w]}}return{distances:d,path:E,pathLength:S}}function johnson(e){var t=e.sources,r=e.targets,i=e.weights,n=e.indexes,a=e.adjacency,o=e.undirected,s=e.ignoreWeights;var u=Number.POSITIVE_INFINITY;var l=n?n.length:a.length;if(!n){n=new Uint32Array(l);for(var d=0;d<l;d++){n[d]=d+1}}var h=new Array(l);var f={};for(var d=0;d<l;d++){h[d]=new Float32Array(l);for(var c=0;c<l;c++){h[d][c]=d===c?0:u}f[n[d]]=d}var v=l;var p=i.length;t=t.slice();r=r.slice();i=i.slice();for(var d=0;d<l;d++){t[p+d]=v;r[p+d]=n[d];i[p+d]=0;if(s){i[d]=1}}var g=bellmanFord({sources:t,targets:r,weights:i,undirected:o,N:l+1,source:v});if(g===null){throw new Error("Graph has negative weight loops")}var _=g.distances;for(var d=0;d<i.length;d++){var m=f[t[d]];var y=f[r[d]];if(m!==undefined&&y!==undefined){i[d]=i[d]+_[m]-_[y]}}t=t.slice(0,p);r=r.slice(0,p);i=i.slice(0,p);for(var d=0;d<l;d++){var b=n[d];var x=dijkstra(a,b,undefined,n,f,s).distances;for(var c=0;c<l;c++){h[d][c]=d===c?0:x[c]}}return h}function removeRadialOverlap(e){var t=e.X,r=e.Y,i=e.sizes,n=e.indexes,a=e.R,o=e.center,s=e.gap,u=s===void 0?0:s,l=e.epsilon,d=l===void 0?.001:l,h=e.maxLoops,f=h===void 0?5:h,c=e.inPlace,v=c===void 0?true:c;var p=n.length;var g=o[0],_=o[1];var m=p;if(!v){t=t.slice();r=r.slice()}var y=circleCircleIntersection;var b=circleSortCompare;var x=n.slice().sort(function(e,i){return b(t[e],r[e],t[i],r[i],g,_)});var A=x[p-1];var E=t[A];var S=r[A];var w=false;for(var T=0;T<m-1;T++){var C=T%p;var I=(T+1)%p;if(T===-1){C=p-1;I=0}C=x[C];I=x[I];var M=t[C];var L=r[C];var k=t[I];var N=r[I];var F=i[C];var z=i[I];var R=F+z+u;var P=b(M,L,k,N,g,_);if(P===-1&&w){P=1}if(R>a){continue}if(P===1||R-distance(M,L,k,N)>d){var O=y(g,_,a,M,L,R);if(O){var D=O[0];w=k>g&&D[0]<g;k=t[I]=D[0];N=r[I]=D[1]}}else{w=false}if(T%p===p-2){var B=x[p-1];var V=x[0];if(r[B]>_&&r[V]>_&&t[B]-i[B]<t[V]+i[B]){var j=0;m=Math.min(p*f,m+p);while(r[x[B]]>_&&r[x[0]]>_&&t[x[B]]<t[x[0]]&&++j<p){x.unshift(x.pop())}}}}var U=E-g;var G=S-_;var q=t[A]-g;var H=r[A]-_;var W=U===q?0:Math.abs(Math.acos((U*q+G*H)/(Math.sqrt(U*U+G*G)*Math.sqrt(q*q+H*H))));if(W!==0){var X=Math.sin(-W);var Y=Math.cos(-W);var Z=void 0;for(var T=0;T<p;T++){Z=x[T];var j=t[Z]-g;var K=r[Z]-_;t[Z]=j*Y-K*X+g;r[Z]=j*X+K*Y+_}}return{X:t,Y:r}}function weightedStress(e,t,r,i,n,a){var o=0;for(var s=0;s<i;s++){for(var u=0;u<i;u++){var l=a[s];var d=a[u];if(l!==d){var h=e[l][d]*n;var f=1/(h*h);if(f){var c=t[l]-t[d];var v=r[l]-r[d];o+=f*Math.pow(h-Math.sqrt(c*c+v*v),2)}}}}return o}function distanceStress(e,t,r,i,n,a,o){var s=0;if(n===-1){return 0}for(var u=0;u<i;u++){for(var l=0;l<i;l++){var d=o[u];var h=o[l];if(d!==h&&(d===n||h===n)){var f=e[d][h]*a;var c=1/(f*f);if(c){var v=t[d]-t[h];var p=r[d]-r[h];s+=c*Math.pow(f-Math.sqrt(v*v+p*p),2)}}}}return s}function constrainedStress(e,t,r,i,n,a,o,s){o=o||0;var weightedStress=0;var distanceStress=0;for(var u=0;u<i;u++){for(var l=0;l<i;l++){var d=s[u];var h=s[l];if(d!==h){var f=e[d][h]*a;var c=1/(f*f);if(c){var v=t[d]-t[h];var p=r[d]-r[h];var g=c*Math.pow(f-Math.sqrt(v*v+p*p),2);weightedStress+=g;if(d===n||h===n){distanceStress+=g}}}}}return(1-o)*weightedStress+o*distanceStress}function stressMinimizationStep(e,t,r,i,n,a,o,s,u){o=o||0;n=typeof n==="undefined"?-1:n;var l=t;var d=r;var h=1e-6;if(n===-1){o=0}var f=t[n];var c=r[n];for(var v=0;v<i;v++){var p=s[v];var g=u(e[n][v]);var _=o/(g*g);if(g===0){continue}var m=0;var y=0;var b=0;var x=t[p];var A=r[p];for(var E=0;E<i;E++){var S=s[E];if(S!==p){var w=e[p][S]*a;var T=1/(w*w);var C=t[S];var I=r[S];if(T!==0){var M=x-C;var L=A-I;var k=M*M+L*L;var N=k<h?0:1/Math.sqrt(k);y+=(1-o)*T*(C+w*(x-C)*N);b+=(1-o)*T*(I+w*(A-I)*N)}m+=T}}var F=(1-o)*m+_;if(F!==0){var M=x-f;var L=A-c;var k=M*M+L*L;k=k<h?0:1/Math.sqrt(k);var z=g===0?0:_*(g*k);l[p]=(y+z*t[p])/F;d[p]=(b+z*r[p])/F}}return{X:l,Y:d}}function stressMinimizationStepGeneral(e,t,r,i,n,a,o,s){o=o||0;n=typeof n==="undefined"?-1:n;var u=t;var l=r;var d=1e-6;if(n===-1){o=0}var h;for(var f=0;f<i;f++){var c=s[f];var v=0;var p=0;var g=0;var _=t[c];var m=r[c];for(var y=0;y<i;y++){var b=s[y];var x=void 0;if(b!==c){var A=0;var E=e[c][b]*a;var S=1/(E*E);if(c===n||b===n){A=S}var w=(1-o)*S+o*A;v+=w;if(S!==0){var T=t[b];var C=r[b];var I=_-T;var M=m-C;var L=I*I+M*M;if(L>d){x=1/Math.sqrt(L)}p+=w*(T+E*(_-T)*x);g+=w*(C+E*(m-C)*x)}}}h=v;if(h!==0){u[c]=p/h;l[c]=g/h}}return{X:u,Y:l}}var mA=function(e,t){return e-t};var yA={imports:{minHeap:minHeap,bellmanFord:bellmanFord,dijkstra:dijkstra,johnson:johnson,distance:distance,circleCircleIntersection:circleCircleIntersection,circleSortCompare:circleSortCompare,weightedStress:weightedStress,distanceStress:distanceStress,constrainedStress:constrainedStress,stressMinimizationStep:stressMinimizationStep,removeRadialOverlap:removeRadialOverlap},configure:function(e,t){if(e===void 0)e={};var r=t.graph;var i=null,n,a,o,s=-1;var u=null;if(e.centralNode!==undefined&&e.centralNode!==null){i=r.getNode(e.centralNode,true);o=i.getPosition();n=isFinite(e.centerX)?parseFloat(e.centerX):o.x;a=isFinite(e.centerY)?parseFloat(e.centerY):o.y;s=i._index}else{throw new Error('concentric layout: missing parameter "centralNode"')}if(!e.nodes){e.nodes=r.getNodes()}if(e.nodes&&!(e.nodes instanceof _i)){e.nodes=r.getNodes(e.nodes)}if(!e.nodes.includes(i)){e.nodes=e.nodes.concat(i)}var l=r.getNodes(e.nodes);var d=l._indexes;var h=l.getAttribute("layoutable");d=d.filter(function(e,t){return h[t]||e===s});d.sort(mA);var f=d.length;var c=r.getConnectedComponents(l,{internalIndexes:true});var v=AA(d,c,s);c=v;var p=r.degrees(d);var g=r.getNodeAttribute("x").getMultiple(d);var _=r.getNodeAttribute("y").getMultiple(d);var m=r.getNodeAttribute("radius").getMultiple(d);var y=r.getEdges()._indexes;var b=r.getEdgeAttribute("source").getMultiple(y);var x=r.getEdgeAttribute("target").getMultiple(y);var A=r.getAdjacencyList({internalIndexes:true,weight:1,indexes:d});var E=isFinite(e.radiusRatio)?parseFloat(e.radiusRatio):Math.SQRT2;var S=isFinite(e.radiusDelta)?parseFloat(e.radiusDelta):0;var w=isFinite(e.nodeGap)?parseInt(e.nodeGap):10;var T=f*(isFinite(e.repulsion)?parseFloat(e.repulsion):1);var C=isFinite(e.maxIterations)?parseInt(e.maxIterations):100;if(C<1){throw new RangeError("maxIterations must be a positive integer")}var I=isFinite(e.iterationsPerRender)?parseInt(e.iterationsPerRender):20;if(I<1){throw new RangeError("iterationsPerRender must be a positive integer")}var M=isFinite(e.epsilon)?parseFloat(e.epsilon):.001;if(M<=0){throw new RangeError("epsilon has to be a positive number")}return{centerIndex:s,centerX:n,centerY:a,list:d,components:v,X:g,Y:_,degree:p,size:f,currStress:Number.POSITIVE_INFINITY,epsilon:M,maxSteps:C,iterationsPerRender:I,attributes:{size:m,adjacency:A,weights:x.map(function(){return 1}),sources:b,targets:x},sortAttr:u,allowOverlap:!!e.allowOverlap,nodeGap:w,radiusRatio:E,radiusDelta:S,repulsion:T,randomize:"randomize"in e?!!e.randomize:true,renderSteps:!!e.renderSteps}},context:function(){return{getHighestNodeSize:function e(t,r){var i=0;for(var n=0,a=r.length;n<a;n++){var o=t[r[n]];if(o>i){i=o}}return i},grid:function e(t,r){if(r===void 0)r=8;var i=t.size;var n=new Float32Array(i);var a=new Float32Array(i);var o,s,u=this.getHighestNodeSize(t.attributes.size,t.list,i);var l=u*r;var d=Math.ceil(Math.sqrt(i));var h=Math.ceil(i/d);var f=-Math.floor((h-1)*l/2);var c=-Math.floor((d-1)*l/2);for(o=0;o<d;o++){for(s=0;s<h;s++){n[o*h+s]=f+s*l;a[o*h+s]=c+o*l}}return{x:n,y:a}},connectSubgraphs:function e(t,r,i,n,a,o){var s,u;function l(e,value){var t=new Uint32Array(e.length+1);t.set(e);t[e.length]=value;return t}var d=function(e){s=t[e];var d=0,h=0;s.forEach(function(e,t){if(a[e]>d){h=t;d=a[e]}});u=s[h];var f=r[o[u]];f.nodes=l(f.nodes,i);f.weights.push(n);f=r[o[i]];f.nodes=l(f.nodes,u);f.weights.push(n)};for(var h=1;h<t.length;h++)d(h)},correctSubgraphsDistances:function e(t,r,i,n,a){var o=Array.prototype.reduce.call(t[i],function(e,t,r){if(r!==i&&t<n&&t>e){e=t}return e},0);var s=n-o-1;for(var u=1;u<r.length;u++){var l=r[u];for(var d=0,h=l.length;d<h;d++){var f=a[l[d]];t[i][f]-=s;t[f][i]-=s}}},establishRadii:function e(t,r,i,n,a,o,s,u){var l=Object.create(null);var d=a[r];var h=d,f=0;var c=d;for(var v in n){var p=n[v];var g=0;var _=0,m=void 0;for(var y=0,b=p.length;y<b;y++){m=a[p[y]];_=Math.max(_,m);g+=m*2+o}var x=g/(2*Math.PI)+_;var A=_+h;var E=u?f+Math.max(u,A):f*s;f=Math.max(f,x,c,E);l[v]=f;h=_}l[0]=0;l[Number.POSITIVE_INFINITY]=f;return l},initData:function e(t,r){t.step=0;t.data=r;t.totalSteps=r.totalSteps;t.currStress=Number.POSITIVE_INFINITY;t.prevStress=0;t.epsilon=t.data.epsilon;var i={},n={};t.normIndexes=r.list.reduce(function(e,a,o){e[o]=i[a]=o;n[a]=r.degree[o];if(a===r.centerIndex){t.centerIndexPos=o}return e},new Uint32Array(r.list.length));var a=t.centerIndexPos;var o=r.components[0].length;this.connectSubgraphs(r.components,r.attributes.adjacency,r.centerIndex,o,n,i);var s=johnson({sources:r.attributes.sources,targets:r.attributes.targets,weights:r.attributes.weights,indexes:r.list,adjacency:r.attributes.adjacency,undirected:true});this.correctSubgraphsDistances(s,r.components,a,o,i);t.D=s;t.rings=this.groupRings(s,a,t.normIndexes);t.radii=this.establishRadii(s,a,t.normIndexes,t.rings,r.attributes.size,r.nodeGap,r.radiusRatio,r.radiusDelta)},groupRings:function e(t,r,i){var n=t[r];var a=Object.create(null);for(var o=0,s=i.length;o<s;o++){if(o!==r){var u=n[o];a[u]=a[u]||[];a[u].push(i[o])}}return a},removeOverlaps:function e(t,r){var i=t.centerIndexPos;var n=r.attributes.size;var a=t.rings;var o=r.X[i];var s=r.Y[i];for(var u in a){var l=a[u];var d=distance(o,s,r.X[l[0]],r.Y[l[0]]);removeRadialOverlap({X:r.X,Y:r.Y,sizes:n,indexes:l,center:[o,s],R:d,gap:r.nodeGap,inPlace:true})}},easingQuadraticInOut:function(e){if((e*=2)<1){return.5*e*e}return-.5*(--e*(e-2)-1)}}},update:function(e,t){e=e||t.data;var r=e.list;var i=e.centerIndex;var n=e.X||new Float32Array(e.size);var a=e.Y||new Float32Array(e.size);var o=null;var s;if(t.step===undefined){t.initData(t,e)}else{t.step++}var u=e.repulsion;var l=function(e){return t.radii[e]||1};if(t.step===0){if(e.randomize){s=t.grid(e);e.X=s.x;e.Y=s.y}e.spent=0}else if(!t.converged){var d=e.maxSteps;var h=e.iterationsPerRender;var f=t.step;var c=Math.min(f+h,d+1);while(f<=c||!t.converged){var v=t.easingQuadraticInOut(Math.min(f,d)/d);t.step=f++;s=stressMinimizationStep(t.D,n,a,e.size,t.centerIndexPos,u,v,t.normIndexes,l);e.X=s.X;e.Y=s.Y;t.prevStress=t.currStress;t.currStress=constrainedStress(t.D,e.X,e.Y,e.size,t.centerIndexPos,u,v,t.normIndexes);t.converged=t.converged||Math.abs(t.currStress-t.prevStress)<=t.epsilon}}if(t.converged){if(t.overlapRemoved||t.data.allowOverlap){t.done=true;o=Object.keys(t.rings).reduce(function(e,i){e[i]=t.rings[i].map(function(e){return r[e]});return e},{})}else{t.removeOverlaps(t,e,i);t.overlapRemoved=true}}return{x:e.X,y:e.Y,indexes:e.list,components:t.overlapRemoved?e.components:undefined,rings:o,centerIndex:t.centerIndexPos,cx:e.centerX,cy:e.centerY,step:t.step,renderSteps:e.renderSteps,converged:t.converged,overlapRemoved:t.overlapRemoved,stress:t.currStress,done:t.done}},isRunning:function(e){if(!e.converged){return true}else{return e.data.allowOverlap?false:!e.done}},onSync:function(e,t){if(e.renderSteps||e.done){return bA(e)}},onEnd:function(e,t){return bA(e)}};function bA(e){var t=e.x,r=e.y;var i=e.indexes.length;var n=t[e.centerIndex]-e.cx;var a=r[e.centerIndex]-e.cy;for(var o=0;o<i;o++){t[o]-=n;r[o]-=a}return{indexes:e.indexes,x:t,y:r}}function xA(e,t){var r=0,i=e.length-1,n;var a;while(r<=i){n=(r+i)/2|0;a=e[n];if(a<t){r=n+1}else if(a>t){i=n-1}else{return n}}return-1}function AA(e,t,r){var i=e.slice().sort(mA),n=[];for(var a=0,o=t.length;a<o;a++){var s=[],u=t[a];var l=false;for(var d=0,h=u.length;d<h;d++){var f=u[d];var c=xA(i,f);if(c!==-1){if(f===r){l=true}s.push(f)}}if(s.length!==0){n[l?"unshift":"push"](s.sort(mA))}}return n}var EA=function(e){e.modules.layouts.register("radial",yA);return{radial:function(t){return e.modules.layouts.start("radial",t)}}};/**
  * @preserve
  * @linkurious/force-layout @ 0.2.0
  * Ogma general-purpose force-directed layout
  */
function SA(){var force=function(){var e=function e(r){var i=t();this.c=1;this.s0=i(" ");this.s1=i(" ");this.s2=i(" ");this.s0-=i(String(r));if(this.s0<0){this.s0+=1}this.s1-=i(String(r));if(this.s1<0){this.s1+=1}this.s2-=i(r);if(this.s2<0){this.s2+=1}i=null};e.prototype.next=function e(){var t=this;return function(){var e=2091639*t.s0+t.c*2.3283064365386963e-10;t.s0=t.s1;t.s1=t.s2;return t.s2=e-(t.c=e|0)}};e.prototype.nextDouble=function e(){var t=this.next();return function(){return t()+(t()*2097152|0)*1.1102230246251565e-16}};e.prototype.nextInt32=function e(){var t=this.next();return function(){return t()*4294967296|0}};function t(){var e=4022871197;return function(t){t=t.toString();for(var r=0;r<t.length;r++){e+=t.charCodeAt(r);var i=.02519603282416938*e;e=i>>>0;i-=e;i*=e;e=i>>>0;i-=e;e+=i*4294967296}return(e>>>0)*2.3283064365386963e-10}}function r(t){return new e(t.toString()).next()}var i=42;var n=r(i);function a(e){n=r(e)}function o(){return(n()-.5)*1e-6}var s=[0,1];var u=[0,2];for(var l=4;l<65535;l<<=2){for(var d=0,h=s.length;d<h;d++){s.push(s[d]|l);u.push((s[d]|l)<<1)}}function f(e,t){return(u[t&255]|s[e&255])+(u[t>>8&255]|s[e>>8&255])*65536+(u[t>>16&255]|s[e>>16&255])*4294967296}function c(e,t){var r=e^t;var i=65535^r;var n=65535^(e|t);var a=e&(t^65535);var o=r|i>>1;var s=r>>1^r;var u=n>>1^i&a>>1^n;var l=r&n>>1^a>>1^a;r=o;i=s;n=u;a=l;o=r&r>>2^i&i>>2;s=r&i>>2^i&(r^i)>>2;u^=r&n>>2^i&a>>2;l^=i&n>>2^(r^i)&a>>2;r=o;i=s;n=u;a=l;o=r&r>>4^i&i>>4;s=r&i>>4^i&(r^i)>>4;u^=r&n>>4^i&a>>4;l^=i&n>>4^(r^i)&a>>4;r=o;i=s;n=u;a=l;u^=r&n>>8^i&a>>8;l^=i&n>>8^(r^i)&a>>8;r=u^u>>1;i=l^l>>1;var d=e^t;var h=i|65535^(d|r);d=(d|d<<8)&16711935;d=(d|d<<4)&252645135;d=(d|d<<2)&858993459;d=(d|d<<1)&1431655765;h=(h|h<<8)&16711935;h=(h|h<<4)&252645135;h=(h|h<<2)&858993459;h=(h|h<<1)&1431655765;return(h<<1|d)>>>0}function v(e,t,r,i){if(r>=i){return}var n=t[r+i>>1];var a=r-1;var o=i+1;var s;while(true){do{a++}while(t[a]<n);do{o--}while(t[o]>n);if(a>=o){break}s=e[a];e[a]=e[o];e[o]=s;s=t[a];t[a]=t[o];t[o]=s}v(e,t,r,o);v(e,t,o+1,i)}function p(e,t){return v(e,t,0,e.length-1)}var g=function e(t,r,i){this.left=null;this.right=null;this.code=t;this.left=r;this.right=i};var _=function e(t,r){this.code=t;this.data=r};var m=function e(t,r){this.code=t;this.data=r};var y;(function(e){e[e["HILBERT"]=1]="HILBERT";e[e["MORTON"]=0]="MORTON"})(y||(y={}));function b(e,t,r,i,n,a){if(n-i<a){var o=new Array(n-i+1);for(var s=i,u=0;s<=n;s++,u++){o[u]=e[t[s]]}return new m(r[i],o)}var l=T(r,i,n);var d=b(e,t,r,i,l,a);var h=b(e,t,r,l+1,n,a);return new g(l,d,h)}function x(e,t,r,i,n){if(n-i===0){return new _(r[i],e[t[i]])}var a=T(r,i,n);var o=x(e,t,r,i,a);var s=x(e,t,r,a+1,n);return new g(a,o,s)}var A=function e(){this.left=null;this.right=null;this.data=null};function E(e,t,r,i,n){var a=new A;var o=[a];var s=[i,n];while(o.length!==0){var u=s.pop();var l=s.pop();var d=o.pop();if(u-l===0){d.code=r[l];d.data=e[t[l]]}else{var h=T(r,l,u);d.code=h;if(l<=h){d.left=new A;o.push(d.left);s.push(l,h)}if(u>h){d.right=new A;o.push(d.right);s.push(h+1,u)}}}return a}function S(e,t,r,i,n,a){var o=new A;var s=[o];var u=[i,n];while(s.length!==0){var l=u.pop();var d=u.pop();var h=s.pop();if(l-d<a){var f=new Array(l-d+1);for(var c=d,v=0;c<=l;c++,v++){f[v]=e[t[c]]}h.code=r[d];h.data=f}else{var p=T(r,d,l);h.code=p;if(d<=p){h.left=new A;s.push(h.left);u.push(d,p)}if(l>p){h.right=new A;s.push(h.right);u.push(p+1,l)}}}return o}function w(e){var t=1<<31;for(var r=0;r<31;r+=1){if(t&e){return r}t>>>=1}return 32}function T(e,t,r){var i=e[t];var n=e[r];if(i===n){return t}var a=w(i^n);var o=t;var s=r-t,u,l,d;do{s=s+1>>1;u=o+s;if(u<r){l=e[u];d=w(i^l);if(d>a){o=u}}}while(s>1);return o}var C=function e(t,r){if(r===void 0)r={};var i=r.getX;var n=r.getY;var a=r.bucketSize;if(a===void 0)a=0;var o=r.sfc;if(o===void 0)o=y.HILBERT;var s=r.recursive;if(s===void 0)s=true;this._bucketSize=0;this._root=null;var u=t.length;var l=new Uint32Array(u);var d=Infinity,h=Infinity,v=-Infinity,g=-Infinity;var _,m,A,w;this._x=i;this._y=n;var T=o===y.HILBERT?c:f;this._project=T;var C=new Uint32Array(u);for(m=0;m<u;m++){_=t[m];A=i(_);w=n(_);if(A<d){d=A}if(w<h){h=w}if(A>v){v=A}if(w>g){g=w}C[m]=m}this._minX=d;this._minY=h;this._maxX=v;this._maxY=g;var I=(1<<16)-1;var M=Math.max(v-d,1);var L=Math.max(g-h,1);var k=I/M;var N=I/L;this._hw=k;this._hh=N;for(m=0;m<u;m++){_=t[m];l[m]=T(k*(i(_)-d),N*(n(_)-h))}p(C,l);if(a===0){this._root=s?x(t,C,l,0,u-1):E(t,C,l,0,u-1)}else{this._root=s?b(t,C,l,0,u-1,a):S(t,C,l,0,u-1,a)}this._bucketSize=a};var I={root:{configurable:true}};I.root.get=function(){return this._root};C.prototype.inOrder=function e(t,r){var i=this._root;var n=[];var a=false;while(!a){if(i){n.push(i);i=i.left}else{if(n.length!==0){i=n.pop();if(t.call(r,i)){break}i=i.right}else{a=true}}}return this};C.prototype.preOrder=function e(t,r){var i=[this._root];while(i.length!==0){var n=i.pop();if(!t.call(r,n)){if(n.right){i.push(n.right)}if(n.left){i.push(n.left)}}}return this};C.prototype.postOrder=function e(t,r){var i=[];var n=this._root,a;do{while(n){if(n.right){i.push(n.right)}i.push(n);n=n.left}n=i.pop();a=i.length-1;if(n.right&&i[a]===n.right){i[a]=n;n=n.right}else{t.call(r,n);n=null}}while(i.length!==0);return this};C.prototype.map=function e(t,r){var i=[];this.inOrder(function(e){i.push(t.call(r,e))});return i};C.prototype.height=function e(){return M(this._root)};C.prototype.toString=function e(t){if(t===void 0)t=function(e){return e.code.toString()};var r=[];L(this._root,"",true,function(e){return r.push(e)},t);return r.join("")};C.prototype.size=function e(){var t=0;this.preOrder(function(){t++});return t};Object.defineProperties(C.prototype,I);function M(e){return e?1+Math.max(M(e.left),M(e.right)):0}function L(e,t,r,i,n){if(e){i(t+(r?"^-- ":"|-- ")+n(e)+"\n");var a=t+(r?"    ":"|   ");if(e.left){L(e.left,a,false,i,n)}if(e.right){L(e.right,a,true,i,n)}}}function k(e){for(var t=e.length-1;t>=0;t--){var r=Math.floor(Math.random()*(t+1));r=Math.max(Math.min(r,t),0);var i=e[t];e[t]=e[r];e[r]=i}return e}var N=function(e){return e.x};var F=function(e){return e.y};var z=function(e){return e.r};function R(e,t,r,i){if(t===void 0)t=N;if(r===void 0)r=F;if(i===void 0)i=z;var n=k(e.slice());var a=n.length;var o=[];var s=0,u;while(s<a){var l=n[s];if(u&&D(u,t(l),r(l),i(l))){s++}else{o=P(o,l,t,r,i);u=V(o,t,r,i);s=0}}return u}function P(e,t,r,i,n){var a=r(t),o=i(t),s=n(t);var u={x:a,y:o,r:s};if(B(u,e,r,i,n)){return[t]}for(var l=0;l<e.length;++l){var d=e[l];var h=r(d),f=i(d),c=n(d);if(!O(u,h,f,c)&&B(U(h,f,c,a,o,s),e,r,i,n)){return[e[l],t]}}for(var v=0;v<e.length-1;v++){for(var p=v+1;p<e.length;p++){var g=e[v],_=e[p];var m=r(g),y=i(g),b=n(g);var x=r(_),A=i(_),E=n(_);if(!O(U(m,y,b,x,A,E),a,o,s)&&!O(U(m,y,b,a,o,s),x,A,E)&&!O(U(x,A,E,a,o,s),m,y,b)&&B(G(m,y,b,x,A,E,a,o,s),e,r,i,n)){return[e[v],e[p],t]}}}throw new Error}function O(e,t,r,i){var n=e.r-i,a=t-e.x,o=r-e.y;return n>=0&&n*n>a*a+o*o}function D(e,t,r,i){var n=e.r-i+1e-6,a=t-e.x,o=r-e.y;return n>0&&n*n>a*a+o*o}function B(e,t,r,i,n){for(var a=0;a<t.length;++a){var o=t[a];if(!D(e,r(o),i(o),n(o))){return false}}return true}function V(e,t,r,i){if(e.length===1){return j(t(e[0]),r(e[0]),i(e[0]))}else if(e.length===2){return U(t(e[0]),r(e[0]),i(e[0]),t(e[1]),r(e[1]),i(e[1]))}return G(t(e[0]),r(e[0]),i(e[0]),t(e[1]),r(e[1]),i(e[1]),t(e[2]),r(e[2]),i(e[2]))}function j(e,t,r){return{x:e,y:t,r:r}}function U(e,t,r,i,n,a){var o=i-e,s=n-t,u=a-r;var l=Math.sqrt(o*o+s*s);return{x:(e+i+o/l*u)/2,y:(t+n+s/l*u)/2,r:(l+r+a)/2}}function G(e,t,r,i,n,a,o,s,u){var l=e-i;var d=e-o;var h=t-n;var f=t-s;var c=a-r;var v=u-r;var p=e*e+t*t-r*r;var g=p-i*i-n*n+a*a;var _=p-o*o-s*s+u*u;var m=d*h-l*f;var y=(h*_-f*g)/(m*2)-e;var b=(f*c-h*v)/m;var x=(d*g-l*_)/(m*2)-t;var A=(l*v-d*c)/m;var E=b*b+A*A-1;var S=2*(r+y*b+x*A);var w=y*y+x*x-r*r;var T=-(E?(S+Math.sqrt(S*S-4*E*w))/(2*E):w/S);return{x:e+y+b*T,y:t+x+A*T,r:T}}function q(e,t,r,i,n){var a=i.X;var s=i.Y;var u=i.R;var l=i.fx;var d=i.fy;var h=i.masses;var f=n.friction;var c=n.theta;var v=n.charge;var p=function(e){return a[e]};var g=function(e){return s[e]};var _=1;var m=Math.floor(Math.log(t.length));if(r===null){r=new C(t,{getX:p,getY:g,recursive:true,bucketSize:m});r.postOrder(function(e){var t,r,i,n=0,o,l;if(e.data!==undefined){if(e.data.length){var d=R(e.data,function(e){return a[e]},function(e){return s[e]},function(e){return u[e]});t=d.x;r=d.y;i=d.r;for(var f=0;f<e.data.length;f++){n+=h[e.data[f]]}}else{l=e.data;t=a[l];r=s[l];i=u[l];n=h[l]}}else{if(e.left&&e.right){var c=e.left.cx,v=e.left.cy;var p=e.right.cx,g=e.right.cy;var _=e.left.r,m=e.right.r;var y=p-c,b=g-v;var x=m-_;var A=Math.sqrt(y*y+b*b);t=(c+p+y/A*x)/2;r=(v+g+b/A*x)/2;i=(A+_+m)/2;n=e.left.mass+e.right.mass}else{o=e.left||e.right;t=o.cx;r=o.cy;i=o.r;n=o.mass}}e.cx=t;e.cy=r;e.r=i;e.mass=n})}var y=t.length;var b=function(i){var n=t[i];var p=a[n],g=s[n];var m=u[n];r.preOrder(function(t){var r=0,i=0;var y=0;var b=p-t.cx||o();var x=g-t.cy||o();var A=b*b+x*x;var E=m+t.r;if(t.data){if(t.data===n){return false}if(t.data.length){for(var S=0;S<t.data.length;S++){var w=t.data[S];if(w===n){continue}b=p-a[w]||o();x=g-s[w]||o();A=b*b+x*x;E=m+u[w];if(A<_){A=Math.sqrt(_*A)}r=v*h[w];i=e*r/A;l[n]+=b*i;d[n]+=x*i}}else{if(A<_){A=Math.sqrt(_*A)}r=v*t.mass;if(A<E*E){A=f*E*E}i=e*r/A;l[n]+=b*i;d[n]+=x*i}}else{y=E/c;if(A>=y*y){if(A<_){A=Math.sqrt(_*A)}r=v*t.mass;if(A<E*E){A=f*E*E}i=e*r/A;l[n]+=b*i;d[n]+=x*i;return true}}})};for(var x=0;x<y;x++)b(x);return r}q.initialize=function e(t,r,i){var n=r.X;var a=r.Y;var o=r.R;var s=r.degrees;var u=r.layer;var l=r.pinned;var d=r.component;var h=r.masses;var f=r.nodeIds;var c=r.cluster;var v=r.layers;var p=r.parent;var g=i.scaling;var _=i.defaultRadius;var m=t.length;var y=Infinity,b=Infinity,x=-Infinity,A=-Infinity;var E=Math.PI*(3-Math.sqrt(5));var S=10;for(var w=0;w<t.length;w++){var T=t[w];var C=T.x;var I=T.y;var M=T.r;var L=T.mass;if(isNaN(C)||isNaN(I)){var k=S*Math.sqrt(w);var N=w*E;C=k*Math.cos(N);I=k*Math.sin(N)}n[w]=C;a[w]=I;o[w]=M||_;l[w]=T.pinned?1:0;u[w]=T.layer;d[w]=T.component;h[w]=L===undefined?(1+s[w])*g:L;f[w]=w;if(C<y){y=C}if(I<b){b=I}if(C>x){x=C}if(I>A){A=I}}if(t.length>1&&(x-y===0||A-b===0)){var F=(y+x)/2;var z=(b+A)/2;for(var R=0;R<m;R++){if(!l[R]){var P=S*Math.sqrt(R);var O=R*E;var D=F+P*Math.cos(O);var B=z+P*Math.sin(O);n[R]=D;a[R]=B;if(D<y){y=D}if(B<b){b=B}if(D>x){x=D}if(B>A){A=B}}}}};function H(e,t,r,i){var n=r.sources;var a=r.targets;var s=r.X;var u=r.Y;var l=r.R;var d=r.fx;var h=r.fy;var f=r.degrees;var c=i.edgeStrength;var v=i.edgeLength;for(var p=0;p<t.length;p++){var g=t[p];var _=n[g],m=a[g];var y=1;var b=f[_]+y;var x=f[m]+y;var A=s[m]+d[m]-s[_]-d[_]||o();var E=u[m]+h[m]-u[_]-h[_]||o();var S=A*A+E*E;var w=Math.sqrt(S);var T=v+l[_]+l[m];if(w<=T){continue}var C=T-w;var I=e*c*C*C/S/Math.min(b,x);A*=I;E*=I;var M=x/(x+b);d[_]+=A*M;h[_]+=E*M;d[m]-=A*(1-M);h[m]-=E*(1-M)}}H.initialize=function(e,t){var r=t.edgeIds;var i=t.sources;var n=t.targets;var a=t.degrees;for(var o=0;o<e.length;o++){var s=e[o];var u=s.source;var l=s.target;i[o]=u;n[o]=l;a[u]++;a[l]++;r[o]=o}};function W(e,t,r,i,n){var a=i.X;var s=i.Y;var u=i.R;var l=i.fx;var d=i.fy;var h=n.margin;var f=n.elasticity;if(f===0){return r}if(!r){var c=function(e){return a[e]};var v=function(e){return s[e]};var p=Math.floor(Math.log(t.length));r=new C(t,{getX:c,getY:v,bucketSize:p});r.postOrder(function(e){var t,r,i,n,o;if(e.data){o=e.data;t=a[o];r=s[o];i=u[o]}else{if(e.left&&e.right){var l=e.left.cx,d=e.left.cy;var h=e.right.cx,f=e.right.cy;var c=e.left.r,v=e.right.r;var p=h-l,g=f-d;var _=v-c;var m=Math.sqrt(p*p+g*g);t=(l+h+p/m*_)/2;r=(d+f+g/m*_)/2;i=(m+c+v)/2}else{n=e.left||e.right;if(n){t=n.cx;r=n.cy;i=n.r}}}e.cx=t;e.cy=r;e.r=i})}var g=function(e){var i=t[e];var n=a[i]+l[i];var c=s[i]+d[i];var v=u[i];r.preOrder(function(e){if(e.data){if(e.data.length){for(var t=0;t<e.data.length;t++){var r=e.data[t];if(r>i){var p=u[r];var g=n-a[r];var _=c-s[r];var m=v+p+h;var y=g*g+_*_;if(y<m*m){if(g===0){g=o();y+=g*g}if(_===0){_=o();y+=_*_}y=Math.sqrt(y);var b=(m-y)*f/y;var x=p/m;l[i]+=g*b*x;d[i]+=_*b*x;l[r]-=g*b*(1-x);d[r]-=_*b*(1-x)}}}}else{var A=e.data;if(A>i){var E=u[A];var S=n-a[A];var w=c-s[A];var T=v+E+h;var C=S*S+w*w;if(C<T*T){if(S===0){S=o();C+=S*S}if(w===0){w=o();C+=w*w}C=Math.sqrt(C);var I=(T-C)*f/C;var M=E/T;l[i]+=S*I*M;d[i]+=w*I*M;l[A]-=S*I*(1-M);d[A]-=w*I*(1-M)}}}}else{var L=e.cx-n;var k=e.cy-c;var N=e.r+v;return L*L+k*k>N*N}})};for(var _=0;_<t.length;_++)g(_);return r}function X(e,t,r,i){var n=r.pinned;var a=r.X;var s=r.Y;var u=r.fx;var l=r.fy;var d=i.gravity;var h=i.cx;var f=i.cy;var c=0;var v=0;var p=t.length;for(var g=0;g<p;g++){c+=a[g];v+=s[g]}c=c/p-h;v=v/p-f;for(var _=0;_<p;_++){var m=t[_];if(!n[m]){a[m]-=c;s[m]-=v}}for(var y=0;y<p;y++){var b=t[y];var x=h-a[b]||o();var A=f-s[b]||o();var E=d*e;u[b]+=x*E;l[b]+=A*E}}X.initialize=function e(t,r,i){var n=r.X;var a=r.Y;var o=i.cx;var s=i.cy;var u=t.length;if(o===undefined||s===undefined){o=s=0;for(var l=0;l<u;l++){o+=n[l];s+=a[l]}o/=u;s/=u}i.cx=o;i.cy=s};function Y(e){var t=0;var r=0;for(var i=0,n=e;i<n.length;i+=1){var a=n[i];t+=a.w*a.h;r=Math.max(r,a.w)}e.sort(function(e,t){return t.h-e.h});var o=Math.max(Math.ceil(Math.sqrt(t/.95)),r);var s=[{x:0,y:0,w:o,h:Infinity}];var u=0;var l=0;for(var d=0,h=e;d<h.length;d+=1){var f=h[d];for(var c=s.length-1;c>=0;c--){var v=s[c];if(f.w>v.w||f.h>v.h){continue}f.x=v.x;f.y=v.y;l=Math.max(l,f.y+f.h);u=Math.max(u,f.x+f.w);if(f.w===v.w&&f.h===v.h){var p=s.pop();if(c<s.length){s[c]=p}}else if(f.h===v.h){v.x+=f.w;v.w-=f.w}else if(f.w===v.w){v.y+=f.h;v.h-=f.h}else{s.push({x:v.x+f.w,y:v.y,w:v.w-f.w,h:f.h});v.y+=f.h;v.h-=f.h}break}}}function Z(e,t){if(t===void 0)t=1;return Y(e.map(function(e){e.w+=e.maxr+t;e.h+=e.maxr+t;return e}).sort(function(e,t){return e.w*e.h-t.w*t.h}))}function K(e,t,r,i,n){if(t===void 0)t=20;for(var a=0,o=e;a<o.length;a+=1){var s=o[a];var u=R(s.ids,function(e){return r[e]},function(e){return i[e]},function(e){return n[e]});var l=u.x;var d=u.y;var h=u.r;s.cx=l;s.cy=d;s.radius=h+t}var f=e.slice().sort(function(e,t){return e.radius-t.radius});var c=f.map(function(e){return{x:e.cx,y:e.cy,r:e.radius}});var v=f.pop();var p=3*Math.PI/2,g=v.radius,_=1;var m=2*Math.PI;var y=v.cx;var b=v.cy;var x=[v];var A=function(){var e=f[f.length-1];var t=g+e.radius;var r=y+Math.cos(p)*t;var i=b+Math.sin(p)*t;if(x.some(function(t){var n=t.cx-r;var a=t.cy-i;var o=Math.sqrt(n*n+a*a)<t.radius+e.radius;return o})){g+=1;return}e.x=r-e.w/2;e.y=i-e.h/2;e.cx=r;e.cy=i;c[f.length-1].x=r;c[f.length-1].y=i;x.push(f.pop());p+=_*((e.radius*2+1)/t)%m};while(f.length!==0)A()}var Q=function e(){this.ids=[];this.xmin=Infinity;this.ymin=Infinity;this.xmax=-Infinity;this.ymax=-Infinity;this.x=0;this.y=0;this.w=0;this.h=0;this.cx=0;this.cy=0;this.radius=0;this.mx=0;this.my=0;this.m=0;this.maxr=0};Q.prototype.add=function e(t,r,i,n){this.ids.push(t);if(r-n<this.xmin){this.xmin=r-n}if(i-n<this.ymin){this.ymin=i-n}if(r+n>this.xmax){this.xmax=r+n}if(i+n>this.ymax){this.ymax=i+n}if(n>this.maxr){this.maxr=n}this.mx+=n*r;this.my+=n*i;this.m+=n};Q.prototype.measure=function e(t){if(t===void 0)t=0;this.w=this.xmax-this.xmin+t*2;this.h=this.ymax-this.ymin+t*2;this.cx=this.mx/this.m;this.cy=this.my/this.m;this.x=this.xmin;this.y=this.ymin;this.radius=Math.sqrt(this.w*this.w+this.h*this.h)/2;return this};function J(e,t){return e<t?e*t+Math.pow(t-e-1,2)/4:e*t+Math.pow(e-t-1,2)/4}function $(e,t){return(e+t)*(e+t+1)/2+t}function ee(e,t,r){var i=e.edgeIds;var n=e.sources;var a=e.targets;var o=e.pinned;var s=e.degrees;var u=e.X;var l=e.Y;var d=e.R;if(t===void 0)t=0;if(r===void 0)r=.5;var h={};var f={};for(var c=0,v=i;c<v.length;c+=1){var p=v[c];var g=n[p];var _=a[p];if(g===_){continue}h[g]=h[g]||{};h[_]=h[_]||{};h[g][_]=true;h[_][g]=true}Object.keys(h).forEach(function(e){var t=Number(e);var r=Object.keys(h[Number(t)]);if(r.length===2){var i=r[0];var n=r[1];var a=J(Number(i),Number(n));if(!(a in f)){f[a]=[Number(n),Number(i)]}if(!o[t]){f[a].push(t)}}});Object.keys(f).forEach(function(e){var i=f[Number(e)];var n=i[0];var a=i[1];var o=i.slice(2);if(o.length===1){return}var h=u[n],c=l[n];var v=u[a],p=l[a];var g=s[n];var _=s[a];var m=.25+.5*g/(g+_);var y=h+(v-h)*m;var b=c+(p-c)*m;var x=-(p-c);var A=v-h;var E=Math.sqrt(Math.pow(h-v,2)+Math.pow(c-p,2));x=-2*x/E;A=-2*A/E;var S=Math.acos(x/Math.sqrt(x*x+A*A));if(t>0){if(S<t||S>Math.PI-t&&S<=Math.PI){x=Math.cos(Math.PI-t)*2;A=Math.sin(Math.PI-t)*2}else if(S>2*Math.PI-t||S>=Math.PI&&S<Math.PI+t){x=Math.cos(t)*2;A=Math.sin(t)*2}}var w=0,T=1;o.sort(function(e,t){return d[t]-d[e]});var C=0,I=0;var M=Math.max(d[o[0]],d[o[1]])/2;if(o.length%2===1){w=1;y-=x*M;b-=A*M}var L=1+r;for(var k=0;k<o.length;k++){var N=(w+k)%2;var F=o[k];var z=k>=2?d[F]:M;var R=(N?C:I)+z;u[F]=y+x*T*R;l[F]=b+A*T*R;if(N){C+=z*L}else{I+=z*L}T=-T}})}var te;(function(e){e["none"]="none";e["box"]="box";e["spiral"]="spiral"})(te||(te={}));function re(e,t,r,i){var n=0;var a=[];for(var o=0,s=i;o<s.length;o+=1){var u=s[o];var l=new Q;for(var d=0,h=u;d<h.length;d+=1){var f=h[d];l.add(f,e[f],t[f],r[f])}a.push(l.measure());if(u.length>a[n].ids.length){n=a.length-1}}return{boxes:a,biggest:n}}function ie(e,t,r,i){var n=r.X;var a=r.Y;var o=r.R;var s=r.components;var u=r.pinned;var l=r.degrees;var d=r.sources;var h=r.targets;var f=r.edgeIds;var c=i.update;var v=i.onUpdate;var p=i.placement;var g=i.placementOffset;var _=i.alignSiblings;var m=i.siblingsMinAngle;var y=i.siblingsOffset;if(_){ee({X:n,Y:a,R:o,degrees:l,pinned:u,sources:d,targets:h,edgeIds:f},m,y);c(e,n,a)}if(p in te){var b=re(n,a,o,s);var x=b.boxes;var A=b.biggest;if(p===te.spiral){K(x,g,n,a,o)}else if(p===te.box){Z(x,g)}else{return}var E=x[A].xmin-x[A].x;var S=x[A].ymin-x[A].y;for(var w=0,T=x;w<T.length;w+=1){var C=T[w];var I=C.xmin;var M=C.ymin;var L=C.x;var k=C.y;var N=C.ids;var F=I-L-E;var z=M-k-S;for(var R=0,P=N;R<P.length;R+=1){var O=P[R];n[O]-=F;a[O]-=z}}c(e,n,a);v()}}function ne(e,t,r,i,n,a){var o=r.X;var s=r.Y;var u=r.nodeIds;var l=r.edgeIds;var d=i.nextTick;var h=i.cancelTick;var f=i.batch;var c=i.maxIterations;var v=i.steps;var p=i.minMovement;var g=i.update;var _=i.onUpdate;var m=0;var y=1;var b=.1;var x=0;var A=1-Math.pow(b,1/v);var E=false,S;var w=function(){E=true;h(S);_();a()};var T=function(){y+=(x-y)*A;var t=n(y,u,l);var r=E||y<b||t<=p;var i=m%f===0;if(i){g(e,o,s);_()}if(++m<c&&!r){S=d(T)}else{w()}};S=setTimeout(T);return{done:false,stop:function e(){w();return this},get iterations(){return m}}}function ae(e,t,r,i,a,o){var s=r.X;var u=r.Y;var l=r.R;var d=r.degrees;var h=r.nodeIds;var f=r.edgeIds;var c=r.layers;var v=r.layer;var p=r.cluster;var g=r.masses;var _=r.weights;var m=r.sources;var y=r.targets;var b=i.cx;var x=i.cy;var A=i.nextTick;var E=i.cancelTick;var S=i.update;var w=i.onUpdate;var T=i.batch;var C=i.maxIterations;var I=i.steps;var M=i.minMovement;var L=c.slice();var k=0;var N;function F(){E(N);S(e,s,u);w();o()}var z={};for(var R=0;R<t.length;R++){z[Number(t[R].id)||R]=R}var P=new Map;for(var O=0;O<f.length;O++){var D=f[O];P.set($(m[D],y[D]),D)}for(var B=0;B<c.length;B++){var V=c[B];var j=B;for(var U=0;U<V.length;U++){var G=V[U];var q=p[G];if(q!==-1){g[q]+=g[G]}}for(var H=0;H<t.length;H++){var W=t[H];var X=Number(W.id)||H;var Y=W.source,Z=W.target;var K=_[z[X]];if(v[Y]===j&&v[Z]===j){var Q=p[Y],J=p[Z];if(Q!==J){var ee=P.get($(Q,J));if(ee!==undefined){_[ee]+=K}}}}}h.length=0;f.length=0;C=Infinity;var te=1;var re=.1;var ie=0;var ne=1-Math.pow(re,1/I/2);var ae=(te-re)/I;var oe=.5;var se,ue;function le(){te+=(ie-te)*ne;var r=a(te,h,f);var i=te<=oe||r<M;if(k===0||i){var o=L.pop();if(o){if(se){ue=se.reduce(function(e,t){return Math.max(e,b-s[t],x-u[t])},0)}h.push.apply(h,o);for(var c=0;c<o.length;c++){var v=o[c];var _=p[v];if(_!==-1){var m=d[v]>1?2:1;var y=l[_]+l[v];g[_]-=g[v];s[v]=s[_]+m*y*(2*n()-1);u[v]=u[_]+m*y*(2*n()-1)}else if(se){s[v]=b+ue*2*(1-2*n());u[v]=x+ue*2*(1-2*n())}}se=o;var E=h.reduce(function(e,t){return e[t]=true,e},{});f.length=0;for(var I=0;I<t.length;I++){var R=t[I];var P=R.source;var O=R.target;var D=R.id;if(E[P]&&E[O]){f.push(z[Number(D)])}}i=false;if(L.length===0){te=.2;oe=.1}else{te=.1+ae*2;oe=.1}}}var B=k%T===0;if(B){S(e,s,u);w()}if(++k>=C||i){F()}else{N=A(le)}}N=setTimeout(le);return{done:false,stop:function e(){F();return this},get iterations(){return k}}}function oe(e,t,r){var i=r.X;var n=r.Y;var a=r.fx;var o=r.fy;var s=r.vx;var u=r.vy;var l=r.masses;var d=r.pinned;var h=0,f=0;var c=1;var v=e.length;var p=c/8;for(var g=0;g<v;g++){var _=e[g];var m=l[_];var y=a[_]/m;var b=o[_]/m;s[_]+=y*p;u[_]+=b*p;var x=.2*s[_]*p+.5*y*p*p;var A=.2*u[_]*p+.5*b*p*p;a[_]=o[_]=0;if(!d[_]){i[_]+=x;n[_]+=A;h+=Math.abs(x)*m;f+=Math.abs(A)*m}}return(h*h+f*f)/v}function se(e,t,r){var i=r.X;var n=r.Y;var a=r.fx;var o=r.fy;var s=r.pinned;var u=1e4;var l=0;var d=e.length;for(var h=0;h<d;h++){var f=e[h];var c=a[f]*=t;var v=o[f]*=t;if(s[f]){a[f]=o[f]=0}else{var p=c;var g=v;if(p>u||g>u){var _=Math.sqrt(p*p+g*g);g/=_;p/=_}i[f]+=p;n[f]+=g;l+=.5*(p*p+g*g)}}return l}function ue(e,t,r){var i=r.X;var n=r.Y;var a=r.fx;var o=r.fy;var s=r.vx;var u=r.vy;var l=r.pinned;var d=r.masses;var h=1;var f=e.length;var c=1e4;var v=.1;var p=0;for(var g=0;g<f;g++){var _=e[g];var m=d[_];var y=a[_]/m;var b=o[_]/m;var x=s[_]+y*h;var A=u[_]+b*h;var E=x*h;var S=A*h;if(E>c){E=v}if(S>c){S=v}s[_]=t*(x+s[_])/2;u[_]=t*(A+u[_])/2;a[_]=o[_]=0;if(!l[_]){i[_]+=E;n[_]+=S}p+=.5*(E*E+S*S)}return p}var le=0;var de=typeof window==="undefined";var he=typeof performance!=="undefined"&&performance.now?performance:Date;var fe=de?function(e){var t=he.now();var r=Math.max(0,16-(t-le));var i=setTimeout(function(){return e(t+r)},r);le=t+r;return i}:window.requestAnimationFrame;var ce=de?function(e){return clearTimeout(e)}:window.cancelAnimationFrame;function ve(e,t,r){for(var i=0;i<e.length;i++){var n=e[i];n.x=t[i];n.y=r[i]}}var pe=function(){};var ge=function e(t){if(t===void 0)t={};this.onUpdate=pe;this.update=ve;this.nextTick=fe;this.cancelTick=ce;this.onEnd=pe;this.charge=10;this.maxIterations=1e3;this.minMovement=.1;this.edgeLength=30;this.edgeStrength=2;this.friction=.1;this.elasticity=.9;this.margin=1;this.cx=undefined;this.cy=undefined;this.gravity=.01;this.theta=.34;this.batch=1;this.inertia=.9;this.integrator=0;this.multilevel=false;this.placement=te.none;this.placementOffset=10;this.alignSiblings=false;this.siblingsMinAngle=0;this.siblingsOffset=.15;this.steps=300;this.scaling=1;this.defaultRadius=1;for(var r in t){if(t[r]!==undefined){this[r]=t[r]}}};function _e(e,t,r){me(e,t,r);ye(r)}function me(e,t,r){var i=r.sources;var n=r.targets;var a=r.degrees;var o=r.nodeIds;var s=r.edgeIds;var u=r.layers;var l={};for(var d=0;d<e.length;d++){l[d]=o[d]=d}for(var h=0;h<t.length;h++){var f=t[h];var c=f.source;var v=f.target;var p=l[c];var g=l[v];s[h]=h;i[h]=p;n[h]=g;a[p]++;a[g]++}}function ye(e){var t=e.nodeIds;var r=e.edgeIds;var i=e.sources;var n=e.targets;var a=e.degrees;var o=e.layer;var s=e.layers;var u=e.component;var l=e.components;var d=e.cluster;var h=e.parent;var f=0;var c=1;var v=new Uint32Array(t.length);for(var p=0;p<t.length;p++){v[p]=a[p]}var g=new Array(t.length);for(var _=0;_<r.length;_++){var m=r[_];var y=i[m];var b=n[m];g[y]=g[y]||[];g[b]=g[b]||[];g[y].push(b);g[b].push(y)}var x=new Uint8Array(t.length);var A=new Uint8Array(t.length);h.fill(-1);var E=0;for(var S=0;S<t.length;S++){if(x[S]===0){var w=[S];while(w.length!==0){var T=w.pop();if(x[T]===0){w.push.apply(w,g[T]);x[T]=1;u[T]=E}}E++}}var C=new Array(t.length);for(var I=0;I<t.length;I++){o[I]=0;C[I]=I}while(C.length!==0){var M=[];var L=[];for(var k=0;k<C.length;k++){if(v[C[k]]<=f){M.push(k);L.push(C[k])}}for(var N=0;N<L.length;N++){var F=L[N];A[F]=f;o[F]=c;var z=g[F];if(z){for(var R=0;R<z.length;R++){v[z[R]]--}}}for(var P=0;P<L.length;P++){var O=L[P];var D=g[O];if(D){for(var B=0;B<D.length;B++){var V=D[B];var j=o[V];if(j===undefined||j>c){h[O]=V;break}}}}M.reverse();for(var U=0;U<M.length;U++){C.splice(M[U],1)}c+=1;if(C.length>0){var G=Infinity;for(var q=0;q<C.length;q++){var H=v[C[q]];if(H<G){G=H}}if(G>=f+1){f=G;c=1}}}x.fill(0);for(var W=0;W<t.length;W++){var X=t[W];var Y=o[X];if(h[X]===-1||o[h[X]]===Y){var Z=[X];x.fill(0);while(Z.length!==0){var K=Z.pop();if(x[K]){continue}if(o[K]>Y){h[X]=K;break}var Q=g[K];x[K]=1;if(Q){Z.push.apply(Z,Q)}}}}for(var J=0;J<t.length;J++){var $=t[J];var ee=u[$];l[ee]=l[ee]||[];l[ee].push($);var te=o[$]-1;s[te]=s[te]||[];s[te].push($);d[$]=h[$]}}var be=function e(t){var r=t.nodes.length;var i=t.edges.length;a(r+i);this.X=new Array(r);this.Y=new Array(r);this.R=new Array(r);this.fx=new Float32Array(r);this.fy=new Float32Array(r);this.vx=new Float32Array(r);this.vy=new Float32Array(r);this.pinned=new Uint8Array(r);this.masses=new Float32Array(r);this.weights=new Float32Array(i);this.sources=new Uint16Array(i);this.targets=new Uint16Array(i);this.degrees=new Uint32Array(r);this.layer=new Uint32Array(r);this.parent=new Int32Array(r);this.cluster=new Int32Array(r);this.component=new Uint16Array(r);this.components=[];this.layers=[];this.nodeIds=new Array(r);this.edgeIds=new Array(i);_e(t.nodes,t.edges,this)};var xe=function e(t){this.promise=new Promise(t)};xe.prototype.then=function e(t){return this.promise.then(t)};xe.prototype.stop=function e(){this.simulation.stop();return this};xe.prototype.iterations=function e(){return this.simulation.iterations};var Ae={euler:oe,verlet:se,leapfrog:ue};function force(e,t){if(t===void 0)t={};var r,i;var n=function(e){if(e===void 0)e={nodes:[],edges:[]};r=e.nodes;i=e.edges;a($(r.length,i.length));return new be(e)};var o=function(e){if(e===void 0)e={};return new ge(e)};var s=n(e);var u=o(t);n(e);o(t);H.initialize(i,s);q.initialize(r,s,u);X.initialize(r,s,u);var l=Ae[u.integrator]||se;var d=null;var h=function(e,t,r){d=null;if(t.length<=1){return 0}d=q(e,t,d,s,u);H(e,r,s,u);if(u.elasticity!==0){W(e,t,d,s,u)}X(e,t,s,u);return l(t,u.inertia,s)};var f;return{setOptions:o,setGraph:n,start:function e(){f=(u.multilevel?ae:ne)(r,i,s,u,h,function(){if(!f.done){ie(r,i,s,u)}u.onEnd();f.done=true});return this},iterations:function e(){return f.iterations},data:function e(){return s},stop:function e(){if(f){f.stop()}return this},step:function e(t){if(t===void 0)t=1;h(t,s.nodeIds,s.edgeIds);return this}}}force.run=function(e,t){var r;var i=new xe(function(i){t.onEnd=i;r=force(e,t).start()});i.simulation=r;i.stop=function(){r.stop();return i};i.iterations=function(){return r.iterations};return i};return force}();return force.apply(this,arguments)}var wA=1.25;var TA={imports:{force:SA},configure:function(e,t){var r=t.graph;var i=e.nodes._indexes;var n=r.getNodeAttribute("x").getMultiple(i);var a=r.getNodeAttribute("y").getMultiple(i);var o=r.getNodeAttribute("radius").getMultiple(i);var s=r.getNodeAttribute("layoutable").getMultiple(i);var u=e.nodes.getAdjacentEdges();var l=[];var h=[];var f={};if(e.edgeStrength!==undefined){e.edgeStrength=1.5*e.edgeStrength}else{e.edgeStrength=.75}if(e.gravity==null){e.gravity=.05}if(e.siblingsOffset==null){e.siblingsOffset=0}e.alignSiblings=!!e.alignSiblings;var c=e.radiusRatio||wA;for(var v=0;v<e.nodes._indexes.length;v++){var p=e.nodes._indexes[v];f[p]=v;l.push({id:v,x:n[v],y:a[v],r:o[v]*c,pinned:!s[v]})}u.forEach(function(e){var t=f[e.getSource()._index];var r=f[e.getTarget()._index];if(t!==r&&t!==undefined&&r!==undefined){h.push({source:t,target:r})}});var g=W(d({},e));delete g.nodes;return{graph:{nodes:l,edges:h},options:g,indexes:e.nodes._indexes,done:false,x:n,y:a}},update:function(e,t){if(!t.simulation){t.graph=e.graph;t.options=e.options;t.indexes=e.indexes;e.options.nextTick=function(e){return e()};e.options.update=function(e,r,i){t.x=r;t.y=i};e.options.onEnd=function(){return t.done=true};var r=SA(e.graph,e.options).start();var i=r.data(),n=i.X,a=i.Y;t.simulation=r;t.x=n;t.y=a}return{graph:t.graph,indexes:t.indexes,x:t.x,y:t.y}},context:function(){return{done:false,graph:null,x:null,y:null,indexes:null}},isRunning:function(e){return!e.done},onSync:function(e){var t=e.indexes,r=e.x,i=e.y;return{indexes:t,x:r,y:i}}};function minDisk(e,t,r,i){var n;if(i){n=i}else{n=new Uint32Array(e.length);for(var a=0,o=e.length;a<o;a++){n[a]=a}}function s(e){for(var t=e.length-1;t>=0;t--){var r=Math.floor(Math.random()*(t+1));r=Math.max(Math.min(r,t),0);var i=e[t];e[t]=e[r];e[r]=i}return e}function u(e,t,r,i,n,a,o){var s=null;var u=t.length;var l,d,h;if(u===1){l=t[0];s=[r[l],i[l],n[l]||0]}else if(u===2){l=t[0];d=t[1];s=a(r[l],i[l],r[d],i[d],n[l],n[d])}else if(u===3){l=t[0];d=t[1];h=t[2];s=o(r[l],i[l],r[d],i[d],r[h],i[h],n[l],n[d],n[h])}return s}function l(e,t,r,i,n,a,o,s,d){var h=null;if(r===0||t.length===3){h=u(e,t,i,n,a,s,d)}else{var f=e[r-1];h=l(e,t,r-1,i,n,a,o,s,d);if(h===null||!o(h,i[f],n[f],a[f])){t.push(f);h=l(e,t,r-1,i,n,a,o,s,d);t.pop()}}return h}function d(e,t,r,i){var n=e-r;var a=t-i;return[(e+r)/2,(t+i)/2,Math.sqrt(n*n+a*a)/2]}function h(e,t,r,i,n,a){var o=r-e;var s=i-t;var u=a-n;var l=Math.sqrt(o*o+s*s);return[(e+r+o/l*u)/2,(t+i+s/l*u)/2,(l+n+a)/2]}function f(e,t,r,i,n,a,o,s,u){var l=2*(e-r),d=2*(t-i),h=2*(s-o);var f=e*e+t*t-o*o-r*r-i*i+s*s;var c=2*(e-n),v=2*(t-a),p=2*(u-o);var g=e*e+t*t-o*o-n*n-a*a+u*u;var _=c*d-l*v,m=(d*g-v*f)/_-e,y=(v*h-d*p)/_,b=(c*f-l*g)/_-t,x=(l*p-c*h)/_;var A=y*y+x*x-1,E=2*(m*y+b*x+o),S=m*m+b*b-o*o,w=(-E-Math.sqrt(E*E-4*A*S))/(2*A);return[m+y*w+e,b+x*w+t,w]}function c(e,t,r,i,n,a){var o=(e*(i-a)+r*(a-t)+n*(t-i))*2;if(o===0){return null}var s=((e*e+t*t)*(i-a)+(r*r+i*i)*(a-t)+(n*n+a*a)*(t-i))/o;var u=((e*e+t*t)*(n-r)+(r*r+i*i)*(e-n)+(n*n+a*a)*(r-e))/o;var l=s-e,d=u-t;return[s,u,Math.sqrt(l*l+d*d)]}n=s(n);var v=r?h:d;var p=r?f:c;var g=r?Xd:Wd;r=r||[];return l(n,[],n.length,e,t,r,g,v,p)}function CA(e,t,r){return(t[0]-e[0])*(r[1]-e[1])-(t[1]-e[1])*(r[0]-e[0])}function IA(e){var t=e.length;var r=[0,1];var i=2;for(var n=2;n<t;n++){while(i>1&&CA(e[r[i-2]],e[r[i-1]],e[n])<=0){--i}r[i++]=n}return r.slice(0,i)}function MA(e){var t=e.length;if(t<3){return null}var r=new Array(t);var i=new Array(t);for(var n=0;n<t;n++){r[n]=[+e[n][0],+e[n][1],n]}r.sort(function(e,t){return e[0]-t[0]||e[1]-t[1]});for(var n=0;n<t;n++){i[n]=[r[n][0],-r[n][1]]}var a=IA(r);var o=IA(i);var s=o[o.length-1];var u=a[a.length-1];var l=o[0]===a[0];var d=s===u?1:0;var h=[];for(var n=a.length-1;n>=0;--n){h.push(e[r[a[n]][2]])}for(var n=+l;n<o.length-d;n++){h.push(e[r[o[n]][2]])}return h}var LA=s(function(e){(function(){function t(e){if(!(this instanceof t)){return new t(e)}this.points=e||[]}t.prototype={triangulate:function(){var e=this.points;e.sort(function(e,t){if(e[0]===t[0]){return e[1]-t[1]}return e[0]-t[0]});for(var t=e.length-1;t>=1;t--){if(e[t][0]===e[t-1][0]&&e[t][1]===e[t-1][1]){e.splice(t,1)}}if(e.length<2){return{}}var r=f(e).le;var i=[];var a=0;var o=[r];while(n(r.onext.dest,r)){r=r.onext}var s=r;do{o.push(s.sym);s.mark=true;s=s.lnext}while(s!==r);do{var u=o[a++];if(!u.mark){s=u;do{i.push(s.orig);if(!s.sym.mark){o.push(s.sym)}s.mark=true;s=s.lnext}while(s!=u)}}while(a<o.length);return i}};function r(e,t,r){return(t[0]-e[0])*(r[1]-e[1])-(t[1]-e[1])*(r[0]-e[0])>0}function i(e,t){return r(e,t.dest,t.orig)}function n(e,t){return r(e,t.orig,t.dest)}function a(e,t){return i(e.dest,t)}function o(e,t,r,i){if(e[0]===i[0]&&e[1]===i[1]||t[0]===i[0]&&t[1]===i[1]||r[0]===i[0]&&r[1]===i[1]){return false}var n=e[0]*e[0]+e[1]*e[1],a=t[0]*t[0]+t[1]*t[1],o=r[0]*r[0]+r[1]*r[1],s=i[0]*i[0]+i[1]*i[1];var u=o-s,l=r[1]-i[1],d=r[1]*s-o*i[1],h=r[0]-i[0],f=r[0]*s-o*i[0],c=r[0]*i[1]-r[1]*i[0];return e[0]*(t[1]*u-a*l+d)-e[1]*(t[0]*u-a*h+f)+n*(t[0]*l-t[1]*h+c)-t[0]*d+t[1]*f-a*c>1}function s(e,t,r){this.onext=e;this.rot=t;this.orig=r;this.mark=false}s.prototype={get sym(){return this.rot.rot},get dest(){return this.sym.orig},get rotSym(){return this.rot.sym},get oprev(){return this.rot.onext.rot},get dprev(){return this.rotSym.onext.rotSym},get lnext(){return this.rotSym.onext.rot},get lprev(){return this.onext.sym},get rprev(){return this.sym.onext}};function u(e,t){var r=new s(null,null,e),i=new s(null,null,null),n=new s(null,null,t),a=new s(null,null,null);r.onext=r;n.onext=n;i.onext=a;a.onext=i;r.rot=i;i.rot=n;n.rot=a;a.rot=r;return r}function l(e,t){var r=e.onext.rot,i=t.onext.rot;var n=e.onext,a=i.onext,o=r.onext;e.onext=t.onext;t.onext=n;r.onext=a;i.onext=o}function d(e,t){var r=u(e.dest,t.orig);l(r,e.lnext);l(r.sym,t);return r}function h(e){l(e,e.oprev);l(e.sym,e.sym.oprev)}function f(e){var t,s,c,v;if(e.length===2){t=u(e[0],e[1]);return{le:t,re:t.sym}}else if(e.length===3){t=u(e[0],e[1]);s=u(e[1],e[2]);l(t.sym,s);if(r(e[0],e[1],e[2])){c=d(s,t);return{le:t,re:s.sym}}else if(r(e[0],e[2],e[1])){c=d(s,t);return{le:c.sym,re:c}}else{return{le:t,re:s.sym}}}else{var p=Math.ceil(e.length/2);var g=f(e.slice(0,p));var _=f(e.slice(p));var m=g.le,y=g.re,b=_.le,x=_.re;do{if(n(b.orig,y)){y=y.lnext}else if(i(y.orig,b)){b=b.rprev}else{break}}while(true);var A=d(b.sym,y);if(y.orig===m.orig){m=A.sym}if(b.orig===x.orig){x=A}do{var E=A.sym.onext;if(a(E,A)){while(o(A.dest,A.orig,E.dest,E.onext.dest)){v=E.onext;h(E);E=v}}var S=A.oprev;if(a(S,A)){while(o(A.dest,A.orig,S.dest,S.oprev.dest)){v=S.oprev;h(S);S=v}}if(!a(E,A)&&!a(S,A)){break}if(!a(E,A)||a(S,A)&&o(E.dest,E.orig,S.orig,S.dest)){A=d(S,A.sym)}else{A=d(A.sym,E.sym)}}while(true);return{le:m,re:x}}}t.prototype.ccw=r;t.prototype.rightOf=i;t.prototype.leftOf=n;t.prototype.inCircle=o;{e.exports=t}})()});function kA(e,t,r,i,convexhull){if(t===void 0){t=1}if(r===void 0){r=0}if(!i||!convexhull){var n=e.map(function(e){return[e.x,e.y]});i=new LA(n.slice()).triangulate();convexhull=MA(n)}var a=r*r;var o=[];var s={};for(var u=0;u<i.length;u+=3){var l=RA(i[u],i[u+1],i[u+2]);if(NA(convexhull,l)){var d=zA(i[u],i[u+1],i[u+2]);if(d>a){o.push(u);s[u]=d}}}if(o.length===0){return[]}o.sort(function(e,t){return s[e]-s[t]});var h=o[0];var f=s[h];var c=[];for(var u=0;u<o.length;u++){var v=o[u];var d=s[v];if(d>f&&d>a){h=v;f=d;c.push(h);if(c.length>t){c.shift()}}}return c.map(function(e){return FA(i[e],i[e+1],i[e+2])})}function NA(e,t){var r=e.length;var i=e[r-1];var n=t[0],a=t[1];var o=i[0],s=i[1];var u=false;for(var l=0;l<r;l++){var d=e[l];var h=d[0],f=d[1];if(f>a!==s>a&&n<(o-h)*(a-f)/(s-f)+h){u=!u}o=h;s=f}return u}function FA(e,t,r){var i=arguments;var n=RA(e,t,r);var a=0;for(var o=0;o<3;o++){var s=i[o];var u=s[0]-n[0];var l=s[1]-n[1];var d=Math.sqrt(u*u+l*l);if(d>a){a=d}}return[n[0],n[1],a]}function zA(e,t,r){var i=RA(e,t,r),n=i[0],a=i[1];var o=e[0],s=e[1];var u=n-o;var l=a-s;return u*u+l*l}function RA(e,t,r){var i=[(e[0]+t[0])/2,(e[1]+t[1])/2];var n=[(t[0]+r[0])/2,(t[1]+r[1])/2];var a=-1/((t[1]-e[1])/(t[0]-e[0]));var o=-1/((r[1]-t[1])/(r[0]-t[0]));var s=i[1]-a*i[0];var u=n[1]-o*n[0];var l=(s-u)/(o-a);return[l,a*l+s]}function PA(e,t,r,i,n){return{x:e+n*(r-e),y:t+n*(i-t)}}var OA=10;function DA(e,t,distance){var r=Infinity;var i,n;for(var a=0,o=t.length;a<o;a++){var s=t[a];var u=t[(a+1)%o];var l=Zu(e[0],e[1],s[0],s[1],u[0],u[1]);if(l<r){r=l;i=s;n=u}}return BA(e[0],e[1],i[0],i[1],n[0],n[1],distance)}function BA(e,t,r,i,n,a,distance){var o=Ku(e,t,r,i,n,a);var s=r-n;var u=i-a;var l=-u;var d=s;var h=Math.sqrt(l*l+d*d);l/=h;d/=h;return[o.x-distance*l,o.y-distance*d]}function VA(e,t,r,i){for(var n=0;n<e.length;n++){var a=e[n],o=a[0],s=a[1];var u=Math.abs(o-t);var l=Math.abs(s-r);if(u+l<=i){return true}if(u>i||l>i){continue}if(u*u+l*l<=i*i){return true}}return false}function jA(e,t,r){var i=Hu(r.cx,r.cy,e,t,r.minX,r.minY,r.maxX,r.maxY);var n=+Infinity,a,o={x:r.maxX,y:t};for(var s=0,u=i;s<u.length;s++){var l=u[s];a=distance(e,t,l.x,l.y);if(a<n){n=a;o=l}}return o}function UA(e){var t=e.bottomLeft();var r=e.topRight();return[[t.x,t.y],[t.x,r.y],[r.x,r.y],[r.x,t.y]]}function GA(e,t,r){var i=t.duration,n=i===void 0?0:i,a=t.margin,o=a===void 0?5:a,s=t.referenceNodes,u=t.nodes;var l=s;if(l&&!(l instanceof _i)){l=e.getNodes(l)}var d=l||u.inverse();var h=d.getPosition().map(function(e){return[e.x,e.y]});var f=r;var c=u.getBoundingBox();var v=d.getBoundingBox();v.pad(v.maxScaledSize);var p=minDisk(f.map(function(e){return e.x}),f.map(function(e){return e.y}),u.getAttribute("radius"));var g=p[0],_=p[1];var m=p[2]+v.maxScaledSize+o;var y=0;var b=0;var x;if(VA(h,g,_,m)){if(d.size<=3){if(Yd(g,_,p[2],v.minX,v.minY,v.maxX,v.maxY)){var A=jA(g,_,v);x=distance(v.cx,v.cy,A.x,A.y);var E=PA(v.cx,v.cy,A.x,A.y,(x+m)/x);y=E.x-g;b=E.y-_}}else{var S=new LA(h.slice()).triangulate();var convexhull=h.length>3?MA(h):UA(v);var w=kA(d.getPosition(),OA,m,S,convexhull);var A=DA([g,_],convexhull,m);if(w.length>0){var T=Math.pow(g-A[0],2)+Math.pow(_-A[1],2);for(var C=0,I=w;C<I.length;C++){var M=I[C];y=g-M[0];b=_-M[1];x=y*y+b*b;if(x<T){T=x;A=M.slice(0,2)}}y=A[0]-g;b=A[1]-_}else{y=A[0]-c.cx;b=A[1]-c.cy}}}var L={layoutName:"incremental",ids:u.getId(),positions:{before:f,current:f}};if(y||b){var k=f.map(function(e){e.x+=y;e.y+=b;return e});if(t.locate){if(typeof t.locate==="boolean"){t.locate={}}var N=e.modules.locate.layoutDataBoundingBox({x:h.map(function(e){return e[0]}).concat(k.map(function(e){return e.x})),y:h.map(function(e){return e[1]}).concat(k.map(function(e){return e.y})),indexes:e.getNodes()._indexes});var F=e.modules.locate.computeConfigForBounds(N,t.locate);e.modules.camera.setView(F,{duration:n,easing:t.locate.easing,ignoreZoomLimits:true})}L.positions.current=k;return u.setAttributes(k,n).then(function(){return L})}else{return u.setAttributes(f,n).then(function(){return L})}}function qA(e,t,r){var i=O(t);i.duration=0;i.dryRun=true;i.locate=false;delete i["incremental"];return r(i).then(function(r){return GA(e,t,r.positions.current)})}function HA(e,t,r){var i=t.nodes,n=t.duration,a=t.centralNode;var o=i;var s=o.reduce(function(e,t){e[t._index]=true;return e},{});var u=e.getNodes();if(t.focusOnGroupShape){return r({nodes:o,duration:0}).then(function(){var t=o.concat(a);var i=t.getAttribute("layoutable");t.setAttributes({layoutable:false});return r({nodes:e.getNodes(),duration:n}).then(function(){return t.setAttributes(i)})})}else{var l=O(t);delete l.centralNode;l.incremental=false;l.nodes=u;l.nodeMass=function(e,t){var r=s[e._index]?1:2;return(t+1)*r};return r(l)}}function WA(e,t,r){var i=e.nodes,n=e.centralNode;if(!i||i.size===0){throw new Error("Incremental layout: no nodes are selected")}var a=typeof e.incremental!="boolean"&&"margin"in e.incremental&&!isFinite(e.incremental.margin);if(a){throw new Error("Incremental layout: margin has to be a positive number")}var o=O(e);if(typeof e.incremental!=="boolean"){o.margin=e.incremental.margin;o.referenceNodes=e.incremental.referenceNodes}if(n&&!n.getAttribute("layoutable")){return HA(t,o,r)}o.nodes=o.nodes instanceof _i?o.nodes:t.getNodes(o.nodes);return qA(t,o,r)}var XA=function(e){e.modules.layouts.register("force",TA);return{force:function(t){if(t===void 0){t={}}if(!t.nodes){t.nodes=e.modules.graph.getNodes()}else if(Array.isArray(t.nodes)){t.nodes=e.getNodes(t.nodes)}else if(!(t.nodes instanceof _i)){throw new Error("'nodes' must be a NodeList or an Array<NodeId>")}if(t.incremental){return WA(t,e,e.layouts.force)}if("edgeStrength"in t&&(!isFinite(t.edgeStrength)||(t.edgeStrength<=0||t.edgeStrength>1))){throw new Error("force layout: edgeStrength must be between 0 and 1")}if("steps"in t&&(!isFinite(t.steps)||t.steps<=0)){throw new Error("force layout: 'steps' must be a positive integer")}if("edgeLength"in t&&(!isFinite(t.edgeLength)||t.edgeLength<=0)){throw new Error("force layout: 'edgeLength' must be positive")}if("gravity"in t&&(!isFinite(t.gravity)||t.gravity<0||t.gravity>=1)){throw new Error("force layout: 'gravity' must be between 0 and 1")}if("charge"in t&&!isFinite(t.charge)){throw new Error("force layout: 'charge' must be a number")}if("radiusRatio"in t&&(!isFinite(t.radiusRatio)||t.radiusRatio<0)){throw new Error("force layout: 'radiusRatio' must be a positive number")}if("theta"in t&&(!isFinite(t.theta)||t.theta<0||t.theta>1)){throw new Error("force layout: 'theta' must be between 0 and 1")}if(("cx"in t||"cy"in t)&&(typeof t.cx!=="number"||typeof t.cy!=="number")){throw new Error("force layout: both 'cx' and 'cy' must be numbers")}if("siblingsOffset"in t&&!isFinite(t.siblingsOffset)){throw new Error("force layout: 'siblingsOffset' must be a number")}return e.modules.layouts.start("force",t)}}};var YA={configure:function(e,t){var r=t.graph,i=t.camera,n=t.graphics;var a=e.nodes;var o=a._indexes;var s,u={},l={};var d=o.length,h,f;var c=r.getObjectList(true);var v=r.getObjectList(false);if(e.nodes){e=O(e);delete e.nodes}var p=n._getAttributeArray(true,"innerStroke.width");var g=n._getAttributeArray(true,"outerStroke.width");var _=r.degrees(o);var m=r.getNodeAttribute("x").getMultiple(o);var y=r.getNodeAttribute("y").getMultiple(o);var b=r.getNodeAttribute("radius").getMultiple(o);p=p.getMultiple(o);g=g.getMultiple(o);var x=r.nodeList(o).getAttribute("layoutable");var A=typeof e.nodeMass==="function"?e.nodeMass:function(e,t,r){return t+1};delete e.nodeMass;var E=typeof e.edgeWeight==="function"?e.edgeWeight:function(e){return 1};delete e.edgeWeight;if(!isFinite(e.scalingRatio)){delete e.scalingRatio}var S=o.reduce(function(e,t,r){if(!x[r]){e[t]=true}return e},{});var w=0,T=0,C=0;var I=i.getZoom();for(f=0;f<o.length;++f){var M=o[f];var L=m[f],k=y[f];var N=b[f]+(p[f]+g[f])/I;u[M]={id:M,x:L,y:k,degree:_[f],size:N,pinned:!!S[M],mass:A(c.get(M),_[f],f)};C=Math.max(N,C)}if(d>1){for(f=0;f<d;f++){var F=u[o[f]];w+=F.x;T+=F.y}}w/=d;T/=d;var z={x:w,y:T};var R=a.getAdjacentEdges();s=R._indexes;h=s.length;var P=R.getSource()._indexes;var D=R.getTarget()._indexes;for(f=0;f<h;f++){var B=s[f];var V=P[f];var j=D[f];if(u[V]&&u[j]){l[B]={source:V,target:j};l[B].weight=E(v.get(B))}}return{nodes:u,edges:l,maxSize:C,config:W(e),barycentre:z}},context:function(){return{}},update:function(e,t){var r;if(!t.W){r={ppn:10,ppe:3,ppr:9,MAX_SUBDIVISION_RETRIES:3,maxForce:10,iterations:0,converged:false,settings:{linLogMode:false,outboundAttractionDistribution:false,adjustSizes:false,edgeWeightInfluence:0,scalingRatio:100,strongGravityMode:true,gravity:1,slowDown:1,barnesHutOptimize:false,barnesHutTheta:.5,startingIterations:10,iterationsPerRender:10,maxIterations:1e3,avgDistanceThreshold:.01,autoStop:true,alignNodeSiblings:true,nodeSiblingsScale:5,nodeSiblingsAngleMin:0}};t.W=r;v(e,e.config);r.settings=o(e.config,r.settings);t.nodes=e.nodes;t.edges=e.edges;t.barycentre=e.barycentre}else{r=t.W}var i=t.NodeMatrix,n=t.EdgeMatrix,a;function o(e,t){for(var r in e){t[r]=e[r]}return t}function s(e,t,r,i){var n=r-e,a=i-t;return Math.sqrt(n*n+a*a)}function u(value,e,t,r,i){return(i-r)*(value-e)/(t-e)+r}function l(e){return Math.acos(e.x/Math.sqrt(e.x*e.x+e.y*e.y))}function d(e,t,r,i){return{xi:-(i-t),yi:r-e,xiPrime:i-t,yiPrime:-(r-e)}}function h(e,t){return{x:(e.xiPrime-e.xi)/t,y:(e.yiPrime-e.yi)/t}}function f(e,t,r,i,n){return{x:e+(r-e)*n,y:t+(i-t)*n}}function c(e,t){var i=e.nodes,n=e.edges,a=e.maxSize,o=Object.keys(e.nodes),s=Object.keys(e.edges),u=o.length*r.ppn,l=s.length*r.ppe,d={},h,f,c;var v=Math.pow(10,Math.log(Math.max(a,1))-6);var p=v/2;var g=Math.random;var _=t.randomizeFactor||1;var m;if(t.randomize==="locally"){m=function(e){return e+g()*_}}else if(t.randomize==="globally"){m=function(e){return g()*_}}else{m=function(e){return e+g()*v-p}}var y=new Float32Array(u);var b=new Float32Array(l);for(h=f=0,c=o.length;h<c;h++){var x=o[h],A=i[x];var E=A.x;var S=A.y;if(!A.pinned){E=m(E);S=m(S)}d[x]=f;y[f]=E;y[f+1]=S;y[f+2]=0;y[f+3]=0;y[f+4]=0;y[f+5]=0;y[f+6]=A.mass;y[f+7]=1;y[f+8]=A.size;y[f+9]=A.pinned||0;f+=r.ppn}for(h=f=0,c=s.length;h<c;h++){x=s[h];var w=n[x];b[f]=d[w.source];b[f+1]=d[w.target];b[f+2]=w.weight||0;f+=r.ppe}return{nodes:y,edges:b}}function v(e,i){var n=c(e,i);t.NodeMatrix=n.nodes;t.EdgeMatrix=n.edges;r.nodesLength=t.NodeMatrix.length;r.edgesLength=t.EdgeMatrix.length}function p(){var e,t,o,c,v,p,g,_;var m,y,b,x,A,E,S,distance,w;for(o=0;o<r.nodesLength;o+=r.ppn){i[o+4]=i[o+2];i[o+5]=i[o+3];i[o+2]=0;i[o+3]=0}if(r.settings.outboundAttractionDistribution){m=0;for(o=0;o<r.nodesLength;o+=r.ppn){m+=i[o+6]}m/=r.nodesLength}if(r.settings.barnesHutOptimize){var T=Infinity,C=-Infinity,I=Infinity,M=-Infinity,L,k,N,F;a=[];for(o=0;o<r.nodesLength;o+=r.ppn){T=Math.min(T,i[o+0]);C=Math.max(C,i[o+0]);I=Math.min(I,i[o+1]);M=Math.max(M,i[o+1])}var z=C-T,R=M-I;if(z>R){I-=(z-R)/2;M=I+z}else{T-=(R-z)/2;C=T+R}a[0+0]=-1;a[0+1]=(T+C)/2;a[0+2]=(I+M)/2;a[0+3]=Math.max(C-T,M-I);a[0+4]=-1;a[0+5]=-1;a[0+6]=0;a[0+7]=0;a[0+8]=0;e=1;for(o=0;o<r.nodesLength;o+=r.ppn){t=0;N=r.MAX_SUBDIVISION_RETRIES;while(true){if(a[t+5]>=0){if(i[o+0]<a[t+1]){if(i[o+1]<a[t+2]){L=a[t+5]}else{L=a[t+5]+r.ppr}}else{if(i[o+1]<a[t+2]){L=a[t+5]+r.ppr*2}else{L=a[t+5]+r.ppr*3}}a[t+7]=(a[t+7]*a[t+6]+i[o+0]*i[o+6])/(a[t+6]+i[o+6]);a[t+8]=(a[t+8]*a[t+6]+i[o+1]*i[o+6])/(a[t+6]+i[o+6]);a[t+6]+=i[o+6];t=L;continue}else{if(a[t+0]<0){a[t+0]=o;break}else{a[t+5]=e*r.ppr;g=a[t+3]/2;_=a[t+5];a[_+0]=-1;a[_+1]=a[t+1]-g;a[_+2]=a[t+2]-g;a[_+3]=g;a[_+4]=_+r.ppr;a[_+5]=-1;a[_+6]=0;a[_+7]=0;a[_+8]=0;_+=r.ppr;a[_+0]=-1;a[_+1]=a[t+1]-g;a[_+2]=a[t+2]+g;a[_+3]=g;a[_+4]=_+r.ppr;a[_+5]=-1;a[_+6]=0;a[_+7]=0;a[_+8]=0;_+=r.ppr;a[_+0]=-1;a[_+1]=a[t+1]+g;a[_+2]=a[t+2]-g;a[_+3]=g;a[_+4]=_+r.ppr;a[_+5]=-1;a[_+6]=0;a[_+7]=0;a[_+8]=0;_+=r.ppr;a[_+0]=-1;a[_+1]=a[t+1]+g;a[_+2]=a[t+2]+g;a[_+3]=g;a[_+4]=a[t+4];a[_+5]=-1;a[_+6]=0;a[_+7]=0;a[_+8]=0;e+=4;F=t+0;if(i[a[F]+0]<a[t+1]){if(i[a[F]+1]<a[t+2]){L=a[t+5]}else{L=a[t+5]+r.ppr}}else{if(i[a[F]+1]<a[t+2]){L=a[t+5]+r.ppr*2}else{L=a[t+5]+r.ppr*3}}a[t+6]=i[a[F]+6];a[t+7]=i[a[F]+0];a[t+8]=i[a[F]+1];a[L+0]=a[t+0];a[t+0]=-1;if(i[o+0]<a[t+1]){if(i[o+1]<a[t+2]){k=a[t+5]}else{k=a[t+5]+r.ppr}}else{if(i[o+1]<a[t+2]){k=a[t+5]+r.ppr*2}else{k=a[t+5]+r.ppr*3}}if(L===k){if(N--){t=L;continue}else{N=r.MAX_SUBDIVISION_RETRIES;break}}a[k+0]=o;break}}}}}if(r.settings.barnesHutOptimize){y=r.settings.scalingRatio;for(o=0;o<r.nodesLength;o+=r.ppn){t=0;while(true){if(a[t+5]>=0){distance=Math.sqrt((i[o+0]-a[t+7])*(i[o+0]-a[t+7])+(i[o+1]-a[t+8])*(i[o+1]-a[t+8]));if(2*a[t+3]/distance<r.settings.barnesHutTheta){b=i[o+0]-a[t+7];x=i[o+1]-a[t+8];if(r.settings.adjustSizes){if(distance>0){w=y*i[o+6]*a[t+6]/distance/distance;i[o+2]+=b*w;i[o+3]+=x*w}else if(distance<0){w=-y*i[o+6]*a[t+6]/distance;i[o+2]+=b*w;i[o+3]+=x*w}}else{if(distance>0){w=y*i[o+6]*a[t+6]/distance/distance;i[o+2]+=b*w;i[o+3]+=x*w}}if(a[t+4]<0){break}t=a[t+4];continue}else{t=a[t+5];continue}}else{if(a[t+0]>=0&&a[t+0]!==o){b=i[o+0]-i[a[t+0]+0];x=i[o+1]-i[a[t+0]+1];distance=Math.sqrt(b*b+x*x);if(r.settings.adjustSizes){if(distance>0){w=y*i[o+6]*i[a[t+0]+6]/distance/distance;i[o+2]+=b*w;i[o+3]+=x*w}else if(distance<0){w=-y*i[o+6]*i[a[t+0]+6]/distance;i[o+2]+=b*w;i[o+3]+=x*w}}else{if(distance>0){w=y*i[o+6]*i[a[t+0]+6]/distance/distance;i[o+2]+=b*w;i[o+3]+=x*w}}}if(a[t+4]<0){break}t=a[t+4];continue}}}}else{y=r.settings.scalingRatio;for(c=0;c<r.nodesLength;c+=r.ppn){for(v=0;v<c;v+=r.ppn){b=i[c+0]-i[v+0];x=i[c+1]-i[v+1];if(r.settings.adjustSizes){distance=Math.sqrt(b*b+x*x)-i[c+8]-i[v+8];if(distance>0){w=y*i[c+6]*i[v+6]/distance/distance;i[c+2]+=b*w;i[c+3]+=x*w;i[v+2]+=b*w;i[v+3]+=x*w}else if(distance<0){w=100*y*i[c+6]*i[v+6];i[c+2]+=b*w;i[c+3]+=x*w;i[v+2]-=b*w;i[v+3]-=x*w}}else{distance=Math.sqrt(b*b+x*x);if(distance>0){w=y*i[c+6]*i[v+6]/distance/distance;i[c+2]+=b*w;i[c+3]+=x*w;i[v+2]-=b*w;i[v+3]-=x*w}}}}}_=r.settings.gravity/r.settings.scalingRatio;y=r.settings.scalingRatio;for(o=0;o<r.nodesLength;o+=r.ppn){w=0;b=i[o+0];x=i[o+1];distance=Math.sqrt(b*b+x*x);if(r.settings.strongGravityMode){if(distance>0){w=y*i[o+6]*_}}else{if(distance>0){w=y*i[o+6]*_/distance}}i[o+2]-=b*w;i[o+3]-=x*w}y=1*(r.settings.outboundAttractionDistribution?m:1);for(p=0;p<r.edgesLength;p+=r.ppe){c=n[p+0];v=n[p+1];g=n[p+2];S=Math.pow(g,r.settings.edgeWeightInfluence);b=i[c+0]-i[v+0];x=i[c+1]-i[v+1];if(r.settings.adjustSizes){distance=Math.sqrt(b*b+x*x)-i[c+8]-i[v+8];if(r.settings.linLogMode){if(r.settings.outboundAttractionDistribution){if(distance>0){w=-y*S*Math.log(1+distance)/distance/i[c+6]}}else{if(distance>0){w=-y*S*Math.log(1+distance)/distance}}}else{if(r.settings.outboundAttractionDistribution){if(distance>0){w=-y*S/i[c+6]}}else{if(distance>0){w=-y*S}}}}else{distance=Math.sqrt(b*b+x*x);if(r.settings.linLogMode){if(r.settings.outboundAttractionDistribution){if(distance>0){w=-y*S*Math.log(1+distance)/distance/i[c+6]}}else{if(distance>0){w=-y*S*Math.log(1+distance)/distance}}}else{if(r.settings.outboundAttractionDistribution){distance=1;w=-y*S/i[c+6]}else{distance=1;w=-y*S}}}if(distance>0){i[c+2]+=b*w;i[c+3]+=x*w;i[v+2]-=b*w;i[v+3]-=x*w}}var force,P,O,D,B=0;if(r.settings.adjustSizes){for(o=0;o<r.nodesLength;o+=r.ppn){if(!i[o+9]){force=Math.sqrt(i[o+2]*i[o+2]+i[o+3]*i[o+3]);if(force>r.maxForce){i[o+2]=i[o+2]*r.maxForce/force;i[o+3]=i[o+3]*r.maxForce/force}P=i[o+6]*Math.sqrt((i[o+4]-i[o+2])*(i[o+4]-i[o+2])+(i[o+5]-i[o+3])*(i[o+5]-i[o+3]));O=Math.sqrt((i[o+4]+i[o+2])*(i[o+4]+i[o+2])+(i[o+5]+i[o+3])*(i[o+5]+i[o+3]))/2;D=.1*Math.log(1+O)/(1+Math.sqrt(P));A=i[o+0];E=i[o+1];i[o+0]=i[o+0]+i[o+2]*(D/r.settings.slowDown);i[o+1]=i[o+1]+i[o+3]*(D/r.settings.slowDown);b=i[o+0];x=i[o+1];distance=Math.sqrt((b-A)*(b-A)+(x-E)*(x-E));B+=distance}}}else{for(o=0;o<r.nodesLength;o+=r.ppn){if(!i[o+9]){P=i[o+6]*Math.sqrt((i[o+4]-i[o+2])*(i[o+4]-i[o+2])+(i[o+5]-i[o+3])*(i[o+5]-i[o+3]));O=Math.sqrt((i[o+4]+i[o+2])*(i[o+4]+i[o+2])+(i[o+5]+i[o+3])*(i[o+5]+i[o+3]))/2;D=i[o+7]*Math.log(1+O)/(1+Math.sqrt(P));i[o+7]=Math.min(1,Math.sqrt(D*(i[o+2]*i[o+2]+i[o+3]*i[o+3])/(1+Math.sqrt(P))));A=i[o+0];E=i[o+1];i[o+0]=i[o+0]+i[o+2]*(D/r.settings.slowDown);i[o+1]=i[o+1]+i[o+3]*(D/r.settings.slowDown);b=i[o+0];x=i[o+1];distance=Math.sqrt((b-A)*(b-A)+(x-E)*(x-E));B+=distance}}}r.iterations++;if(r.settings.autoStop){r.converged=r.iterations>r.settings.maxIterations||B/r.nodesLength<r.settings.avgDistanceThreshold;if(r.converged&&r.settings.alignNodeSiblings){var V={},j={},U,G;for(p=0;p<r.edgesLength;p+=r.ppe){c=n[p+0];v=n[p+1];if(c===v){continue}V[c]=V[c]||{};V[v]=V[v]||{};V[c][v]=true;V[v][c]=true}Object.keys(V).forEach(function(e){var t=~~e;G=Object.keys(V[t]);if(G.length==2){U=G[0]+";"+G[1];if(U in j){j[U].push(t)}else{U=G[1]+";"+G[0];if(!j[U]){j[U]=[~~G[1],~~G[0]]}j[U].push(t)}}});var q,H,W,X,Y,Z,K,Q,J,$,ee,te,re,ie,ne,ae=r.settings.nodeSiblingsAngleMin;Object.keys(j).forEach(function(e){H=j[e].shift();W=j[e].shift();q=j[e].filter(function(e){return!i[e+9]});if(q.length==1){return}Z=i[H+0];K=i[H+1];Q=i[W+0];J=i[W+1];X=Object.keys(V[H]).length;Y=Object.keys(V[W]).length;$=u(X/(X+Y),0,1,1/4,3/4);te=f(Z,K,Q,J,$);re=d(Z,K,Q,J);ee=s(Z,K,Q,J);ie=h(re,ee);ne=l(ie);if(2*ae>Math.PI){throw new Error("ForceLink.Worker - Invalid parameter: angleMin must be smaller than 2 PI.")}if(ae>0){if(ne<ae||ne>Math.PI-ae&&ne<=Math.PI){ie={x:Math.cos(Math.PI-ae)*2,y:Math.sin(Math.PI-ae)*2}}else if(ne>2*Math.PI-ae||ne>=Math.PI&&ne<Math.PI+ae){ie={x:Math.cos(ae)*2,y:Math.sin(ae)*2}}}var t=0,n=1,a=1;if(q.length%2==1){a=0;t=1}for(var o=0;o<q.length;o++){i[q[o]+0]=te.x+n*ie.x*a*(t||o>=2?r.settings.nodeSiblingsScale:r.settings.nodeSiblingsScale*2/3);i[q[o]+1]=te.y+n*ie.y*a*(t||o>=2?r.settings.nodeSiblingsScale:r.settings.nodeSiblingsScale*2/3);n=-n;a+=(o+t)%2}})}}}function g(){if(r.settings.autoStop){while(!r.converged){p()}}else{var e=r.iterations===0?r.settings.startingIterations:r.iterations+r.settings.iterationsPerRender;while(r.iterations!==e){p()}}return{nodes:_(t.nodes),barycentre:t.barycentre}}function _(e){var t=Object.keys(e);var n={};for(var a=0;a<i.length;a+=r.ppn){var o=t[a/r.ppn];n[o]={id:o,x:i[a+0],y:i[a+1],pinned:i[a+9]}}return n}return g()},isRunning:function(e){return!e.W.settings.autoStop},onSync:function(e,t){var r=e.nodes,i=e.barycentre;var n=t.graph;var a=Object.keys(r);var o=a.length;var s=0,u=0;var l,d,h,f,c,v,p,g;var _=new Array(o);var m=new Array(o);var y=new Array(o);var b=new Array(o);var x=n.getAttributes(true,["x","y"]),A=x[0],E=x[1];for(l=0;l<o;l++){d=a[l];h=r[d];g=parseInt(d);_[l]=g;b[l]=h.pinned;if(h.pinned){f=A.get(g);c=E.get(g)}else{f=h.x;c=h.y}m[l]=f;y[l]=c;s+=f;u+=c}v=s/o-i.x;p=u/o-i.y;for(l=0;l<o;l++){if(!b[l]){m[l]-=v;y[l]-=p}}return{indexes:_,x:m,y:y}}};var ZA=function(e){e.modules.layouts.register("forceLink",YA);return{forceLink:function(t){if(t===void 0){t={}}if(!t.nodes){t.nodes=e.modules.graph.getNodes()}else if(Array.isArray(t.nodes)){t.nodes=e.getNodes(t.nodes)}else if(!(t.nodes instanceof _i)){throw new Error("'nodes' must be a NodeList or an Array<NodeId>")}if(t.incremental){return WA(t,e,e.layouts.forceLink)}return e.modules.layouts.start("forceLink",t)}}};var KA=function(e){return e.reduce(function(e,t){e[t]=true;return e},{})};function QA(e,t){var r=[e];var i=KA(r);var n=[e];while(r.length){var a=r.shift();for(var o=0,s=t[a];o<s.length;o+=1){var u=s[o];if(!i[u]){i[u]=true;n.push(u);r.push(u)}}}return n}function JA(e){return e.reduce(function(e,t){e[t.source]=e[t.source]||[];e[t.target]=e[t.target]||[];e[t.source].push(""+t.target);e[t.target].push(""+t.source);return e},{})}function $A(e,t){var r=[],i=arguments.length-2;while(i-- >0)r[i]=arguments[i+2];var n=t;for(var a=0,o=r;a<o.length;a+=1){var s=o[a];if(!n[s]){return e}n=n[s]}return n}function eE(e){return function(t,r){var i=Math.abs(t.layer-r.layer);var n=[r,t].reduce(function(e,t){return e+(sE(t)?1:.01)},0);if(!i){return n*e}return 2*i*e}}function tE(e){return e.reduce(function(e,t){return e+$A(sE(t)?.5:0,t,"data","radius")},0)/e.length}function rE(e,t,r){var i=r||JA(t||[]);return e.filter(function(e){var t=e.id;return!(t in i)})}function iE(e,t){var r=KA(t);return e.filter(function(e){return!(e in r)})}function nE(e,t){e.forEach(function(e,r){e.forEach(function(e,i,n){t(e,i,n,r)})})}function aE(e){return Object.keys(e).map(function(t){return e[t]})}function oE(e,t){return Object.keys(e).reduce(function(r,i){r[i]=t(e[i],i,e);return r},{})}function sE(e){return!!e.data}function uE(e,t,r){if(r===void 0)r={};var i=JA(t);var n=Object.keys(i);var a=[];while(n.length){var o=n[0];var s=QA(o,i);a.push(s);n=iE(n,s)}if(r.skipSingletons){return a}return a.concat(rE(e,t,i).map(function(e){var t=e.id;return[t+""]}))}function lE(e,t){return{id:e,data:t,children:[]}}function dE(e,t,r){var i=t.reduce(function(e,t){e[t.source]=e[t.source]||[];e[t.source].push(t);return e},{});function n(e,t){var a=e.visited;var o=e.stack;var s=e.result;if(a[t.id]){return e}a[t.id]=o[t.id]=1;var u=i[t.id]||[];for(var l=0,d=u;l<d.length;l+=1){var h=d[l];if(o[h.target]){s.push(h)}else{n(e,r[h.target])}}delete o[t.id];return e}var a=e.reduce(n,{visited:{},stack:{},result:[]});var o=a.result;var s=o.reduce(function(e,t){var r=t.source;var i=t.target;e[r]=e[r]||{};e[r][i]=1;return e},{});var u=t.map(function(e){var t=e.source;var r=e.target;if(s[t]&&s[t][r]){return{source:r,target:t}}return e});return u}function hE(e){e.sort(function(e,t){return e-t});if(e.length===0){return 0}var t=Math.floor(e.length/2);if(e.length%2){return e[t]}return(e[t-1]+e[t])/2}function fE(e,t){t.forEach(function(e){return e._median=[]});e.forEach(function(e,t){e.children.filter(function(t){return t.layer>e.layer}).forEach(function(e){e._median.push(t)})});t.forEach(function(e,t){e.children.filter(function(t){return t.layer<=e.layer}).forEach(function(){return e._median.push(t)})});t.forEach(function(e){return e._median=hE(e._median)||0});t.sort(function(e,t){return e._median-t._median});t.forEach(function(e){return delete e._median})}function cE(){return function(e){e.slice(0,e.length-1).forEach(function(t,r){return fE(t,e[r+1])});return e}}var vE="up";var pE="down";var gE="left";var _E="right";var mE=Number.POSITIVE_INFINITY;function yE(e){for(var t=0,r=[vE,pE];t<r.length;t+=1){var i=r[t];e(i)}}function bE(e){for(var t=0,r=[gE,_E];t<r.length;t+=1){var i=r[t];e(i)}}function xE(e){var t={};nE(e,function(e){if(!t[e.id]){t[e.id]={successors:[],ancestors:[]}}for(var r=0,i=e.children;r<i.length;r+=1){var n=i[r];if(!t[n.id]){t[n.id]={successors:[],ancestors:[]}}if(n.layer>e.layer){t[e.id].successors.push(n);t[n.id].ancestors.push(e)}if(n.layer<e.layer){t[e.id].ancestors.push(n);t[n.id].successors.push(e)}}});return{getSuccessors:function(e){return t[e.id].successors},getAncestors:function(e){return t[e.id].ancestors}}}function AE(e){var t={};nE(e,function(e,r){t[e.id]=r});return t}function EE(){return function e(t,r){var i=xE(t);var n=i.getSuccessors;var a=i.getAncestors;var o=AE(t);var s=ME(t,n,function(e){var t=e.id;return o[t]});var u={};yE(function(e){var i=e===vE?t:[].concat(t).reverse();bE(function(t){if(t===_E){i=i.map(function(e){return[].concat(e).reverse()})}var o=e===vE?a:n;var l=r;var d=IE(i,s,o);var h=d.roots;var f=d.aligns;var c=CE(i,h,f,l);if(t===_E){c=oE(c,function(e){return-e})}u[e+t]=c})});var l=SE(u);wE(u,l);var d=TE(u);nE(t,function(e){e.x=d[e.id]});return t}}function SE(e){var t=Object.keys(e).reduce(function(t,r){var i=t.alignment;var value=t.value;var n=e[r];var a=aE(n);var o=Math.max.apply(Math,a)-Math.min.apply(Math,a);if(value<=o){return{alignment:i,value:value}}return{alignment:r,value:o}},{alignment:null,value:mE});var r=t.alignment;return e[r]}function wE(e,t){var r=aE(t);var i=Math.min.apply(Math,r);var n=Math.max.apply(Math,r);yE(function(r){bE(function(a){var o=r+a;var s=e[o];if(s===t){return}var u=aE(s);var l=a===gE?i-Math.min.apply(Math,u):n-Math.max.apply(Math,u);if(l){e[o]=oE(s,function(e){return e+l})}})})}function TE(e){return oE(e[vE+gE],function(t,r){var i=[];yE(function(t){bE(function(n){var a=t+n;i.push(e[a][r])})});i.sort(function(e,t){return e-t});return(i[1]+i[2])/2})}function CE(e,t,r,i){var n={};var a={};var o={};var s={};var u={};var l={};var d={};nE(e,function(e,t,r){n[e.id]=e;a[e.id]=mE;o[e.id]=t;u[e.id]=r[t-1]||e;l[e.id]=e;d[e.id]=0});var h=Math.max(1e4,1+Object.keys(d).length/2);function f(e){if(s[e.id]==null){s[e.id]=0;var o=e;var c=false;while(!c){if(u[o.id]!=null){var v=l[t[u[o.id].id]];if(d[v.id]>h){return}f(v);d[v.id]++;if(n[e.id]===e){n[e.id]=n[v.id]}if(n[e.id]!==n[v.id]){a[n[v.id].id]=Math.min(a[n[v.id].id],s[e.id]-s[v.id]-i(e,u[e.id]))}else{s[e.id]=Math.max(s[e.id],s[v.id]+i(e,u[e.id]))}}o=l[r[o.id]];c=o===e}}}e.forEach(function(e){e.filter(function(e){return t[e.id]===e.id}).forEach(f)});nE(e,function(e){s[e.id]=s[t[e.id]];var r=a[n[t[e.id]].id];if(e.id===t[e.id]&&isFinite(r)){s[e.id]+=r}});return s}function IE(e,t,r){function i(e,r){return t[e.id]&&t[e.id][r.id]||t[r.id]&&t[r.id][e.id]}var n={};var a={};var o={};nE(e,function(e,t){n[e.id]=e.id;a[e.id]=e.id;o[e.id]=t});e.forEach(function(e){var t=-1;e.forEach(function(e){var s=r(e).sort(function(e,t){return o[e.id]-o[t.id]});if(s.length){var u=(s.length-1)/2;for(var l=0,d=[Math.floor(u),Math.ceil(u)];l<d.length;l+=1){var h=d[l];var f=s[h];if(a[e.id]===e.id){if(!i(e,f)&&t<o[f.id]){a[f.id]=e.id;n[e.id]=n[f.id];a[e.id]=n[e.id];t=o[f.id]}}}}})});return{roots:n,aligns:a}}function ME(e,t,r){var i=e.length;function n(e){if(sE(e)){return t(e).find(sE)}}return e.reduce(function(e,a,o){var s=e.prevLayer;var u=e.conflicts;if(!o||o>i-2){return{prevLayer:s,conflicts:u}}var l=0;var d=0;var h=a.length;var f=a[h-1];a.forEach(function(e,i){var o=n(e);var s=o?r(o):h-1;if(o||e===f){var c=function(){var e=a[d];t(e).forEach(function(t){var i=r(t);if(i<l||i>s){u[e.id]=u[e.id]||{};u[e.id][t.id]=true}});d++};while(d<=i)c()}});return{prevLayer:a,conflicts:u}},{prevLayer:e[0],conflicts:{}}).conflicts}function LE(){function e(e,t){var r=-mE;e.forEach(function(e){var i=e.filter(sE);if(i.length===1){var n=i[0];n.x=1/2}else{i.reduce(function(e,r){r.x=e===undefined?0:e.x+t(e,r);return r},undefined);var a=i[i.length-1].x;r=Math.max(r,a);i.forEach(function(e){return e.x/=a})}});r=Math.max(r,1);nE(e,function(e){return e.x*=r});return e}return e}function kE(e){var t=e.nodes.reduce(function(e,t){if(t.data.fixed){if(e==null){return t}if(e.layer>t.layer){return t}}return e},null);if(t){e.nodes.forEach(function(e){e.ref=t.id})}return e}function NE(e,t,r,i){this.feasible=r;this.evaluation=t;this.bounded=i;this._tableau=e}var FE=NE;NE.prototype.generateSolutionSet=function(){var e={};var t=this._tableau;var r=t.varIndexByRow;var i=t.variablesPerIndex;var n=t.matrix;var a=t.rhsColumn;var o=t.height-1;var s=Math.round(1/t.precision);for(var u=1;u<=o;u+=1){var l=r[u];var d=i[l];if(d===undefined||d.isSlack===true){continue}var h=n[u][a];e[d.id]=Math.round(h*s)/s}return e};function zE(e,t,r,i,n){FE.call(this,e,t,r,i);this.iter=n}var RE=zE;zE.prototype=Object.create(FE.prototype);zE.constructor=zE;function PE(e){this.model=null;this.matrix=null;this.width=0;this.height=0;this.costRowIndex=0;this.rhsColumn=0;this.variablesPerIndex=[];this.unrestrictedVars=null;this.feasible=true;this.evaluation=0;this.varIndexByRow=null;this.varIndexByCol=null;this.rowByVarIndex=null;this.colByVarIndex=null;this.precision=e||1e-8;this.optionalObjectives=[];this.objectivesByPriority={};this.savedState=null;this.availableIndexes=[];this.lastElementIndex=0;this.variables=null;this.nVars=0;this.bounded=true;this.unboundedVarIndex=null;this.branchAndCutIterations=0}var OE=PE;PE.prototype.solve=function(){if(this.model.getNumberOfIntegerVariables()>0){this.branchAndCut()}else{this.simplex()}this.updateVariableValues();return this.getSolution()};function DE(e,t){this.priority=e;this.reducedCosts=new Array(t);for(var r=0;r<t;r+=1){this.reducedCosts[r]=0}}DE.prototype.copy=function(){var e=new DE(this.priority,this.reducedCosts.length);e.reducedCosts=this.reducedCosts.slice();return e};PE.prototype.setOptionalObjective=function(e,t,r){var i=this.objectivesByPriority[e];if(i===undefined){var n=Math.max(this.width,t+1);i=new DE(e,n);this.objectivesByPriority[e]=i;this.optionalObjectives.push(i);this.optionalObjectives.sort(function(e,t){return e.priority-t.priority})}i.reducedCosts[t]=r};PE.prototype.initialize=function(e,t,r,i){this.variables=r;this.unrestrictedVars=i;this.width=e;this.height=t;var n=new Array(e);for(var a=0;a<e;a++){n[a]=0}this.matrix=new Array(t);for(var o=0;o<t;o++){this.matrix[o]=n.slice()}this.varIndexByRow=new Array(this.height);this.varIndexByCol=new Array(this.width);this.varIndexByRow[0]=-1;this.varIndexByCol[0]=-1;this.nVars=e+t-2;this.rowByVarIndex=new Array(this.nVars);this.colByVarIndex=new Array(this.nVars);this.lastElementIndex=this.nVars};PE.prototype._resetMatrix=function(){var e=this.model.variables;var t=this.model.constraints;var r=e.length;var i=t.length;var n,a;var o=this.matrix[0];var s=this.model.isMinimization===true?-1:1;for(n=0;n<r;n+=1){var u=e[n];var l=u.priority;var d=s*u.cost;if(l===0){o[n+1]=d}else{this.setOptionalObjective(l,n+1,d)}a=e[n].index;this.rowByVarIndex[a]=-1;this.colByVarIndex[a]=n+1;this.varIndexByCol[n+1]=a}var h=1;for(var f=0;f<i;f+=1){var c=t[f];var v=c.index;this.rowByVarIndex[v]=h;this.colByVarIndex[v]=-1;this.varIndexByRow[h]=v;var p,g,_;var m=c.terms;var y=m.length;var b=this.matrix[h++];if(c.isUpperBound){for(p=0;p<y;p+=1){g=m[p];_=this.colByVarIndex[g.variable.index];b[_]=g.coefficient}b[0]=c.rhs}else{for(p=0;p<y;p+=1){g=m[p];_=this.colByVarIndex[g.variable.index];b[_]=-g.coefficient}b[0]=-c.rhs}}};PE.prototype.setModel=function(e){this.model=e;var t=e.nVariables+1;var r=e.nConstraints+1;this.initialize(t,r,e.variables,e.unrestrictedVariables);this._resetMatrix();return this};PE.prototype.getNewElementIndex=function(){if(this.availableIndexes.length>0){return this.availableIndexes.pop()}var e=this.lastElementIndex;this.lastElementIndex+=1;return e};PE.prototype.density=function(){var e=0;var t=this.matrix;for(var r=0;r<this.height;r++){var i=t[r];for(var n=0;n<this.width;n++){if(i[n]!==0){e+=1}}}return e/(this.height*this.width)};PE.prototype.setEvaluation=function(){var e=Math.round(1/this.precision);var t=this.matrix[this.costRowIndex][this.rhsColumn];this.evaluation=Math.round(t*e)/e};PE.prototype.getSolution=function(){var e=this.model.isMinimization===true?this.evaluation:-this.evaluation;if(this.model.getNumberOfIntegerVariables()>0){return new RE(this,e,this.feasible,this.bounded,this.branchAndCutIterations)}else{return new FE(this,e,this.feasible,this.bounded)}};OE.prototype.simplex=function(){this.bounded=true;this.phase1();if(this.feasible===true){this.phase2()}return this};OE.prototype.phase1=function(){var e=this.model.checkForCycles;var t=[];var r=this.matrix;var i=this.rhsColumn;var n=this.width-1;var a=this.height-1;var o;var s=0;while(true){var u=0;var l=-this.precision;for(var d=1;d<=a;d++){o=this.unrestrictedVars[this.varIndexByRow[d]]===true;if(o){continue}var value=r[d][i];if(value<l){l=value;u=d}}if(u===0){this.feasible=true;return s}var h=0;var f=-Infinity;var c=r[0];var v=r[u];for(var p=1;p<=n;p++){var g=v[p];if(-this.precision<g&&g<this.precision){continue}o=this.unrestrictedVars[this.varIndexByCol[p]]===true;if(o||g<-this.precision){var _=-c[p]/g;if(f<_){f=_;h=p}}}if(h===0){this.feasible=false;return s}if(e){t.push([this.varIndexByRow[u],this.varIndexByCol[h]]);var m=this.checkForCycles(t);if(m.length>0){console.log("Cycle in phase 1");console.log("Start :",m[0]);console.log("Length :",m[1]);throw new Error}}this.pivot(u,h);s+=1}};OE.prototype.phase2=function(){var e=this.model.checkForCycles;var t=[];var r=this.matrix;var i=this.rhsColumn;var n=this.width-1;var a=this.height-1;var o=this.precision;var s=this.optionalObjectives.length;var u=null;var l=0;var d,h;while(true){var f=r[this.costRowIndex];if(s>0){u=[]}var c=0;var v=o;var p=false;for(var g=1;g<=n;g++){d=f[g];h=this.unrestrictedVars[this.varIndexByCol[g]]===true;if(s>0&&-o<d&&d<o){u.push(g);continue}if(h&&d<0){if(-d>v){v=-d;c=g;p=true}continue}if(d>v){v=d;c=g;p=false}}if(s>0){var _=0;while(c===0&&u.length>0&&_<s){var m=[];var y=this.optionalObjectives[_].reducedCosts;v=o;for(var b=0;b<u.length;b++){g=u[b];d=y[g];h=this.unrestrictedVars[this.varIndexByCol[g]]===true;if(-o<d&&d<o){m.push(g);continue}if(h&&d<0){if(-d>v){v=-d;c=g;p=true}continue}if(d>v){v=d;c=g;p=false}}u=m;_+=1}}if(c===0){this.setEvaluation();return l}var x=0;var A=Infinity;var E=this.varIndexByRow;for(var S=1;S<=a;S++){var w=r[S];var T=w[i];var C=w[c];if(-o<C&&C<o){continue}if(C>0&&o>T&&T>-o){A=0;x=S;break}var I=p?-T/C:T/C;if(I>o&&A>I){A=I;x=S}}if(A===Infinity){this.evaluation=-Infinity;this.bounded=false;this.unboundedVarIndex=this.varIndexByCol[c];return l}if(e){t.push([this.varIndexByRow[x],this.varIndexByCol[c]]);var M=this.checkForCycles(t);if(M.length>0){console.log("Cycle in phase 2");console.log("Start :",M[0]);console.log("Length :",M[1]);throw new Error}}this.pivot(x,c,true);l+=1}};var BE=[];OE.prototype.pivot=function(e,t){var r=this.matrix;var i=r[e][t];var n=this.height-1;var a=this.width-1;var o=this.varIndexByRow[e];var s=this.varIndexByCol[t];this.varIndexByRow[e]=s;this.varIndexByCol[t]=o;this.rowByVarIndex[s]=e;this.rowByVarIndex[o]=-1;this.colByVarIndex[s]=-1;this.colByVarIndex[o]=t;var u=r[e];var l=0;for(var d=0;d<=a;d++){if(u[d]!==0){u[d]/=i;BE[l]=d;l+=1}}u[t]=1/i;var h,f,c;var v=this.precision;for(var p=0;p<=n;p++){var g=r[p];if(p!==e){h=g[t];if(h!==0){for(f=0;f<l;f++){d=BE[f];c=u[d];if(c!==0){g[d]=g[d]-h*c}}g[t]=-h/i}}}var _=this.optionalObjectives.length;if(_>0){for(var m=0;m<_;m+=1){var y=this.optionalObjectives[m].reducedCosts;h=y[t];if(h!==0){for(f=0;f<l;f++){d=BE[f];c=u[d];if(c!==0){y[d]=y[d]-h*c}}y[t]=-h/i}}}};OE.prototype.checkForCycles=function(e){for(var t=0;t<e.length-1;t++){for(var r=t+1;r<e.length;r++){var i=e[t];var n=e[r];if(i[0]===n[0]&&i[1]===n[1]){if(r-t>e.length-r){break}var a=true;for(var o=1;o<r-t;o++){var s=e[t+o];var u=e[r+o];if(s[0]!==u[0]||s[1]!==u[1]){a=false;break}}if(a){return[t,r-t]}}}}return[]};function VE(e,t,r,i){this.id=e;this.cost=t;this.index=r;this.value=0;this.priority=i}function jE(e,t,r,i){VE.call(this,e,t,r,i)}jE.prototype.isInteger=true;function UE(e,t){VE.call(this,e,0,t,0)}UE.prototype.isSlack=true;function GE(e,t){this.variable=e;this.coefficient=t}function qE(e,t,r){if(r===0||r==="required"){return null}t=t||1;r=r||1;if(e.isMinimization===false){t=-t}return e.addVariable(t,"r"+e.relaxationIndex++,false,false,r)}function HE(e,t,r,i){this.slack=new UE("s"+r,r);this.index=r;this.model=i;this.rhs=e;this.isUpperBound=t;this.terms=[];this.termsByVarIndex={};this.relaxation=null}HE.prototype.addTerm=function(e,t){var r=t.index;var i=this.termsByVarIndex[r];if(i===undefined){i=new GE(t,e);this.termsByVarIndex[r]=i;this.terms.push(i);if(this.isUpperBound===true){e=-e}this.model.updateConstraintCoefficient(this,t,e)}else{var n=i.coefficient+e;this.setVariableCoefficient(n,t)}return this};HE.prototype.removeTerm=function(e){return this};HE.prototype.setRightHandSide=function(e){if(e!==this.rhs){var t=e-this.rhs;if(this.isUpperBound===true){t=-t}this.rhs=e;this.model.updateRightHandSide(this,t)}return this};HE.prototype.setVariableCoefficient=function(e,t){var r=t.index;if(r===-1){console.warn("[Constraint.setVariableCoefficient] Trying to change coefficient of inexistant variable.");return}var i=this.termsByVarIndex[r];if(i===undefined){this.addTerm(e,t)}else{if(e!==i.coefficient){var n=e-i.coefficient;if(this.isUpperBound===true){n=-n}i.coefficient=e;this.model.updateConstraintCoefficient(this,t,n)}}return this};HE.prototype.relax=function(e,t){this.relaxation=qE(this.model,e,t);this._relax(this.relaxation)};HE.prototype._relax=function(e){if(e===null){return}if(this.isUpperBound){this.setVariableCoefficient(-1,e)}else{this.setVariableCoefficient(1,e)}};function WE(e,t){this.upperBound=e;this.lowerBound=t;this.model=e.model;this.rhs=e.rhs;this.relaxation=null}WE.prototype.isEquality=true;WE.prototype.addTerm=function(e,t){this.upperBound.addTerm(e,t);this.lowerBound.addTerm(e,t);return this};WE.prototype.removeTerm=function(e){this.upperBound.removeTerm(e);this.lowerBound.removeTerm(e);return this};WE.prototype.setRightHandSide=function(e){this.upperBound.setRightHandSide(e);this.lowerBound.setRightHandSide(e);this.rhs=e};WE.prototype.relax=function(e,t){this.relaxation=qE(this.model,e,t);this.upperBound.relaxation=this.relaxation;this.upperBound._relax(this.relaxation);this.lowerBound.relaxation=this.relaxation;this.lowerBound._relax(this.relaxation)};var XE={Constraint:HE,Variable:VE,IntegerVariable:jE,SlackVariable:UE,Equality:WE,Term:GE};var YE=XE.SlackVariable;OE.prototype.addCutConstraints=function(e){var t=e.length;var r=this.height;var i=r+t;for(var n=r;n<i;n+=1){if(this.matrix[n]===undefined){this.matrix[n]=this.matrix[n-1].slice()}}this.height=i;this.nVars=this.width+this.height-2;var a;var o=this.width-1;for(var s=0;s<t;s+=1){var u=e[s];var l=r+s;var d=u.type==="min"?-1:1;var h=u.varIndex;var f=this.rowByVarIndex[h];var c=this.matrix[l];if(f===-1){c[this.rhsColumn]=d*u.value;for(a=1;a<=o;a+=1){c[a]=0}c[this.colByVarIndex[h]]=d}else{var v=this.matrix[f];var p=v[this.rhsColumn];c[this.rhsColumn]=d*(u.value-p);for(a=1;a<=o;a+=1){c[a]=-d*v[a]}}var g=this.getNewElementIndex();this.varIndexByRow[l]=g;this.rowByVarIndex[g]=l;this.colByVarIndex[g]=-1;this.variablesPerIndex[g]=new YE("s"+g,g);this.nVars+=1}};OE.prototype._addLowerBoundMIRCut=function(e){if(e===this.costRowIndex){return false}var t=this.model;var r=this.matrix;var i=this.variablesPerIndex[this.varIndexByRow[e]];if(!i.isInteger){return false}var n=r[e][this.rhsColumn];var a=n-Math.floor(n);if(a<this.precision||1-this.precision<a){return false}var o=this.height;r[o]=r[o-1].slice();this.height+=1;this.nVars+=1;var s=this.getNewElementIndex();this.varIndexByRow[o]=s;this.rowByVarIndex[s]=o;this.colByVarIndex[s]=-1;this.variablesPerIndex[s]=new YE("s"+s,s);r[o][this.rhsColumn]=Math.floor(n);for(var u=1;u<this.varIndexByCol.length;u+=1){var l=this.variablesPerIndex[this.varIndexByCol[u]];if(!l.isInteger){r[o][u]=Math.min(0,r[e][u]/(1-a))}else{var d=r[e][u];var h=Math.floor(d)+Math.max(0,d-Math.floor(d)-a)/(1-a);r[o][u]=h}}for(var f=0;f<this.width;f+=1){r[o][f]-=r[e][f]}return true};OE.prototype._addUpperBoundMIRCut=function(e){if(e===this.costRowIndex){return false}var t=this.model;var r=this.matrix;var i=this.variablesPerIndex[this.varIndexByRow[e]];if(!i.isInteger){return false}var n=r[e][this.rhsColumn];var a=n-Math.floor(n);if(a<this.precision||1-this.precision<a){return false}var o=this.height;r[o]=r[o-1].slice();this.height+=1;this.nVars+=1;var s=this.getNewElementIndex();this.varIndexByRow[o]=s;this.rowByVarIndex[s]=o;this.colByVarIndex[s]=-1;this.variablesPerIndex[s]=new YE("s"+s,s);r[o][this.rhsColumn]=-a;for(var u=1;u<this.varIndexByCol.length;u+=1){var l=this.variablesPerIndex[this.varIndexByCol[u]];var d=r[e][u];var h=d-Math.floor(d);if(l.isInteger){if(h<=a){r[o][u]=-h}else{r[o][u]=-(1-h)*a/h}}else{if(d>=0){r[o][u]=-d}else{r[o][u]=d*a/(1-a)}}}return true};OE.prototype.applyMIRCuts=function(){var e=this.height;for(var t=0;t<e;t+=1){this._addUpperBoundMIRCut(t)}for(t=0;t<e;t+=1){this._addLowerBoundMIRCut(t)}};OE.prototype._putInBase=function(e){var t=this.rowByVarIndex[e];if(t===-1){var r=this.colByVarIndex[e];for(var i=1;i<this.height;i+=1){var n=this.matrix[i][r];if(n<-this.precision||this.precision<n){t=i;break}}this.pivot(t,r)}return t};OE.prototype._takeOutOfBase=function(e){var t=this.colByVarIndex[e];if(t===-1){var r=this.rowByVarIndex[e];var i=this.matrix[r];for(var n=1;n<this.height;n+=1){var a=i[n];if(a<-this.precision||this.precision<a){t=n;break}}this.pivot(r,t)}return t};OE.prototype.updateVariableValues=function(){var e=this.variables.length;var t=Math.round(1/this.precision);for(var r=0;r<e;r+=1){var i=this.variables[r];var n=i.index;var a=this.rowByVarIndex[n];if(a===-1){i.value=0}else{var o=this.matrix[a][this.rhsColumn];i.value=Math.round(o*t)/t}}};OE.prototype.updateRightHandSide=function(e,t){var r=this.height-1;var i=this.rowByVarIndex[e.index];if(i===-1){var n=this.colByVarIndex[e.index];for(var a=0;a<=r;a+=1){var o=this.matrix[a];o[this.rhsColumn]-=t*o[n]}var s=this.optionalObjectives.length;if(s>0){for(var u=0;u<s;u+=1){var l=this.optionalObjectives[u].reducedCosts;l[this.rhsColumn]-=t*l[n]}}}else{this.matrix[i][this.rhsColumn]-=t}};OE.prototype.updateConstraintCoefficient=function(e,t,r){if(e.index===t.index){throw new Error("[Tableau.updateConstraintCoefficient] constraint index should not be equal to variable index !")}var i=this._putInBase(e.index);var n=this.colByVarIndex[t.index];if(n===-1){var a=this.rowByVarIndex[t.index];for(var o=0;o<this.width;o+=1){this.matrix[i][o]+=r*this.matrix[a][o]}}else{this.matrix[i][n]-=r}};OE.prototype.updateCost=function(e,t){var r=e.index;var i=this.width-1;var n=this.colByVarIndex[r];if(n===-1){var a=this.matrix[this.rowByVarIndex[r]];var o;if(e.priority===0){var s=this.matrix[0];for(o=0;o<=i;o+=1){s[o]+=t*a[o]}}else{var u=this.objectivesByPriority[e.priority].reducedCosts;for(o=0;o<=i;o+=1){u[o]+=t*a[o]}}}else{this.matrix[0][n]-=t}};OE.prototype.addConstraint=function(e){var t=e.isUpperBound?1:-1;var r=this.height;var i=this.matrix[r];if(i===undefined){i=this.matrix[0].slice();this.matrix[r]=i}var n=this.width-1;for(var a=0;a<=n;a+=1){i[a]=0}i[this.rhsColumn]=t*e.rhs;var o=e.terms;var s=o.length;for(var u=0;u<s;u+=1){var l=o[u];var d=l.coefficient;var h=l.variable.index;var f=this.rowByVarIndex[h];if(f===-1){i[this.colByVarIndex[h]]+=t*d}else{var c=this.matrix[f];var v=c[this.rhsColumn];for(a=0;a<=n;a+=1){i[a]-=t*d*c[a]}}}var p=e.index;this.varIndexByRow[r]=p;this.rowByVarIndex[p]=r;this.colByVarIndex[p]=-1;this.height+=1};OE.prototype.removeConstraint=function(e){var t=e.index;var r=this.height-1;var i=this._putInBase(t);var n=this.matrix[r];this.matrix[r]=this.matrix[i];this.matrix[i]=n;this.varIndexByRow[i]=this.varIndexByRow[r];this.varIndexByRow[r]=-1;this.rowByVarIndex[t]=-1;this.availableIndexes[this.availableIndexes.length]=t;e.slack.index=-1;this.height-=1};OE.prototype.addVariable=function(e){var t=this.height-1;var r=this.width;var i=this.model.isMinimization===true?-e.cost:e.cost;var n=e.priority;var a=this.optionalObjectives.length;if(a>0){for(var o=0;o<a;o+=1){this.optionalObjectives[o].reducedCosts[r]=0}}if(n===0){this.matrix[0][r]=i}else{this.setOptionalObjective(n,r,i);this.matrix[0][r]=0}for(var s=1;s<=t;s+=1){this.matrix[s][r]=0}var u=e.index;this.varIndexByCol[r]=u;this.rowByVarIndex[u]=-1;this.colByVarIndex[u]=r;this.width+=1};OE.prototype.removeVariable=function(e){var t=e.index;var r=this._takeOutOfBase(t);var i=this.width-1;if(r!==i){var n=this.height-1;for(var a=0;a<=n;a+=1){var o=this.matrix[a];o[r]=o[i]}var s=this.optionalObjectives.length;if(s>0){for(var u=0;u<s;u+=1){var l=this.optionalObjectives[u].reducedCosts;l[r]=l[i]}}var d=this.varIndexByCol[i];this.varIndexByCol[r]=d;this.colByVarIndex[d]=r}this.varIndexByCol[i]=-1;this.colByVarIndex[t]=-1;this.availableIndexes[this.availableIndexes.length]=t;e.index=-1;this.width-=1};OE.prototype.log=function(e,force){console.log("****",e,"****");console.log("Nb Variables",this.width-1);console.log("Nb Constraints",this.height-1);console.log("Basic Indexes",this.varIndexByRow);console.log("Non Basic Indexes",this.varIndexByCol);console.log("Rows",this.rowByVarIndex);console.log("Cols",this.colByVarIndex);var t=5;var r="",i=[" "],n,a,o,s,u,l,d,h,f;var c,v;for(a=1;a<this.width;a+=1){u=this.varIndexByCol[a];s=this.variablesPerIndex[u];if(s===undefined){l="c"+u}else{l=s.id}d=l.length;h=" ";f="\t";if(d>5){h+=" "}else{f+="\t"}i[a]=h;r+=f+l}console.log(r);var p;var g=this.matrix[this.costRowIndex];var _="\t";for(n=1;n<this.width;n+=1){p="\t";_+=p;_+=i[n];_+=g[n].toFixed(t)}p="\t";_+=p+i[0]+g[0].toFixed(t);console.log(_+"\tZ");for(o=1;o<this.height;o+=1){c=this.matrix[o];v="\t";for(a=1;a<this.width;a+=1){p="\t";v+=p+i[a]+c[a].toFixed(t)}p="\t";v+=p+i[0]+c[0].toFixed(t);u=this.varIndexByRow[o];s=this.variablesPerIndex[u];if(s===undefined){l="c"+u}else{l=s.id}console.log(v+"\t"+l)}console.log("");var m=this.optionalObjectives.length;if(m>0){console.log("    Optional objectives:");for(var y=0;y<m;y+=1){var b=this.optionalObjectives[y].reducedCosts;var x="";for(n=1;n<this.width;n+=1){p=b[n]<0?"":" ";x+=p;x+=i[n];x+=b[n].toFixed(t)}p=b[0]<0?"":" ";x+=p+i[0]+b[0].toFixed(t);console.log(x+" z"+y)}}console.log("Feasible?",this.feasible);console.log("evaluation",this.evaluation);return this};OE.prototype.copy=function(){var e=new OE(this.precision);e.width=this.width;e.height=this.height;e.nVars=this.nVars;e.model=this.model;e.variables=this.variables;e.variablesPerIndex=this.variablesPerIndex;e.unrestrictedVars=this.unrestrictedVars;e.lastElementIndex=this.lastElementIndex;e.varIndexByRow=this.varIndexByRow.slice();e.varIndexByCol=this.varIndexByCol.slice();e.rowByVarIndex=this.rowByVarIndex.slice();e.colByVarIndex=this.colByVarIndex.slice();e.availableIndexes=this.availableIndexes.slice();var t=[];for(var r=0;r<this.optionalObjectives.length;r++){t[r]=this.optionalObjectives[r].copy()}e.optionalObjectives=t;var i=this.matrix;var n=new Array(this.height);for(var a=0;a<this.height;a++){n[a]=i[a].slice()}e.matrix=n;return e};OE.prototype.save=function(){this.savedState=this.copy()};OE.prototype.restore=function(){if(this.savedState===null){return}var e=this.savedState;var t=e.matrix;this.nVars=e.nVars;this.model=e.model;this.variables=e.variables;this.variablesPerIndex=e.variablesPerIndex;this.unrestrictedVars=e.unrestrictedVars;this.lastElementIndex=e.lastElementIndex;this.width=e.width;this.height=e.height;var r,i;for(r=0;r<this.height;r+=1){var n=t[r];var a=this.matrix[r];for(i=0;i<this.width;i+=1){a[i]=n[i]}}var o=e.varIndexByRow;for(i=0;i<this.height;i+=1){this.varIndexByRow[i]=o[i]}while(this.varIndexByRow.length>this.height){this.varIndexByRow.pop()}var s=e.varIndexByCol;for(r=0;r<this.width;r+=1){this.varIndexByCol[r]=s[r]}while(this.varIndexByCol.length>this.width){this.varIndexByCol.pop()}var u=e.rowByVarIndex;var l=e.colByVarIndex;for(var d=0;d<this.nVars;d+=1){this.rowByVarIndex[d]=u[d];this.colByVarIndex[d]=l[d]}if(e.optionalObjectives.length>0&&this.optionalObjectives.length>0){this.optionalObjectives=[];this.optionalObjectivePerPriority={};for(var h=0;h<e.optionalObjectives.length;h++){var f=e.optionalObjectives[h].copy();this.optionalObjectives[h]=f;this.optionalObjectivePerPriority[f.priority]=f}}};function ZE(e,value){this.index=e;this.value=value}OE.prototype.getMostFractionalVar=function(){var e=0;var t=null;var r=null;var i=this.model.integerVariables;var n=i.length;for(var a=0;a<n;a++){var o=i[a].index;var s=this.rowByVarIndex[o];if(s===-1){continue}var u=this.matrix[s][this.rhsColumn];var l=Math.abs(u-Math.round(u));if(e<l){e=l;t=o;r=u}}return new ZE(t,r)};OE.prototype.getFractionalVarWithLowestCost=function(){var e=Infinity;var t=null;var r=null;var i=this.model.integerVariables;var n=i.length;for(var a=0;a<n;a++){var o=i[a];var s=o.index;var u=this.rowByVarIndex[s];if(u===-1){continue}var l=this.matrix[u][this.rhsColumn];if(Math.abs(l-Math.round(l))>this.precision){var d=o.cost;if(e>d){e=d;t=s;r=l}}}return new ZE(t,r)};OE.prototype.countIntegerValues=function(){var e=0;for(var t=1;t<this.height;t+=1){if(this.variablesPerIndex[this.varIndexByRow[t]].isInteger){var r=this.matrix[t][this.rhsColumn];r=r-Math.floor(r);if(r<this.precision&&-r<this.precision){e+=1}}}return e};OE.prototype.isIntegral=function(){var e=this.model.integerVariables;var t=e.length;for(var r=0;r<t;r++){var i=this.rowByVarIndex[e[r].index];if(i===-1){continue}var n=this.matrix[i][this.rhsColumn];if(Math.abs(n-Math.round(n))>this.precision){return false}}return true};OE.prototype.computeFractionalVolume=function(e){var t=-1;for(var r=1;r<this.height;r+=1){if(this.variablesPerIndex[this.varIndexByRow[r]].isInteger){var i=this.matrix[r][this.rhsColumn];i=Math.abs(i);var n=Math.min(i-Math.floor(i),Math.floor(i+1));if(n<this.precision){if(!e){return 0}}else{if(t===-1){t=i}else{t*=i}}}}if(t===-1){return 0}return t};var KE=OE;function QE(e,t,value){this.type=e;this.varIndex=t;this.value=value}function JE(e,t){this.relaxedEvaluation=e;this.cuts=t}function $E(e,t){return t.relaxedEvaluation-e.relaxedEvaluation}OE.prototype.applyCuts=function(e){this.restore();this.addCutConstraints(e);this.simplex();if(this.model.useMIRCuts){var t=true;while(t){var r=this.computeFractionalVolume(true);this.applyMIRCuts();this.simplex();var i=this.computeFractionalVolume(true);if(i>=.9*r){t=false}}}};OE.prototype.branchAndCut=function(){var e=[];var t=0;var r=Infinity;var i=null;var n=[];for(var a=0;a<this.optionalObjectives.length;a+=1){n.push(Infinity)}var o=new JE(-Infinity,[]);e.push(o);while(e.length>0){o=e.pop();if(o.relaxedEvaluation>r){continue}var s=o.cuts;this.applyCuts(s);t++;if(this.feasible===false){continue}var u=this.evaluation;if(u>r){continue}if(u===r){var l=true;for(var d=0;d<this.optionalObjectives.length;d+=1){if(this.optionalObjectives[d].reducedCosts[0]>n[d]){break}else if(this.optionalObjectives[d].reducedCosts[0]<n[d]){l=false;break}}if(l){continue}}if(this.isIntegral()===true){if(t===1){this.branchAndCutIterations=t;return}i=o;r=u;for(var h=0;h<this.optionalObjectives.length;h+=1){n[h]=this.optionalObjectives[h].reducedCosts[0]}}else{if(t===1){this.save()}var f=this.getMostFractionalVar();var c=f.index;var v=[];var p=[];var g=s.length;for(var _=0;_<g;_+=1){var m=s[_];if(m.varIndex===c){if(m.type==="min"){p.push(m)}else{v.push(m)}}else{v.push(m);p.push(m)}}var y=Math.ceil(f.value);var b=Math.floor(f.value);var x=new QE("min",c,y);v.push(x);var A=new QE("max",c,b);p.push(A);e.push(new JE(u,v));e.push(new JE(u,p));e.sort($E)}}if(i!==null){this.applyCuts(i.cuts)}this.branchAndCutIterations=t};var eS={};var tS=XE.Constraint;var rS=XE.Equality;var iS=XE.Variable;var nS=XE.IntegerVariable;function aS(e,t){this.tableau=new OE(e);this.name=t;this.variables=[];this.integerVariables=[];this.unrestrictedVariables={};this.constraints=[];this.nConstraints=0;this.nVariables=0;this.isMinimization=true;this.tableauInitialized=false;this.relaxationIndex=1;this.useMIRCuts=true;this.checkForCycles=false}var oS=aS;aS.prototype.minimize=function(){this.isMinimization=true;return this};aS.prototype.maximize=function(){this.isMinimization=false;return this};aS.prototype._getNewElementIndex=function(){if(this.availableIndexes.length>0){return this.availableIndexes.pop()}var e=this.lastElementIndex;this.lastElementIndex+=1;return e};aS.prototype._addConstraint=function(e){var t=e.slack;this.tableau.variablesPerIndex[t.index]=t;this.constraints.push(e);this.nConstraints+=1;if(this.tableauInitialized===true){this.tableau.addConstraint(e)}};aS.prototype.smallerThan=function(e){var t=new tS(e,true,this.tableau.getNewElementIndex(),this);this._addConstraint(t);return t};aS.prototype.greaterThan=function(e){var t=new tS(e,false,this.tableau.getNewElementIndex(),this);this._addConstraint(t);return t};aS.prototype.equal=function(e){var t=new tS(e,true,this.tableau.getNewElementIndex(),this);this._addConstraint(t);var r=new tS(e,false,this.tableau.getNewElementIndex(),this);this._addConstraint(r);return new rS(t,r)};aS.prototype.addVariable=function(e,t,r,i,n){if(typeof n==="string"){switch(n){case"required":n=0;break;case"strong":n=1;break;case"medium":n=2;break;case"weak":n=3;break;default:n=0;break}}var a=this.tableau.getNewElementIndex();if(t===null||t===undefined){t="v"+a}if(e===null||e===undefined){e=0}if(n===null||n===undefined){n=0}var o;if(r){o=new nS(t,e,a,n);this.integerVariables.push(o)}else{o=new iS(t,e,a,n)}this.variables.push(o);this.tableau.variablesPerIndex[a]=o;if(i){this.unrestrictedVariables[a]=true}this.nVariables+=1;if(this.tableauInitialized===true){this.tableau.addVariable(o)}return o};aS.prototype._removeConstraint=function(e){var t=this.constraints.indexOf(e);if(t===-1){console.warn("[Model.removeConstraint] Constraint not present in model");return}this.constraints.splice(t,1);this.nConstraints-=1;if(this.tableauInitialized===true){this.tableau.removeConstraint(e)}if(e.relaxation){this.removeVariable(e.relaxation)}};aS.prototype.removeConstraint=function(e){if(e.isEquality){this._removeConstraint(e.upperBound);this._removeConstraint(e.lowerBound)}else{this._removeConstraint(e)}return this};aS.prototype.removeVariable=function(e){var t=this.variables.indexOf(e);if(t===-1){console.warn("[Model.removeVariable] Variable not present in model");return}this.variables.splice(t,1);if(this.tableauInitialized===true){this.tableau.removeVariable(e)}return this};aS.prototype.updateRightHandSide=function(e,t){if(this.tableauInitialized===true){this.tableau.updateRightHandSide(e,t)}return this};aS.prototype.updateConstraintCoefficient=function(e,t,r){if(this.tableauInitialized===true){this.tableau.updateConstraintCoefficient(e,t,r)}return this};aS.prototype.setCost=function(e,t){var r=e-t.cost;if(this.isMinimization===false){r=-r}t.cost=e;this.tableau.updateCost(t,r);return this};aS.prototype.loadJson=function(e){this.isMinimization=e.opType!=="max";var t=e.variables;var r=e.constraints;var i={};var n={};var a=Object.keys(r);var o=a.length;for(var s=0;s<o;s+=1){var u=a[s];var l=r[u];var d=l.equal;var h=l.weight;var f=l.priority;var c=h!==undefined||f!==undefined;var v,p;if(d===undefined){var g=l.min;if(g!==undefined){v=this.greaterThan(g);i[u]=v;if(c){v.relax(h,f)}}var _=l.max;if(_!==undefined){p=this.smallerThan(_);n[u]=p;if(c){p.relax(h,f)}}}else{v=this.greaterThan(d);i[u]=v;p=this.smallerThan(d);n[u]=p;var m=new rS(v,p);if(c){m.relax(h,f)}}}var y=Object.keys(t);var b=y.length;var x=e.ints||{};var A=e.binaries||{};var E=e.unrestricted||{};var S=e.optimize;for(var w=0;w<b;w+=1){var T=y[w];var C=t[T];var I=C[S]||0;var M=!!A[T];var L=!!x[T]||M;var k=!!E[T];var N=this.addVariable(I,T,L,k);if(M){this.smallerThan(1).addTerm(1,N)}var F=Object.keys(C);for(s=0;s<F.length;s+=1){var z=F[s];if(z===S){continue}var R=C[z];var P=i[z];if(P!==undefined){P.addTerm(R,N)}var O=n[z];if(O!==undefined){O.addTerm(R,N)}}}return this};aS.prototype.getNumberOfIntegerVariables=function(){return this.integerVariables.length};aS.prototype.solve=function(){if(this.tableauInitialized===false){this.tableau.setModel(this);this.tableauInitialized=true}return this.tableau.solve()};aS.prototype.isFeasible=function(){return this.tableau.feasible};aS.prototype.save=function(){return this.tableau.save()};aS.prototype.restore=function(){return this.tableau.restore()};aS.prototype.activateMIRCuts=function(e){this.useMIRCuts=e};aS.prototype.debug=function(e){this.checkForCycles=e};aS.prototype.log=function(e){return this.tableau.log(e)};var sS=function(e){var t,r,i;if(typeof e.optimize==="string"){if(e.constraints[e.optimize]){t=Math.random();for(r in e.variables){if(e.variables[r][e.optimize]){e.variables[r][t]=e.variables[r][e.optimize]}}e.constraints[t]=e.constraints[e.optimize];delete e.constraints[e.optimize];return e}else{return e}}else{for(i in e.optimize){if(e.constraints[i]){if(e.constraints[i]==="equal"){delete e.optimize[i]}else{t=Math.random();for(r in e.variables){if(e.variables[r][i]){e.variables[r][t]=e.variables[r][i]}}e.constraints[t]=e.constraints[i];delete e.constraints[i]}}}return e}};var uS={CleanObjectiveAttributes:sS};function lS(e){var t={is_blank:/^\W{0,}$/,is_objective:/(max|min)(imize){0,}\:/i,is_int:/^(?!\/\*)\W{0,}int/i,is_constraint:/(\>|\<){0,}\=/i,is_unrestricted:/^\S{0,}unrestricted/i,parse_lhs:/(\-|\+){0,1}\s{0,1}\d{0,}\.{0,}\d{0,}\s{0,}[A-Za-z]\S{0,}/gi,parse_rhs:/(\-|\+){0,1}\d{1,}\.{0,}\d{0,}\W{0,}\;{0,1}$/i,parse_dir:/(\>|\<){0,}\=/gi,parse_int:/[^\s|^\,]+/gi,get_num:/(\-|\+){0,1}(\W|^)\d+\.{0,1}\d{0,}/g,get_word:/[A-Za-z].*/},r={opType:"",optimize:"_obj",constraints:{},variables:{}},i={">=":"min","<=":"max","=":"equal"},n="",a=null,o="",s="",u="",l=0;if(typeof e==="string"){e=e.split("\n")}for(var d=0;d<e.length;d++){u="__"+d;n=e[d];a=null;if(t.is_objective.test(n)){r.opType=n.match(/(max|min)/gi)[0];a=n.match(t.parse_lhs).map(function(e){return e.replace(/\s+/,"")}).slice(1);a.forEach(function(e){o=e.match(t.get_num);if(o===null){if(e.substr(0,1)==="-"){o=-1}else{o=1}}else{o=o[0]}o=parseFloat(o);s=e.match(t.get_word)[0].replace(/\;$/,"");r.variables[s]=r.variables[s]||{};r.variables[s]._obj=o})}else if(t.is_int.test(n)){a=n.match(t.parse_int).slice(1);r.ints=r.ints||{};a.forEach(function(e){e=e.replace(";","");r.ints[e]=1})}else if(t.is_constraint.test(n)){var h=n.indexOf(":");var f=h===-1?n:n.slice(h+1);a=f.match(t.parse_lhs).map(function(e){return e.replace(/\s+/,"")});a.forEach(function(e){o=e.match(t.get_num);if(o===null){if(e.substr(0,1)==="-"){o=-1}else{o=1}}else{o=o[0]}o=parseFloat(o);s=e.match(t.get_word)[0];r.variables[s]=r.variables[s]||{};r.variables[s][u]=o});l=parseFloat(n.match(t.parse_rhs)[0]);n=i[n.match(t.parse_dir)[0]];r.constraints[u]=r.constraints[u]||{};r.constraints[u][n]=l}else if(t.is_unrestricted.test(n)){a=n.match(t.parse_int).slice(1);r.unrestricted=r.unrestricted||{};a.forEach(function(e){e=e.replace(";","");r.unrestricted[e]=1})}}return r}function dS(e){if(!e){throw new Error("Solver requires a model to operate on")}var t="",r={max:"<=",min:">=",equal:"="},i=new RegExp("[^A-Za-z0-9]+","gi");t+=e.opType+":";for(var n in e.variables){e.variables[n][n]=e.variables[n][n]?e.variables[n][n]:1;if(e.variables[n][e.optimize]){t+=" "+e.variables[n][e.optimize]+" "+n.replace(i,"_")}}t+=";\n";for(n in e.constraints){for(var a in e.constraints[n]){for(var o in e.variables){if(e.variables[o][n]){t+=" "+e.variables[o][n]+" "+o.replace(i,"_")}}t+=" "+r[a]+" "+e.constraints[n][a];t+=";\n"}}if(e.ints){t+="\n\n";for(n in e.ints){t+="int "+n.replace(i,"_")+";\n"}}if(e.unrestricted){t+="\n\n";for(n in e.unrestricted){t+="unrestricted "+n.replace(i,"_")+";\n"}}return t}var hS=function(e){if(e.length){return lS(e)}else{return dS(e)}};var fS=function(e,t){var r=t.optimize,i=JSON.parse(JSON.stringify(t.optimize)),n=Object.keys(t.optimize),a,o=0,s={},u="",l={},d=[],h,f,c,v;delete t.optimize;for(h=0;h<n.length;h++){i[n[h]]=0}for(h=0;h<n.length;h++){t.optimize=n[h];t.opType=r[n[h]];a=e.Solve(t,undefined,undefined,true);for(v in n){if(!t.variables[n[v]]){a[n[v]]=a[n[v]]?a[n[v]]:0;for(c in t.variables){if(t.variables[c][n[v]]&&a[c]){a[n[v]]+=a[c]*t.variables[c][n[v]]}}}}u="base";for(f=0;f<n.length;f++){if(a[n[f]]){u+="-"+(a[n[f]]*1e3|0)/1e3}else{u+="-0"}}if(!s[u]){s[u]=1;o++;for(f=0;f<n.length;f++){if(a[n[f]]){i[n[f]]+=a[n[f]]}}delete a.feasible;delete a.result;d.push(a)}}for(h=0;h<n.length;h++){t.constraints[n[h]]={equal:i[n[h]]/o}}t.optimize="cheater-"+Math.random();t.opType="max";for(h in t.variables){t.variables[h].cheater=1}for(h in d){for(c in d[h]){l[c]=l[c]||{min:1e99,max:-1e99}}}for(h in l){for(c in d){if(d[c][h]){if(d[c][h]>l[h].max){l[h].max=d[c][h]}if(d[c][h]<l[h].min){l[h].min=d[c][h]}}else{d[c][h]=0;l[h].min=0}}}a=e.Solve(t,undefined,undefined,true);return{midpoint:a,vertices:d,ranges:l}};var cS=XE.Constraint;var vS=XE.Variable;var pS=XE.Numeral;var gS=XE.Term;var _S=function(){this.Model=oS;this.branchAndCut=eS;this.Constraint=cS;this.Variable=vS;this.Numeral=pS;this.Term=gS;this.Tableau=KE;this.lastSolvedModel=null;this.Solve=function(e,t,r,i){if(i){for(var n in uS){e=uS[n](e)}}if(!e){throw new Error("Solver requires a model to operate on")}if(e instanceof oS===false){e=new oS(t).loadJson(e)}var a=e.solve();this.lastSolvedModel=e;a.solutionSet=a.generateSolutionSet();if(r){return a}else{var o={};o.feasible=a.feasible;o.result=a.evaluation;o.bounded=a.bounded;Object.keys(a.solutionSet).map(function(e){o[e]=a.solutionSet[e]});return o}};this.ReformatLP=hS;this.MultiObjective=function(e){return fS(this,e)}};if(typeof window==="object"){window.solver=new _S}var mS=new _S;function yS(e){var t={};var r={};var i={};e.nodes.forEach(function(e){r[e.id]=1;t[e.id]={opt:e.children.length};e.children.forEach(function(r){var n=e.id+"->"+r.id;i[n]={min:1};t[e.id][n]=-1})});e.nodes.forEach(function(e){e.children.forEach(function(r){var i=e.id+"->"+r.id;t[r.id].opt--;t[r.id][i]=1})});var n=mS.Solve({optimize:"opt",opType:"max",constraints:i,variables:t,ints:r});e.nodes.forEach(function(e){e.layer=n[e.id]||0});return e}function bS(e){e.nodes.forEach(function(e){e.layer=e.data.layer!=null?e.data.layer:e.layer});return e}function xS(e){if(e.nodes.every(function(e){return e.layer})){var t=Infinity;e.nodes.forEach(function(e){t=Math.min(t,e.layer)});e.nodes.forEach(function(e){e.layer-=t})}return e}function AS(e){var t={};e.nodes.forEach(function(e){t[e.id]=(t[e.id]||[]).concat(e.children);e.children.forEach(function(r){t[r.id]=(t[r.id]||[]).concat([e])})});var r=[];e.nodes.forEach(function(e){if(e.layer===0){r.push(e)}});var i={};var n={};e.nodes.forEach(function(e){if(e.layer!=null){n[e.id]=e.layer}});while(r.length){var a=r.shift();var o=a.id;for(var s=0,u=t[o];s<u.length;s+=1){var l=u[s];if(!i[l.id]){if(n[l.id]==null){var d=n[o]+1;n[l.id]=d;l.layer=d}i[l.id]=true;r.push(l)}}}return e}function ES(e){if(e.nodes.some(function(e){return e.data.sink})){var t=-Infinity;e.nodes.forEach(function(e){t=Math.max(t,e.layer)});e.nodes.forEach(function(e){if(e.data.sink){e.layer=t+1}})}return e}function SS(e,t){if(!t.normalization){return e}var r=[];e.nodes.forEach(function(e){return r[e.layer]=0});var i=Array.from(r);var n=function(e,t,r){if(r===0){e.push(0);return e}var i=e[r-1];if(t!=null){e.push(i);return e}e.push(i-1);return e};var a=i.reduce(n,[]);e.nodes.forEach(function(e){e.layer+=a[e.layer]});return e}function wS(e){var t=Object.assign({},{normalization:true},e);var r=yS;function i(e){if(e.nodes.some(function(e){return"layer"in e.data&&e.data.layer<0})){throw new Error("Some nodes have negative layering information")}if(!t.normalization){if(e.nodes.every(function(e){return"layer"in e.data&&e.data.layer>-1})){var i=[];e.nodes.forEach(function(e){return i[e.data.layer]=1});var n=i.findIndex(function(e){return e!=null});var a=i.slice(n);for(var o=0,s=a;o<s.length;o+=1){var u=s[o];if(u==null){throw new Error("The overall layering contains gaps (two non-consecutive layers)")}}}}var l;if(!e.nodes.some(function(e){return"layer"in e.data&&e.data.layer===0})){l=bS(r(e))}l=AS(bS(e));var d=xS(ES(l));SS(d,t);return kE(d)}return i}var TS=function e(){this.root=null};TS.prototype.fit=function e(t){var r=t.length?t[0].w:0;var i=t.length?t[0].h:0;this.root={x:0,y:0,w:r,h:i};for(var n=0,a=t;n<a.length;n+=1){var o=a[n];var s=this.findNode(this.root,o.w,o.h);if(s){o.fit=this.splitNode(s,o.w,o.h)}else{o.fit=this.growNode(o.w,o.h)}}};TS.prototype.findNode=function e(t,r,i){if(t.used){return this.findNode(t.right,r,i)||this.findNode(t.down,r,i)}if(r<=t.w&&i<=t.h){return t}};TS.prototype.splitNode=function e(t,r,i){t.used=true;t.down={x:t.x,y:t.y+i,w:t.w,h:t.h-i};t.right={x:t.x+r,y:t.y,w:t.w-r,h:i};return t};TS.prototype.growNode=function e(t,r){var i=t<=this.root.w;var n=r<=this.root.h;if(n&&this.root.h>=this.root.w+t){return this.growRight(t,r)}if(i&&this.root.w>=this.root.h+r){return this.growDown(t,r)}if(n){return this.growRight(t,r)}if(i){return this.growDown(t,r)}};TS.prototype.getNewRoot=function e(t,r,i,n){if(t===void 0)t=0;if(r===void 0)r=0;if(i===void 0)i=this.root;if(n===void 0)n=this.root;return{used:true,x:0,y:0,w:this.root.w+t,h:this.root.h+r,right:i,down:n}};TS.prototype.growRight=function e(t,r){this.root=this.getNewRoot(t,0,{x:this.root.w,y:0,w:t,h:this.root.h});return this.grow(t,r)};TS.prototype.growDown=function e(t,r){this.root=this.getNewRoot(0,r,undefined,{x:0,y:this.root.h,w:this.root.w,h:r});return this.grow(t,r)};TS.prototype.grow=function e(t,r){var i=this.findNode(this.root,t,r);if(i){return this.splitNode(i,t,r)}};function CS(e,t){var r=e.reduce(function(e,r){return r.nodes.reduce(function(e,r){var i=r.id;var n=t[i]||{};var a=n.x;var o=n.y;if(a!=null&&o!==null){e.x=Math.min(a,e.x);e.y=Math.min(o,e.y)}return e},e)},{x:Infinity,y:Infinity});var i=r.x;var n=r.y;return{x:isFinite(i)?i:0,y:isFinite(n)?n:0}}function IS(e){return e.nodes.filter(function(e){var t=e.layer;return!t})}var MS={down:function(){},up:function(e,t,r){e.y=-e.y+r},left:function(e,t,r){var i=e.x;e.x=-e.y+r;e.y=i-t},right:function(e,t,r){var i=e.x;e.x=e.y-r;e.y=-i+t}};function LS(e,t,r,i){if(t&&t in MS){MS[t](e,r,i)}}function kS(e,t,r,i){var n=e;if(e.length>1){var a={id:"__root__",parentIds:[],virtual:true};for(var o=0,s=e.map(IS);o<s.length;o+=1){var u=s[o];for(var l=0,d=u;l<d.length;l+=1){var h=d[l];h.data.parentIds.push(a.id)}}var f=e.reduce(function(e,t){return e.concat(t.nodes.map(function(e){return e.data}))},[a]);n=i([f],r)}return NS(n,t,r)}function NS(e,t,r){var i=-Infinity;var n=-Infinity;var a=50;var o=[];var s=r.nodesSeparation||0;var u=CS(e,t);var l=e.reduce(function(e,r){var i=r.nodes.filter(function(e){return e.data&&e.data.fixed});return i.reduce(function(e,r){var i=t[r.id];var n=i.x;var a=i.y;e[r.id]={x:n,y:a};return e},e)},{});var d=function(){var e=f[h];var u={};var l=e.nodes;var d=l.length==1;var c=2*tE(l)|5;var v=r.layerSeparation!=null?r.layerSeparation:a;var p=l.reduce(function(e,t){var r=t.x;return Math.min(e,r)},Infinity);i=l.reduce(function(e,t){var r=t.x;return Math.max(e,r)},-Infinity)-p;for(var g=0,_=l;g<_.length;g+=1){var m=_[g];var y=m.x;var b=m.y;var x=m.id;if(t[x]){if(d){t[x].x=t[x].y=0}else{t[x].x=y-p;t[x].y=b;u[b]=u[b]||[];u[b].push(t[x])}}}var A=Math.max(c,v);var E=Object.keys(u);var S=E.reduce(function(e,t){return Math.max(e,u[t].length-1)},1);var w=S*(3+Math.max(1,s));n=(E.length||1)*A;i=Math.max(i,1);if(!e.isFake){E.sort(function(e,t){return e-t}).forEach(function(e,t){u[e].forEach(function(e){e.y=t*A;e.x=e.x/i*w})})}o.push({w:Math.ceil(w),h:Math.ceil(n),dag:e});i=-Infinity;n=-Infinity};for(var h=0,f=e;h<f.length;h+=1)d();o.sort(function(e,t){return Math.max(t.w,t.h)-Math.max(e.w,e.h)});var c=new TS;c.fit(o);var v=o.reduce(function(e,t){var r=t.h;return Math.max(e,r)},1);var p=o.reduce(function(e,t){var r=t.fit;return Math.max(r&&r.x||0,e)},1);var g=2*a;for(var _=0,m=o;_<m.length;_+=1){var y=m[_];var b=y.fit;var x=y.dag;var A=y.w;var E=y.h;var S=b||{x:0,y:0};var w=S.y/v*a+S.y;var T=S.x/p*g+S.x;for(var C=0,I=x.nodes;C<I.length;C+=1){var M=I[C];var L=M;var k=L.id;if(t[k]){t[k].x+=T;t[k].y+=w;LS(t[k],r.direction,(A+T)/2,(E+w)/2);t[k].x+=u.x;t[k].y+=u.y}}var N=x.nodes[0]&&x.nodes[0].ref;var F=0;var z=0;if(N){F=t[N].x-l[N].x;z=t[N].y-l[N].y}if(F||z){for(var R=0,P=x.nodes;R<P.length;R+=1){var O=P[R];var D=O;var B=D.id;if(t[B]){t[B].x-=F;t[B].y-=z}}}}var V=Object.keys(l);for(var j=0,U=V;j<U.length;j+=1){var G=U[j];t[G].x=l[G].x;t[G].y=l[G].y}return e}var FS={rect:NS,hierarchy:kS};function zS(e,t,r,i){if(r===void 0)r={};var n=FS[r.packing]||FS.rect;return n(e,t,r,i)}var RS=1.2;var PS=50;function OS(e){return e.reduce(function(e,t){var r=t.r;return Math.max(e,2*r)},0)}function DS(e,t){if(t===void 0)t={};var r=e.slice().sort(function(e,t){return t.r-e.r});var i=Math.sqrt(r.length);var n=Math.floor(i);var a=Math.ceil(i);if(n*a<r.length){if(n<a){n++}else{a++}}var o=RS*OS(r);var s=Math.max(t.nodesGridSeparation||PS,1);var u=o*a+s*(a-1);var l=o*n+s*Math.max(n-1,0);r.forEach(function(e,t){var r=t%a;var i=Math.floor(t/a);e.x=u*r/a;e.y=l*i/n});return{w:u,h:l}}function BS(e){if(!e||!e.length){throw Error("Cannot stratify empty data")}for(var t=0,r=e;t<r.length;t+=1){var i=r[t];if(i==null){throw Error('Node data is "null"')}if(i.id==null){throw Error('Node id contains a "null" value')}}var n=e.map(function(e){return lE(e.id,e)});var a=n.reduce(function(e,t){if(e[t.id]){throw Error("The connected component contains id duplicates: "+t.id)}e[t.id]=t;return e},{});var o=lE();for(var s=0,u=n;s<u.length;s+=1){var l=u[s];for(var d=0,h=l.data.parentIds;d<h.length;d+=1){var f=h[d];var c=a[f];if(!c){throw Error("The node "+l.id+" has a missing parent id "+f)}c.children.push(l)}if(!l.data.parentIds.length){o.children.push(l)}}var v=VS(o);return{nodes:v}}function VS(e){var t={};var r=[].concat(e.children);var i=[];while(r.length){var n=r.pop();if(!t[n.id]){i.push(n);t[n.id]=1;r.push.apply(r,n.children)}}return i}var jS=1;var US=1;function GS(e,t){var r=t.decross;var i=t.separation;var n=t.coord;var a=t.layering;a(e);var o=YS(e);qS(o);HS(o,{decross:r,coord:n,separation:i});ZS(e);return e}function qS(e){var t=e.length===1?WS:XS;return e.forEach(function(r,i){for(var n=0,a=r;n<a.length;n+=1){var o=a[n];o.y=t(i,e.length)}})}function HS(e,t){var r=t.coord;var i=t.decross;var n=t.separation;if(e.every(function(e){return e.length===1})){return e.forEach(function(e){var t=e[0];return t.x=US/2})}i(e);r(e,n)}function WS(){return jS/2}function XS(e,t){return jS*e/(t-1)}function YS(e){return e.nodes.reduce(function(e,t){e[t.layer]=e[t.layer]||[];var r=e[t.layer];r.push(t);t.children=t.children.map(function(r){if(r.layer===t.layer+1){return r}var i=r;for(var n=r.layer-1;n>t.layer;n--){var a=lE(t.id+"->"+r.id+"@"+n);a.children=[i];e[n]=e[n]||[];e[n].push(a);i=a}return i});return e},[])}function ZS(e){e.nodes.forEach(function(e){if(e.data){e.children=e.children.filter(function(e){return e.data})}})}function KS(e,t){return Object.assign({},{nodes:e.map(function(e){return Object.assign({},e,{data:e})}),isFake:true},t)}function QS(e){var t=e.id;var r=e.layer;var i=e.sink;var n=e.r;var a=e.layoutable;return{id:""+t,layer:r,sink:i,radius:n,fixed:a===false,parentIds:[],ref:null}}var JS=function(e,t){if(t===void 0)t={};var r=(e.edges||[]).filter(function(e){var t=e.source;var r=e.target;return t!==r});var i={};for(var n=0,a=e.nodes;n<a.length;n+=1){var o=a[n];i[o.id]=o}var s=dE(e.nodes,r,i);var u=uE(e.nodes,s,{skipSingletons:t.packing==="singleton"});var l=s.reduce(function(e,t){if(!e[t.source]){e[t.source]=QS(i[t.source])}if(!e[t.target]){e[t.target]=QS(i[t.target])}var r=e[t.target];r.parentIds.push(""+t.source);return e},{});var d=u.map(function(e){return e.map(function(e){return l[e]||QS({id:e})})});return{shapes:d,nLookup:i}};function $S(e,t){if(t===void 0)t={};var r=[];for(var i=0,n=e;i<n.length;i+=1){var a=n[i];var o=BS(a);r.push(o);var s=tE(o.nodes);GS(o,{decross:cE(),separation:eE(s),coord:t.evenDistribution?LE():EE(),layering:wS(t)})}return r}function ew(e,t){if(!e||!e.nodes){return e}var r=t||{};var i=JS(e,r);var n=i.shapes;var a=i.nLookup;var o=$S(n,r);if(r.packing==="singleton"){var s=rE(e.nodes,e.edges);var u=DS(s,r);o.push(KS(s,u))}zS(o,a,r,$S);return e}var tw={direction:"TB",nodeDistance:50,levelDistance:50,arrangeComponents:"fit",gridDistance:50,layer:"layer"};var rw={imports:{sequential:ew},configure:function(e,t){if(e===void 0){e={}}var r=t.graph,i=t.data;function n(e,t,r){if(r===void 0){r=e.getNodes()}if(!t){return r}if(!(t instanceof _i)){return e.getNodes(t)}return t}var a=d({},tw,e);a.nodes=n(r,e.nodes);a.direction=e.direction||a.rankdir||tw.direction;a.layerSeparation=a.levelDistance;a.nodesSeparation=a.nodeDistance;a.packing=a.arrangeComponents;var o=d({},a);var s=r.getEdges();var u=r.getNodes(a.nodes);if(["TB","BT","LR","RL"].indexOf(a.direction)===-1){throw new Error('direction should be one of the "TB", "BT", "LR", "RL"')}if(["fit","grid","singleLine"].indexOf(a.packing)===-1){throw new Error('arrangeComponents should be one of the "fit", "grid", "singleLine"')}a.nodesGridSeparation=e.gridDistance;var l=u.getId();var h=u.getAttribute("layoutable").reduce(function(e,value,t){e[l[t]]=value;return e},{});var f=u.getAttributes(["x","y"]).reduce(function(e,value,t){e[l[t]]=value;return e},{});var c=u.getAttribute("radius");if(typeof o.layer!=="string"){throw new Error("'layer' should be the valid data field name")}var v=n(r,a.roots,r.nodeList());v.fillData(o.layer,0);var p=i.getProperty(a.nodes,o.layer);v.fillData(o.layer,null);var g=n(r,a.sinks,r.nodeList());var _=g.toArray().reduce(function(e,t){e[t.getId()]=true;return e},{});var m=l.map(function(e){return _[e]});return{nodes:l,edges:s.map(function(e){return{id:e.getId(),source:e.getSource().getId(),target:e.getTarget().getId()}}),options:W(a),layoutable:h,radiuses:c,layers:p,sinks:m,coords:f}},context:function(){},update:function(e){var t=e.nodes,r=e.edges,i=e.options,n=e.layoutable,a=e.radiuses,o=e.layers,s=e.sinks,u=e.coords;var l=r.filter(function(e){var t=e.source,r=e.target;return t in n&&r in n});var d={nodes:t.map(function(e,t){return{id:e,r:a[t],layer:o[t],sink:s[t],layoutable:n[e],x:u[e].x,y:u[e].y}}),edges:l};var h={TB:"down",BT:"up",RL:"left",LR:"right"};var f={fit:"rect",singleLine:"hierarchy",grid:"singleton"};var c=ew(d,{packing:f[i.arrangeComponents],direction:h[i.direction],layerSeparation:i.layerSeparation,nodesSeparation:i.nodesSeparation,nodesGridSeparation:i.nodesGridSeparation,evenDistribution:i.evenDistribution}).nodes;return{positions:c}},isRunning:function(){return false},onSync:function(e,t){var r=e.positions;var i=t.graph;var n=r.map(function(e){var t=e.id;return i.getNode(t)._index});var a=r.map(function(e){var t=e.x;return t});var o=r.map(function(e){var t=e.y;return t});return{indexes:n,x:a,y:o}}};var iw=function(e){e.modules.layouts.register("hierarchical",rw);return{hierarchical:function(t){if(t===void 0){t={}}t.useWebWorker=false;return e.modules.layouts.start("hierarchical",t)}}};var nw=function(e){e.modules.layouts.register("sequential",rw);return{sequential:function(t){if(t===void 0){t={}}t.useWebWorker=false;var r=d({},t,{evenDistribution:true});return e.modules.layouts.start("sequential",r)}}};var aw={configure:function(e,t){var r=t.graph,i=t.camera;function n(e){return e===undefined||typeof e==="number"&&isFinite(e)&&e>0}function a(e,t,r){if(!n(e)){throw new TypeError('"rows" should be a positive integer')}if(!n(t)){throw new TypeError('"cols" should be a positive integer')}if(e){return{rows:e,cols:Math.ceil(r/e)}}if(t){return{cols:t,rows:Math.ceil(r/t)}}var i=Math.ceil(Math.sqrt(r));return{cols:i,rows:Math.ceil(r/i)}}function o(e,t,r,i,n){if(typeof e!=="string"){return i.map(function(e,t){return t})}if(e==="radius"){return t.getAttribute(true,"radius").getMultiple(i)}if(e==="random"){return i.map(function(){return Math.random()})}return r.getData(e).map(function(value){return value||n})}var s=e.sortBy;var u=d({},e,{nodes:null});if(!e.nodes){u.nodes=r.getNodes()}if(e.nodes&&!(e.nodes instanceof _i)){u.nodes=r.getNodes(e.nodes)}var l=u.nodes;var h=Array.from(l._indexes);var f=h.length;var c=a(u.rows,u.cols,f),v=c.rows,p=c.cols;var g=o(s,r,l,h,e.sortFallbackValue);var _=l.getAttribute("layoutable");var m=h.reduce(function(e,t,r){if(!_[r]){return e}e.push({id:t,attr:g[r]});return e},[]);var y=l.getBoundingBox();var b=Math.max(y.maxScaledSize,y.maxFixedSize/i.getZoom())*.65;var x=y.minX+b;var A=y.maxX-b;var E=y.minY+b;var S=y.maxY-b;if(y.width<b*p*2){x=y.cx-b*p+b;A=y.cx+b*p-b}if(y.height<b*v*2){E=y.cy-b*v+b;S=y.cy+b*v-b}return{sort:!!s,nodes:m,reverse:!!u.reverse,cols:p,rows:v,minX:x,maxX:A,minY:E,maxY:S}},update:function(e){var t=e.sort,r=e.nodes,i=e.maxX,n=e.minX,a=e.maxY,o=e.minY,s=e.reverse,u=e.rows,l=e.cols;if(t){r.sort(function(e,t){var r=e.attr;var i=t.attr;if(r<i){return-1}if(r>i){return 1}return 0})}if(s){r.reverse()}var d=(i-n)/(l-1);var h=(a-o)/(u-1);var f=n;var c=o;if(!isFinite(d)){d=0}if(!isFinite(h)){h=0}var v=0;var p=0;r.forEach(function(e){e.x=f+v*d;e.y=c+p*h;v+=1;if(v===l){p+=1;v=0}});return r},onSync:function(e){var t=e.map(function(e){var t=e.id;return t});var r=e.map(function(e){var t=e.x;return t});var i=e.map(function(e){var t=e.y;return t});return{indexes:t,x:r,y:i}}};var ow=function(e){e.modules.layouts.register("grid",aw);return{grid:function(t){if(t===void 0){t={}}return e.modules.layouts.start("grid",t)}}};var sw=function(e){return{incremental:function(t){vr("Incremental ForceLink layout is now deprecated.\n    Please use the incremental option in force and forceLink layouts.");var r=t.nodes,i=t.centralNode;if(r instanceof _i&&r.size===0||Array.isArray(r)&&r.length===0){throw new Error("Incremental ForceLink layout: no nodes are selected")}if("margin"in t&&!isFinite(t.margin)){throw new Error("Incremental ForceLink layout: margin has to be a positive number")}if(i&&!i.getAttribute("layoutable")){return HA(e,t,e.layouts.forceLink)}else{var n=d({},t,{nodes:t.nodes instanceof _i?t.nodes:e.getNodes(t.nodes)});return qA(e,n,e.layouts.forceLink)}}}};var uw=function(e){return d({},_A(e),EA(e),XA(e),ZA(e),iw(e),nw(e),ow(e),sw(e),{stop:function(){return e.modules.layouts.stop()}})};var lw=function(){function e(){}e.initNamespace=function(e){e.layouts=uw(e)};return e}();function dw(e){return{move:function(t){return e.modules.virtualMouse.move(t)},down:function(t){return e.modules.virtualMouse.down(t)},up:function(t){return e.modules.virtualMouse.up(t)},click:function(t){return e.modules.virtualMouse.click(t)},rightClick:function(t){return e.modules.virtualMouse.rightClick(t)},doubleClick:function(t){return e.modules.virtualMouse.doubleClick(t)},drag:function(t,r){return e.modules.virtualMouse.drag(t,r)},wheel:function(t){return e.modules.virtualMouse.wheel(t)}}}var hw=function(){function e(){}e.initNamespace=function(e){e.mouse=dw(e)};return e}();var fw=function(e){return{astar:function(t,r,i){if(i===void 0){i={}}return e.modules.pathfinding.astar(t,r,i)},dijkstra:function(t,r,i){if(i===void 0){i={}}return e.modules.pathfinding.dijkstra(t,r,i)},dijkstraBig:function(t,r,i){if(i===void 0){i={}}return e.modules.pathfinding.dijkstraBig(t,r,i)}}};var cw=function(){function e(){}e.initNamespace=function(e){e.pathfinding=fw(e)};return e}();var vw=function(e){return{map:function(t){return e.modules.rules.createMapping(t)},slices:function(t){return e.modules.rules.createSlices(t)},template:function(t){return e.modules.rules.createTemplate(t)}}};var pw=function(){function e(){}e.initNamespace=function(e){e.rules=vw(e)};return e}();var gw=function(){function e(){}e.prototype.clearSelection=function(){return this.modules.selection.clear()};e.prototype.getSelectedNodes=function(){return this.modules.selection.getSelectedNodes()};e.prototype.getNonSelectedNodes=function(){return this.modules.selection.getNonSelectedNodes()};e.prototype.getSelectedEdges=function(){return this.modules.selection.getSelectedEdges()};e.prototype.getNonSelectedEdges=function(){return this.modules.selection.getNonSelectedEdges()};return e}();var _w=function(){function e(){}e.prototype.setOptions=function(e){return this.modules.settings.update(e)};e.prototype.getOptions=function(){return this.modules.settings.get()};return e}();var mw=function(e){return{setNodesVisibility:function(value){return e.modules.graphics.setNodesVisibility(value)},setEdgesVisibility:function(value){return e.modules.graphics.setEdgesVisibility(value)},setNodeTextsVisibility:function(value){return e.modules.graphics.setNodeTextsVisibility(value)},setEdgeTextsVisibility:function(value){return e.modules.graphics.setEdgeTextsVisibility(value)},addRule:function(t){return e.modules.styleRules.addRule(t)},getRuleList:function(){return e.modules.styleRules.getRuleList()},addNodeRule:function(t,r){var i,n;if(arguments.length===1){i=t;n=undefined}else{i=r;n=t}return e.styles.addRule({nodeAttributes:i,nodeSelector:n})},addEdgeRule:function(t,r){var i,n;if(arguments.length===1){i=t;n=undefined}else{i=r;n=t}return e.styles.addRule({edgeAttributes:i,edgeSelector:n})},getNodeRules:function(){return e.styles.getRuleList().filter(function(e){return e.getDefinition().edgeAttributes===undefined})},getEdgeRules:function(){return e.styles.getRuleList().filter(function(e){return e.getDefinition().nodeAttributes===undefined})},createClass:function(t){return e.modules.classes.createClass(t)},getClass:function(t){return e.modules.classes.getClassByName(t)},getClassList:function(){return e.modules.classes.getClassList()},setHoveredNodeAttributes:function(t,r){e.modules.hover.updateNodeAttributes(t,r)},setHoveredEdgeAttributes:function(t,r){e.modules.hover.updateEdgeAttributes(t,r)},setSelectedNodeAttributes:function(t,r){return e.modules.selection.setNodeAttributes(t,r)},setSelectedEdgeAttributes:function(t,r){return e.modules.selection.setEdgeAttributes(t,r)}}};var yw=function(){function e(){}e.initNamespace=function(e){e.styles=mw(e)};return e}();function bw(e){return{watchNodeObjectProperty:function(t){return e.modules.watcher.watchNodeObjectProperty(t)},watchEdgeObjectProperty:function(t){return e.modules.watcher.watchEdgeObjectProperty(t)},watchNodeNonObjectProperty:function(t){return e.modules.watcher.watchNodeNonObjectProperty(t)},watchEdgeNonObjectProperty:function(t){return e.modules.watcher.watchEdgeNonObjectProperty(t)}}}var xw=function(){function e(){}e.initNamespace=function(e){e.schema=bw(e)};return e}();var Aw=function(e){return{enable:function(t){e.modules.lasso.enable(t);return this},disable:function(){e.modules.lasso.disable();return this},enabled:function(){return e.modules.lasso.enabled()}}};var Ew=function(e){return{enable:function(t){e.modules.connectNodes.enable(t);return this},disable:function(){e.modules.connectNodes.disable();return this},enabled:function(){return e.modules.connectNodes.enabled()}}};var Sw=function(e){return{enable:function(t){return e.modules.legend.enable(t)},disable:function(){return e.modules.legend.disable()},enabled:function(){return e.modules.legend.enabled()},getOptions:function(){return e.modules.legend.getOptions()}}};var ww=function(e){return{enable:function(t){e.modules.rectangleSelect.enable(t)},disable:function(){e.modules.rectangleSelect.disable()},enabled:function(){return e.modules.rectangleSelect.enabled()}}};var Tw=function(e){return{enable:function(t){e.modules.resizing.enable(t);return this},disable:function(){e.modules.resizing.disable();return this},enabled:function(){return e.modules.resizing.enabled()}}};var Cw=function(e){return{enable:function(t){e.modules.rewiring.enable(t);return this},disable:function(){e.modules.rewiring.disable();return this},enabled:function(){return e.modules.rewiring.enabled()}}};var Iw=function(e){return{enable:function(t){e.modules.snapping.enable(t);return this},disable:function(){e.modules.snapping.disable();return this},enabled:function(){return e.modules.snapping.enabled()}}};var Mw=function(e){return{onNodeHover:function(t,r){e.modules.tooltip.setHandler("hover.node",t,r)},onNodeClick:function(t,r){e.modules.tooltip.setHandler("click.left.node",t,r)},onNodeRightClick:function(t,r){e.modules.tooltip.setHandler("click.right.node",t,r)},onNodeDoubleClick:function(t,r){e.modules.tooltip.setHandler("doubleClick.left.node",t,r)},onEdgeHover:function(t,r){e.modules.tooltip.setHandler("hover.edge",t,r)},onEdgeClick:function(t,r){e.modules.tooltip.setHandler("click.left.edge",t,r)},onEdgeRightClick:function(t,r){e.modules.tooltip.setHandler("click.right.edge",t,r)},onEdgeDoubleClick:function(t,r){e.modules.tooltip.setHandler("doubleClick.left.edge",t,r)},onBackgroundClick:function(t,r){e.modules.tooltip.setHandler("click.left.background",t,r)},onBackgroundRightClick:function(t,r){e.modules.tooltip.setHandler("click.right.background",t,r)},onBackgroundDoubleClick:function(t,r){e.modules.tooltip.setHandler("doubleClick.left.background",t,r)},refresh:function(){return e.modules.tooltip.refresh()},isShown:function(){return e.modules.tooltip.isShown()},hide:function(){e.modules.tooltip.hide()},show:function(t,r){return e.modules.tooltip.show(t,r)}}};var Lw=function(e){return{set:function(t,r){return e.modules.brand.set(t,r)},remove:function(){e.modules.brand.remove()}}};var kw=function(e){return{lasso:Aw(e),connectNodes:Ew(e),legend:Sw(e),rectangleSelect:ww(e),resize:Tw(e),rewire:Cw(e),snapping:Iw(e),tooltip:Mw(e),brand:Lw(e)}};var Nw=function(){function e(){}e.initNamespace=function(e){e.tools=kw(e)};return e}();function Fw(e,t){return e.getEdge(t)==null}var zw=function(e){return true};var Rw=function(e){return""};var Pw=function(e,t,r){return{}};var Ow=function(e){l(t,e);function t(t){var r=e.call(this,t)||this;r._nodeSelector=t.nodeSelector;r._nodeGroupIdFunction=t.nodeGroupIdFunction;r._nodeGenerator=t.nodeGenerator;r._edgeSelector=t.edgeSelector;r._edgeGroupIdFunction=t.edgeGroupIdFunction;r._edgeGenerator=t.edgeGenerator;r._edgeSource=t.edgeSource;r._edgeTarget=t.edgeTarget;r._separateEdgesByDirection=t.separateEdgesByDirection;r._groupSelfLoopEdges=t.groupSelfLoopEdges;r._groupEdges=t.groupEdges;return r}t.prototype._computeNodeGroupId=function(e){return this._nodeSelector(e)?this._nodeGroupIdFunction(e):undefined};t.prototype._computeEdgeGroupId=function(e){return this._edgeSelector(e)?this._edgeGroupIdFunction(e):undefined};t.prototype._addMetaNodes=function(e,t){var r=t.getId();var i=e.getNodes();var n=new ya;for(var a=0;a<i.size;++a){var o=i.get(a);var s=this._computeNodeGroupId(o);if(s!==undefined){var u=n.get(s);if(!u){u={id:s,nodes:[]};n.set(s,u)}u.nodes.push(o)}}var l=n.values();var h=l.map(function(t){var r=t.nodes;return e.getNodes(r)});var f=[];for(var a=0;a<l.length;++a){var s=l[a].id;var c=h[a];var v=this._nodeGenerator(c,s,t);if(v.id===undefined){v.id=jw(s,r)}v.position=kf(c.getPosition());f.push(v)}return e.addNodes(f.map(function(e){return{id:e.id,attributes:e.position}}),{virtual:true}).then(function(){var t=e.getNodes(f.map(function(e){return e.id}));t.replaceOriginalAttributes(f.map(function(e){return e.attributes}),["x","y"]);var r=t.getData();for(var i=0;i<r.length;i++){var n=r[i];var a=f[i];r[i]=n===undefined?a.data:d({},n,a.data)}t.setData(null,r);t.setVisible(true);e.modules.grouping.setSubElements(t,h);h.forEach(function(r,i){e.modules.grouping.setMetaElement(r,t.get(i))});return t})};t.prototype._addMetaEdges=function(e,t){var r=t.getId();var i=e.getEdges();var n=new ya;var a=e.modules.graphics.getAttributesManager().getUsedEdgeAttributes();for(var o=0;o<i.size;++o){var s=i.get(o);var u=this._computeEdgeGroupId(s);if(u!==undefined){var l=this._edgeSource(s);var h=this._edgeTarget(s);var f=this._groupEdges?Bw(u,l.getId(),h.getId(),this._separateEdgesByDirection):String(s.getId());var c=n.get(f);if(!c){c={id:f,source:l,target:h,edges:[]};n.set(f,c)}c.edges.push(s)}}var v=n.values();var p=v.map(function(t){var r=t.edges;return e.getEdges(r)});var g=[];for(var o=0;o<v.length;++o){var c=v[o];var u=c.id;var _=p[o];var m=this._groupEdges?this._edgeGenerator(_,u,t):Vw(_,a);if(m.id!=null&&!Fw(e,m.id)){throw Error("The id "+m.id+" returned by the edgeGenerator function is not a unique id.")}if(m.id===undefined){m.id=jw(u,r)}m.source=c.source.getId();m.target=c.target.getId();g.push(m)}return e.addEdges(Dw(g),{virtual:true}).then(function(){var t=e.getEdges(g.map(function(e){return e.id}));t.replaceOriginalAttributes(g.map(function(e){return e.attributes}));var r=t.getData();for(var i=0;i<r.length;i++){var n=g[i];var a=r[i];r[i]=a===undefined?n.data:d({},a,n.data)}t.setData(null,r);t.setVisible(true);e.modules.grouping.setSubElements(t,p);p.forEach(function(r,i){e.modules.grouping.setMetaElement(r,t.get(i))});return t})};return t}(lv);function Dw(e){return e.map(function(e){var t=e.id,r=e.source,i=e.target;return{id:t,source:r,target:i}})}function Bw(e,t,r,i){var n=t;var a=r;if(!i&&n.toString()>a.toString()){n=r;a=t}return e+"["+n+"-"+a+"]"}function Vw(e,t){var r=e.get(0);return{data:r.getData(),attributes:r.getAttributes(t)}}function jw(e,t){return"gen_grp_"+t+"_"+e}var Uw=function(e){l(t,e);function t(t){var r=t.selector,i=r===void 0?zw:r,n=t.groupIdFunction,a=n===void 0?Rw:n,o=t.nodeGenerator,s=o===void 0?Pw:o,u=t.edgeGenerator,l=u===void 0?Pw:u,d=t.separateEdgesByDirection,h=d===void 0?false:d,f=t.groupSelfLoopEdges,c=f===void 0?false:f,v=t.groupEdges,p=v===void 0?true:v,g=t.restorePositions,_=g===void 0?true:g;var m=e.call(this,{nodeSelector:i,nodeGroupIdFunction:a,nodeGenerator:s,edgeSelector:function(e){return!!(e.getSource().getMetaNode()||e.getTarget().getMetaNode())},edgeGroupIdFunction:function(){return""},edgeGenerator:l,edgeSource:function(e){return Gw(e.getSource())},edgeTarget:function(e){return Gw(e.getTarget())},separateEdgesByDirection:h,groupEdges:p})||this;m._groupSelfLoopEdges=c;m._restorePositions=_;return m}t.prototype.getName=function(){return"node-grouping"};t.prototype.run=function(e){var t=this;var r=e.ogma,i=e.duration,n=e.wrapper;var a,o;var s,u,l;return this._addMetaNodes(r,n).then(function(e){a=e;a.setVisible(false);return t._addMetaEdges(r,n)}).then(function(e){o=e;o.setVisible(false);s=a.getSubNodes().reduce(function(e,value){return e.concat(value)},r.createNodeList());u=o.getSubEdges().reduce(function(e,value){return e.concat(value)},r.createEdgeList());var t=r.getNodes(s.getMetaNode()).getPosition();l=s.getPosition().map(function(e,r){var i=t[r];return{x:e.x-i.x,y:e.y-i.y}});return s.setAttributes(t,i)}).then(function(){s.setVisible(false);u.setVisible(false);a.setVisible(true);o.filter(function(e){return t._groupSelfLoopEdges||e.getSource()!==e.getTarget()}).setVisible(true);return{metaNodes:a,metaEdges:o,subNodes:s,subEdges:u,offsets:l}})};t.prototype.undo=function(e){var t=this;var r=e.ogma,i=e.duration,n=e.context;var a=n.metaNodes,o=n.metaEdges,s=n.subNodes,u=n.subEdges,l=n.offsets;var d=r.getNodes(s.getMetaNode()).getPosition();var h=d.map(function(e,t){return qw(e,l[t])});s.setVisible(true);u.setVisible(true);r.modules.grouping.setMetaElement(s,null);r.modules.grouping.setMetaElement(u,null);a.setVisible(false);o.setVisible(false);return s.setAttributes(d).then(function(){if(t._restorePositions){return s.setAttributes(h,i)}})};t.prototype.cleanup=function(e){var t=e.ogma,r=e.context;var i=r.metaNodes,n=r.metaEdges;var a=i.filter(function(e){return!e.isVisible()});var o=n.filter(function(e){return!e.isVisible()});return Promise.all([t.removeEdges(o,{virtual:true}),t.removeNodes(a,{virtual:true})]).then(function(){return Promise.resolve()})};return t}(Ow);function Gw(e){return e.getMetaNode()||e}function qw(e,t){return{x:e.x+t.x,y:e.y+t.y}}var Hw=function(e){l(t,e);function t(t){var r=t.selector,i=r===void 0?zw:r,n=t.groupIdFunction,a=n===void 0?Rw:n,o=t.generator,s=o===void 0?Pw:o,u=t.separateEdgesByDirection,l=u===void 0?false:u;return e.call(this,{nodeSelector:null,nodeGroupIdFunction:null,nodeGenerator:null,edgeSelector:i,edgeGroupIdFunction:a,edgeGenerator:s,edgeSource:function(e){return e.getSource()},edgeTarget:function(e){return e.getTarget()},separateEdgesByDirection:l,groupEdges:true})||this}t.prototype.getName=function(){return"edge-grouping"};t.prototype.run=function(e){var t=e.ogma,r=e.wrapper;var i,n;return this._addMetaEdges(t,r).then(function(e){i=e;n=i.getSubEdges().reduce(function(e,value){return e.concat(value)},t.createEdgeList());n.setVisible(false);return{metaEdges:i,subEdges:n}})};t.prototype.undo=function(e){var t=e.context;var r=t.metaEdges,i=t.subEdges;i.setVisible(true);r.setVisible(false);return Promise.resolve()};t.prototype.cleanup=function(e){var t=e.ogma,r=e.context;var i=r.metaEdges;return t.removeEdges(i.filter(function(e){return!e.isVisible()}),{virtual:true})};return t}(Ow);var Ww=function(e){return{addNodeGrouping:function(t){if(t===void 0){t={}}return e.modules.transformations.add(new Uw(t),{duration:t.duration,enabled:t.enabled})},addEdgeGrouping:function(t){if(t===void 0){t={}}return e.modules.transformations.add(new Hw(t),{duration:t.duration,enabled:t.enabled})}}};var Xw=function(e){return{addNodeFilter:function(t){return e.modules.filters.addNodeFilter(t)},addEdgeFilter:function(t){return e.modules.filters.addEdgeFilter(t)}}};var Yw=function(e){function t(t){e.call(this);var r=t.selector;if(r===void 0)r=function(){return true};var i=t.neighborIdFunction;if(i===void 0)i=function(){return null};var n=t.nodeGenerator;if(n===void 0)n=function(){return{}};var a=t.edgeGenerator;if(a===void 0)a=function(){return{}};this._generateIds=function(e){return r(e)&&i(e)};this._nodeGenerator=n;this._edgeGenerator=a}if(e)t.__proto__=e;t.prototype=Object.create(e&&e.prototype);t.prototype.constructor=t;t.prototype.run=function e(t){var r=this;var i=t.ogma;var n=t.duration;var a=t.wrapper;var o=a.getId();var s=i.getNodes();var u=new ya;for(var l=0;l<s.size;++l){var d=s.get(l);var h=Zw(this._generateIds(d));if(h){for(var f=0;f<h.length;++f){var c=h[f];var v=u.get(c);if(!v){v=[];u.set(c,v)}v.push(d)}}}var p=new Array(u.size);var g=u.keys();var _=u.values().map(function(e){return i.getNodes(e)});for(var m=0;m<p.length;++m){var y=g[m];var b=_[m];var x=this._nodeGenerator(y,b);x.id="_gen_"+o+"_"+y;x.position=kf(b.getPosition());p[m]=x}var A,E;return i.addNodes(p.map(function(e){return{id:e.id,attributes:e.position}}),{virtual:true}).then(function(e){A=e;A.replaceOriginalAttributes(p.map(function(e){return e.attributes}),["x","y"]);A.setData(null,p.map(function(e){return e.data}));var t=[];for(var n=0;n<e.size;++n){var a=e.get(n);var o=_[n];for(var s=0;s<o.size;++s){var u=o.get(s);var l=r._edgeGenerator(u,a);if(!l.source&&!l.target){l.source=u;l.target=a}t.push(l)}}return i.addEdges(t,{virtual:true})}).then(function(e){E=e;A.setVisible(true);E.setVisible(true);A.addClass(Nl);E.addClass(Nl);return Promise.all([A.removeClass(Nl,n),E.removeClass(Nl,n)])}).then(function(){return{virtualNodes:A,virtualEdges:E}})};t.prototype.undo=function e(t){var r=t.context;var i=t.duration;var n=r.virtualNodes;var a=r.virtualEdges;return Promise.all([n.addClass(Nl,i),a.addClass(Nl,i)]).then(function(){n.setVisible(false);a.setVisible(false)})};t.prototype.cleanup=function e(t){var r=t.ogma;var i=t.context;var n=i.virtualNodes.filter(function(e){return!e.isVisible()});var a=i.virtualEdges.filter(function(e){return!e.isVisible()});r.removeNodes(n,{virtual:true});r.removeEdges(a,{virtual:true});return Promise.resolve()};return t}(lv);function Zw(value){return Array.isArray(value)?value:value?[value]:null}var Kw=function(e){function t(t){e.call(this);var r=t.selector;if(r===void 0)r=function(){return false};var i=t.dataFunction;if(i===void 0)i=function(){return undefined};this._selector=r;this._dataFunction=i}if(e)t.__proto__=e;t.prototype=Object.create(e&&e.prototype);t.prototype.constructor=t;t.prototype.run=function e(t){var r=t.ogma;var i=t.duration;var n=r.getNodes().filter(this._selector);var a=[];var o=new ya;for(var s=0;s<n.size;++s){var u=n.get(s);var l=u.getAdjacentEdges();var d=this._dataFunction(u);for(var h=0;h<l.size;++h){var f=l.get(h);var c=f.getSource();var v=f.getTarget();if(c!==v&&d!==undefined){var p=c===u?v:c;var g=o.get(p);if(!g){g=[];o.set(p,g)}g.push(d)}a.push(f)}}var _=r.getEdges(a);var m=r.getNodes(o.keys());var y=o.values();var b=m.getData();var x=new Array(m.size);for(var A=0;A<x.length;++A){var E=y[A];var S=b[A];for(var w=0;w<E.length;++w){S=Z(S,E[w])}x[A]=S}return Promise.all([n.addClass(Nl,i),_.addClass(Nl,i)]).then(function(){n.setVisible(false);_.setVisible(false);m.setData(x);return{hiddenNodes:n,hiddenEdges:_,nodesWithDataChange:m,oldDataList:b}})};t.prototype.undo=function e(t){var r=t.duration;var i=t.context;var n=i.hiddenNodes;var a=i.hiddenEdges;var o=i.nodesWithDataChange;var s=i.oldDataList;n.setVisible(true);a.setVisible(true);n.addClass(Nl);a.addClass(Nl);return Promise.all([n.removeClass(Nl,r),a.removeClass(Nl,r)]).then(function(){o.setData(s)})};return t}(lv);var Qw=function(e){return{addNeighborGeneration:function(t){return e.modules.transformations.add(new Yw(t),{duration:t.duration,enabled:t.enabled})},addNeighborMerging:function(t){return e.modules.transformations.add(new Kw(t),{duration:t.duration,enabled:t.enabled})}}};var Jw=function(e){l(t,e);function t(t){var r=t.selector,i=r===void 0?function(){return false}:r,n=t.edgeGenerator,a=n===void 0?function(){return{}}:n;var o=e.call(this)||this;o._selector=i;o._edgeGenerator=a;return o}t.prototype.getName=function(){return Km.NodeCollapsing};t.prototype.run=function(e){var t=this;var r=e.ogma,i=e.duration;var n=r.getNodes().filter(this._selector);var a=n.getAdjacentEdges();var o=[];for(var s=0;s<n.size;++s){var u=n.get(s);var l=u.getAdjacentNodes().filter(function(e){return!t._selector(e)});for(var d=0;d<l.size-1;++d){var h=l.get(d);var f=r.modules.graph.getEdgesBetweenTwoNodes(u,h);if(h===u){continue}for(var c=d+1;c<l.size;++c){var v=l.get(c);var p=r.modules.graph.getEdgesBetweenTwoNodes(u,v);var g=this._edgeGenerator(u,h,v,f,p);if(g){var _=A(g);for(var m=0;m<_.length;++m){o.push($w(r,_[m],m,u,h,v,f,p))}}}}}return r.addEdges(o,{virtual:true}).then(function(e){return e.addClass(Nl)}).then(function(e){return Promise.all([e.removeClass(Nl,i),n.addClass(Nl,i),a.addClass(Nl,i)])}).then(function(e){var t=e[0];n.setVisible(false);a.setVisible(false);return{virtualEdges:t,hiddenNodes:n,hiddenEdges:a}})};t.prototype.undo=function(e){var t=e.duration,r=e.context;var i=r.virtualEdges,n=r.hiddenNodes,a=r.hiddenEdges;n.setVisible(true);a.setVisible(true);return Promise.all([n.addClass(Nl),a.addClass(Nl)]).then(function(){return Promise.all([n.removeClass(Nl,t),a.removeClass(Nl,t),i.addClass(Nl,t)])}).then(function(){i.setVisible(false)})};t.prototype.cleanup=function(e){var t=e.ogma,r=e.context;return t.removeEdges(r.virtualEdges.filter(function(e){return!e.isVisible()}),{virtual:true})};return t}(lv);function $w(e,t,r,i,n,a,o,s){var u=null;var l=null;if(t.source!==undefined){u=e.getNode(t.source);if(u!==n&&u!==a){throw new Error(["addNodeCollapsing: edge generator produced RawEdge with invalid source ["+t.source+"]","expected to be ["+n.getId()+"] or ["+a.getId()+"]"].join("; "))}}if(t.target!==undefined){l=e.getNode(t.target);if(l!==n&&l!==a){throw new Error(["addNodeCollapsing: edge generator produced RawEdge with invalid target ["+t.target+"]","expected to be ["+n.getId()+"] or ["+a.getId()+"]"].join("; "))}}if(u&&l&&u===l){throw new Error("addNodeCollapsing: edge generator produced RawEdge with same source and target ["+u.getId()+"]")}if(u&&!l){l=u===n?a:n}else if(l&&!u){u=l===n?a:n}else if(!u&&!l){var h=true;for(var f=0;f<o.size;++f){var c=o.get(f);if(c.getSource()===n){h=false}}for(var f=0;f<s.size;++f){var c=s.get(f);if(c.getTarget()===a){h=false}}if(h){u=a;l=n}else{u=n;l=a}}return d({},t,{id:"_gen_"+i.getId()+"_"+u.getId()+"_"+l.getId()+"_"+r,source:u.getId(),target:l.getId()})}var eT=function(e){return{addNodeCollapsing:function(t){if(t===void 0){t={}}return e.modules.transformations.add(new Jw(t),{duration:t.duration,enabled:t.enabled})}}};var tT=function(e){function t(t){e.call(this);var r=t.nodeSelector;if(r===void 0)r=function(){return true};var i=t.edgeSelector;if(i===void 0)i=function(){return true};var n=t.nodeDataFunction;if(n===void 0)n=null;var a=t.edgeDataFunction;if(a===void 0)a=null;this._nodeSelector=r;this._edgeSelector=i;this._nodeDataFunction=n;this._edgeDataFunction=a}if(e)t.__proto__=e;t.prototype=Object.create(e&&e.prototype);t.prototype.constructor=t;t.prototype.getName=function e(){return"virtual-properties"};t.prototype.run=function e(t){var r=t.ogma;var i={nodes:null,oldNodesData:null,edges:null,oldEdgesData:null};if(this._nodeDataFunction){i.nodes=r.getNodes().filter(this._nodeSelector);i.oldNodesData=rT(i.nodes,this._nodeDataFunction)}if(this._edgeDataFunction){i.edges=r.getEdges().filter(this._edgeSelector);i.oldEdgesData=rT(i.edges,this._edgeDataFunction)}return Promise.resolve(i)};t.prototype.undo=function e(t){var r=t.context;var i=r.nodes;var n=r.oldNodesData;var a=r.edges;var o=r.oldEdgesData;if(i){i.setData(n)}if(a){a.setData(o)}return Promise.resolve()};return t}(lv);function rT(e,t){var r=[];for(var i=0;i<e.size;++i){var n=e.get(i);var a=n.getData();var o=t(n);var s=Z(a,o);r.push(a);n.setData(s)}return r}var iT=function(e){return{addVirtualProperties:function(t){return e.modules.transformations.add(new tT(t),{duration:t.duration,enabled:t.enabled})}}};var nT=function(e){return{getList:function(){return e.modules.transformations.getList()},clear:function(){return e.modules.transformations.clear()},afterNextUpdate:function(){return e.modules.transformations.whenApplied()}}};var aT=function(e){return d({},nT(e),Ww(e),Xw(e),Qw(e),eT(e),iT(e))};var oT=function(){function e(){}e.initNamespace=function(e){e.transformations=aT(e)};e.prototype.addNodeFilter=function(e){return this.modules.filters.addNodeFilter(e)};e.prototype.addEdgeFilter=function(e){return this.modules.filters.addEdgeFilter(e)};e.prototype.getNodeFilters=function(){return this.modules.transformations.getList().filter(function(e){return e.getName()===Km.NodeFilter})};e.prototype.getEdgeFilters=function(){return this.modules.transformations.getList().filter(function(e){return e.getName()===Km.EdgeFilter})};e.prototype.clearNodeFilters=function(){return Promise.all(this.getNodeFilters().map(function(e){return e.destroy()})).then(function(){return Promise.resolve()})};e.prototype.clearEdgeFilters=function(){return Promise.all(this.getEdgeFilters().map(function(e){return e.destroy()})).then(function(){return Promise.resolve()})};return e}();function sT(e){var t=e.modules,r=t.camera,i=t.captor,n=t.dom,a=t.graphics,o=t.locate;return{setZoom:function(e,t){return r.setZoom(e,t)},zoomIn:function(e,t){return r.zoomIn(e,t)},zoomOut:function(e,t){return r.zoomOut(e,t)},getZoom:function(){return r.getZoom()},setCenter:function(e,t){return r.setCenter(e,t)},move:function(e,t){return r.move(e,t)},getCenter:function(){return r.getCenter()},setAngle:function(e,t){return r.setAngle(e,t)},rotate:function(e,t){return r.rotate(e,t)},getAngle:function(){return r.getAngle()},set:function(e,t){return r.setView(e,t)},get:function(){return r.getView()},graphToScreenCoordinates:function(e){return r.graphToScreenCoordinates(e)},screenToGraphCoordinates:function(e){return r.screenToGraphCoordinates(e)},getImageData:function(){return a.getImageData()},getElementAt:function(e){return i.getElementAt(e)},beforeNextFrame:function(){return n.beforeNextFrame()},afterNextFrame:function(){return n.afterNextFrame()},setFullScreen:function(value){return n.setFullScreen(value)},isFullScreen:function(){return n.isFullScreen()},forceResize:function(){return n.forceResize()},getSize:function(){return n.getDimensions()},setSize:function(e){if(!e||isNaN(e.width)||isNaN(e.height)){throw new Error("Size must follow the format { width: number, height: number }")}else{if(e.width<0){throw new Error("width must be positive")}if(e.height<0){throw new Error("height must be positive")}n.setDimensions(e);return Promise.resolve()}},locateGraph:function(e){return o.locateGraph(e)},locateRawGraph:function(e,t){return o.locateRawGraph(e,t)},getGraphBoundingBox:function(){return o.getGraphBoundingBox()}}}var uT=function(){function e(){}e.initNamespace=function(e){e.view=sT(e)};return e}();var lT=Object.freeze({__proto__:null,circleCircleIntersection:circleCircleIntersection,circleSortCompare:circleSortCompare,circleContainsPoint:Wd,circleContainsCircle:Xd,circleIntersectsBox:Yd,circleLineIntersection:Zd,isPointInLine:Du,twoSegmentsIntersect:Bu,lineAngle:ju,angle:Uu,lineIntersection:Gu,segmentIntersection:qu,segmentRectangleIntersection:Hu,lineLine:Wu,lineAABB:Xu,distancePointSegment:Yu,distToSegmentSquared:Zu,getClosestPointOnSegment:Ku,getClosestPointOnLine:Qu,defaultAABB:lu,rotate:du,move:hu,distance:distance,squaredDistance:fu,radiansToDegrees:cu,degreesToRadians:vu,extendBounds:pu,isPointInPolygon:Tf,polygonsIntersect:Lf,computeCentroid:kf,getPointOnQuadraticCurve:ul,isPointOnQuadraticCurve:ll,getPointOnBezierCurve:dl,isPointOnBezierCurve:hl,getQuadraticCurveBoundingBox:fl,getBezierCurveBoundingBox:cl,quadBezierAABB:al,cubicBezierAABB:sl,getSelfLoopControlPoints:tu,getQuadraticCurveControlPoint:eu,getAABB:lg,getOBBPoints:dg,moveAABB:hg,padBounds:fg,overlapsAABB:cg,intersects:vg,overlaps:pg});var dT=function(e){return--e*e*e+1};var hT=function(e,t,r){var i=e-r[0];var n=t-r[1];return i*i+n*n};var fT=function(e,t){var r=Infinity;var i=-Infinity;for(var n=0;n<e.length;n++){var a=e[n];var o=t?t[a]:a;r=Math.min(o,r);i=Math.max(o,i)}return{min:r,max:i}};function circlePack(e){var t=e.X,r=e.Y,i=e.R,n=e.center,a=e.maxSteps,o=a===void 0?1e3:a,s=e.padding,u=s===void 0?5:s,l=e.epsilon,d=l===void 0?1e-5:l,h=e.damping,f=h===void 0?2:h,c=e.pinned,v=e.indexes,p=e.onUpdate,g=e.pushSmallerOut,_=g===void 0?true:g;var m=v?v.length:t.length;var y=v;if(!isFinite(c)){c=-1}if(y===undefined){y=new Uint32Array(m);for(var b=0;b<m;b++){y[b]=b}}else{y=v}if(c!==-1){n=[t[c],r[c]]}else if(!n){var x=0;var A=0;for(var b=0;b<m;b++){x+=t[y[b]];A+=r[y[b]]}n=[x/m,A/m]}var E=fT(y,i),S=E.min,w=E.max;y.sort(function(e,a){return i[a]*hT(t[a],r[a],n)-i[e]*hT(t[e],r[e],n)});function T(e,a){var o=0;for(var s=0;s<m-1;s++){for(var l=s+1;l<m;l++){if(s===l){continue}var d=y[s];var h=y[l];var v=t[d];var p=r[d];var g=i[d];var b=t[h];var x=r[h];var A=i[h];var E=b-v;var T=x-p;var C=g+A+u;var I=E*E+T*T;if(I<C*C-e){var M=(C-Math.sqrt(I))*a;var L=1/I;var k=E*L*M;var N=T*L*M;var F=k*k+N*N;if(h!==c){var z=g/S;o+=F*z;t[h]+=k*z;r[h]+=N*z}if(d!==c){var z=A/S;o+=F*z;t[d]-=k*z;r[d]-=N*z}}}}var R=e*f*(1-a);var P=n[0];var O=n[1];for(var s=0;s<m;s++){var d=y[s];if(d!==c){var D=t[d];var B=r[d];var C=i[d];var z=C/w;var V=_?R*z:R;var k=(D-P)*V;var N=(B-O)*V;var F=k*k+N*N;o+=F;t[d]-=k;r[d]-=N}}return o}var C=0;var I=0;var M=dT(1/m);for(var b=0;b<o;b++){C=T(M,dT((b+1)/o));if(p){setTimeout(function(){return p(t,r)})}if(Math.abs(C-I)<d){break}I=C}return{X:t,Y:r}}var cT=Object.freeze({__proto__:null,minHeap:minHeap,bellmanFord:bellmanFord,dijkstra:dijkstra,johnson:johnson,largestEmptyCircle:kA,minDisk:minDisk,removeRadialOverlap:removeRadialOverlap,convexhull:MA,circlePack:circlePack,Quadtree:wg,weightedStress:weightedStress,distanceStress:distanceStress,constrainedStress:constrainedStress,stressMinimizationStep:stressMinimizationStep,stressMinimizationStepGeneral:stressMinimizationStepGeneral,detectCyclesUndirected:qv,detectCyclesDirected:Wv,detectCyclesUndirectedDFS:Yv,CyclesFinder:Zv});var vT=1;var Ogma=function(){function Ogma(e){if(e===void 0){e={}}var t=this;this.node=function(e){return new gi(e,t)};this.edge=function(e){return new Vr(e,t)};this.nodeList=function(e){return new _i(e||new Uint32Array(0),t)};this.edgeList=function(e){return new jr(e||new Uint32Array(0),t)};this._onReady=[];if(this===undefined||this===null||this.constructor!==Ogma){return new Ogma(e)}this._init(e)}Ogma.prototype._init=function(e){var t=this;this._initParameters=e;this._debug=!!e.debug;this._token=vT++;this.modules=new ty(this,e);yw.initNamespace(this);iy.initNamespace(this);Mb.initNamespace(this);pA.initNamespace(this);lx.initNamespace(this);lw.initNamespace(this);cA.initNamespace(this);oT.initNamespace(this);Nw.initNamespace(this);uT.initNamespace(this);hw.initNamespace(this);dy.initNamespace(this);xw.initNamespace(this);pw.initNamespace(this);hx.initNamespace(this);cw.initNamespace(this);sy.initNamespace(this);this._onReady.forEach(function(e){return e(t)});this.safelyBindToInstance()};Ogma.prototype.safelyBindToInstance=function(){for(var e=0,t=Object.keys(Ogma.prototype);e<t.length;e++){var r=t[e];if(typeof Ogma.prototype[r]==="function"){this[r]=this[r].bind(this)}}};Ogma.prototype.onReady=function(e){this._onReady.push(e)};Ogma.prototype._destroy=function(){if(!this._token){throw new Error('"destroy" called twice on the same instance of Ogma')}this._onReady=[];this.modules.destroy();this.modules=null};Ogma.prototype.destroy=function(){this._destroy()};Ogma.prototype.reset=function(){var e=this._initParameters;this._destroy();this._init(e)};Ogma.libraries=c;Ogma.build={version:"2.9.0",commit:"376beea",date:"Thu Nov 14 2019 12:07:15 GMT+0100 (Central European Standard Time)"};Ogma.geometry=lT;Ogma.algorithms=cT;Ogma.utils=ro;return Ogma}();var pT=[iy,ny,ay,sy,uy,dy,Mb,lx,hx,_x,mx,cA,pA,lw,cw,gw,_w,yw,Nw,oT,uT,hw,xw,pw];Object.assign.apply(Object,[Ogma.prototype].concat(pT.map(function(e){return e.prototype})));return Ogma});
